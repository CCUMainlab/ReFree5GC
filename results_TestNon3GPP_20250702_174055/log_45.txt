Run TestCN
os.Args: [/tmp/go-build2675355040/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-07-02T18:10:18.087990695+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.088071741+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.088076916+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.088082118+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-07-02T18:10:18.088095317+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-07-02T18:10:18.092948929+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.092976598+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.092985377+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.093252918+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-07-02T18:10:18.096431982+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.096517988+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.096608904+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.098295765+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-07-02T18:10:18.098327280+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-07-02T18:10:18.098533467+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T18:10:18.098572380+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.098593987+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.098611085+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.099217853+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.099265940+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.099273966+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.099296006+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-07-02T18:10:18.099485611+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-07-02T18:10:18.100507321+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.100539436+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.100548862+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.100565578+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-07-02T18:10:18.100584051+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-07-02T18:10:18.100738947+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.100765461+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.100773675+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.101013951+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.101042726+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.101051657+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.101066906+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 8da3caf0-2112-4c63-8ba4-fb2518feae96 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{8da3caf0-2112-4c63-8ba4-fb2518feae96 nausf-auth 0xc0000d9ed8 http REGISTERED   0xc0000d9ec0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000113860 false false}
2025-07-02T18:10:18.101227897+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-07-02T18:10:18.101442531+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:18.101473827+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-07-02T18:10:18.101481099+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:18.101503465+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-07-02T18:10:18.101525073+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-07-02T18:10:18.101659778+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-07-02T18:10:18.101728071+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-07-02T18:10:18.302511158+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-07-02T18:10:18.302650818+08:00[36m [INFO][AMF][Init] [0mServer started
2025-07-02T18:10:18.303126084+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-07-02T18:10:18.304251413+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:18.312392276+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:18.314274519+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 524d49b3-d7f2-4e31-8fc2-b33011f03cd2
2025-07-02T18:10:18.316758988+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/524d49b3-d7f2-4e31-8fc2-b33011f03cd2 |  |
2025-07-02T18:10:18.316932452+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:18.317028970+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-07-02T18:10:18.503338998+08:00[36m [INFO][SMF][Init] [0mServer started
2025-07-02T18:10:18.505603731+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:18.524637688+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:18.527111752+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6269b6ee-4a8f-42be-9246-c024926799f9
2025-07-02T18:10:18.528935456+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6269b6ee-4a8f-42be-9246-c024926799f9 |  |
2025-07-02T18:10:18.529197591+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:18.529333600+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {6269b6ee-4a8f-42be-9246-c024926799f9 SMF REGISTERED 0 0xc0007b8828 0xc0007b8858 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000212040 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0007b86d8 false false []}
2025-07-02T18:10:18.529390365+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-07-02T18:10:18.529456783+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-07-02 18:10:18.529451267 +0800 CST m=+0.473664360]
2025-07-02T18:10:18.529516450+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-07-02T18:10:18.708620429+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:18.720169249+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:18.722195265+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 78ab3183-658e-4a39-a995-23fdcea2b2ed
2025-07-02T18:10:18.723617916+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/78ab3183-658e-4a39-a995-23fdcea2b2ed |  |
2025-07-02T18:10:18.724233610+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:18.724281689+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-07-02T18:10:18.724287655+08:00[36m [INFO][UDR][Init] [0mServer started
2025-07-02T18:10:18.724290966+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T18:10:18.724344583+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-07-02T18:10:18.908164599+08:00[36m [INFO][PCF][Init] [0mServer started
2025-07-02T18:10:18.910818552+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:18.922555615+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:18.924948308+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 43a18de6-b8a1-4a36-888f-910cd4ea8d6a
2025-07-02T18:10:18.926555584+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/43a18de6-b8a1-4a36-888f-910cd4ea8d6a |  |
2025-07-02T18:10:18.929500819+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:18.929530045+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-07-02T18:10:19.109358340+08:00[36m [INFO][UDM][Init] [0mServer started
2025-07-02T18:10:19.109414714+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-07-02T18:10:19.112801951+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:19.119943726+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:19.124333964+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 1a93310c-2c10-46d2-b22e-e09d0b023ff3
2025-07-02T18:10:19.125454815+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/1a93310c-2c10-46d2-b22e-e09d0b023ff3 |  |
2025-07-02T18:10:19.125721795+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:19.125731677+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-07-02T18:10:19.311170193+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:19.325786452+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:19.327942288+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 7c36d083-8a61-4a2e-90ec-99657a78db8e
2025-07-02T18:10:19.331124463+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/7c36d083-8a61-4a2e-90ec-99657a78db8e |  |
2025-07-02T18:10:19.331277444+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:19.331321516+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-07-02T18:10:19.331326657+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-07-02T18:10:19.511979671+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-07-02T18:10:19.513857202+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:19.523244349+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:19.525061536+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8da3caf0-2112-4c63-8ba4-fb2518feae96
2025-07-02T18:10:19.526928959+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8da3caf0-2112-4c63-8ba4-fb2518feae96 |  |
2025-07-02T18:10:19.527067746+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:19.527099723+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-07-02T18:10:19.530637912+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-07-02T18:10:19.531557244+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-07-02T18:10:19.714733455+08:00[36m [INFO][CHF][Init] [0mServer started
2025-07-02T18:10:19.717073022+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-07-02T18:10:19.723189820+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T18:10:19.731576468+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T18:10:19.733336086+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 27731051-c2cc-40a2-9d62-b9d5db236f99
2025-07-02T18:10:19.735268334+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/27731051-c2cc-40a2-9d62-b9d5db236f99 |  |
2025-07-02T18:10:19.735416106+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T18:10:19.735424643+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-07-02T18:10:26.765941819+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574
2025-07-02T18:10:26.767262066+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574
2025-07-02T18:10:26.767466380+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle NGSetupRequest
2025-07-02T18:10:26.767474482+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mMissing IE PagingDRX
2025-07-02T18:10:26.767488774+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build4110724767/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-07-02T18:10:33.089465517+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.089596084+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.089601727+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:33.089604919+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T18:10:33.089607133+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:33.089802963+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.089808930+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.089810605+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:33.089813157+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T18:10:33.089814858+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:33.098599755+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.098643275+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.098653330+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.098661667+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.098668559+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.098675898+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.098682332+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-07-02T18:10:33.102296499+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.102330073+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T18:10:33.102338935+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:33.102354536+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:33.102361039+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:33.102379158+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.102388597+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.102394659+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.102405310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.102411178+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.102416769+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.104410460+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.104457060+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.104467628+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.104475337+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.104482370+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104488566+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.104552967+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.104561033+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.104571354+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.104578238+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.104586547+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.104592950+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-07-02T18:10:33.104651180+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104658171+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.104664407+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T18:10:33.104673956+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.104680204+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104686009+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.104697133+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.104703404+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104709509+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.105590129+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle InitialUEMessage
2025-07-02T18:10:33.105650223+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-07-02T18:10:33.105677293+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-07-02T18:10:33.105705260+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-07-02T18:10:33.105716588+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-07-02T18:10:33.105721183+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-07-02T18:10:33.105724410+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-07-02T18:10:33.105728000+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-07-02T18:10:33.105732729+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-07-02T18:10:33.105735935+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-07-02T18:10:33.106388894+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.132589366+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-07-02T18:10:33.134847360+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-07-02T18:10:33.134858057+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-07-02T18:10:33.135292462+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.202585067+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-07-02T18:10:33.211148659+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-07-02T18:10:33.211185701+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-07-02T18:10:33.211188488+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-07-02T18:10:33.211190724+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-07-02T18:10:33.211628872+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.237167055+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-07-02T18:10:33.240704843+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T18:10:33.242741903+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T18:10:33.242864843+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-07-02T18:10:33.243426349+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-07-02T18:10:33.243457281+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-07-02T18:10:33.243468087+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3665396365346139323961636231313338316662316363386338356461353233
2025-07-02T18:10:33.243520615+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-07-02T18:10:33.243606597+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-07-02T18:10:33.244119130+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend Downlink Nas Transport
2025-07-02T18:10:33.244349182+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-07-02T18:10:33.245072722+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.245093285+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.245096305+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.245098628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.245100526+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.245102216+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.245115380+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.245117398+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.245119205+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.245207213+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.245211076+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.245212913+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T18:10:33.245218477+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.245219927+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.245222163+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.245227227+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.245228591+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.245230019+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.245579071+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:33.245646449+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:33.245674937+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-07-02T18:10:33.245677740+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-07-02T18:10:33.245680435+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-07-02T18:10:33.246266143+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-07-02T18:10:33.246294341+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3665396365346139323961636231313338316662316363386338356461353233
Xres*: 3665396365346139323961636231313338316662316363386338356461353233
2025-07-02T18:10:33.246303825+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-07-02T18:10:33.246597265+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-07-02T18:10:33.247820715+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-07-02T18:10:33.247912692+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-07-02T18:10:33.248115089+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-07-02T18:10:33.248471963+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-07-02T18:10:33.248536471+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-07-02T18:10:33.248549388+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend Downlink Nas Transport
2025-07-02T18:10:33.248624579+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-07-02T18:10:33.249250899+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.249264264+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.249266939+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.249269893+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.249271573+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249276506+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.249285897+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.249287799+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.249289787+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.249312055+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249313982+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.249315528+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T18:10:33.249320077+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.249321542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249324569+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.249329538+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.249330932+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249332314+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.250357338+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:33.250376090+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:33.250394111+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-07-02T18:10:33.250397106+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-07-02T18:10:33.250399884+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-07-02T18:10:33.250410416+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-07-02T18:10:33.250412945+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-07-02T18:10:33.251690699+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.314964533+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T18:10:33.321037179+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-07-02T18:10:33.321673053+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T18:10:33.322356950+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-07-02T18:10:33.322495956+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:33.322883529+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.386626360+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T18:10:33.396428134+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-07-02T18:10:33.398272651+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-07-02T18:10:33.398470653+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-07-02T18:10:33.398907877+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-07-02T18:10:33.400259397+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T18:10:33.400822011+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:33.400946156+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:33.401087756+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-07-02T18:10:33.401608821+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-07-02T18:10:33.401734788+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:33.402130628+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-07-02T18:10:33.402849848+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-07-02T18:10:33.403869353+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-07-02T18:10:33.404128486+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-07-02T18:10:33.404243493+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-07-02T18:10:33.404326079+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-07-02T18:10:33.404684039+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.480132783+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-07-02T18:10:33.486665235+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-07-02T18:10:33.489487026+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.517402757+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-07-02T18:10:33.520224205+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-07-02T18:10:33.521010126+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:33.594068728+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-07-02T18:10:33.600938640+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-07-02T18:10:33.601024569+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-07-02T18:10:33.601042688+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-07-02T18:10:33.601159913+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-07-02T18:10:33.601466575+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-07-02T18:10:33.601563073+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend Initial Context Setup Request
2025-07-02T18:10:33.601732346+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-07-02T18:10:33.602692535+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.602712961+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.602716190+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.602718848+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.602720442+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602727866+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.602745339+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.602747424+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.602753648+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602755395+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T18:10:33.602829672+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602835201+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T18:10:33.602837030+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T18:10:33.602843696+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.602845187+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602848704+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.602853824+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.602855298+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602856772+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.604039480+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.604054233+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.604056911+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604060083+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.604062765+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.604064455+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.604077468+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.604079732+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604081683+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604086132+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604089804+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604092300+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604094534+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.604096263+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-07-02T18:10:33.604110921+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle InitialContextSetupResponse
2025-07-02T18:10:33.604121839+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T18:10:33.604125804+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x1d1d04dd
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000cbb000)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000a245a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000ae2540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000cacf40)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000cbb020)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000cbb040)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000cacf7b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000cacf93)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000cacf99)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-07-02T18:10:33.606085324+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:33.606105585+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:33.606137957+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-07-02T18:10:33.606147593+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-07-02T18:10:33.606156348+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-07-02T18:10:33.606176342+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-07-02T18:10:33.606187650+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend Downlink Nas Transport
2025-07-02T18:10:33.609764571+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-07-02T18:10:34.110859279+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:34.112144211+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:34.112256025+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T18:10:34.112274538+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T18:10:34.112287902+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T18:10:34.112833332+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T18:10:34.114734844+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.157260357+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-07-02T18:10:34.161305080+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T18:10:34.161403018+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T18:10:34.161507544+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T18:10:34.161698913+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T18:10:34.162039019+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.218220185+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:34.226016364+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T18:10:34.226193625+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T18:10:34.226241526+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T18:10:34.226253217+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T18:10:34.227225242+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.288760792+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T18:10:34.292950441+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T18:10:34.293586292+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T18:10:34.293647236+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T18:10:34.294896760+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:34.295181086+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:34.295409533+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T18:10:34+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc00219c320 0xc00219c340 0xc00219c360]
2025-07-02T18:10:34.295471364+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T18:10:34.295477121+08:00[36m [INFO][SMF][GSM] [0m&{[0xc00219c320 0xc00219c340 0xc00219c360]}
2025-07-02T18:10:34.295479114+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T18:10:34.295718864+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.297694000+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&target-nf-type=AMF |  |
2025-07-02T18:10:34.298025186+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T18:10:34.298115332+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-07-02T18:10:34.298120878+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T18:10:34.298123406+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-07-02T18:10:34.298132616+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T18:10:34.298371590+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.375294307+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T18:10:34.381851314+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T18:10:34.381943661+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T18:10:34.383598196+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T18:10:34.384865818+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:34.388919989+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T18:10:34.389070886+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T18:10:34.389383525+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T18:10:34.389816520+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.391930698+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T18:10:34.392315908+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T18:10:34.392561537+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T18:10:34.392834237+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.414276391+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T18:10:34.419508453+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T18:10:34.421081862+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T18:10:34.421221703+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T18:10:34.421240392+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T18:10:34.421261875+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T18:10:34.421284883+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T18:10:34.421418180+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T18:10:34.421772579+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T18:10:34.421820257+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T18:10:34.421825932+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:34.421843677+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T18:10:34.421884100+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:34.421907296+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T18:10:34.421955414+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T18:10:34.422028495+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T18:10:34.422096429+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-07-02T18:10:34.435320869+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T18:10:34.436172367+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T18:10:34.436215196+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend PDU Session Resource Setup Request
2025-07-02T18:10:34.436369487+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T18:10:34.437412371+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:34.437474487+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.437480856+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-07-02T18:10:34.437520715+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.437522750+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.437524483+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.437555140+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.437594270+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.437604704+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.437608581+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.437610889+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.437613025+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.437615491+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-07-02T18:10:34.437707183+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.437711786+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:34.437714748+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.437717848+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.437719654+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:34.437727025+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.437762485+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.437766621+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.437779544+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.437781139+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.437782807+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x199219f7
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000668400)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cca1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000664500)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00067a464)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006781b0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00067e100)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00067a490)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00067a4a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000668420)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000668440)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000668460)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
2025-07-02T18:10:34.439371568+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T18:10:34.439507990+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T18:10:34.440709136+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T18:10:34.443487793+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T18:10:34.443533161+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:197fc031-99eb-469a-908a-415c5fac1a3b/modify |  |
2025-07-02T18:10:34.645067137+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:34.645235066+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:34.645336719+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T18:10:34.645373185+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T18:10:34.645400944+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T18:10:34.645434091+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T18:10:34.648086121+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T18:10:34.648276450+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T18:10:34.648330441+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T18:10:34.648662063+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T18:10:34.650031785+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.701950960+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:34.757224768+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T18:10:34.757431531+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T18:10:34.757456280+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T18:10:34.757535999+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T18:10:34.759002058+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.815324910+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T18:10:34.823083106+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T18:10:34.823876577+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T18:10:34.823946705+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T18:10:34.825388109+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:34.825569541+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:34.825619246+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T18:10:34+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0020833a0 0xc0020833c0 0xc0020833e0]
2025-07-02T18:10:34.825667985+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T18:10:34.825671826+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0020833a0 0xc0020833c0 0xc0020833e0]}
2025-07-02T18:10:34.825674361+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T18:10:34.826200015+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.828760086+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&target-nf-type=AMF |  |
2025-07-02T18:10:34.828936931+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T18:10:34.828991967+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-07-02T18:10:34.828995460+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T18:10:34.828997759+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-07-02T18:10:34.829002127+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T18:10:34.829077808+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.895439344+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T18:10:34.901407148+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T18:10:34.901457209+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T18:10:34.902231844+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T18:10:34.903672428+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:34.907866343+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T18:10:34.907973660+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T18:10:34.908234859+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T18:10:34.908595929+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.910155469+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T18:10:34.910436130+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T18:10:34.913858170+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T18:10:34.914267032+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:34.937281615+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T18:10:34.938757769+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T18:10:34.940205612+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T18:10:34.940303561+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T18:10:34.940318628+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T18:10:34.940325996+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T18:10:34.940332703+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T18:10:34.940349217+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T18:10:34.940475036+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T18:10:34.940566684+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T18:10:34.940611984+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:34.940638092+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T18:10:34.940648608+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:34.940681715+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T18:10:34.940758041+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T18:10:34.940888818+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T18:10:34.941023958+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-07-02T18:10:34.948496380+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T18:10:34.949359223+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T18:10:34.949441985+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend PDU Session Resource Setup Request
2025-07-02T18:10:34.949586908+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T18:10:34.950234921+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:34.950308813+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.950315385+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-07-02T18:10:34.950394468+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.950399318+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.950401256+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.950431537+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.950433822+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.950439894+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.950475290+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.950479915+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.950482246+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.950484154+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T18:10:34.950531155+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.950659705+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:34.950665624+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.950669251+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.950671319+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:34.950676928+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.950678505+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.950680029+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.950690318+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.950691807+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.950693269+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000076842944
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xa50a1b8653310d76cb588e8a73e742d4d7633d6a5615dd8e3feb19eb8a25f711
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x044f6e1b54842905d4ddb590d2522b5212aa7c6a
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000e20602dc
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xa7fa175688dbb2f1a0df59457568376f892113014dc67a1be501d6698b8847ed
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x1a8440c327a9f38263260cfd11d0ba951dd7b08a
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x04fac98f
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006690e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cca4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000664eb0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00067bd7c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000678360)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00067e800)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00067bda0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00067bdb0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000669100)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000669120)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000669140)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T18:10:34.957355186+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T18:10:34.957467277+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T18:10:34.960239190+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T18:10:34.967798133+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T18:10:34.967892267+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:c4cd9cc3-d8b9-4aae-9603-2d806190af41/modify |  |
2025-07-02T18:10:35.161011220+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:35.161138723+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:35.161204121+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T18:10:35.161209724+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T18:10:35.161213476+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T18:10:35.161220919+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T18:10:35.161953446+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T18:10:35.162058535+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T18:10:35.162075546+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T18:10:35.162263393+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T18:10:35.162976334+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.216554010+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:35.221999999+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T18:10:35.222160728+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T18:10:35.222184850+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T18:10:35.222188244+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T18:10:35.222668319+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.283101120+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T18:10:35.287960196+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T18:10:35.288558231+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T18:10:35.288577775+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T18:10:35.289603645+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:35.289775113+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:35.289874623+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T18:10:35+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0016a42c0 0xc0016a42e0 0xc0016a4300]
2025-07-02T18:10:35.289887005+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T18:10:35.289890001+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0016a42c0 0xc0016a42e0 0xc0016a4300]}
2025-07-02T18:10:35.289891872+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T18:10:35.290087048+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.294977471+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&target-nf-type=AMF |  |
2025-07-02T18:10:35.295495490+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T18:10:35.295580836+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-07-02T18:10:35.295587249+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T18:10:35.295590127+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-07-02T18:10:35.295594627+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T18:10:35.295671703+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.364733338+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T18:10:35.372710829+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T18:10:35.372765135+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T18:10:35.373508831+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T18:10:35.375156161+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:35.382523055+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T18:10:35.382794427+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T18:10:35.383031913+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T18:10:35.383458778+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.385172566+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T18:10:35.385489057+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T18:10:35.385698980+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T18:10:35.385798414+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.413972926+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T18:10:35.415932392+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T18:10:35.416846158+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T18:10:35.416879681+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T18:10:35.416891585+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T18:10:35.416903324+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T18:10:35.416910185+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T18:10:35.416927561+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T18:10:35.417300359+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T18:10:35.417438193+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T18:10:35.417447640+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:35.417466905+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T18:10:35.417523059+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:35.417548043+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T18:10:35.417574153+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T18:10:35.417618425+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T18:10:35.417848093+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-07-02T18:10:35.422781922+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T18:10:35.423929372+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T18:10:35.423988060+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend PDU Session Resource Setup Request
2025-07-02T18:10:35.424175908+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T18:10:35.425136078+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:35.425159182+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.425162396+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-07-02T18:10:35.425204399+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.425206291+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.425209451+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.425235039+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.425252722+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425257752+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425259978+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425262803+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425264964+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425266991+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T18:10:35.425297258+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.425312253+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:35.425314821+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.425316641+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.425318424+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:35.425326263+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.425362356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.425366684+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.425377143+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.425378656+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.425380086+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000a3d12f73
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x535d426e4178b6c6bb8a5b79af75ab5d6834516d193931218bbd0a19e7b76da7
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xd019d78494856a3c67b790d224e4b4722687c13d
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000016a89cc9
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xaadf73e0173ce9350c1850045a3d98c0653312e927e352a63c7feb16e280a69c
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x120974d833740b1b9eca576f59540a5ab070918b
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x067bf21d
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000669de0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cca780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000665860)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000b67e7c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000678510)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00067ef00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000b67ea0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000b67eb0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000669e00)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000669e20)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000669e40)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T18:10:35.435280775+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport
2025-07-02T18:10:35.435328327+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T18:10:35.435372339+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T18:10:35.435468859+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T18:10:35.435479558+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T18:10:35.435492545+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T18:10:35.437366979+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T18:10:35.437437998+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T18:10:35.437461669+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T18:10:35.437882369+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T18:10:35.439073428+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.494321516+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T18:10:35.503879391+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T18:10:35.504031984+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T18:10:35.504055217+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T18:10:35.504057612+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T18:10:35.505019398+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.563252559+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T18:10:35.570231027+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T18:10:35.571027003+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T18:10:35.571067894+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T18:10:35.572318933+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:35.572812117+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:35.573143054+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T18:10:35+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0018182e0 0xc001818300 0xc001818320]
2025-07-02T18:10:35.573158838+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T18:10:35.573162602+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0018182e0 0xc001818300 0xc001818320]}
2025-07-02T18:10:35.573164884+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T18:10:35.573449214+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.575916632+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=524d49b3-d7f2-4e31-8fc2-b33011f03cd2&target-nf-type=AMF |  |
2025-07-02T18:10:35.576066761+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T18:10:35.576129127+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-07-02T18:10:35.576140047+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T18:10:35.576147705+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-07-02T18:10:35.576157872+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T18:10:35.576220318+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.651640990+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T18:10:35.657144457+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T18:10:35.657196142+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T18:10:35.657839064+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T18:10:35.659038801+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T18:10:35.667265711+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T18:10:35.667400807+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T18:10:35.667498296+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T18:10:35.667879938+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.669833363+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T18:10:35.669972220+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T18:10:35.670279168+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T18:10:35.670540982+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T18:10:35.698836955+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T18:10:35.701099301+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T18:10:35.702101967+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T18:10:35.702150701+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T18:10:35.702158730+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T18:10:35.702161391+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T18:10:35.702163397+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T18:10:35.702178064+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T18:10:35.702532814+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T18:10:35.702604507+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T18:10:35.702670952+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:35.702710537+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T18:10:35.702714607+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T18:10:35.702732000+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T18:10:35.702809180+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T18:10:35.702912502+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T18:10:35.703227243+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-07-02T18:10:35.703796301+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T18:10:35.703807163+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T18:10:35.704173139+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T18:10:35.708784008+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T18:10:35.710311275+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T18:10:35.710362751+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:be1f9ca0-d7b2-4999-a954-758439e1b46e/modify |  |
2025-07-02T18:10:35.710428197+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T18:10:35.710619493+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mSend PDU Session Resource Setup Request
2025-07-02T18:10:35.710938138+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T18:10:35.712175702+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:35.712197822+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.712204291+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-07-02T18:10:35.712230548+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.712232576+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.712234305+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.712257898+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.712261051+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712266118+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712269391+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712271735+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712276528+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712278475+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T18:10:35.712309115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.712310956+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:35.712313391+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.712315146+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.712316862+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:35.712323329+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.712330551+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.712333427+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.712342038+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.712343476+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.712344875+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000df7fcd19
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xc263393977446568d7e26b0c9a00a500b82a3c83ec1f0bd3076d6bbf354faa35
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x79d4d5f4f4d5bdbdbb54dc6decee84e2a01ee81c
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000c0193bf4
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xb45b8ff3f671d3c8ee51b2469f6b8ea13fc9adaa87bff4ded23a84944b900b9f
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x1735d3cb098fd534fa39fab58e346bbe6f69efff
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x281eda93
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d84b00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000ccaa50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d86280)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00069f10c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006786c0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00067f600)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00069f130)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00069f140)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d84b20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d84b40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d84b60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-07-02T18:10:35.815559038+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T18:10:35.815646973+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57574] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T18:10:35.816449691+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T18:10:35.819409051+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T18:10:35.819437569+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:46457483-9f19-4d0d-b65f-3e3e754eb162/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=3.401927ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.853433ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=2.217083ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=2.435112ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=2.65777ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 1.853433ms/2.513066ms/3.401927ms/517.65µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (10.98s)
PASS
ok  	test	11.019s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (26.64s)
PASS
ok  	test	29.511s

--- STDERR ---
2025-07-02T18:10:14.611806523+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T18:10:14.611896557+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-07-02T18:10:14.612660406+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T18:10:14.612712244+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc000079ea0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000491800)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0004919b0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000033020)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-07-02T18:10:14.612718333+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T18:10:14.612720905+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-07-02T18:10:14.612722891+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:14.612744744+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-07-02T18:10:14.612748195+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-07-02T18:10:14.617591661+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-07-02T18:10:14.617700307+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-07-02T18:10:14.617826738+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-07-02T18:10:14.618001858+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-07-02T18:10:14.618072647+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-07-02T18:10:14.618078925+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-07-02T18:10:19.531156326+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-07-02T18:10:19.531278466+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-07-02T18:10:26.757236240+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T18:10:26.758557456+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-07-02T18:10:26.758987565+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-07-02T18:10:26.759279936+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-07-02T18:10:26.759286035+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-07-02T18:10:26.759345319+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-07-02T18:10:26.759349893+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-07-02T18:10:26.761770142+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-07-02T18:10:26.761823331+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-07-02T18:10:26.765346918+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-07-02T18:10:26.766234128+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-07-02T18:10:26.766452530+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-07-02T18:10:26.768648036+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-07-02T18:10:26.771271762+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-07-02T18:10:26.771336443+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-07-02T18:10:26.771340120+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-07-02T18:10:33.090777292+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.090804730+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.090809411+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.090825045+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.090828522+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.090832698+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-07-02T18:10:33.098328614+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.098407030+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.098412934+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:33.098416239+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T18:10:33.098418518+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:33.098424900+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:33.098426787+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:33.098438761+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.098440583+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T18:10:33.098455314+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.098456920+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.098458382+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:33.098460446+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T18:10:33.098462068+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:33.098463672+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:33.098465238+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:33.102545454+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.102557438+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.102560418+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.102562830+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T18:10:33.102566275+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.102567797+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.102569449+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.102589452+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.102592747+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.102595356+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.102598390+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.102600672+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.102603081+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-07-02T18:10:33.102604556+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.102606151+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T18:10:33.102609300+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-07-02T18:10:33.102611754+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T18:10:33.102613248+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T18:10:33.103986877+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104022528+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T18:10:33.104027763+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-07-02T18:10:33.104032875+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T18:10:33.104037024+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.104038812+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T18:10:33.104051001+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.104053679+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104056376+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.104080670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.104082186+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.104084481+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.104947414+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.104999470+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.105005196+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.105007627+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T18:10:33.105010230+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.105012707+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.105014375+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.105025989+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.105027925+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.105030857+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.105033229+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T18:10:33.105109144+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.105165330+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:33.105170474+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-07-02T18:10:33.105175441+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.105178212+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-07-02T18:10:33.244621969+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T18:10:33.244711794+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:33.244719666+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T18:10:33.244727928+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.244729814+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.244731651+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T18:10:33.244746517+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.244748392+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.244750439+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.244761124+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.244762675+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.244764145+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.245387240+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.245445186+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.245451392+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.245455741+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T18:10:33.245459627+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.245461475+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.245463013+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.245472026+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.245474174+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.245476060+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.245478734+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T18:10:33.245485316+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.245488721+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:33.248917074+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T18:10:33.248928724+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:33.248931766+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T18:10:33.248934857+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.248936736+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.248938372+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T18:10:33.249009038+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.249042184+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249046423+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.249055016+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.249056655+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249058250+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.249562991+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.249791376+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.249960608+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.249966948+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T18:10:33.249970099+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.249971624+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.249973094+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.249984663+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.250090688+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.250095932+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.250098682+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T18:10:33.250146925+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.250153228+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:33.602115555+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-07-02T18:10:33.602445829+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:33.602454879+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-07-02T18:10:33.602459761+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602461666+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T18:10:33.602470649+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.602472605+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602474403+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.602485193+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.602486833+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.602488286+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.603282091+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:33.603352145+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.603358374+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.603361368+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T18:10:33.603365243+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.603366919+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.603368564+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.603379016+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:33.603381211+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.603384494+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:33.603421316+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 272875417, Outbound SPI: 2940714264
2025-07-02T18:10:33.603449710+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.603452989+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T18:10:33.603455042+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T18:10:33.603457261+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:33.603461295+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:33.603463806+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:33.603465909+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:33.603467935+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:33.603473031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.603519366+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.603524026+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.603718341+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:33.603764704+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:33.603771016+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:33.603909542+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.603915733+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.603920435+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:33.603922718+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T18:10:33.603932637+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.603934959+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-07-02T18:10:33.604615876+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T18:10:33.605205126+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:33.605900987+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:33.609951662+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T18:10:34.109159363+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:34.422499596+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T18:10:34.422556705+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-07-02T18:10:34.426782362+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-07-02T18:10:34.426799847+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-07-02T18:10:34.426811303+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-07-02T18:10:34.436613011+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T18:10:34.436796916+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:34.436836651+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T18:10:34.436859437+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.436862528+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:34.436865435+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:34.436868458+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.436870515+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.436872451+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:34.436874175+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:34.436888549+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.436891055+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.436893040+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.436921980+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.437012487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.437031019+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.437983576+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:34.438050595+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.438133496+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.438173326+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T18:10:34.438181617+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 6088153889802391770
2025-07-02T18:10:34.438184579+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.438187868+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.438189482+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.438274219+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.438312961+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.438319224+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.438321460+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.438331049+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.438378259+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:34.438533147+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:34.438573697+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T18:10:34.438728382+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:34.439038280+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:34.439219063+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T18:10:34.440274337+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:34.441186159+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T18:10:34.941236010+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T18:10:34.941254300+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-07-02T18:10:34.943418086+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-07-02T18:10:34.943654422+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-07-02T18:10:34.949724029+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T18:10:34.949854519+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:34.949862788+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T18:10:34.949880347+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.949882734+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:34.949885663+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:34.949888101+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.949893289+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:34.949895297+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:34.949898525+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:34.949906195+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.949907976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.949909577+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.949923521+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.949925182+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.949926689+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.951155992+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:34.951207966+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.951214071+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.951216863+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T18:10:34.951219294+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 6088153889802391770
2025-07-02T18:10:34.951226701+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:34.951230117+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:34.951231958+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:34.951254956+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:34.951274327+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.951277305+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.951279465+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.951281519+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:34.951356608+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:34.951400657+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:34.951406015+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T18:10:34.954489945+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-07-02T18:10:34.956787279+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:34.956898734+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:34.956924295+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T18:10:34.958779411+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:34.960787109+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T18:10:35.417981796+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T18:10:35.418039216+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-07-02T18:10:35.421461292+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-07-02T18:10:35.421523868+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-07-02T18:10:35.424421331+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T18:10:35.424624677+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:35.424632381+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T18:10:35.424735481+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.424808608+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:35.424814952+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:35.424817167+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.424819234+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.424827135+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:35.424830379+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:35.424843321+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.424845377+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.424846995+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.424859899+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.424861390+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.424862999+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.425526429+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:35.425624414+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.425631601+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425634435+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T18:10:35.425636681+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 6088153889802391770
2025-07-02T18:10:35.425639542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.425644123+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.425645827+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.425687042+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.425691113+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425694160+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425696295+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425698355+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.425772545+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:35.425780868+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:35.425783217+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T18:10:35.430677121+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-07-02T18:10:35.430796262+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:35.434506305+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T18:10:35.434952535+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:35.434993348+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T18:10:35.704521947+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T18:10:35.704542638+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-07-02T18:10:35.705499431+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-07-02T18:10:35.705785857+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-07-02T18:10:35.708494618+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T18:10:35.711182883+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T18:10:35.711270644+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:35.711277874+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T18:10:35.711312148+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.711315659+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T18:10:35.711318436+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T18:10:35.711320629+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.711324252+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T18:10:35.711326147+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:35.711327763+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T18:10:35.711334990+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.711337208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.711338824+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.711770681+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.711777900+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.711779925+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.712636612+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T18:10:35.712651365+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.712654074+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712657259+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T18:10:35.712659572+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 6088153889802391770
2025-07-02T18:10:35.712662306+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T18:10:35.712664233+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T18:10:35.712666017+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T18:10:35.712691033+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T18:10:35.712693348+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712697246+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712699677+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712701746+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T18:10:35.712707014+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:35.712710038+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T18:10:35.712712076+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T18:10:35.718687814+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-07-02T18:10:35.718814923+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:35.720269041+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T18:10:35.720297546+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T18:10:35.816909392+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T18:10:47.096955454+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-07-02T18:10:47.096989745+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-07-02T18:10:47.097650676+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-07-02T18:10:47.097668922+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-07-02T18:10:47.097678712+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-07-02T18:10:47.151867889+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-07-02T18:10:47.152033033+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-07-02T18:10:47.152053246+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-07-02T18:10:47.152071949+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-07-02T18:10:47.152074164+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-07-02T18:10:47.152076003+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-07-02T18:10:47.536192244+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-07-02T18:10:47.536226936+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-07-02T18:10:47.536362159+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-07-02T18:10:47.536421801+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-07-02T18:10:47.536429686+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-07-02T18:10:47.536468760+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.178:56499: use of closed network connection
2025-07-02T18:10:47.536504363+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.178:56499: use of closed network connection
2025-07-02T18:10:47.536507256+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-07-02T18:10:47.536520490+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-07-02T18:10:47.536523001+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-07-02T18:10:47.536527280+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-07-02T18:10:47.536567263+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-07-02T18:10:47.536585739+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T18:10:47.536595572+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-07-02T18:10:47.536645102+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T18:10:47.536654024+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-07-02T18:10:47.536691180+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-07-02T18:10:47.536745641+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-07-02T18:10:47.536809577+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-07-02T18:10:47.536850960+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-07-02T18:10:47.536895929+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-07-02T18:10:47.536954369+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-07-02T18:10:47.536966540+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-07-02T18:10:47.536974714+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-07-02T18:10:47.536976848+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (80299): No such process
