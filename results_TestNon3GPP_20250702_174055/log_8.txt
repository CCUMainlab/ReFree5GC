Run TestCN
os.Args: [/tmp/go-build3206620014/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-07-02T17:45:28.599050367+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.599262093+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.599267364+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.599274275+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-07-02T17:45:28.599445456+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-07-02T17:45:28.606287193+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.606882857+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.606939981+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.607241843+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-07-02T17:45:28.610391794+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.610498207+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.610507916+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.610511930+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-07-02T17:45:28.610526429+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-07-02T17:45:28.610900694+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T17:45:28.611038807+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.611045496+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.611047486+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.611832165+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.611898923+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.611904286+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.611925532+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-07-02T17:45:28.612105549+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-07-02T17:45:28.613179281+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.613237011+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.613242758+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.613245284+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-07-02T17:45:28.613263115+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-07-02T17:45:28.613321692+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.613327041+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.613328884+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.613590162+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.613664438+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.613669561+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.613680546+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 220ba3db-f317-45a7-a45f-2c3eb1ef732d ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{220ba3db-f317-45a7-a45f-2c3eb1ef732d nausf-auth 0xc000013b78 http REGISTERED   0xc000013b60  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000832820 false false}
2025-07-02T17:45:28.613823972+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-07-02T17:45:28.614175598+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:28.614239949+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-07-02T17:45:28.614245332+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:28.614247530+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-07-02T17:45:28.614263204+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-07-02T17:45:28.614393045+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-07-02T17:45:28.614416217+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-07-02T17:45:28.824491349+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-07-02T17:45:28.824598531+08:00[36m [INFO][AMF][Init] [0mServer started
2025-07-02T17:45:28.824778864+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-07-02T17:45:28.826387934+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:28.834020517+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:28.836079937+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: ddd00640-8769-4f65-9f61-3aa881e78a8a
2025-07-02T17:45:28.839041471+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/ddd00640-8769-4f65-9f61-3aa881e78a8a |  |
2025-07-02T17:45:28.839739544+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:28.839802740+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-07-02T17:45:29.025689487+08:00[36m [INFO][SMF][Init] [0mServer started
2025-07-02T17:45:29.027916254+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:29.035074497+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:29.037963969+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3bd3ba3d-d395-4f5e-b7ce-83336bf3734d
2025-07-02T17:45:29.040811417+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3bd3ba3d-d395-4f5e-b7ce-83336bf3734d |  |
2025-07-02T17:45:29.041010921+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:29.041084813+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {3bd3ba3d-d395-4f5e-b7ce-83336bf3734d SMF REGISTERED 0 0xc000582780 0xc000582798 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000016800 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0005826d8 false false []}
2025-07-02T17:45:29.041206566+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-07-02T17:45:29.041217450+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-07-02 17:45:29.041212783 +0800 CST m=+0.481093232]
2025-07-02T17:45:29.041223540+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-07-02T17:45:29.232889935+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:29.242912003+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:29.244916235+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8134a97b-2cae-43d2-8dcb-bb429a060767
2025-07-02T17:45:29.246658209+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8134a97b-2cae-43d2-8dcb-bb429a060767 |  |
2025-07-02T17:45:29.246878506+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:29.246917097+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-07-02T17:45:29.246922074+08:00[36m [INFO][UDR][Init] [0mServer started
2025-07-02T17:45:29.246926246+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T17:45:29.247087875+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-07-02T17:45:29.428420592+08:00[36m [INFO][PCF][Init] [0mServer started
2025-07-02T17:45:29.432676806+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:29.441364274+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:29.442890402+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a123697a-14b5-4e64-a46c-8303f69012f0
2025-07-02T17:45:29.444359942+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a123697a-14b5-4e64-a46c-8303f69012f0 |  |
2025-07-02T17:45:29.444548976+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:29.444627366+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-07-02T17:45:29.630813531+08:00[36m [INFO][UDM][Init] [0mServer started
2025-07-02T17:45:29.631322508+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-07-02T17:45:29.633463214+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:29.645597064+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:29.647820599+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 30001de3-9966-4261-8a4e-44f5950c36b8
2025-07-02T17:45:29.649779618+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/30001de3-9966-4261-8a4e-44f5950c36b8 |  |
2025-07-02T17:45:29.649982357+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:29.650196071+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-07-02T17:45:29.832762540+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:29.845542591+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:29.847582546+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 46dee363-0776-4d84-8ca8-b965929fe61f
2025-07-02T17:45:29.851049903+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/46dee363-0776-4d84-8ca8-b965929fe61f |  |
2025-07-02T17:45:29.851223534+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:29.851271537+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-07-02T17:45:29.851290376+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-07-02T17:45:30.033032104+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-07-02T17:45:30.036457579+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:30.041775350+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-07-02T17:45:30.042544470+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-07-02T17:45:30.044990422+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:30.046304328+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 220ba3db-f317-45a7-a45f-2c3eb1ef732d
2025-07-02T17:45:30.047837863+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/220ba3db-f317-45a7-a45f-2c3eb1ef732d |  |
2025-07-02T17:45:30.048202927+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:30.048213421+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-07-02T17:45:30.235673823+08:00[36m [INFO][CHF][Init] [0mServer started
2025-07-02T17:45:30.238248167+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-07-02T17:45:30.243917513+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T17:45:30.253071181+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T17:45:30.254517211+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 2805e3c1-49d2-4626-9e95-9e52956b89f1
2025-07-02T17:45:30.256009969+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/2805e3c1-49d2-4626-9e95-9e52956b89f1 |  |
2025-07-02T17:45:30.256162926+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T17:45:30.256211756+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-07-02T17:45:37.300161987+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770
2025-07-02T17:45:37.300450624+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770
2025-07-02T17:45:37.300797143+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle NGSetupRequest
2025-07-02T17:45:37.300845574+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mMissing IE PagingDRX
2025-07-02T17:45:37.300865352+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2135173763/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-07-02T17:45:43.634118688+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.634195674+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.634208075+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:43.634217459+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T17:45:43.634224255+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:43.637757772+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.637766004+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.637768119+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:43.637771101+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T17:45:43.637773018+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:43.642162150+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.642185629+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.642194507+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.642206920+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.642215350+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.642222333+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.642228548+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-07-02T17:45:43.646674856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.646698521+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T17:45:43.646707577+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:43.646714928+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:43.646730180+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:43.646749816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.646759758+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.646767055+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.646778723+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.646785082+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.646791806+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.648986640+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.649037442+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.649046556+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.649056641+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.649062981+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.649072697+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.649140303+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.649162104+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.649177402+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.649191576+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.649206017+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.649217668+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-07-02T17:45:43.649351068+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.649380991+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:43.649405198+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T17:45:43.649421695+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.649436640+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.649451139+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.649470137+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.649485346+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.649501844+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.651113191+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle InitialUEMessage
2025-07-02T17:45:43.651195361+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-07-02T17:45:43.651225443+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-07-02T17:45:43.651258322+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-07-02T17:45:43.651280456+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-07-02T17:45:43.651287399+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-07-02T17:45:43.651290715+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-07-02T17:45:43.651297212+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-07-02T17:45:43.651319341+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-07-02T17:45:43.651322389+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-07-02T17:45:43.651905094+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:43.677498442+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-07-02T17:45:43.682567636+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-07-02T17:45:43.682622373+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-07-02T17:45:43.683089249+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:43.739495956+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-07-02T17:45:43.743937530+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-07-02T17:45:43.744039500+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-07-02T17:45:43.744045095+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-07-02T17:45:43.744047131+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-07-02T17:45:43.746118810+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:43.771887307+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-07-02T17:45:43.774889526+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T17:45:43.777329362+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T17:45:43.777474173+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-07-02T17:45:43.777786792+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-07-02T17:45:43.777833708+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-07-02T17:45:43.777840563+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3064663064376635383330343564306337643165356161336134306331323362
2025-07-02T17:45:43.777878736+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-07-02T17:45:43.778157108+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-07-02T17:45:43.778181285+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend Downlink Nas Transport
2025-07-02T17:45:43.778303381+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-07-02T17:45:43.780676326+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.780695755+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.780699196+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.780701872+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.780703795+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.780705658+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.780720150+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.780722210+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.780726581+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.780818049+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.780820963+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:43.780822716+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T17:45:43.780829145+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.780830683+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.780832173+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.780836540+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.780837974+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.780839376+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.781229477+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:43.781242833+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:43.781266017+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-07-02T17:45:43.781309000+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-07-02T17:45:43.781316057+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-07-02T17:45:43.782023734+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-07-02T17:45:43.782067043+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3064663064376635383330343564306337643165356161336134306331323362
Xres*: 3064663064376635383330343564306337643165356161336134306331323362
2025-07-02T17:45:43.782072763+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-07-02T17:45:43.783699679+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-07-02T17:45:43.784776080+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-07-02T17:45:43.784886370+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-07-02T17:45:43.785107967+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-07-02T17:45:43.785265810+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-07-02T17:45:43.785320891+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-07-02T17:45:43.785336120+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend Downlink Nas Transport
2025-07-02T17:45:43.785766462+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-07-02T17:45:43.785784467+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.785891566+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.785897378+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.785899789+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.785901345+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785904794+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.785914498+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.785916171+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.785919003+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.785959663+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785963377+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:43.785965131+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T17:45:43.785970539+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.785972527+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785974038+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.785983731+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.785986947+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785989534+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.786653597+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:43.786802859+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:43.787016468+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-07-02T17:45:43.787326759+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-07-02T17:45:43.787486199+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-07-02T17:45:43.787540081+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-07-02T17:45:43.787814340+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-07-02T17:45:43.788465878+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:43.839617666+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T17:45:43.844061056+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-07-02T17:45:43.844553090+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T17:45:43.845104730+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-07-02T17:45:43.845459999+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:43.846014550+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:43.899558730+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T17:45:43.904788821+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-07-02T17:45:43.906026897+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-07-02T17:45:43.906091858+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-07-02T17:45:43.906377864+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-07-02T17:45:43.906501144+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T17:45:43.907112375+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:43.907245945+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:43.907721315+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-07-02T17:45:43.908340147+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-07-02T17:45:43.908490723+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:43.908680463+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-07-02T17:45:43.909187674+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-07-02T17:45:43.909686005+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-07-02T17:45:43.909943264+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-07-02T17:45:43.910240155+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-07-02T17:45:43.910553595+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-07-02T17:45:43.911351025+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:43.974040500+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-07-02T17:45:43.979626423+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-07-02T17:45:43.980060708+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.001096181+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-07-02T17:45:44.003976661+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-07-02T17:45:44.004778257+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.060739464+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-07-02T17:45:44.066494730+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-07-02T17:45:44.066546122+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-07-02T17:45:44.066561389+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-07-02T17:45:44.066679151+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-07-02T17:45:44.066748074+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-07-02T17:45:44.066916538+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend Initial Context Setup Request
2025-07-02T17:45:44.067255368+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-07-02T17:45:44.067925993+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:44.068023293+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.068028394+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068030759+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068032548+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068034706+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068069099+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.068082852+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068110159+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068112335+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T17:45:44.068127484+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068131921+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T17:45:44.068134009+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T17:45:44.068139577+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068155670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068157162+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068161389+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068162811+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068164222+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068944508+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:44.068960718+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.068964734+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068966953+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068968744+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068970223+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068983167+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.068986534+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068988958+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068991561+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068995569+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068997671+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068999837+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.069001397+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-07-02T17:45:44.069185263+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle InitialContextSetupResponse
2025-07-02T17:45:44.069247737+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T17:45:44.069255261+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x68002cef
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000c2f100)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013c960)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc00017ee00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000b5bbb0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000c2f120)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000c2f140)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000b5bbeb)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000b5bc03)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000b5bc09)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-07-02T17:45:44.071564506+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:44.072977994+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:44.073100476+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-07-02T17:45:44.073107707+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-07-02T17:45:44.073143548+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-07-02T17:45:44.073204261+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-07-02T17:45:44.073291497+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend Downlink Nas Transport
2025-07-02T17:45:44.073461591+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-07-02T17:45:44.574714107+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:44.575275232+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:44.576042764+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T17:45:44.576077036+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T17:45:44.576094028+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T17:45:44.576159066+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T17:45:44.577486650+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.609471752+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-07-02T17:45:44.614305184+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T17:45:44.614339777+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T17:45:44.614446528+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T17:45:44.614672668+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T17:45:44.615296112+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.657743910+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:44.662235601+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T17:45:44.662412289+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T17:45:44.662443489+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T17:45:44.662446019+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T17:45:44.662835970+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.719583971+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T17:45:44.725165572+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T17:45:44.725592940+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T17:45:44.725657930+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T17:45:44.726482555+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:44.727849438+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:44.728214277+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T17:45:44+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001195c80 0xc001195ca0 0xc001195cc0]
2025-07-02T17:45:44.728261443+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T17:45:44.728346112+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001195c80 0xc001195ca0 0xc001195cc0]}
2025-07-02T17:45:44.728371474+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T17:45:44.730469339+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.732488134+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&target-nf-type=AMF |  |
2025-07-02T17:45:44.732841960+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T17:45:44.732925639+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-07-02T17:45:44.732931885+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T17:45:44.732934640+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-07-02T17:45:44.732938589+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T17:45:44.733221814+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.789996865+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T17:45:44.797343771+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T17:45:44.797417830+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T17:45:44.798205505+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T17:45:44.799824778+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:44.804832427+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T17:45:44.804956629+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T17:45:44.805064055+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T17:45:44.805373706+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.807189453+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T17:45:44.807726586+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T17:45:44.807889502+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T17:45:44.807998363+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:44.827670209+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T17:45:44.828893733+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T17:45:44.831092184+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T17:45:44.831199554+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T17:45:44.831208029+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T17:45:44.831210591+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T17:45:44.831214877+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T17:45:44.831650149+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T17:45:44.831781391+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T17:45:44.831886341+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T17:45:44.831933641+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:44.831971413+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T17:45:44.831977611+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:44.832006089+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T17:45:44.832112207+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T17:45:44.832228479+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T17:45:44.832381378+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-07-02T17:45:44.842210849+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T17:45:44.844531996+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T17:45:44.844700927+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend PDU Session Resource Setup Request
2025-07-02T17:45:44.844992371+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T17:45:44.845912746+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:44.846057282+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.846063732+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-07-02T17:45:44.846099335+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.846100960+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.846102626+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.846131295+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.846170398+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846176969+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846179864+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846182212+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846184160+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846185925+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-07-02T17:45:44.846240263+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.846244348+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:44.846246952+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:44.846249167+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:44.846250988+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:44.846258302+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.846259844+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.846261296+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.846271673+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.846273145+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.846274577+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x3170614f
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000ae2460)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000de1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c4e6e0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000c405c4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000664360)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c48380)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000c405f0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000c40600)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000ae2480)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000ae24a0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000ae24c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T17:45:44.847587695+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T17:45:44.847605584+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T17:45:44.850893587+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T17:45:44.853534324+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T17:45:44.853617924+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:3e2f7a11-02c6-44b7-b245-d08bf6f81734/modify |  |
2025-07-02T17:45:45.052872755+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:45.052977867+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:45.053024872+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T17:45:45.053037373+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T17:45:45.053045910+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T17:45:45.053060873+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T17:45:45.053754693+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T17:45:45.053827932+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T17:45:45.053852372+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T17:45:45.053906794+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T17:45:45.054499295+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.094997837+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:45.099090841+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T17:45:45.099252950+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T17:45:45.099288308+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T17:45:45.099291160+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T17:45:45.099928366+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.151155620+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T17:45:45.155361308+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T17:45:45.158376801+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T17:45:45.160198456+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T17:45:45.163393469+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:45.163834685+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:45.164047795+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T17:45:45+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001b0a1c0 0xc001b0a1e0 0xc001b0a200]
2025-07-02T17:45:45.164090128+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T17:45:45.164099990+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001b0a1c0 0xc001b0a1e0 0xc001b0a200]}
2025-07-02T17:45:45.164106816+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T17:45:45.164732046+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.166537641+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&target-nf-type=AMF |  |
2025-07-02T17:45:45.166758900+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T17:45:45.166952499+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-07-02T17:45:45.166958394+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T17:45:45.166960728+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-07-02T17:45:45.166964431+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T17:45:45.167442770+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.247434094+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T17:45:45.252538190+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T17:45:45.253319638+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T17:45:45.254234043+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T17:45:45.255853260+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:45.259314089+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T17:45:45.259439970+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T17:45:45.259741905+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T17:45:45.261021134+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.262346083+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T17:45:45.262747903+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T17:45:45.263235883+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T17:45:45.263352315+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.285590905+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T17:45:45.287198723+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T17:45:45.287692490+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T17:45:45.287746220+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T17:45:45.287769816+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T17:45:45.287772179+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T17:45:45.287774729+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T17:45:45.287809977+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T17:45:45.287932430+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T17:45:45.288020846+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T17:45:45.288037375+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:45.288063555+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T17:45:45.288073998+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:45.288102457+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T17:45:45.288185818+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T17:45:45.288293603+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T17:45:45.288480172+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-07-02T17:45:45.296226939+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T17:45:45.297083518+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T17:45:45.297249556+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend PDU Session Resource Setup Request
2025-07-02T17:45:45.297458026+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T17:45:45.298440558+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:45.298638422+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.298645911+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-07-02T17:45:45.298672090+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.298674208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298676151+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.298702193+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.298704437+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.298708276+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.298711897+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.298714249+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.298717253+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.298718955+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T17:45:45.298751359+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298753227+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:45.298755713+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.298757730+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.298759607+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:45.298763741+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.298765680+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298767214+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.298775583+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.298777048+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298778528+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000000816011e
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x2ca917501f4be90f083612859e79b4e4a145ca3543f3803f84975d237810a5a3
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x8a07e905f83b7ee80c82b9a5cab047b8dcef082d
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000ca8be33b
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x60d19f9760cd7000050e5d3e06a2b57e3dc4aaf02d3618bd78c57fc4bf67dda2
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x7febf113e7f2bce93462b15d56522dc4a417a3eb
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-07-02T17:45:45.304073075+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T17:45:45.304111156+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T17:45:45.305104797+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x09469ca0
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000ae3c60)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000de4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c4f090)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000c41edc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000664510)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c48a80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000c41f00)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000c41f10)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000ae3c80)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000ae3ca0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000ae3cc0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T17:45:45.320245017+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T17:45:45.320341496+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:aeac23bb-2763-4dc7-a5c2-6fbb0311e61d/modify |  |
2025-07-02T17:45:45.510509261+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:45.511797410+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:45.511909836+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T17:45:45.511943814+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T17:45:45.511953229+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T17:45:45.511979386+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T17:45:45.512510272+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T17:45:45.512589921+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T17:45:45.512606745+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T17:45:45.512831252+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T17:45:45.513144992+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.559116905+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:45.565752369+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T17:45:45.565943926+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T17:45:45.565966204+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T17:45:45.566096773+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T17:45:45.566533379+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.613338004+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T17:45:45.617217224+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T17:45:45.617821111+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T17:45:45.617855023+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T17:45:45.619007519+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:45.619507494+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:45.619643598+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T17:45:45+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001607c00 0xc001607c20 0xc001607c40]
2025-07-02T17:45:45.619670655+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T17:45:45.619674030+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001607c00 0xc001607c20 0xc001607c40]}
2025-07-02T17:45:45.619676268+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T17:45:45.620169908+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.621820349+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&target-nf-type=AMF |  |
2025-07-02T17:45:45.622113456+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T17:45:45.622203420+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-07-02T17:45:45.622209033+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T17:45:45.622211367+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-07-02T17:45:45.622215787+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T17:45:45.622455891+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.679997616+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T17:45:45.686569606+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T17:45:45.686628147+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T17:45:45.687405845+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T17:45:45.689074411+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:45.693636860+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T17:45:45.693954954+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T17:45:45.694055402+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T17:45:45.694366061+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.696219182+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T17:45:45.696398753+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T17:45:45.696702343+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T17:45:45.696990098+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.720354232+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T17:45:45.722515469+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T17:45:45.724283592+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T17:45:45.724345173+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T17:45:45.724352141+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T17:45:45.724354458+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T17:45:45.724356284+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T17:45:45.724368980+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T17:45:45.724746455+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T17:45:45.725154188+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T17:45:45.725204815+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:45.725235451+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T17:45:45.725239111+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:45.725257475+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T17:45:45.725454175+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T17:45:45.725426864+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T17:45:45.725927188+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-07-02T17:45:45.733940533+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T17:45:45.734482285+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T17:45:45.735088890+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend PDU Session Resource Setup Request
2025-07-02T17:45:45.735214594+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T17:45:45.735978152+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:45.736035869+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.736042653+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-07-02T17:45:45.736074847+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.736076730+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.736078629+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.736104812+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.736107407+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736113198+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736115320+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736118168+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736120348+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736122362+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T17:45:45.736291765+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.736295619+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:45.736298680+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.736300567+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.736302500+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:45.736308304+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.736309897+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.736311439+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.736322129+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.736324196+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.736325655+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000cfd6d174
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x4e34973f41f9d068aadb2d721b44bde37dd7b7bec18da7ed9e8a48ef1938e7bc
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x464eca1b57d153aa9ecb58614e578e390d8fe3cc
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000057075b38
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x2e604888119ed0ca12887dade76419b6ddc0c58b4273927c0231f65674c77004
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x3404b4b6313fd2d9683ed846acebc1e1ee1f3806
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x682c3b30
err <nil>
2025-07-02T17:45:45.738968886+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006a0980)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000de780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c4fa40)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006947cc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006646c0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c49180)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000694800)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000694810)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006a09a0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006a09c0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006a09e0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
2025-07-02T17:45:45.738984342+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T17:45:45.739853220+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T17:45:45.746371010+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T17:45:45.746466402+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:cc9d9e2b-6581-4df4-af6d-a615efd3a038/modify |  |
2025-07-02T17:45:45.940041483+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport
2025-07-02T17:45:45.940459289+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T17:45:45.940650964+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T17:45:45.940698659+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T17:45:45.940705810+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T17:45:45.940713579+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T17:45:45.941337322+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T17:45:45.941416029+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T17:45:45.941475121+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T17:45:45.941801913+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T17:45:45.942151195+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:45.985828597+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T17:45:45.989746638+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T17:45:45.989932652+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T17:45:45.989957207+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T17:45:45.989959773+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T17:45:45.990567520+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:46.044457181+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T17:45:46.048572529+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T17:45:46.050388710+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T17:45:46.050468827+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T17:45:46.051974904+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:46.052270266+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:46.052404961+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T17:45:46+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001195b80 0xc001195ba0 0xc001195bc0]
2025-07-02T17:45:46.052656947+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T17:45:46.052664412+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001195b80 0xc001195ba0 0xc001195bc0]}
2025-07-02T17:45:46.052666404+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T17:45:46.053070983+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:46.055082078+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=ddd00640-8769-4f65-9f61-3aa881e78a8a&target-nf-type=AMF |  |
2025-07-02T17:45:46.055509098+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T17:45:46.055553508+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-07-02T17:45:46.055556215+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T17:45:46.055558569+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-07-02T17:45:46.055563125+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T17:45:46.055693450+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:46.116130808+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T17:45:46.121193284+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T17:45:46.121361259+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T17:45:46.121987968+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T17:45:46.123755989+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T17:45:46.130414514+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T17:45:46.130517841+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T17:45:46.130832000+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T17:45:46.131484468+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:46.132969233+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T17:45:46.133316035+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T17:45:46.133493335+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T17:45:46.133581997+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T17:45:46.157938544+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T17:45:46.159343503+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T17:45:46.160042117+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T17:45:46.160096595+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T17:45:46.160103708+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T17:45:46.160105844+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T17:45:46.160107566+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T17:45:46.160120704+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T17:45:46.160442619+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T17:45:46.160676870+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T17:45:46.160738373+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:46.160768924+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T17:45:46.160772769+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T17:45:46.160789231+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T17:45:46.160817017+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T17:45:46.160902273+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T17:45:46.161043297+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-07-02T17:45:46.169258034+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T17:45:46.170455081+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T17:45:46.170494839+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mSend PDU Session Resource Setup Request
2025-07-02T17:45:46.170763655+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T17:45:46.173350972+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:46.173416516+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:46.173422514+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-07-02T17:45:46.173450669+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:46.173452689+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173454805+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:46.173486898+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:46.173490207+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173494291+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173496407+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173498800+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173500693+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173502547+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T17:45:46.173580542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173584348+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:46.173587086+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:46.173588947+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:46.173590925+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:46.173602115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:46.173659290+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173664292+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:46.173674241+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:46.173675879+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173678548+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000d7828f13
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xd61431bf81e33a29866cc540994a0c07466e495be1e0986c5a9037d239cb9dea
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xa26b6a335e2f3d088e5fe06004ab8e1acf657be3
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000ce8e1e59
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xda77cd41dbf6a92d9e755c7c921d926e92b53ce68bb3a0513e1309c93fb10c40
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x27495aaa902a9147431d2a61c8958385e80e59ef
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x0d988d9c
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006a1680)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000dea50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00007d220)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000ca4fc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000664870)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c49880)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0000ca520)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000ca530)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006a16a0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006a16c0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006a16e0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-07-02T17:45:46.185834957+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T17:45:46.185852128+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:49770] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T17:45:46.187013684+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T17:45:46.199193883+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T17:45:46.199254840+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:49c23609-b4ee-475e-8a2c-cd61d505aff3/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=7.61491ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.730188ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=769.247µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=2.826025ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=5.381782ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 769.247µs/3.66443ms/7.61491ms/2.50527ms
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (10.93s)
PASS
ok  	test	10.970s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (26.54s)
PASS
ok  	test	29.427s

--- STDERR ---
2025-07-02T17:45:25.130211343+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T17:45:25.130494545+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-07-02T17:45:25.131643334+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T17:45:25.131697943+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0005c02d0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0005bf590)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0005bf740)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0005a9000)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-07-02T17:45:25.131703266+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T17:45:25.131705723+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-07-02T17:45:25.131707509+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:25.131763770+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-07-02T17:45:25.131770105+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-07-02T17:45:25.136664042+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-07-02T17:45:25.136730906+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-07-02T17:45:25.137008773+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-07-02T17:45:25.137386076+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-07-02T17:45:25.137490785+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-07-02T17:45:25.137497738+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-07-02T17:45:30.042226750+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-07-02T17:45:30.042323450+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-07-02T17:45:37.287448786+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T17:45:37.287940610+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-07-02T17:45:37.288847478+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-07-02T17:45:37.288999301+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-07-02T17:45:37.289019348+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-07-02T17:45:37.289180231+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-07-02T17:45:37.289234739+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-07-02T17:45:37.292615161+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-07-02T17:45:37.292677969+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-07-02T17:45:37.299166189+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-07-02T17:45:37.300606842+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-07-02T17:45:37.301156069+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-07-02T17:45:37.302607064+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-07-02T17:45:37.301737806+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-07-02T17:45:37.303209340+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-07-02T17:45:37.303237035+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-07-02T17:45:43.634441858+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.634472255+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.634476334+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.634481695+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.634484699+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.634488087+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-07-02T17:45:43.641882112+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.641950982+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.641956856+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:43.641959897+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T17:45:43.641962196+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:43.641964217+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:43.641965928+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:43.641991102+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.641993069+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T17:45:43.642007933+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.642009803+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.642011269+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:43.642013300+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T17:45:43.642014781+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:43.642025157+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:43.642064127+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:43.646877016+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.646889597+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.646892906+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.646895668+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T17:45:43.646899801+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.646901603+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.646903228+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.646938149+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.646942814+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.646944877+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.646948456+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.646950717+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.646953048+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-07-02T17:45:43.646954553+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.646956763+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T17:45:43.646959721+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-07-02T17:45:43.646962383+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T17:45:43.646963922+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T17:45:43.648664926+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.648708172+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T17:45:43.648713894+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-07-02T17:45:43.648720612+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T17:45:43.648725683+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:43.648727506+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T17:45:43.648741328+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.648744099+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.648745892+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.648769992+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.648771633+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.648773110+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.649822460+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.650022502+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.650031721+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.650034756+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T17:45:43.650038591+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.650041902+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.650043443+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.650057906+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.650061000+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.650064649+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.650068077+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T17:45:43.650079403+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:43.650112973+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:43.650280788+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-07-02T17:45:43.650307362+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:43.650493637+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-07-02T17:45:43.778706763+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T17:45:43.778765356+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:43.778772733+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T17:45:43.778780196+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.778782151+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:43.778783950+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T17:45:43.778795948+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.778797663+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.778799280+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.778807937+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.778809384+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.778810792+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.780983628+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.780994253+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.780996947+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.780999239+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T17:45:43.781002438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.781004138+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.781005645+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.781014769+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.781058875+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.781063700+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.781066451+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T17:45:43.781106123+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:43.781112760+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:43.785595906+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T17:45:43.785675711+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:43.785682619+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T17:45:43.785686053+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785687805+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:43.785689403+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T17:45:43.785695428+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.785697096+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785698513+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.785704376+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.785705879+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.785707777+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.786173114+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:43.786316206+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.786321799+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.786324348+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T17:45:43.786326765+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:43.786328433+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:43.786332476+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:43.786341514+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:43.786343357+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.786345902+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:43.786348941+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T17:45:43.786352895+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:43.786355664+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:44.067581976+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-07-02T17:45:44.067673930+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:44.067681999+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-07-02T17:45:44.067686282+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.067688257+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T17:45:44.067700779+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.067702582+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.067704311+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.067716108+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.067717751+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.067719342+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068454223+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:44.068467968+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.068471440+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068474012+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T17:45:44.068477514+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068479438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068482370+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068491842+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.068494142+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068497194+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.068531704+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 291566726, Outbound SPI: 3256988655
2025-07-02T17:45:44.068547727+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068549511+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T17:45:44.068551414+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T17:45:44.068553515+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:44.068556297+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:44.068559209+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:44.068561426+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:44.068563092+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:44.068567586+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068569217+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068570733+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068736276+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.068739697+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.068741234+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.068849206+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.068856315+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.068859542+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:44.068861581+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T17:45:44.068873786+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.068879744+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-07-02T17:45:44.069474354+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T17:45:44.069848518+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.070729841+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:44.073375923+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T17:45:44.573901186+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:44.832932891+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T17:45:44.832957093+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-07-02T17:45:44.837180928+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-07-02T17:45:44.837250395+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-07-02T17:45:44.837992061+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-07-02T17:45:44.845210190+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T17:45:44.845301491+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:44.845560474+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T17:45:44.845587996+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.845592818+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:44.845595662+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:44.845598607+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:44.845601019+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:44.845602863+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:44.845604556+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:44.845613070+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.845614813+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.845616419+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.845637227+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.845717890+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.845719718+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.846510656+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:44.846526702+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.846529531+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846532279+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T17:45:44.846534599+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10413635936059188178
2025-07-02T17:45:44.846537758+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:44.846539373+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:44.846540893+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:44.846565383+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:44.846567596+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846570777+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846572901+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846574963+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:44.846582377+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.846590071+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:44.846593860+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T17:45:44.846704489+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.847037018+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:44.847235873+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T17:45:44.848284137+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:44.851485548+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T17:45:45.289691467+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T17:45:45.289757813+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-07-02T17:45:45.292944934+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-07-02T17:45:45.293116593+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-07-02T17:45:45.297961349+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T17:45:45.298101610+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:45.298109871+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T17:45:45.298135024+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298138139+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:45.298140881+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:45.298142910+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.298145022+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.298146740+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:45.298148333+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:45.298156477+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.298206777+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298211656+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.298227526+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.298229460+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.298234203+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.300625564+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:45.300667198+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.300671928+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.300674726+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T17:45:45.300677091+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10413635936059188178
2025-07-02T17:45:45.300696209+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.300698116+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.300699850+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.300738421+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.300740539+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.300743583+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.300745828+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.300748083+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.300752637+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:45.300755512+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:45.300758975+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T17:45:45.303030687+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-07-02T17:45:45.303286320+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:45.303378257+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:45.303420207+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T17:45:45.308968310+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T17:45:45.315172288+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:45.726000825+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T17:45:45.726023979+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-07-02T17:45:45.729111705+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-07-02T17:45:45.729466298+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-07-02T17:45:45.735585809+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T17:45:45.735730509+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:45.735738322+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T17:45:45.735755483+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.735759067+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:45.735769055+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:45.735773156+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.735775425+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:45.735777553+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:45.735779294+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:45.735788856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.735790670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.735792287+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.735806597+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.735809221+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.735810761+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.736686742+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:45.736737002+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.736743175+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736749917+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T17:45:45.736752491+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10413635936059188178
2025-07-02T17:45:45.736755998+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:45.736757895+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:45.736759564+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:45.736784584+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:45.736786873+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736790089+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736792321+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736794494+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:45.736839420+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:45.736880191+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:45.736885098+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T17:45:45.738387145+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-07-02T17:45:45.738690844+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:45.738780761+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:45.738804366+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T17:45:45.742025335+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T17:45:45.743432119+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T17:45:46.163348880+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T17:45:46.163403195+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-07-02T17:45:46.166007030+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-07-02T17:45:46.166493347+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-07-02T17:45:46.172965054+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T17:45:46.173113944+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:46.173128317+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T17:45:46.173155642+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173158815+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T17:45:46.173161599+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T17:45:46.173164874+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:46.173202238+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T17:45:46.173206740+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:46.173208521+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T17:45:46.173219715+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:46.173221607+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173225360+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:46.173240686+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:46.173242257+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173243715+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:46.173816114+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T17:45:46.173834357+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:46.173837287+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173839828+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T17:45:46.173847296+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10413635936059188178
2025-07-02T17:45:46.173851929+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T17:45:46.173853582+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T17:45:46.173855248+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T17:45:46.173875051+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T17:45:46.173877038+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173882850+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173884993+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173887194+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T17:45:46.173892786+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:46.173895846+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T17:45:46.173898021+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T17:45:46.177839336+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-07-02T17:45:46.182296189+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:46.182414256+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T17:45:46.182442165+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T17:45:46.187768230+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T17:45:57.581087920+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-07-02T17:45:57.581154131+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-07-02T17:45:57.581191110+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-07-02T17:45:57.581199833+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-07-02T17:45:57.581209413+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-07-02T17:45:57.617641914+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-07-02T17:45:57.617721774+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-07-02T17:45:57.617732659+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-07-02T17:45:57.617746378+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-07-02T17:45:57.617748856+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-07-02T17:45:57.617750663+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-07-02T17:45:57.956619888+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-07-02T17:45:57.956692697+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-07-02T17:45:57.956924349+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-07-02T17:45:57.957064661+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-07-02T17:45:57.957114396+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-07-02T17:45:57.957133368+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-07-02T17:45:57.957133531+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-07-02T17:45:57.957136590+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-07-02T17:45:57.957259902+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-07-02T17:45:57.957326308+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.245:40167: use of closed network connection
2025-07-02T17:45:57.957312492+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.245:40167: use of closed network connection
2025-07-02T17:45:57.957328070+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-07-02T17:45:57.957337951+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-07-02T17:45:57.957342542+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-07-02T17:45:57.957346413+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-07-02T17:45:57.957355101+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-07-02T17:45:57.957430562+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T17:45:57.957445887+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-07-02T17:45:57.957448833+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T17:45:57.957467890+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-07-02T17:45:57.957542026+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-07-02T17:45:57.957632629+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-07-02T17:45:57.957644707+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-07-02T17:45:57.957653242+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-07-02T17:45:57.957655400+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (67211): No such process
