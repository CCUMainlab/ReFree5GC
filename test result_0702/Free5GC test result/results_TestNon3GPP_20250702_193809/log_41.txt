Run TestCN
os.Args: [/tmp/go-build2071868622/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-07-02T20:04:05.716780970+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.716875214+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.716883099+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.716894599+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-07-02T20:04:05.716906470+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-07-02T20:04:05.717346630+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.717351892+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.717353718+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.717808088+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-07-02T20:04:05.725839987+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.726107037+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.726221851+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.726228899+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-07-02T20:04:05.726317434+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-07-02T20:04:05.727723601+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T20:04:05.727986542+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.728100826+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.728105703+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.729016144+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.729061374+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.729066268+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.729069879+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-07-02T20:04:05.729219354+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-07-02T20:04:05.729907898+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.729947401+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.729952317+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.729954884+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-07-02T20:04:05.729969330+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-07-02T20:04:05.729982867+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.729985238+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.729987040+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.730130205+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.730177488+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.730182411+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.730192782+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 75b9d5f1-1263-466b-9078-7728f7a8cd9b ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{75b9d5f1-1263-466b-9078-7728f7a8cd9b nausf-auth 0xc000263170 http REGISTERED   0xc000263140  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000d492c0 false false}
2025-07-02T20:04:05.730251960+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-07-02T20:04:05.730549596+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:05.730587054+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-07-02T20:04:05.730665769+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:05.730673634+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-07-02T20:04:05.730687810+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-07-02T20:04:05.730806748+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-07-02T20:04:05.730829907+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-07-02T20:04:05.933648472+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-07-02T20:04:05.934210701+08:00[36m [INFO][AMF][Init] [0mServer started
2025-07-02T20:04:05.936335875+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-07-02T20:04:05.940059137+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:05.949803949+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:05.951822541+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 63e38c63-97ac-4d49-85e3-38568cfd935c
2025-07-02T20:04:05.955362048+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/63e38c63-97ac-4d49-85e3-38568cfd935c |  |
2025-07-02T20:04:05.955735245+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:05.955856105+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-07-02T20:04:06.136341995+08:00[36m [INFO][SMF][Init] [0mServer started
2025-07-02T20:04:06.140137544+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:06.149699127+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:06.154907832+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: ecedad1e-a26a-43f6-a839-6d4bd38e8b20
2025-07-02T20:04:06.157004067+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/ecedad1e-a26a-43f6-a839-6d4bd38e8b20 |  |
2025-07-02T20:04:06.157177536+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:06.157263963+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {ecedad1e-a26a-43f6-a839-6d4bd38e8b20 SMF REGISTERED 0 0xc00075c558 0xc00075c588 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc0004deac0 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc00075c480 false false []}
2025-07-02T20:04:06.157303150+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-07-02T20:04:06.157309155+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-07-02T20:04:06.157568244+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-07-02 20:04:06.157562168 +0800 CST m=+0.473969349]
2025-07-02T20:04:06.341767211+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:06.348113643+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:06.349539497+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 163a5f6d-31bc-4e67-bcb0-cfdd875aceee
2025-07-02T20:04:06.350476782+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/163a5f6d-31bc-4e67-bcb0-cfdd875aceee |  |
2025-07-02T20:04:06.350621159+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:06.350667595+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-07-02T20:04:06.350673082+08:00[36m [INFO][UDR][Init] [0mServer started
2025-07-02T20:04:06.350676288+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T20:04:06.350685979+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-07-02T20:04:06.542354862+08:00[36m [INFO][PCF][Init] [0mServer started
2025-07-02T20:04:06.546192532+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:06.555659910+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:06.557768992+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: b25b0b2d-a50c-4af2-9141-6b7b72879e6e
2025-07-02T20:04:06.559086075+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/b25b0b2d-a50c-4af2-9141-6b7b72879e6e |  |
2025-07-02T20:04:06.559502930+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:06.559534506+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-07-02T20:04:06.743472714+08:00[36m [INFO][UDM][Init] [0mServer started
2025-07-02T20:04:06.743563347+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-07-02T20:04:06.744655696+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:06.751690713+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:06.753716809+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: ecdcfbb4-927e-47cd-9f75-0d4279f02106
2025-07-02T20:04:06.755249422+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/ecdcfbb4-927e-47cd-9f75-0d4279f02106 |  |
2025-07-02T20:04:06.755387276+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:06.755464770+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-07-02T20:04:06.945405994+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:06.963500371+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:06.965542584+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8c921e75-f2ce-4a0d-8a57-12a0db2a37c6
2025-07-02T20:04:06.966616881+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8c921e75-f2ce-4a0d-8a57-12a0db2a37c6 |  |
2025-07-02T20:04:06.966788255+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:06.966811110+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-07-02T20:04:06.966819463+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-07-02T20:04:07.145604064+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-07-02T20:04:07.149787462+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:07.157965636+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-07-02T20:04:07.158771868+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:07.159058692+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-07-02T20:04:07.160427293+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 75b9d5f1-1263-466b-9078-7728f7a8cd9b
2025-07-02T20:04:07.161152851+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/75b9d5f1-1263-466b-9078-7728f7a8cd9b |  |
2025-07-02T20:04:07.161639071+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:07.161668437+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-07-02T20:04:07.346732446+08:00[36m [INFO][CHF][Init] [0mServer started
2025-07-02T20:04:07.349673245+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-07-02T20:04:07.353577368+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T20:04:07.360472289+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T20:04:07.362594345+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 0c5f4feb-42f9-460c-8f86-cc1b2d04da58
2025-07-02T20:04:07.364703440+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/0c5f4feb-42f9-460c-8f86-cc1b2d04da58 |  |
2025-07-02T20:04:07.364942100+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T20:04:07.365032526+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-07-02T20:04:14.376356932+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789
2025-07-02T20:04:14.377675518+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789
2025-07-02T20:04:14.380049318+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle NGSetupRequest
2025-07-02T20:04:14.380100619+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mMissing IE PagingDRX
2025-07-02T20:04:14.380120701+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build362885019/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-07-02T20:04:20.703029274+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.703121043+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.703126488+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:20.703129622+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T20:04:20.703131794+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:20.703243401+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.703278605+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.703283055+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:20.703289034+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T20:04:20.703290955+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:20.711986974+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.712032822+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.712042954+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.712055110+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.712059587+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.712064191+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.712067712+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-07-02T20:04:20.715941864+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.715997526+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T20:04:20.716003552+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:20.716006263+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:20.716008029+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:20.716025471+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.716028029+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.716029783+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.716036811+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.716038182+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.716040055+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.718212249+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.718251864+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.718257394+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718260001+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.718261535+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.718263832+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.718325612+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.718363556+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718368098+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718370073+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718372085+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718373867+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-07-02T20:04:20.718414662+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.718452870+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:20.718457272+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T20:04:20.718461899+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.718463541+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.718464983+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.718470923+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.718472377+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.718474576+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.719586636+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle InitialUEMessage
2025-07-02T20:04:20.719642955+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-07-02T20:04:20.719669011+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-07-02T20:04:20.719698393+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-07-02T20:04:20.719709607+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-07-02T20:04:20.719714739+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-07-02T20:04:20.719718213+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-07-02T20:04:20.719721842+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-07-02T20:04:20.719727183+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-07-02T20:04:20.719729682+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-07-02T20:04:20.720289081+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:20.748895261+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-07-02T20:04:20.751430412+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-07-02T20:04:20.751489841+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-07-02T20:04:20.751824767+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:20.836076578+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-07-02T20:04:20.842337001+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-07-02T20:04:20.842413755+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-07-02T20:04:20.842419256+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-07-02T20:04:20.842421263+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-07-02T20:04:20.842719726+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:20.870878863+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-07-02T20:04:20.875573638+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T20:04:20.877704031+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T20:04:20.878032129+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-07-02T20:04:20.878227584+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-07-02T20:04:20.878274283+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-07-02T20:04:20.878281541+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3630626238646466396230323633373538383632663662653566643938643037
2025-07-02T20:04:20.878326722+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-07-02T20:04:20.878433172+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-07-02T20:04:20.878513522+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend Downlink Nas Transport
2025-07-02T20:04:20.878585681+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-07-02T20:04:20.879368008+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.879386868+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.879389951+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.879392266+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.879394071+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879395781+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.879412466+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.879415010+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.879416845+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.879515630+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879557522+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:20.879562529+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T20:04:20.879568157+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.879569803+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879571234+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.879576355+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.879577756+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879580279+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.880230643+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:20.880281047+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:20.880305696+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-07-02T20:04:20.880308669+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-07-02T20:04:20.880312112+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-07-02T20:04:20.880815004+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-07-02T20:04:20.880891939+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3630626238646466396230323633373538383632663662653566643938643037
Xres*: 3630626238646466396230323633373538383632663662653566643938643037
2025-07-02T20:04:20.880897599+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-07-02T20:04:20.881413952+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-07-02T20:04:20.882584659+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-07-02T20:04:20.882747948+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-07-02T20:04:20.882842767+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-07-02T20:04:20.883196089+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-07-02T20:04:20.883248003+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-07-02T20:04:20.883260627+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend Downlink Nas Transport
2025-07-02T20:04:20.883333407+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-07-02T20:04:20.883826475+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.883838446+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.883841012+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.883843089+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.883844706+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883846640+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.883861242+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.883863693+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.883865420+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.883883630+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883885506+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:20.883887001+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T20:04:20.883891005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.883893213+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883894725+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.883899549+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.883900976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883902406+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.884287970+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:20.884295780+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:20.884312687+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-07-02T20:04:20.884315316+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-07-02T20:04:20.884317841+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-07-02T20:04:20.884369870+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-07-02T20:04:20.884377558+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-07-02T20:04:20.884564847+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:20.959883696+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T20:04:20.965836472+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-07-02T20:04:20.966159768+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T20:04:20.966847933+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-07-02T20:04:20.967235065+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:20.967567095+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:21.046720143+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T20:04:21.054206231+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-07-02T20:04:21.055736836+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-07-02T20:04:21.055905630+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-07-02T20:04:21.056355252+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-07-02T20:04:21.056668717+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T20:04:21.057242305+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:21.057302739+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:21.057966751+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-07-02T20:04:21.058849395+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-07-02T20:04:21.058993920+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:21.059137765+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-07-02T20:04:21.059522042+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-07-02T20:04:21.059892155+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-07-02T20:04:21.060134974+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-07-02T20:04:21.060307521+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-07-02T20:04:21.060448447+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-07-02T20:04:21.060942405+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:21.148978359+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-07-02T20:04:21.171211655+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-07-02T20:04:21.171998022+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:21.204461168+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-07-02T20:04:21.207820799+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-07-02T20:04:21.208296547+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:21.283604332+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-07-02T20:04:21.290442782+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-07-02T20:04:21.290512006+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-07-02T20:04:21.290528315+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-07-02T20:04:21.290824804+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-07-02T20:04:21.290971694+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-07-02T20:04:21.290993519+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend Initial Context Setup Request
2025-07-02T20:04:21.291319576+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-07-02T20:04:21.291891542+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:21.291910106+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:21.291916276+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.291918786+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.291920513+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291922249+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.291935132+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:21.291937441+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.291944001+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291945830+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T20:04:21.291954222+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291962939+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T20:04:21.291965909+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T20:04:21.291971085+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.291972853+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291974293+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.291980845+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.291983792+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291985285+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.292729962+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:21.292775777+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:21.292778189+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292780670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.292782429+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.292785122+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.292797434+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:21.292889803+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292938393+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292944517+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292947948+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle InitialContextSetupResponse
2025-07-02T20:04:21.292947891+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292950746+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292952920+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292958294+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T20:04:21.292954498+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292962403+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend Downlink Nas Transport
    non3gpp_test.go:1517: Get Authentication from N3IWF
Security header type: Integrity Protected And Ciphered
cmac value: 0xf4e918f5
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000d0cfc0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013c780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000aec540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000d18f40)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000d0cfe0)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000d0d000)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000d18f7b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000d18f93)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000d18f99)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-07-02T20:04:21.295369715+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:21.295389602+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:21.295419286+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-07-02T20:04:21.295428770+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-07-02T20:04:21.295436597+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-07-02T20:04:21.295497937+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-07-02T20:04:21.295525592+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend Downlink Nas Transport
2025-07-02T20:04:21.295626874+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-07-02T20:04:21.798245415+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:21.798312354+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:21.798433510+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T20:04:21.798450619+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T20:04:21.798468612+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T20:04:21.798497643+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T20:04:21.802761338+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:21.842468953+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-07-02T20:04:21.854656462+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T20:04:21.854817599+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T20:04:21.855112682+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=63e38c63-97ac-4d49-85e3-38568cfd935c&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T20:04:21.855343358+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T20:04:21.856393339+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:21.917262776+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:21.927532997+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T20:04:21.927724344+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T20:04:21.927754681+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T20:04:21.927757435+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T20:04:21.928589257+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.003844105+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T20:04:22.009158117+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T20:04:22.009909265+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T20:04:22.009974164+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T20:04:22.010917740+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:22.011297623+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:22.011628633+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T20:04:22+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001922620 0xc001922640 0xc001922660]
2025-07-02T20:04:22.011670950+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T20:04:22.011681168+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001922620 0xc001922640 0xc001922660]}
2025-07-02T20:04:22.011688179+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T20:04:22.012225489+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.014593710+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=63e38c63-97ac-4d49-85e3-38568cfd935c&target-nf-type=AMF |  |
2025-07-02T20:04:22.014738755+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T20:04:22.014823111+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-07-02T20:04:22.014828765+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T20:04:22.014831464+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-07-02T20:04:22.014835484+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T20:04:22.014884307+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.103158189+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T20:04:22.108995520+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T20:04:22.109124344+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T20:04:22.109984657+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T20:04:22.113001508+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:22.116956992+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T20:04:22.117059896+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T20:04:22.117456320+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T20:04:22.117910150+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.119804498+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T20:04:22.120281775+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T20:04:22.120679386+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T20:04:22.120997988+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.154091780+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T20:04:22.155939701+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T20:04:22.156816137+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T20:04:22.156860302+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T20:04:22.156872850+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T20:04:22.156880219+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T20:04:22.156886444+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T20:04:22.156997894+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T20:04:22.157064492+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T20:04:22.157120996+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T20:04:22.157135151+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:22.157160060+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T20:04:22.157169954+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:22.157195487+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T20:04:22.157242834+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T20:04:22.157279847+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T20:04:22.157532272+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-07-02T20:04:22.170136573+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T20:04:22.171989277+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T20:04:22.172051711+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend PDU Session Resource Setup Request
2025-07-02T20:04:22.172173505+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T20:04:22.172821541+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:22.172878709+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.172884456+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-07-02T20:04:22.172923181+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.172924960+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.172926566+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.172956500+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.173006337+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173014643+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173018526+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173020933+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173022945+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173025057+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-07-02T20:04:22.173082223+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.173085966+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:22.173088600+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.173091013+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.173092718+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:22.173100610+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.173102239+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.173103695+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.173113570+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.173115144+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.173116608+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x32d77f43
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b36440)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d281e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c84460)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000bec7e4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000d0090)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cae100)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000bec830)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000bec8e0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b36460)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b36480)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b364a0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
2025-07-02T20:04:22.174906950+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T20:04:22.174999627+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T20:04:22.175935090+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T20:04:22.178629435+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T20:04:22.178698496+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:ddb75d46-5f5b-4b57-a6da-0822d9ad7e68/modify |  |
2025-07-02T20:04:22.377064352+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:22.377368819+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:22.377507809+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T20:04:22.377525922+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T20:04:22.377540873+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T20:04:22.377574488+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T20:04:22.381002624+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T20:04:22.381335200+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T20:04:22.381851189+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=63e38c63-97ac-4d49-85e3-38568cfd935c&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T20:04:22.382353573+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T20:04:22.384068608+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.450282831+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:22.456267021+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T20:04:22.456419065+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T20:04:22.456441620+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T20:04:22.456444676+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T20:04:22.456843151+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.526455283+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T20:04:22.531854423+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T20:04:22.532562638+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T20:04:22.532604849+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T20:04:22.533849915+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:22.534385195+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:22.535167019+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T20:04:22+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0017fe100 0xc0017fe120 0xc0017fe140]
2025-07-02T20:04:22.535393477+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T20:04:22.535413201+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0017fe100 0xc0017fe120 0xc0017fe140]}
2025-07-02T20:04:22.535415373+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T20:04:22.535960730+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.538355974+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=63e38c63-97ac-4d49-85e3-38568cfd935c&target-nf-type=AMF |  |
2025-07-02T20:04:22.538543140+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T20:04:22.538651024+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-07-02T20:04:22.538656365+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T20:04:22.538658702+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-07-02T20:04:22.538662424+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T20:04:22.539224296+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.629806568+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T20:04:22.637740749+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T20:04:22.637793298+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T20:04:22.638561898+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T20:04:22.640540742+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:22.644741532+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T20:04:22.644884990+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T20:04:22.645025394+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T20:04:22.645535516+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.647641362+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T20:04:22.647773087+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T20:04:22.647958495+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T20:04:22.648262692+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.678991423+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T20:04:22.681260116+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T20:04:22.682037283+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T20:04:22.682047871+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T20:04:22.682052528+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T20:04:22.682054751+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T20:04:22.682056594+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T20:04:22.682067004+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T20:04:22.682282286+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T20:04:22.682389619+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T20:04:22.682397796+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:22.682417017+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T20:04:22.682420421+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:22.682441270+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T20:04:22.682639904+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T20:04:22.682682631+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T20:04:22.683185353+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-07-02T20:04:22.690365500+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T20:04:22.691039429+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T20:04:22.691102482+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend PDU Session Resource Setup Request
2025-07-02T20:04:22.691323480+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T20:04:22.692183498+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:22.692215183+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.692218742+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-07-02T20:04:22.692253518+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.692256071+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.692257962+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.692285285+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.692287616+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692291032+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692295158+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692297264+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692299119+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692300882+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T20:04:22.692365121+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.692368465+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:22.692371345+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.692373258+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.692378721+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:22.692383342+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.692384841+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.692386266+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.692396058+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.692397567+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.692400597+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000af3e2cd4
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xeb66341c5e0635d858db55fa32ed6401d4fc8c45c2e4763447f4f9007fc9f40a
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x882cfd9f34aaa568ed985257fcb4231997931043
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000f749b17a
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x473c7227e0a3a940059878f35f8dcfa40e1c8fc4612888e79360462dfaefc516
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xd8b518f93dfc6a54c28a995b823604089254cdb6
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-07-02T20:04:22.694390909+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T20:04:22.694569080+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T20:04:22.698855673+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x5811f891
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b37b40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d284b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c84e10)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006b062c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000d0240)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cae800)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0006b0650)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0006b0660)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b37b60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b37b80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b37ba0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T20:04:22.705168306+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T20:04:22.705688180+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:d2f2c345-0d1e-48c7-a1d8-447b03a24442/modify |  |
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T20:04:22.897433714+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:22.897688096+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:22.897821721+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T20:04:22.897839320+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T20:04:22.897856166+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T20:04:22.897879958+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T20:04:22.900490973+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T20:04:22.900663719+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T20:04:22.900724188+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=63e38c63-97ac-4d49-85e3-38568cfd935c&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T20:04:22.901707389+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T20:04:22.903845058+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:22.970866818+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:22.977091200+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T20:04:22.977220520+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T20:04:22.977244407+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T20:04:22.977246819+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T20:04:22.977549135+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.052753826+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T20:04:23.060153158+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T20:04:23.061193243+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T20:04:23.061255772+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T20:04:23.062456074+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:23.062921828+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:23.063390879+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T20:04:23+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0016aa820 0xc0016aa840 0xc0016aa860]
2025-07-02T20:04:23.063498561+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T20:04:23.063516060+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0016aa820 0xc0016aa840 0xc0016aa860]}
2025-07-02T20:04:23.063524669+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T20:04:23.063778178+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.066014414+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=63e38c63-97ac-4d49-85e3-38568cfd935c&target-nf-type=AMF |  |
2025-07-02T20:04:23.066168388+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T20:04:23.066264244+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-07-02T20:04:23.066278881+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T20:04:23.066282698+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-07-02T20:04:23.066286890+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T20:04:23.066444374+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.155520069+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T20:04:23.162463256+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T20:04:23.162551531+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T20:04:23.163290091+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T20:04:23.164664141+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:23.171415581+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T20:04:23.171517977+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T20:04:23.171649578+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T20:04:23.172079582+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.174137463+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T20:04:23.174556608+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T20:04:23.174751588+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T20:04:23.174848679+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.206417093+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T20:04:23.208592471+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T20:04:23.209280216+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T20:04:23.209331934+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T20:04:23.209357064+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T20:04:23.209359416+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T20:04:23.209361294+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T20:04:23.209375129+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T20:04:23.209571589+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T20:04:23.209686225+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T20:04:23.209730620+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:23.209761528+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T20:04:23.209765552+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:23.209784918+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T20:04:23.209931544+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T20:04:23.209997123+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T20:04:23.210277802+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-07-02T20:04:23.215535812+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T20:04:23.216380914+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T20:04:23.216437016+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend PDU Session Resource Setup Request
2025-07-02T20:04:23.216562784+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T20:04:23.217158651+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:23.217228818+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.217234757+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-07-02T20:04:23.217261469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.217263422+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217265084+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.217290485+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.217293369+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.217296891+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.217303622+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.217337603+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.217343104+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.217345313+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T20:04:23.217377162+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217379102+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:23.217382525+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.217384291+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.217386376+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:23.217426915+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.217432053+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217433665+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.217445559+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.217447213+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217448670+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000aa470ec5
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x353325749b02a97ee4663f79b5e7e58f6f4c5a1988e6137bd7ee4b719da9f007
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xe69bb56188e46fa8055f8eabc07c604499c2e1e5
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000006a3424fe
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x4c02604e5e5c74057a6f2c0f03bf1936bd2d9a007facdae1d937b3bc0ae63f7c
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xa69ae7bedf9bcfc7136d454217c5ddbf4abf8ea7
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x2833dc11
err <nil>
2025-07-02T20:04:23.226198828+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T20:04:23.226259002+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006928c0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d28780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c857c0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006b1f0c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000d03f0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000caef00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0006b1f30)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0006b1f40)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006928e0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000692900)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000692920)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T20:04:23.229484639+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T20:04:23.232761136+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T20:04:23.232837802+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:d46b1198-fbd1-4b65-ac82-c82af6f08044/modify |  |
2025-07-02T20:04:23.425204155+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport
2025-07-02T20:04:23.426077780+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T20:04:23.426232392+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T20:04:23.426255978+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T20:04:23.426275802+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T20:04:23.426347069+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T20:04:23.436508263+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T20:04:23.436596848+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T20:04:23.436615374+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=63e38c63-97ac-4d49-85e3-38568cfd935c&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T20:04:23.436814672+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T20:04:23.437097961+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.501487420+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T20:04:23.514043397+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T20:04:23.514159528+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T20:04:23.514182772+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T20:04:23.514185156+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T20:04:23.515170148+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.595032090+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T20:04:23.600435730+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T20:04:23.601024288+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T20:04:23.601084307+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T20:04:23.602316418+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:23.602484206+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:23.602754364+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T20:04:23+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001890180 0xc0018901a0 0xc0018901c0]
2025-07-02T20:04:23.602797491+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T20:04:23.602806313+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001890180 0xc0018901a0 0xc0018901c0]}
2025-07-02T20:04:23.602816654+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T20:04:23.603366272+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.605792169+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=63e38c63-97ac-4d49-85e3-38568cfd935c&target-nf-type=AMF |  |
2025-07-02T20:04:23.606315091+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T20:04:23.606355288+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-07-02T20:04:23.606358128+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T20:04:23.606360200+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-07-02T20:04:23.606363629+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T20:04:23.606561447+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.699511193+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T20:04:23.711673648+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T20:04:23.711745333+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T20:04:23.712475173+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T20:04:23.714330644+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T20:04:23.719452111+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T20:04:23.719620307+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T20:04:23.719892633+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T20:04:23.720594025+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.722441305+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T20:04:23.722612871+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T20:04:23.723174147+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T20:04:23.723541578+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T20:04:23.753386652+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T20:04:23.755177334+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T20:04:23.755761161+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T20:04:23.755795307+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T20:04:23.755806601+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T20:04:23.755813969+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T20:04:23.755820184+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T20:04:23.755836064+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T20:04:23.755992038+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T20:04:23.756119218+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T20:04:23.756127756+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:23.756156270+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T20:04:23.756160074+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T20:04:23.756191610+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T20:04:23.756305199+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T20:04:23.756425628+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T20:04:23.756938228+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-07-02T20:04:23.763511274+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T20:04:23.764097017+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T20:04:23.764115295+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mSend PDU Session Resource Setup Request
2025-07-02T20:04:23.764235887+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T20:04:23.764954351+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:23.765016123+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.765026107+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-07-02T20:04:23.765051848+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.765053610+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.765055424+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.765086058+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.765089068+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765093169+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765095547+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765098044+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765100045+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765101831+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T20:04:23.765134248+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.765136147+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:23.765138535+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.765141590+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.765143381+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:23.765150694+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.765157932+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.765225038+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.765238412+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.765240263+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.765241856+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000e4196a0b
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x3ad41e9a2066e768fb8ed4de6889ad84bd554ac9122d8f8d3aa6090660e97dd0
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xe5f11bcbd91ad16906908a91707229972958bc08
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000df468679
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x42361b826840719c65dd273a1cd4aacb46ba23a64fa3dd4f6a7a29e493ee69f2
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xe3939acc2aa6db13d7fb5504f50ccd216f865ce7
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xb185ae85
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006935c0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d28a50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b30190)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006182fc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000d05a0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000caf600)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000618340)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000618380)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006935e0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000693600)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000693620)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-07-02T20:04:23.776950717+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T20:04:23.776994470+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47789] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T20:04:23.778130630+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T20:04:23.780204427+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T20:04:23.780272038+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:c44c7a0d-cd4e-4dba-83da-0a41cc09f6c9/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.40449ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=955.046µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=2.248303ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=3.411197ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=597.856µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 597.856µs/1.723378ms/3.411197ms/1.008276ms
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (11.42s)
PASS
ok  	test	11.457s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (27.00s)
PASS
ok  	test	29.869s

--- STDERR ---
2025-07-02T20:04:02.229940024+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T20:04:02.230033584+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-07-02T20:04:02.231291123+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T20:04:02.231335246+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0000786e0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000015710)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0000158c0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0004097c0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-07-02T20:04:02.231348012+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T20:04:02.231351141+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-07-02T20:04:02.231355916+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:02.231385202+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-07-02T20:04:02.231388005+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-07-02T20:04:02.235952375+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-07-02T20:04:02.236044840+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-07-02T20:04:02.236157994+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-07-02T20:04:02.236484514+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-07-02T20:04:02.236559460+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-07-02T20:04:02.236566228+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-07-02T20:04:07.158395902+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-07-02T20:04:07.158440203+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-07-02T20:04:14.365481995+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T20:04:14.366195830+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-07-02T20:04:14.367005941+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-07-02T20:04:14.367049511+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-07-02T20:04:14.367055097+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-07-02T20:04:14.367112540+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-07-02T20:04:14.367153414+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-07-02T20:04:14.374796881+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-07-02T20:04:14.374813792+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-07-02T20:04:14.376688570+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-07-02T20:04:14.379773362+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-07-02T20:04:14.379895721+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-07-02T20:04:14.380275194+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-07-02T20:04:14.383542528+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-07-02T20:04:14.383614402+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-07-02T20:04:14.383859883+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-07-02T20:04:20.703420433+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.703449014+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.703453753+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.703460288+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.703463736+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.703467194+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-07-02T20:04:20.711288645+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.711458327+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.711471048+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:20.711476557+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T20:04:20.711480583+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:20.711483832+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:20.711485648+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:20.711508277+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.711510762+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T20:04:20.711533995+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.711536808+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.711538658+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:20.711541612+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T20:04:20.711543835+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:20.711545768+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:20.711547314+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:20.716285839+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.716338211+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.716344570+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.716347343+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T20:04:20.716352180+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.716365136+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.716368315+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.716387104+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.716390487+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.716392652+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.716395898+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.716398526+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.716401164+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-07-02T20:04:20.716408827+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.716410556+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T20:04:20.716413741+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-07-02T20:04:20.716449305+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T20:04:20.716453348+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T20:04:20.717868609+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.717923425+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T20:04:20.717939762+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-07-02T20:04:20.717945198+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T20:04:20.717951289+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:20.717953700+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T20:04:20.717962487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.717964148+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.717965571+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.717990457+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.717992168+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.717994080+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.718742651+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.718786651+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.718792134+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718794433+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T20:04:20.718797179+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.718945054+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.718949947+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.718968845+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.718972351+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718974150+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.718976546+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T20:04:20.718984052+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:20.719174022+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:20.719181435+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-07-02T20:04:20.719187334+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:20.719190293+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-07-02T20:04:20.878875154+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T20:04:20.878978300+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:20.878986414+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T20:04:20.878993796+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.878996045+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:20.878997957+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T20:04:20.879113680+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.879119571+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879121619+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.879131235+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.879132908+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879134342+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.879761492+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.879893977+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.879950588+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.879956712+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T20:04:20.879959823+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.879961368+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.879962928+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.879975467+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.879977480+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.879979233+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.879981814+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T20:04:20.879986562+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:20.879990156+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:20.883504597+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T20:04:20.883514197+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:20.883516645+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T20:04:20.883519607+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883521288+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:20.883522794+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T20:04:20.883538199+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.883590794+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883595830+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.883601878+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.883603414+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.883604901+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.884067930+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:20.884078836+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.884082273+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.884084597+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T20:04:20.884087120+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:20.884088766+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:20.884090256+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:20.884099891+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:20.884101598+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.884103261+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:20.884105777+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T20:04:20.884108847+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:20.884111095+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:21.291614851+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-07-02T20:04:21.291635274+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:21.291638336+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-07-02T20:04:21.291642670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291644484+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T20:04:21.291653469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.291655246+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291656872+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.291664115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.291665587+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.291666904+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.292206574+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:21.292217510+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:21.292219928+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292222480+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T20:04:21.292226159+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.292227807+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.292229285+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.292238115+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:21.292240328+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292252855+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:21.292280577+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 587748571, Outbound SPI: 3902585896
2025-07-02T20:04:21.292298036+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.292299935+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T20:04:21.292302613+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T20:04:21.292306382+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:21.292309234+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:21.292311067+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:21.292314120+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:21.292315750+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:21.292320081+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.292364966+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.292369778+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.292519348+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:21.292589583+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:21.292594823+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:21.292675138+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:21.292681617+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:21.292684780+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:21.292686972+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T20:04:21.292693582+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:21.292696276+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-07-02T20:04:21.293678898+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T20:04:21.294027169+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:21.295254251+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:21.295772297+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T20:04:21.797178036+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:22.157700164+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T20:04:22.157747787+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-07-02T20:04:22.165403396+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-07-02T20:04:22.165534248+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-07-02T20:04:22.166612790+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-07-02T20:04:22.172386159+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T20:04:22.172543967+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:22.172550766+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T20:04:22.172568442+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.172570954+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:22.172573781+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:22.172575952+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.172579110+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.172581130+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:22.172582926+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:22.172590401+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.172592197+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.172595018+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.172611280+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.172612944+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.172614335+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.173372909+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:22.173516429+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.173567310+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173573768+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T20:04:22.173576108+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9998737268033353693
2025-07-02T20:04:22.173578837+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.173580481+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.173582456+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.173603912+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.173606239+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173704654+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173711271+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173713576+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.173720010+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:22.173847051+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:22.173884172+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T20:04:22.174010661+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:22.174166381+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:22.174239241+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T20:04:22.176330543+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:22.176437459+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T20:04:22.683794874+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T20:04:22.683816091+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-07-02T20:04:22.687359469+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-07-02T20:04:22.687806029+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-07-02T20:04:22.691589586+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T20:04:22.691775536+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:22.691783736+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T20:04:22.691894170+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.691904265+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:22.691907086+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:22.691909266+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.691911375+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:22.691913278+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:22.691914944+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:22.691921765+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.691923426+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.691925062+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.691939274+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.691941893+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.691943399+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.692597005+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:22.692611423+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.692614090+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692616727+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T20:04:22.692618987+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9998737268033353693
2025-07-02T20:04:22.692621504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:22.692623188+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:22.692624644+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:22.692647284+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:22.692649391+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692651981+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692654108+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692657344+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:22.692663105+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:22.692666011+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:22.692668021+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T20:04:22.693715579+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-07-02T20:04:22.694041647+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:22.694094510+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:22.694112313+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T20:04:22.699670036+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T20:04:22.707968898+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:23.210320617+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T20:04:23.210399116+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-07-02T20:04:23.211956745+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-07-02T20:04:23.212447084+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-07-02T20:04:23.216876007+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T20:04:23.216966463+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:23.216972616+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T20:04:23.216987938+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.216990193+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:23.217005083+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:23.217008596+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.217013852+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.217016774+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:23.217018462+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:23.217026172+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.217064704+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217069407+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.217087569+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.217089379+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217090957+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.217800783+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:23.217932642+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.217965394+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.217971095+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T20:04:23.217973753+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9998737268033353693
2025-07-02T20:04:23.217976250+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.217977908+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.217980744+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.218000764+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.218002717+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.218005839+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.218008202+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.218011358+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.218015943+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:23.218019544+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:23.218052170+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T20:04:23.221423765+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-07-02T20:04:23.222508971+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:23.222580421+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:23.222613407+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T20:04:23.229035861+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T20:04:23.229914663+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T20:04:23.756798457+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T20:04:23.756817010+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-07-02T20:04:23.758468115+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-07-02T20:04:23.761055212+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-07-02T20:04:23.764464155+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T20:04:23.764552510+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:23.764559155+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T20:04:23.764576845+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.764614722+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T20:04:23.764620742+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T20:04:23.764622965+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.764636087+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T20:04:23.764639145+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:23.764640876+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T20:04:23.764651350+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.764653280+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.764654999+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.764669037+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.764705676+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.764710085+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.765313969+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T20:04:23.765449764+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.765455775+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765458948+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T20:04:23.765461138+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9998737268033353693
2025-07-02T20:04:23.765463871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T20:04:23.765465832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T20:04:23.765467389+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T20:04:23.765490050+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T20:04:23.765493090+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765500199+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765503197+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765505329+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T20:04:23.765510811+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:23.765515816+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T20:04:23.765518029+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T20:04:23.769452117+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-07-02T20:04:23.769624423+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:23.770320733+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T20:04:23.770343051+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T20:04:23.778694633+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T20:04:35.149659150+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-07-02T20:04:35.149784203+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-07-02T20:04:35.149886893+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-07-02T20:04:35.149895953+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-07-02T20:04:35.149905749+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-07-02T20:04:35.200762550+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-07-02T20:04:35.200784935+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-07-02T20:04:35.200801019+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-07-02T20:04:35.200869474+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-07-02T20:04:35.200879112+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-07-02T20:04:35.200881307+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-07-02T20:04:35.524847691+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-07-02T20:04:35.524903919+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-07-02T20:04:35.525044032+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-07-02T20:04:35.525228399+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-07-02T20:04:35.525377459+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-07-02T20:04:35.525439131+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.250:41773: use of closed network connection
2025-07-02T20:04:35.525435873+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.250:41773: use of closed network connection
2025-07-02T20:04:35.525440465+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-07-02T20:04:35.525491424+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-07-02T20:04:35.525494241+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-07-02T20:04:35.525498610+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-07-02T20:04:35.525514616+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-07-02T20:04:35.525518281+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T20:04:35.525553467+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-07-02T20:04:35.525556308+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T20:04:35.525563148+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-07-02T20:04:35.525292167+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-07-02T20:04:35.525568118+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-07-02T20:04:35.525570555+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-07-02T20:04:35.525573643+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-07-02T20:04:35.525638094+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-07-02T20:04:35.525648376+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-07-02T20:04:35.525657767+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-07-02T20:04:35.525666257+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-07-02T20:04:35.525668216+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (97093): No such process
