Run TestCN
os.Args: [/tmp/go-build1354528033/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-07-02T19:55:04.268409175+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.268485545+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.268491318+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.268497823+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-07-02T19:55:04.269804543+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-07-02T19:55:04.275673524+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.275680453+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.275682447+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.275724058+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-07-02T19:55:04.276816969+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.276862186+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.276866996+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.276870927+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-07-02T19:55:04.276890196+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-07-02T19:55:04.277052657+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T19:55:04.277105578+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.277110501+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.277112368+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.277739281+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.277794578+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.277804027+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.277808232+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-07-02T19:55:04.277947173+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-07-02T19:55:04.282852559+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.282905979+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.282912358+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.282915416+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-07-02T19:55:04.282940541+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-07-02T19:55:04.282999151+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.283069916+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.283074314+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.283850376+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.283903529+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.283909602+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.283926907+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} a7a2fa12-945f-4199-9a85-7f8b6ca701a1 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{a7a2fa12-945f-4199-9a85-7f8b6ca701a1 nausf-auth 0xc000325488 http REGISTERED   0xc000325470  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc00071f680 false false}
2025-07-02T19:55:04.284075944+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-07-02T19:55:04.284459730+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:04.284491526+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-07-02T19:55:04.284493775+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:04.284497813+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-07-02T19:55:04.284538834+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-07-02T19:55:04.284874836+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-07-02T19:55:04.284938981+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-07-02T19:55:04.486132532+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-07-02T19:55:04.486298171+08:00[36m [INFO][AMF][Init] [0mServer started
2025-07-02T19:55:04.487400472+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-07-02T19:55:04.491737316+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:04.500813729+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:04.502648929+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 11620b29-2190-404b-8742-f890ce4b4f60
2025-07-02T19:55:04.505034382+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/11620b29-2190-404b-8742-f890ce4b4f60 |  |
2025-07-02T19:55:04.505554301+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:04.505611439+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-07-02T19:55:04.689803807+08:00[36m [INFO][SMF][Init] [0mServer started
2025-07-02T19:55:04.692860067+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:04.706686510+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:04.709192326+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 50a981f8-13d2-4472-8e3e-18552a1c5a54
2025-07-02T19:55:04.711120061+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/50a981f8-13d2-4472-8e3e-18552a1c5a54 |  |
2025-07-02T19:55:04.711338810+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:04.711511478+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {50a981f8-13d2-4472-8e3e-18552a1c5a54 SMF REGISTERED 0 0xc00080e330 0xc00080e348 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000264640 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc00080e258 false false []}
2025-07-02T19:55:04.711639049+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-07-02T19:55:04.711629788+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-07-02T19:55:04.711985241+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-07-02 19:55:04.711972244 +0800 CST m=+0.479765002]
2025-07-02T19:55:04.896883755+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:04.906483541+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:04.908721163+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 371686b1-bb98-4a86-bd8a-42776da9f7b3
2025-07-02T19:55:04.910678087+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/371686b1-bb98-4a86-bd8a-42776da9f7b3 |  |
2025-07-02T19:55:04.911216490+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:04.911256710+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-07-02T19:55:04.911269647+08:00[36m [INFO][UDR][Init] [0mServer started
2025-07-02T19:55:04.911278373+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T19:55:04.911291234+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-07-02T19:55:05.092781109+08:00[36m [INFO][PCF][Init] [0mServer started
2025-07-02T19:55:05.097811470+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:05.104781113+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:05.106530938+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 2f35ebce-0a8e-4259-b2a0-1b9e9cc322ff
2025-07-02T19:55:05.107170810+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/2f35ebce-0a8e-4259-b2a0-1b9e9cc322ff |  |
2025-07-02T19:55:05.107665066+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:05.107722443+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-07-02T19:55:05.293396114+08:00[36m [INFO][UDM][Init] [0mServer started
2025-07-02T19:55:05.293457454+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-07-02T19:55:05.294109006+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:05.300680784+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:05.302361111+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 57850de0-6b1c-4ccf-975a-03580dc8f4f0
2025-07-02T19:55:05.303718805+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/57850de0-6b1c-4ccf-975a-03580dc8f4f0 |  |
2025-07-02T19:55:05.304009665+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:05.304037066+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-07-02T19:55:05.498263239+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:05.519078555+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:05.521439550+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: d33456f4-e381-4ad1-8d65-fe8157eece66
2025-07-02T19:55:05.523448763+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d33456f4-e381-4ad1-8d65-fe8157eece66 |  |
2025-07-02T19:55:05.523650720+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:05.523656417+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-07-02T19:55:05.523658493+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-07-02T19:55:05.695696432+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-07-02T19:55:05.698697649+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:05.711543241+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:05.712154214+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-07-02T19:55:05.712884662+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-07-02T19:55:05.713724211+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a7a2fa12-945f-4199-9a85-7f8b6ca701a1
2025-07-02T19:55:05.716075793+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a7a2fa12-945f-4199-9a85-7f8b6ca701a1 |  |
2025-07-02T19:55:05.716249875+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:05.716306422+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-07-02T19:55:05.897385375+08:00[36m [INFO][CHF][Init] [0mServer started
2025-07-02T19:55:05.900082973+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-07-02T19:55:05.905097463+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:55:05.912078724+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:55:05.913995259+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 14c397c2-ada0-4df8-832d-fd22adbe715f
2025-07-02T19:55:05.915371101+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/14c397c2-ada0-4df8-832d-fd22adbe715f |  |
2025-07-02T19:55:05.915541527+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:55:05.915588509+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-07-02T19:55:12.884415864+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886
2025-07-02T19:55:12.885725895+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886
2025-07-02T19:55:12.885956978+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle NGSetupRequest
2025-07-02T19:55:12.886004393+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mMissing IE PagingDRX
2025-07-02T19:55:12.886024140+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2022330059/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-07-02T19:55:19.177221528+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.177307800+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.177321395+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:19.177324490+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:55:19.177479561+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:19.177631682+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.177642647+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.177644846+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:19.177648208+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:55:19.177654460+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:19.187963499+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.188014192+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.188020272+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.188024173+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.188026434+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.188028591+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.188030267+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-07-02T19:55:19.191840778+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.191847009+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:55:19.191849097+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:19.191851697+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:19.191853574+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:19.191864276+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.191866883+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.191868401+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.191874670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.191876212+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.191877558+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.193643236+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.193705776+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.193711581+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.193715346+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.193717005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193718543+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.193785315+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.193787939+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.193790234+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.193792307+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.193794247+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.193796017+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-07-02T19:55:19.193841865+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193844616+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.193846139+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:55:19.193850305+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.193852659+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193854393+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.193860192+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.193861887+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193863664+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.195869065+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle InitialUEMessage
2025-07-02T19:55:19.195900237+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-07-02T19:55:19.195924723+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-07-02T19:55:19.195954416+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-07-02T19:55:19.195966313+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-07-02T19:55:19.195972436+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-07-02T19:55:19.195975933+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-07-02T19:55:19.195979397+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-07-02T19:55:19.195984762+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-07-02T19:55:19.195987542+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-07-02T19:55:19.196584054+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.224714732+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-07-02T19:55:19.230510553+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-07-02T19:55:19.230557119+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-07-02T19:55:19.231189166+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.309509382+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-07-02T19:55:19.316433148+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-07-02T19:55:19.316535527+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-07-02T19:55:19.316541637+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-07-02T19:55:19.316543798+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-07-02T19:55:19.316896590+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.346705953+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-07-02T19:55:19.349781194+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T19:55:19.350726513+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T19:55:19.350851824+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-07-02T19:55:19.350908431+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-07-02T19:55:19.350952944+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-07-02T19:55:19.350959590+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3035343730623364353430393232396435353632386335383332386231663633
2025-07-02T19:55:19.350993054+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-07-02T19:55:19.351460577+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-07-02T19:55:19.351523446+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend Downlink Nas Transport
2025-07-02T19:55:19.351663587+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-07-02T19:55:19.352574340+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.352632865+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.352638665+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.352649678+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.352652190+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352654052+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.352683720+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.352685835+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.352705798+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.352791568+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352846055+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.352855159+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:55:19.352861784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.352863370+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352864941+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.352870416+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.352871888+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352873318+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.353847724+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:19.353880513+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:19.353907839+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-07-02T19:55:19.353917073+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-07-02T19:55:19.353928627+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-07-02T19:55:19.354306416+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-07-02T19:55:19.354351825+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3035343730623364353430393232396435353632386335383332386231663633
Xres*: 3035343730623364353430393232396435353632386335383332386231663633
2025-07-02T19:55:19.354357558+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-07-02T19:55:19.354879911+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-07-02T19:55:19.356117747+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-07-02T19:55:19.356257969+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-07-02T19:55:19.356463654+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-07-02T19:55:19.357895186+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-07-02T19:55:19.358042800+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-07-02T19:55:19.358057126+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend Downlink Nas Transport
2025-07-02T19:55:19.358299656+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-07-02T19:55:19.358956966+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.358971340+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.358974158+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.358976239+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.358977823+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.358979812+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.358988277+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.359097653+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.359104854+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.359124786+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.359128637+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.359130341+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:55:19.359226590+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.359230776+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.359232420+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.359238033+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.359239670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.359241149+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.359744908+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:19.359798566+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:19.359821920+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-07-02T19:55:19.359824884+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-07-02T19:55:19.359827628+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-07-02T19:55:19.359997284+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-07-02T19:55:19.360039428+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-07-02T19:55:19.360422202+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.430291039+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T19:55:19.437157901+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-07-02T19:55:19.437370780+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T19:55:19.438129334+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-07-02T19:55:19.438703088+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:19.441889543+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.512019452+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T19:55:19.517460727+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-07-02T19:55:19.518496234+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-07-02T19:55:19.518953506+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-07-02T19:55:19.519150328+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-07-02T19:55:19.519424706+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T19:55:19.519928827+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:19.520102959+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:19.520256102+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-07-02T19:55:19.521129392+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-07-02T19:55:19.521518298+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:19.521678335+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-07-02T19:55:19.522359858+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-07-02T19:55:19.524419179+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-07-02T19:55:19.524880631+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-07-02T19:55:19.525052751+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-07-02T19:55:19.525229514+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-07-02T19:55:19.525520425+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.618807020+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-07-02T19:55:19.631696663+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-07-02T19:55:19.632385231+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.663107378+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-07-02T19:55:19.666404681+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-07-02T19:55:19.667237835+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:19.738622576+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-07-02T19:55:19.745271806+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-07-02T19:55:19.745284233+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-07-02T19:55:19.745295912+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-07-02T19:55:19.745506093+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-07-02T19:55:19.745852003+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-07-02T19:55:19.745920513+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend Initial Context Setup Request
2025-07-02T19:55:19.746065246+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-07-02T19:55:19.747118443+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.747140882+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.747143907+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.747146364+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.747147938+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747149515+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747165617+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.747167679+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.747177512+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747179296+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:55:19.747201295+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747204124+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T19:55:19.747205819+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T19:55:19.747220310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.747221849+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747223891+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747228494+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.747234357+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747235863+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747944814+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.748028137+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.748031813+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748035312+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.748036969+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.748038652+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.748110020+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.748115634+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748124310+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748127047+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748131485+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748133573+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748136978+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.748138817+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-07-02T19:55:19.748324925+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle InitialContextSetupResponse
2025-07-02T19:55:19.748335733+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T19:55:19.748338845+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x0f701192
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000b37900)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013ca50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000aec540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000be7670)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000b37920)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000b37980)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000be76ab)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000be76c3)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000be76c9)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-07-02T19:55:19.749851672+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:19.749868929+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:19.749897016+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-07-02T19:55:19.749906871+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-07-02T19:55:19.749914596+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-07-02T19:55:19.749989078+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-07-02T19:55:19.750017528+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend Downlink Nas Transport
2025-07-02T19:55:19.750097054+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-07-02T19:55:20.252388008+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:20.252451947+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:20.252704921+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:55:20.252745025+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:55:20.252751765+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:55:20.252758956+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:55:20.254353863+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.299021817+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-07-02T19:55:20.303184330+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:55:20.303258784+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:55:20.303454651+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=11620b29-2190-404b-8742-f890ce4b4f60&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:55:20.303733517+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:55:20.304383825+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.360000468+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:20.373172882+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:55:20.373533151+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:55:20.373716654+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:55:20.373765976+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:55:20.374466810+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.452149818+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:55:20.457662876+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:55:20.458513979+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:55:20.458557782+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:55:20.462636879+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:20.463248785+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:20.463542363+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:55:20+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0008a0380 0xc0008a03a0 0xc0008a03c0]
2025-07-02T19:55:20.463585142+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:55:20.463596312+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0008a0380 0xc0008a03a0 0xc0008a03c0]}
2025-07-02T19:55:20.463603776+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:55:20.464156651+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.466478077+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=11620b29-2190-404b-8742-f890ce4b4f60&target-nf-type=AMF |  |
2025-07-02T19:55:20.466809454+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:55:20.467071776+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-07-02T19:55:20.467099201+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:55:20.467108537+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-07-02T19:55:20.467118545+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:55:20.467345198+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.546631390+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:55:20.553490311+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:55:20.553548364+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:55:20.554535235+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:55:20.555951842+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:20.558370574+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:55:20.558464192+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:55:20.558851491+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:55:20.559864462+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.561530235+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:55:20.562241315+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:55:20.562760546+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:55:20.563640143+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.594282482+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:55:20.596180564+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:55:20.598642884+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:55:20.598949469+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:55:20.598988434+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:55:20.599194457+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:55:20.599207112+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:55:20.600429787+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:55:20.601386935+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:55:20.601458080+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-07-02T19:55:20.601483661+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:55:20.601489226+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:20.601505369+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:55:20.601508384+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:20.601529748+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:55:20.601579529+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:55:20.601706577+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:55:20.601934157+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-07-02T19:55:20.609989542+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:55:20.610987793+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:55:20.611156389+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend PDU Session Resource Setup Request
2025-07-02T19:55:20.611344915+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:55:20.612039797+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:20.612064679+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:20.612069545+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-07-02T19:55:20.612150117+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:20.612153301+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.612155014+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:20.612189427+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:20.612193972+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612199243+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612202111+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612204185+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612206043+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612208255+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 2 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-07-02T19:55:20.612256813+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.612259610+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:20.612262090+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:20.612264488+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:20.612266200+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:20.612272502+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:20.612273916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.612275341+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:20.612284423+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:20.612285869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.612287254+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xc209f66c
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00072c440)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cb41e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0007285f0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000c9a454)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000644240)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00071c080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000c9a480)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000c9a490)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00072c460)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00072c480)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00072c4a0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T19:55:20.613703448+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:55:20.613957943+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T19:55:20.614783040+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T19:55:20.617418202+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:55:20.617487050+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:364932e7-10d2-493f-b05f-a4d093b58c79/modify |  |
2025-07-02T19:55:20.816332422+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:20.816427717+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:20.816476144+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:55:20.816487822+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:55:20.816496263+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:55:20.816507386+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:55:20.817668403+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:55:20.817757437+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:55:20.817779177+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=11620b29-2190-404b-8742-f890ce4b4f60&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:55:20.817851232+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:55:20.818497631+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.882011566+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:20.889609170+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:55:20.889791105+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:55:20.889856426+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:55:20.889861559+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:55:20.890359991+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.967371325+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:55:20.972939563+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:55:20.974064419+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:55:20.974140632+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:55:20.976043507+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:20.976270420+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:20.976668320+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:55:20+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000a90320 0xc000a90340 0xc000a90360]
2025-07-02T19:55:20.976739278+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:55:20.976743474+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000a90320 0xc000a90340 0xc000a90360]}
2025-07-02T19:55:20.976745389+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:55:20.977289809+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:20.979728320+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=11620b29-2190-404b-8742-f890ce4b4f60&target-nf-type=AMF |  |
2025-07-02T19:55:20.980063820+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:55:20.980132454+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-07-02T19:55:20.980144556+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:55:20.980152567+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-07-02T19:55:20.980161836+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:55:20.980458478+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.071794656+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:55:21.079217593+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:55:21.079285595+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:55:21.081715724+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:55:21.084033621+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:21.086750805+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:55:21.087213160+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:55:21.087638747+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:55:21.088213192+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.090755264+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:55:21.091344413+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:55:21.091639081+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:55:21.091888210+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.117027422+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:55:21.120766032+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:55:21.121566926+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:55:21.121579025+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:55:21.121583602+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:55:21.121585863+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:55:21.121587755+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:55:21.121601777+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:55:21.121895827+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:55:21.121979572+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-07-02T19:55:21.122065379+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:55:21.122073497+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:21.122109766+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:55:21.122113522+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:21.122130427+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:55:21.122197138+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:55:21.122334276+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:55:21.122698491+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-07-02T19:55:21.129318995+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:55:21.130292657+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:55:21.130393235+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend PDU Session Resource Setup Request
2025-07-02T19:55:21.130651485+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:55:21.135071997+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:21.135104613+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.135107887+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-07-02T19:55:21.135289872+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.135294003+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.135295906+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.135325051+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.135358959+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135365300+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135368134+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135370449+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135372530+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135374342+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 2 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T19:55:21.135408828+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.135446077+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:21.135452678+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.135455778+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.135460469+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:21.135469085+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.135470755+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.135472283+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.135484467+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.135486030+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.135487404+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000ad57ecf1
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xac8e6604dee69344f5910625ee24343e7710f5e13cb6bd619dd419ce92518024
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x62df627c958b6f833520252d0fa738a6a5b928b8
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000d4049bcb
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x90072f950376c9880895425b442b31fbf2e9b00bfaca796c54de74cd10342eac
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x2578ea03bce29d37bdd3558423f5f47f85378eb4
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xb888f0ef
err <nil>
2025-07-02T19:55:21.143626469+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:55:21.143649755+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00072d120)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cb44b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000728fa0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000c9bd6c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006443f0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00071c780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000c9bd90)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000c9bda0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00072d140)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00072d160)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00072d180)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T19:55:21.147430946+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T19:55:21.154265769+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:55:21.154519668+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:bc81054f-5b8f-4729-a751-c88d5d763356/modify |  |
2025-07-02T19:55:21.348135437+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:21.348307310+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:21.348351066+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:55:21.348356247+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:55:21.348359674+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:55:21.348366251+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:55:21.348828984+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:55:21.348920136+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:55:21.348943356+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=11620b29-2190-404b-8742-f890ce4b4f60&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:55:21.349201642+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:55:21.349650604+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.407170373+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:21.412839225+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:55:21.413348656+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:55:21.413791049+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:55:21.415838704+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:55:21.417708630+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.487224992+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:55:21.492523630+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:55:21.493137029+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:55:21.493158436+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:55:21.493892649+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:21.494234908+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:21.494551253+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:55:21+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000767340 0xc000767360 0xc000767380]
2025-07-02T19:55:21.494566951+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:55:21.494571043+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000767340 0xc000767360 0xc000767380]}
2025-07-02T19:55:21.494573170+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:55:21.494932787+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.497357344+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=11620b29-2190-404b-8742-f890ce4b4f60&target-nf-type=AMF |  |
2025-07-02T19:55:21.497690695+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:55:21.497777786+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-07-02T19:55:21.497783882+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:55:21.497786452+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-07-02T19:55:21.497790678+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:55:21.497847564+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.576619487+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:55:21.584746361+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:55:21.584837466+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:55:21.585734274+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:55:21.587077540+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:21.591255352+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:55:21.591409618+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:55:21.591747790+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:55:21.592353606+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.594135228+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:55:21.594390818+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:55:21.594551592+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:55:21.594607532+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.621642916+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:55:21.624659484+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:55:21.625323041+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:55:21.625362134+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:55:21.625388994+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:55:21.625397516+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:55:21.625405070+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:55:21.625421569+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:55:21.625727361+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:55:21.625858250+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:55:21.625866698+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:21.625902090+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:55:21.625944426+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:21.625970545+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:55:21.626003835+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:55:21.626087055+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:55:21.626432952+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-07-02T19:55:21.632362368+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:55:21.633538117+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:55:21.633730058+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend PDU Session Resource Setup Request
2025-07-02T19:55:21.633965614+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:55:21.634703759+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:21.634732577+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.634735885+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-07-02T19:55:21.634765548+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.634767438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.634871863+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.634903813+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.634906820+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.634910729+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.634913003+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.634915282+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.634993137+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.635075014+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T19:55:21.635114201+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.635116388+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:21.635119635+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.635122092+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.635123999+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:21.635129188+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.635130752+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.635132260+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.635144472+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.635145934+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.635147433+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000ee7bcaf3
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xde0fbb9386fc22177ce2511ecc23a847d8ccb77813955193ffa24bcc7b57667b
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x0793928fded2fa8b8f1d128231e7d726ffe301b9
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000c819a753
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xaf784d17e58a6d671b8bd7518224b47ef8a98e43797e5b1c1f1372e93a978c02
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x1c0c4d6dbb448b44354fe3f68db7a63fb5986b1a
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-07-02T19:55:21.639282243+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:55:21.639322686+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T19:55:21.640144051+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x47a54644
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00072de20)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cb4780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000729950)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000e48bc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006445a0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00071ce80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0000e48e0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000e4900)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00072de40)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00072de60)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00072de80)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T19:55:21.648847138+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:55:21.648922434+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:3fa87556-3129-4533-8e2c-6e65b0f5fd56/modify |  |
2025-07-02T19:55:21.840405999+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport
2025-07-02T19:55:21.840642212+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:55:21.840765086+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:55:21.840802542+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:55:21.840830893+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:55:21.840866733+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:55:21.842934929+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:55:21.843123370+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:55:21.843662013+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=11620b29-2190-404b-8742-f890ce4b4f60&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:55:21.844502514+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:55:21.846301140+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.912221317+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:55:21.917964713+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:55:21.918225354+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:55:21.918283602+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:55:21.918288627+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:55:21.918548053+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:21.990166756+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:55:21.999047000+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:55:22.000750453+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:55:22.000909937+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:55:22.001767599+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:22.002048590+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:22.002337121+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:55:22+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001a5c220 0xc001a5c240 0xc001a5c260]
2025-07-02T19:55:22.002404032+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:55:22.002427840+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001a5c220 0xc001a5c240 0xc001a5c260]}
2025-07-02T19:55:22.002434787+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:55:22.003558941+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:22.005712101+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=11620b29-2190-404b-8742-f890ce4b4f60&target-nf-type=AMF |  |
2025-07-02T19:55:22.005858330+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:55:22.005913536+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-07-02T19:55:22.005924347+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:55:22.005931770+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-07-02T19:55:22.005941111+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:55:22.005991802+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:22.091625381+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:55:22.100602321+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:55:22.100654218+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:55:22.103844485+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:55:22.106663909+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:55:22.110581822+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:55:22.110781785+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:55:22.111240978+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:55:22.111753318+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:22.113676576+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:55:22.113922515+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:55:22.114181511+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:55:22.114411953+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:55:22.142644500+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:55:22.144663398+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:55:22.145402114+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:55:22.145547714+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:55:22.145560045+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:55:22.145567324+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:55:22.145573447+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:55:22.145590080+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:55:22.145979041+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:55:22.146098974+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:55:22.146144445+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:22.146173154+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:55:22.146176547+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:55:22.146192174+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:55:22.146217993+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:55:22.146351637+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:55:22.146469322+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-07-02T19:55:22.154697674+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:55:22.155826353+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:55:22.155887353+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mSend PDU Session Resource Setup Request
2025-07-02T19:55:22.156059677+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:55:22.157056430+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:22.157079125+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:22.157081819+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-07-02T19:55:22.157111111+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:22.157112982+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.157114832+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:22.157137675+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:22.157139772+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157143580+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157145648+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157153074+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157155262+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157157034+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T19:55:22.157197916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.157200221+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:22.157202663+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:22.157205285+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:22.157207135+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:22.157219049+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:22.157221500+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.157222927+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:22.157231910+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:22.157233416+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.157236140+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000001c743ca0
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x54cf6902d1d5241c8953085ffb0a2ed06a26f45600a49ae139a7fd271cac2121
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x5b4b06eb07ddcd2ce40b00d47c6fc852f4a136df
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000fd1cd099
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xb886321ccbb4e34a64ebb1a6f143f02db7120e8f38c792c7ad80d44e667b1cde
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x62b77df265cee73cbfd62b1adcc8729768c2d5ae
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x3340f718
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000ca6b60)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cb4a50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c843c0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00068e5bc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000644750)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00071da00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00068e5e0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00068e5f0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000ca6b80)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000ca6ba0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000ca6bc0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T19:55:22.165744350+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:55:22.165797677+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:40886] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1844: Create 2 interfaces
2025-07-02T19:55:22.168101944+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T19:55:22.173146561+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:55:22.173193794+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:f26a6952-07e3-4ad8-8b0d-e6a6f2b06936/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=4.530629ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=2.932639ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=2.706385ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=4.841228ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=3.287155ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 2.706385ms/3.659607ms/4.841228ms/863.798µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (11.41s)
PASS
ok  	test	11.456s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (26.93s)
PASS
ok  	test	29.806s

--- STDERR ---
2025-07-02T19:55:00.736096017+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T19:55:00.736228337+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-07-02T19:55:00.736435344+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T19:55:00.736460709+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0004ca4b0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc00031e1e0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc00031e750)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0000ccec0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-07-02T19:55:00.736470115+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T19:55:00.736482602+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-07-02T19:55:00.736489330+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:00.736549712+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-07-02T19:55:00.736577764+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-07-02T19:55:00.741215739+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-07-02T19:55:00.741400809+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-07-02T19:55:00.741571861+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-07-02T19:55:00.741724092+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-07-02T19:55:00.741735718+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-07-02T19:55:00.741738428+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-07-02T19:55:05.712601009+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-07-02T19:55:05.712677160+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-07-02T19:55:12.869775357+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T19:55:12.870541830+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-07-02T19:55:12.870959748+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-07-02T19:55:12.870993105+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-07-02T19:55:12.871005755+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-07-02T19:55:12.871059799+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-07-02T19:55:12.871073050+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-07-02T19:55:12.882615321+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-07-02T19:55:12.882690704+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-07-02T19:55:12.884554428+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-07-02T19:55:12.886103108+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-07-02T19:55:12.886431848+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-07-02T19:55:12.887726899+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-07-02T19:55:12.888875356+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-07-02T19:55:12.889061197+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-07-02T19:55:12.889087438+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-07-02T19:55:19.178920833+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.180036844+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.180047877+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.180054740+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.180057944+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.180077782+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-07-02T19:55:19.187667937+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.187751628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.187757492+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:19.187760429+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:55:19.187762432+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:19.187764340+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:19.187765954+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:19.187779100+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.187780827+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:55:19.187794771+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.187796312+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.187797744+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:19.187799851+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:55:19.187801373+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:19.187802960+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:19.187807577+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:19.192093830+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.192104601+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.192107344+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.192109593+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:55:19.192112713+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.192114356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.192116133+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.192136696+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.192139930+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.192143304+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.192146116+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.192148316+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.192150650+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-07-02T19:55:19.192152129+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.192153732+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:55:19.192156699+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-07-02T19:55:19.192159179+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T19:55:19.192160564+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T19:55:19.193305727+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193356934+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:55:19.193362164+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-07-02T19:55:19.193364382+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T19:55:19.193368409+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.193370161+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:55:19.193382875+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.193385741+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193387245+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.193408492+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.193410039+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.193413082+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.195429192+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.195439925+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.195442327+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.195445677+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:55:19.195448335+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.195450675+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.195452158+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.195461696+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.195463624+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.195465295+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.195467537+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T19:55:19.195476540+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.195501098+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:19.195538275+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-07-02T19:55:19.195548314+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.195550865+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-07-02T19:55:19.352053623+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:55:19.352165621+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:19.352173197+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T19:55:19.352274693+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352317170+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.352322093+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:55:19.352330226+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.352331999+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352333611+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.352349649+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.352351309+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.352355153+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.353022524+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.353075540+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.353080996+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.353083541+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:55:19.353086431+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.353087962+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.353089413+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.353103825+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.353106648+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.353108359+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.353110711+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T19:55:19.353115420+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.353119928+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:19.358473707+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:55:19.358694865+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:19.358702361+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T19:55:19.358706086+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.358707966+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.358709669+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:55:19.358717150+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.358718863+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.358720397+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.358727654+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.358729244+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.358730678+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.359333180+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.359345190+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.359347909+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.359350284+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:55:19.359353107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.359354659+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.359356088+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.359365328+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.359367713+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.359369460+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.359371696+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T19:55:19.359374914+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.359377398+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:19.746597375+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-07-02T19:55:19.746632744+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:19.746657805+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-07-02T19:55:19.746662759+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.746755927+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:55:19.746801347+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.746806088+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.746807954+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.746815028+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.746816536+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.746817920+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747315980+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:19.747363840+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.747369358+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.747373645+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:55:19.747377016+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.747378587+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747380312+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747389616+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:19.747391726+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.747395859+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:19.747533448+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 4007360973, Outbound SPI: 338654037
2025-07-02T19:55:19.747607464+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747612495+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T19:55:19.747614809+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T19:55:19.747616980+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:19.747635984+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:19.747638125+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:19.747640212+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:19.747642447+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:19.747648915+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.747650501+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747651974+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747822722+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:19.747874978+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:19.747880227+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:19.747939537+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.747945761+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.747949761+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:19.747951852+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:55:19.747961276+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.748014381+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-07-02T19:55:19.748586157+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:55:19.749086228+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:19.749737070+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:19.750455344+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:55:20.251975546+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:20.602273672+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:55:20.602325929+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-07-02T19:55:20.605165602+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-07-02T19:55:20.605214356+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-07-02T19:55:20.605433425+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-07-02T19:55:20.611628825+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:55:20.611798941+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:20.611806763+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:55:20.611824502+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.611857954+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:20.611863378+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:20.611865724+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:20.611868081+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:20.611869932+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:20.611872966+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:20.611881112+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:20.611882982+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.611884624+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:20.611902009+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:20.611904196+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.611905752+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:20.612490166+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:20.612507943+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:20.612510941+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612513655+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:55:20.612516118+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13301136015076512878
2025-07-02T19:55:20.612518889+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:20.612520504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:20.612523842+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:20.612544746+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:20.612546835+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612549862+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612551958+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612553986+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:20.612607596+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:20.612647954+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:20.612654117+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:55:20.612870339+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:20.613350059+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:20.613429840+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:55:20.614241456+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:20.615478441+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:55:21.122752762+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:55:21.122771121+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-07-02T19:55:21.125074800+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-07-02T19:55:21.126132018+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-07-02T19:55:21.131131742+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:55:21.134419185+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:21.134474694+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:55:21.134498034+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.134500664+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:21.134503448+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:21.134507056+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.134509531+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.134511404+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:21.134513146+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:21.134522390+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.134631040+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.134666016+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.134684624+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.134686626+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.134688114+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.135862943+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:21.135876885+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.135879835+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135882579+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:55:21.135885209+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13301136015076512878
2025-07-02T19:55:21.135888476+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.135890285+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.135892061+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.135924178+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.135926438+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135931186+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135933484+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135936006+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.135984298+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:21.135992288+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:21.135994702+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:55:21.142483039+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-07-02T19:55:21.142846140+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:21.143283993+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:21.143312287+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:55:21.144669373+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:21.148071560+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:55:21.626538891+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:55:21.626557783+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-07-02T19:55:21.629273643+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-07-02T19:55:21.629589225+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-07-02T19:55:21.634226962+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:55:21.634313168+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:21.634320267+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:55:21.634336412+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.634339961+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:21.634342607+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:21.634344783+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.634346796+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:21.634348589+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:21.634350305+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:21.634358423+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.634392438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.634396715+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.634412942+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.634414709+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.634416137+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.635480273+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:21.635495752+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.635498503+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.635502448+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:55:21.635505467+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13301136015076512878
2025-07-02T19:55:21.635508614+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:21.635510346+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:21.635512059+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:21.635531353+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:21.635533293+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.635536463+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.635538515+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.635541293+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:21.635546217+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:21.635549115+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:21.635552107+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:55:21.636708786+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-07-02T19:55:21.636828485+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:21.636873163+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:21.636891228+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:55:21.644639768+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:55:21.646649965+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:55:22.146928605+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:55:22.147193289+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-07-02T19:55:22.152885506+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-07-02T19:55:22.153030459+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-07-02T19:55:22.156414125+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:55:22.156462122+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:22.156465861+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:55:22.156484138+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.156644188+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:55:22.156687109+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:55:22.156693755+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:22.156696193+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:55:22.156698161+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:22.156699984+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:55:22.156743446+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:22.156745505+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.156747247+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:22.156763689+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:22.156765408+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.156766955+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:22.157384075+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:55:22.157401920+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:22.157404618+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157407671+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:55:22.157409979+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13301136015076512878
2025-07-02T19:55:22.157413081+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:55:22.157414822+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:55:22.157416421+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:55:22.157439868+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:55:22.157441955+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157445626+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157448009+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157450520+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:55:22.157494482+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:22.157633612+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:55:22.157639359+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:55:22.163690484+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-07-02T19:55:22.163915536+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:22.163977326+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:55:22.164001087+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:55:22.169114503+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:55:33.620952266+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-07-02T19:55:33.621046871+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-07-02T19:55:33.621087571+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-07-02T19:55:33.621094435+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-07-02T19:55:33.621101492+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-07-02T19:55:33.671685541+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-07-02T19:55:33.671702689+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-07-02T19:55:33.671720859+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-07-02T19:55:33.671735046+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-07-02T19:55:33.671743025+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-07-02T19:55:33.671745120+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-07-02T19:55:34.005739291+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-07-02T19:55:34.005814379+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-07-02T19:55:34.007881214+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-07-02T19:55:34.007923003+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-07-02T19:55:34.007928401+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-07-02T19:55:34.007953354+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.70:47405: use of closed network connection
2025-07-02T19:55:34.007956464+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.70:47405: use of closed network connection
2025-07-02T19:55:34.007959092+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-07-02T19:55:34.007970580+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-07-02T19:55:34.007974060+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-07-02T19:55:34.007977918+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-07-02T19:55:34.007985844+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-07-02T19:55:34.007988106+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T19:55:34.007996303+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-07-02T19:55:34.007998164+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T19:55:34.008002451+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-07-02T19:55:34.008121019+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-07-02T19:55:34.008133066+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-07-02T19:55:34.008137402+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-07-02T19:55:34.008141343+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-07-02T19:55:34.008297441+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-07-02T19:55:34.008314814+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-07-02T19:55:34.008324340+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-07-02T19:55:34.008332692+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-07-02T19:55:34.008335076+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (92067): No such process
