Run TestCN
os.Args: [/tmp/go-build2379166792/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-07-02T19:56:21.941553272+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.941777167+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.941809942+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.941822733+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-07-02T19:56:21.942019828+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-07-02T19:56:21.944631935+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.944642716+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.944649724+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.944704671+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-07-02T19:56:21.945604200+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.945629340+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.945639115+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.945652033+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-07-02T19:56:21.945677135+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-07-02T19:56:21.945833915+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T19:56:21.945854086+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.945861941+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.945868158+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.946444388+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.946467985+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.946475525+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.946499583+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-07-02T19:56:21.946864313+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-07-02T19:56:21.947674373+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.947717296+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.948095067+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.948107443+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-07-02T19:56:21.948128716+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-07-02T19:56:21.948149291+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.948157339+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.948163822+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.948320656+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.948335708+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.948346910+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.948364081+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} c4bebf9d-1605-48aa-bd2d-4b63b07811cd ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{c4bebf9d-1605-48aa-bd2d-4b63b07811cd nausf-auth 0xc000298fa8 http REGISTERED   0xc000298f90  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000ccb360 false false}
2025-07-02T19:56:21.948540300+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-07-02T19:56:21.948782303+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:21.948795020+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-07-02T19:56:21.948803928+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:21.948810895+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-07-02T19:56:21.948828786+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-07-02T19:56:21.951032107+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-07-02T19:56:21.951097959+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-07-02T19:56:22.153000694+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-07-02T19:56:22.154710845+08:00[36m [INFO][AMF][Init] [0mServer started
2025-07-02T19:56:22.155523404+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-07-02T19:56:22.160958545+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:22.171378714+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:22.173526543+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 03007252-23c0-4b5d-b5df-c3ac81344484
2025-07-02T19:56:22.176321276+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/03007252-23c0-4b5d-b5df-c3ac81344484 |  |
2025-07-02T19:56:22.176584904+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:22.176657630+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-07-02T19:56:22.353101498+08:00[36m [INFO][SMF][Init] [0mServer started
2025-07-02T19:56:22.355624588+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:22.372133030+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:22.373987246+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: af74b930-d2ce-4ad9-ae02-9ec440ef487e
2025-07-02T19:56:22.375626012+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/af74b930-d2ce-4ad9-ae02-9ec440ef487e |  |
2025-07-02T19:56:22.375801673+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:22.375869196+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {af74b930-d2ce-4ad9-ae02-9ec440ef487e SMF REGISTERED 0 0xc0009291e8 0xc000929200 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc00012c940 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc000929140 false false []}
2025-07-02T19:56:22.375912038+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-07-02T19:56:22.375919279+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-07-02 19:56:22.375914926 +0800 CST m=+0.469209785]
2025-07-02T19:56:22.375925740+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-07-02T19:56:22.554233488+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:22.563468060+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:22.568315685+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: e9548eba-0159-4c4b-abaa-f4c408ab5d73
2025-07-02T19:56:22.569290400+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/e9548eba-0159-4c4b-abaa-f4c408ab5d73 |  |
2025-07-02T19:56:22.569470241+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:22.569497487+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-07-02T19:56:22.569505978+08:00[36m [INFO][UDR][Init] [0mServer started
2025-07-02T19:56:22.569514995+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-07-02T19:56:22.569569739+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-07-02T19:56:22.755390623+08:00[36m [INFO][PCF][Init] [0mServer started
2025-07-02T19:56:22.756754236+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:22.762849822+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:22.764898406+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 0c1ab3f3-7046-4c3f-9c10-2c43128d6662
2025-07-02T19:56:22.766858131+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/0c1ab3f3-7046-4c3f-9c10-2c43128d6662 |  |
2025-07-02T19:56:22.767184845+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:22.767195630+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-07-02T19:56:22.961512910+08:00[36m [INFO][UDM][Init] [0mServer started
2025-07-02T19:56:22.961586251+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-07-02T19:56:22.962260144+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:22.978125199+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:22.980260419+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8c56749d-1d71-4480-91e9-b2e8322683d2
2025-07-02T19:56:22.982153023+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8c56749d-1d71-4480-91e9-b2e8322683d2 |  |
2025-07-02T19:56:22.982462778+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:22.982769213+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-07-02T19:56:23.163195532+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:23.170938903+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:23.172916229+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 4a329a70-4bb8-4e72-8a4c-67b02f5bbd22
2025-07-02T19:56:23.174244690+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/4a329a70-4bb8-4e72-8a4c-67b02f5bbd22 |  |
2025-07-02T19:56:23.174579934+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:23.174631633+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-07-02T19:56:23.174637132+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-07-02T19:56:23.364038011+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-07-02T19:56:23.364835239+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:23.372659983+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:23.374802439+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: c4bebf9d-1605-48aa-bd2d-4b63b07811cd
2025-07-02T19:56:23.376128244+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-07-02T19:56:23.376805659+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-07-02T19:56:23.376849927+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/c4bebf9d-1605-48aa-bd2d-4b63b07811cd |  |
2025-07-02T19:56:23.377046032+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:23.377112555+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-07-02T19:56:23.567357643+08:00[36m [INFO][CHF][Init] [0mServer started
2025-07-02T19:56:23.568992640+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-07-02T19:56:23.572702462+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-07-02T19:56:23.581118229+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-07-02T19:56:23.583580649+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 44bf77ce-661d-4ca2-8bda-2c0b5208ddbd
2025-07-02T19:56:23.584920834+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/44bf77ce-661d-4ca2-8bda-2c0b5208ddbd |  |
2025-07-02T19:56:23.585057123+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-07-02T19:56:23.585081105+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-07-02T19:56:30.690230178+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768
2025-07-02T19:56:30.690891285+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768
2025-07-02T19:56:30.691263428+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle NGSetupRequest
2025-07-02T19:56:30.691312915+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mMissing IE PagingDRX
2025-07-02T19:56:30.691332403+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2132464106/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-07-02T19:56:37.094520524+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.094636981+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.094642713+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:37.094645856+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:56:37.094647879+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:37.094707464+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.094710525+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.094713493+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:37.094715686+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:56:37.094717227+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:37.104780068+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.104797578+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.104800535+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.104803605+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.104805679+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.104810905+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.104812677+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-07-02T19:56:37.108638771+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.108690461+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:56:37.108695713+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:37.108698368+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:37.108700882+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:37.108713843+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.108716667+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.108718458+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.108725062+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.108726574+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.108727979+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.110478589+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.110507666+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.110510286+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.110512794+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.110514802+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110516266+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.110581343+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.110622393+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.110627363+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.110632543+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.110637881+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.110641482+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-07-02T19:56:37.110677354+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110679463+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.110681080+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:56:37.110686064+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.110687531+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110688994+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.110696906+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.110698481+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110699894+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.111517083+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle InitialUEMessage
2025-07-02T19:56:37.111668787+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-07-02T19:56:37.111757083+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-07-02T19:56:37.111794301+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-07-02T19:56:37.111819833+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-07-02T19:56:37.111826070+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-07-02T19:56:37.111829759+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-07-02T19:56:37.111833401+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-07-02T19:56:37.111838296+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-07-02T19:56:37.111841063+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-07-02T19:56:37.112237922+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.140056724+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-07-02T19:56:37.142165303+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-07-02T19:56:37.142241845+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-07-02T19:56:37.142688202+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.218958834+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-07-02T19:56:37.225011673+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-07-02T19:56:37.225042469+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-07-02T19:56:37.225045234+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-07-02T19:56:37.225047175+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-07-02T19:56:37.225650951+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.254523594+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-07-02T19:56:37.261717509+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T19:56:37.263924669+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-07-02T19:56:37.264090506+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-07-02T19:56:37.264407435+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-07-02T19:56:37.264416812+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-07-02T19:56:37.264420512+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3266616135313633326434303738326539306165383230303964353863623765
2025-07-02T19:56:37.264454735+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-07-02T19:56:37.264518006+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-07-02T19:56:37.264582075+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend Downlink Nas Transport
2025-07-02T19:56:37.264691514+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-07-02T19:56:37.265491358+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.265517606+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.265522181+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.265524965+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.265526690+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265528495+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.265542738+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.265545067+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.265547292+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.265627678+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265671582+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.265676494+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:56:37.265682503+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.265684081+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265685584+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.265691860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.265693314+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265698103+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.266154258+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:37.266298877+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:37.266327280+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-07-02T19:56:37.266331296+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-07-02T19:56:37.266334824+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-07-02T19:56:37.266752425+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-07-02T19:56:37.266818480+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3266616135313633326434303738326539306165383230303964353863623765
Xres*: 3266616135313633326434303738326539306165383230303964353863623765
2025-07-02T19:56:37.266824418+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-07-02T19:56:37.267198470+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-07-02T19:56:37.268976670+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-07-02T19:56:37.269302265+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-07-02T19:56:37.269682230+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-07-02T19:56:37.269945930+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-07-02T19:56:37.270155353+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-07-02T19:56:37.270168375+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend Downlink Nas Transport
2025-07-02T19:56:37.270240161+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-07-02T19:56:37.270643567+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.270654475+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.270656593+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.270658642+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.270660114+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270662973+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.270671337+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.270673350+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.270675065+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.270694153+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270695949+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.270700030+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:56:37.270704961+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.270706487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270709039+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.270713909+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.270715320+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270716808+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.271344720+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:37.271399299+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:37.271424243+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-07-02T19:56:37.271427536+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-07-02T19:56:37.271430429+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-07-02T19:56:37.271496617+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-07-02T19:56:37.271551776+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-07-02T19:56:37.272070050+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.348398911+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T19:56:37.354485589+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-07-02T19:56:37.358765650+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T19:56:37.359388357+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-07-02T19:56:37.359676313+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:37.360273544+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.429925789+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-07-02T19:56:37.441927085+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-07-02T19:56:37.443742746+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-07-02T19:56:37.443813191+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-07-02T19:56:37.444017330+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-07-02T19:56:37.444234435+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-07-02T19:56:37.444795907+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:37.444952473+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:37.445188275+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-07-02T19:56:37.445752222+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-07-02T19:56:37.446273913+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:37.447078914+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-07-02T19:56:37.448307258+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-07-02T19:56:37.448534652+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-07-02T19:56:37.449284332+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-07-02T19:56:37.449422997+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-07-02T19:56:37.449587393+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-07-02T19:56:37.450182460+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.533204004+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-07-02T19:56:37.540752369+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-07-02T19:56:37.541178273+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.570601186+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-07-02T19:56:37.574011366+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-07-02T19:56:37.574607007+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:37.645529659+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-07-02T19:56:37.653393575+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-07-02T19:56:37.653463522+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-07-02T19:56:37.653482886+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-07-02T19:56:37.653710249+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-07-02T19:56:37.653840675+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-07-02T19:56:37.653860867+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend Initial Context Setup Request
2025-07-02T19:56:37.654037596+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-07-02T19:56:37.654628841+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.654808723+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.654814926+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.654817403+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.654819050+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654820874+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.654832778+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.654841539+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.654847512+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654849359+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:56:37.654869673+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654873914+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T19:56:37.654875799+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T19:56:37.654882898+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.654920497+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654924328+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.654931909+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.654933486+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654934942+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.655850869+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.655867437+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.655870492+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.655874577+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.655876229+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.655971316+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle InitialContextSetupResponse
2025-07-02T19:56:37.655981219+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T19:56:37.655984513+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend Downlink Nas Transport
2025-07-02T19:56:37.655878767+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.656041821+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.656047379+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.656049684+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.656052371+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.656055681+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.656057976+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.656060350+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.656061934+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
Security header type: Integrity Protected And Ciphered
cmac value: 0x4df7b78b
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000d08d40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000a7a5a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000b36460)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000bbec70)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000d08d60)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000d08d80)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000bbecab)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000bbecc3)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000bbecc9)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-07-02T19:56:37.658162339+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:37.658178411+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:37.658199336+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-07-02T19:56:37.658211736+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-07-02T19:56:37.658214721+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-07-02T19:56:37.658226449+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-07-02T19:56:37.658229624+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend Downlink Nas Transport
2025-07-02T19:56:37.658317171+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-07-02T19:56:38.161438970+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:38.161599665+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:38.161693075+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:56:38.161736244+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:56:38.161751971+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:56:38.161774703+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:56:38.164040543+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.209784170+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-07-02T19:56:38.216344884+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:56:38.216460182+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:56:38.216574279+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=03007252-23c0-4b5d-b5df-c3ac81344484&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:56:38.216839188+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:56:38.217267136+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.276815429+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:38.287616624+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:56:38.287882733+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:56:38.287947661+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:56:38.287950761+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:56:38.288158771+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.360614854+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:56:38.367283223+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:56:38.368622120+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:56:38.368671753+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:56:38.369768008+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:38.369972818+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:38.370194908+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:56:38+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000ae41c0 0xc000ae41e0 0xc000ae4200]
2025-07-02T19:56:38.370261278+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:56:38.370266582+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000ae41c0 0xc000ae41e0 0xc000ae4200]}
2025-07-02T19:56:38.370268533+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:56:38.370772019+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.373993445+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=03007252-23c0-4b5d-b5df-c3ac81344484&target-nf-type=AMF |  |
2025-07-02T19:56:38.374345016+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:56:38.374413234+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-07-02T19:56:38.374424823+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:56:38.374432183+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-07-02T19:56:38.374440717+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:56:38.374677165+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.462794914+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:56:38.469973183+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:56:38.470053778+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:56:38.470771998+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:56:38.472501781+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:38.477201406+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:56:38.477265859+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:56:38.477685837+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:56:38.478438539+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.480637753+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:56:38.481029060+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:56:38.481676544+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-07-02T19:56:38.482200104+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.507918142+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:56:38.510917425+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:56:38.513715783+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:56:38.513780336+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:56:38.513813957+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:56:38.513821577+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:56:38.513828117+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:56:38.513954739+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:56:38.514270999+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:56:38.514367127+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:56:38.514375198+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:38.514392525+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:56:38.514395599+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:38.514411831+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:56:38.514466029+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:56:38.514584560+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:56:38.514797385+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-07-02T19:56:38.524710913+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:56:38.525722718+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:56:38.525765706+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend PDU Session Resource Setup Request
2025-07-02T19:56:38.526469849+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:38.526528233+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:38.526535192+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-07-02T19:56:38.526571525+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:38.526573256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526580403+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:38.526606234+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:38.526600158+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:56:38.526675830+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.526688037+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.526690524+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.526694170+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.526696183+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.526698078+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-07-02T19:56:38.526748844+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526751059+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:38.526753640+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:38.526755771+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:38.526757620+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:38.526780260+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:38.526782858+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526784385+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:38.526793621+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:38.526795142+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526796657+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xa8293a97
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006b8720)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fa1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000ca4780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000ca2864)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000d12120)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cc0300)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000ca2890)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000ca28a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006b8740)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006b8760)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006b8780)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-07-02T19:56:38.528827016+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:56:38.528861126+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T19:56:38.529823932+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-07-02T19:56:38.532975573+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:56:38.533106025+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:defe3130-8c7e-4b55-a1fd-e8eafba3be31/modify |  |
2025-07-02T19:56:38.734520116+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:38.734752989+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:38.734877034+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:56:38.734893872+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:56:38.734908129+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:56:38.734930384+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:56:38.738933310+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:56:38.739316755+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:56:38.739354598+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=03007252-23c0-4b5d-b5df-c3ac81344484&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:56:38.739792798+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:56:38.740287157+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.800525154+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:38.811395605+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:56:38.811577340+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:56:38.811602957+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:56:38.811605467+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:56:38.812132343+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.884754241+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:56:38.892803722+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:56:38.893403159+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:56:38.893495799+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:56:38.894363421+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:38.896930111+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:38.897171335+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:56:38+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0005ce260 0xc0005ce280 0xc0005ce2a0]
2025-07-02T19:56:38.897255829+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:56:38.897265909+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0005ce260 0xc0005ce280 0xc0005ce2a0]}
2025-07-02T19:56:38.897272711+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:56:38.897738403+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.900566330+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=03007252-23c0-4b5d-b5df-c3ac81344484&target-nf-type=AMF |  |
2025-07-02T19:56:38.900762864+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:56:38.900863091+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-07-02T19:56:38.900868922+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:56:38.900871381+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-07-02T19:56:38.900875818+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:56:38.901120757+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:38.982979919+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:56:39.033508165+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:56:39.033593003+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:56:39.034842431+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:56:39.037224761+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:39.043543253+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:56:39.043693932+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:56:39.043782805+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:56:39.044086688+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.046159922+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:56:39.046244671+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:56:39.046631545+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-07-02T19:56:39.046895159+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.075324999+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:56:39.078173663+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:56:39.081737430+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:56:39.081774290+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:56:39.081786396+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:56:39.081793893+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:56:39.081800301+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:56:39.081816473+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:56:39.082049164+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:56:39.082521322+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:56:39.083404082+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:39.083440899+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:56:39.083445508+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:39.083483676+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:56:39.083559015+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:56:39.083666199+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:56:39.084579188+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-07-02T19:56:39.089935098+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:56:39.091226755+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:56:39.091289271+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend PDU Session Resource Setup Request
2025-07-02T19:56:39.091417317+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:56:39.092147152+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:39.092176854+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.092181086+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-07-02T19:56:39.092205018+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.092206699+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.092208485+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.092243194+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.092246741+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092252074+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092254914+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092257198+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092259163+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092262039+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T19:56:39.092293686+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.092295795+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:39.092299276+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.092301361+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.092303128+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:39.092310360+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.092312005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.092313461+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.092322555+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.092324133+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.092325615+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000000abcb79f
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xeb5dfac48e28321f529d2b898860752e022fbca1d4aff45ec21d864fcbe1813c
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xaa1820b94147b07b2904bba751cd971c4e5c7206
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000044f3e902
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xb91a2ed3b7c9982e3be8684384691b635e08c04cc31cbbd8305099abcd26b752
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xa7b6046a35f9578c7ab674dbe0e772439f25f2a2
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
2025-07-02T19:56:39.103912302+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:56:39.103971153+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T19:56:39.104367155+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
Security header type: Integrity Protected And Ciphered
cmac value: 0x4811b641
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006b9400)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fa4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000ca5130)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006ac21c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000d122d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cc0a00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0006ac280)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0006ac290)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006b9420)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006b9440)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006b9460)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T19:56:39.114375267+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:56:39.114423278+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:2a878d19-a014-4cb1-8dbd-94993bc48d7c/modify |  |
2025-07-02T19:56:39.308126255+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:39.308183352+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:39.308269082+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:56:39.308281043+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:56:39.308291212+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:56:39.308308228+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:56:39.310364054+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:56:39.310560359+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:56:39.310893117+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=03007252-23c0-4b5d-b5df-c3ac81344484&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:56:39.313003918+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:56:39.314042817+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.376894156+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:39.382141402+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:56:39.382296690+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:56:39.382320771+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:56:39.382323413+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:56:39.382795094+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.456102896+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:56:39.461259990+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:56:39.464266604+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:56:39.464281260+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:56:39.465617167+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:39.465797227+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:39.465903168+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:56:39+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001ac4300 0xc001ac4320 0xc001ac4340]
2025-07-02T19:56:39.465916627+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:56:39.465920004+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001ac4300 0xc001ac4320 0xc001ac4340]}
2025-07-02T19:56:39.465922007+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:56:39.466180142+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.468417812+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=03007252-23c0-4b5d-b5df-c3ac81344484&target-nf-type=AMF |  |
2025-07-02T19:56:39.468634634+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:56:39.468746418+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-07-02T19:56:39.468752418+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:56:39.468754995+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-07-02T19:56:39.468759141+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:56:39.468809559+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.555788397+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:56:39.564010619+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:56:39.564118828+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:56:39.564904841+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:56:39.566334938+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:39.568290716+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:56:39.570783036+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:56:39.571311207+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:56:39.571614369+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.573315306+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:56:39.573433388+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:56:39.573567129+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-07-02T19:56:39.573675979+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.603636830+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:56:39.605484305+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:56:39.606112371+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:56:39.606148870+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:56:39.606168162+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:56:39.606175433+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:56:39.606181484+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:56:39.606196922+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:56:39.606457020+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:56:39.606522089+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:56:39.606564115+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:39.606600476+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:56:39.606604126+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:39.606625009+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:56:39.606689908+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:56:39.606899627+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:56:39.606964637+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-07-02T19:56:39.611622367+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:56:39.612307051+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:56:39.612326907+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend PDU Session Resource Setup Request
2025-07-02T19:56:39.612479469+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:56:39.613205914+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:39.613305455+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.613347387+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-07-02T19:56:39.613378812+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.613380966+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613382649+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.613409845+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.613443617+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613450977+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613453306+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613455679+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613457604+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613459507+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T19:56:39.613488955+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613490967+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:39.613494656+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.613497626+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.613499309+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:39.613509044+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.613510644+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613512028+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.613522365+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.613523858+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613525234+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000050e9f773
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x57efe46505b84b1110e434ac2f032132b34d3182a38fb6d71b2923437b778e5e
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xc48fc165540fe6c48c5a558940e2563c33b2f4fd
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000007068d72
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xe6032c63c339acc6b712650fc8bf3c3c497c0d47e8c3b4cb17c97154d69f012a
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x813be95491a00e8c7baa66fc887c5fe112132a96
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-07-02T19:56:39.617039994+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:56:39.617057306+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T19:56:39.617720758+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xa584da30
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000bdc4c0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fa780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000ca5ae0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000014e3c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000d12480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cc1100)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000014e60)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000014e70)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000bdc4e0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000bdc500)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000bdc520)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-07-02T19:56:39.628486941+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:56:39.628658057+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:e5dbbdb0-fd7d-4816-9789-2a7828328651/modify |  |
2025-07-02T19:56:39.821508615+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport
2025-07-02T19:56:39.821548953+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-07-02T19:56:39.821617426+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-07-02T19:56:39.821626225+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-07-02T19:56:39.821634091+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-07-02T19:56:39.821649448+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-07-02T19:56:39.824450540+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-07-02T19:56:39.824550504+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-07-02T19:56:39.824581646+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=03007252-23c0-4b5d-b5df-c3ac81344484&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-07-02T19:56:39.825060749+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-07-02T19:56:39.827444975+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.894498968+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-07-02T19:56:39.900830658+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-07-02T19:56:39.900978023+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-07-02T19:56:39.901001931+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-07-02T19:56:39.901004609+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-07-02T19:56:39.901603461+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:39.983121219+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-07-02T19:56:39.993216463+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-07-02T19:56:39.995201844+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-07-02T19:56:39.995384890+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-07-02T19:56:39.996616348+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:39.996816360+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:39.996935011+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-07-02T19:56:39+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0005fe2a0 0xc0005fe2c0 0xc0005fe2e0]
2025-07-02T19:56:39.996987578+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-07-02T19:56:39.996991794+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0005fe2a0 0xc0005fe2c0 0xc0005fe2e0]}
2025-07-02T19:56:39.996993863+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-07-02T19:56:39.997891651+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:40.000988722+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=03007252-23c0-4b5d-b5df-c3ac81344484&target-nf-type=AMF |  |
2025-07-02T19:56:40.001169730+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-07-02T19:56:40.001247895+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-07-02T19:56:40.001284888+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-07-02T19:56:40.001290187+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-07-02T19:56:40.001294526+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:56:40.001482227+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:40.088418556+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-07-02T19:56:40.096084557+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:56:40.096138338+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:56:40.096886288+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-07-02T19:56:40.098300546+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-07-02T19:56:40.102213503+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-07-02T19:56:40.102335885+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-07-02T19:56:40.102920487+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-07-02T19:56:40.103729048+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:40.105638022+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-07-02T19:56:40.105945340+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-07-02T19:56:40.106198340+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-07-02T19:56:40.106969888+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-07-02T19:56:40.135251555+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-07-02T19:56:40.137042094+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-07-02T19:56:40.137788888+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-07-02T19:56:40.137852954+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-07-02T19:56:40.137860014+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-07-02T19:56:40.137862305+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-07-02T19:56:40.137864064+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-07-02T19:56:40.137876566+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-07-02T19:56:40.138141111+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-07-02T19:56:40.138252281+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-07-02T19:56:40.138260845+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:40.138285820+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-07-02T19:56:40.138327947+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-07-02T19:56:40.138352378+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-07-02T19:56:40.138422559+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-07-02T19:56:40.138514165+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-07-02T19:56:40.138862401+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-07-02T19:56:40.141232241+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-07-02T19:56:40.142080045+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-07-02T19:56:40.142143762+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mSend PDU Session Resource Setup Request
2025-07-02T19:56:40.142225804+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-07-02T19:56:40.143050484+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:40.143120400+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:40.143126823+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-07-02T19:56:40.143154175+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:40.143156355+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.143158270+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:40.143181982+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:40.143184089+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143191578+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143245455+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143250578+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143252786+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143264124+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-07-02T19:56:40.143296050+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.143297989+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:40.143300500+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:40.143309738+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:40.143312772+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:40.143320362+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:40.143322589+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.143324039+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:40.143333114+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:40.143334668+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.143336144+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000a3368963
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xab3118ba00e7c0aa1f07015d30819eeb9f9b76df6d897fa53680c55e58b7cc88
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xf054b622796073ca8ec289f7180110036fd40430
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000d2ed0517
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x45c2aefb9aba375536c46fee5f33499f8042ce0cac8b934f61e3a88dc81f068d
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x85ebf4ccc3736596573ce342b619524d5d8dfc62
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-07-02T19:56:40.147065127+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse
2025-07-02T19:56:40.147091598+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:36768] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-07-02T19:56:40.147883276+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xe445c449
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000bdd1c0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000faa50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b5a4b0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00024e4dc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000d12630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cc1800)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00024e510)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00024e520)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000bdd1e0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000bdd200)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000bdd220)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-07-02T19:56:40.158613257+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-07-02T19:56:40.158836900+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:e22b0161-3d05-4166-81e3-d7ba1879d75e/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=728.127µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.154716ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=3.225095ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=1.707482ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=1.708421ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 728.127µs/1.704767ms/3.225095ms/844.725µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (11.51s)
PASS
ok  	test	11.560s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (27.25s)
PASS
ok  	test	30.119s

--- STDERR ---
2025-07-02T19:56:18.510992371+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T19:56:18.511419223+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-07-02T19:56:18.512060989+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T19:56:18.512105125+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc00052a0a0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000480ba0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0004810b0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0004a21e0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-07-02T19:56:18.512110387+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-07-02T19:56:18.512113092+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-07-02T19:56:18.512115402+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:18.512175776+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-07-02T19:56:18.512214622+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-07-02T19:56:18.517663756+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-07-02T19:56:18.517755803+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-07-02T19:56:18.518023113+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-07-02T19:56:18.518101772+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-07-02T19:56:18.518120339+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-07-02T19:56:18.518130001+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-07-02T19:56:23.376483842+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-07-02T19:56:23.376522390+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-07-02T19:56:30.669786308+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-07-02T19:56:30.670184869+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-07-02T19:56:30.670609621+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-07-02T19:56:30.671532166+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-07-02T19:56:30.671569366+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-07-02T19:56:30.671818907+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-07-02T19:56:30.671859536+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-07-02T19:56:30.682678936+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-07-02T19:56:30.682735211+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-07-02T19:56:30.685110912+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-07-02T19:56:30.686136103+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-07-02T19:56:30.686243348+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-07-02T19:56:30.686388642+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-07-02T19:56:30.688581079+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-07-02T19:56:30.688597399+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-07-02T19:56:30.691635805+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-07-02T19:56:37.094824711+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.094852387+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.094856353+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.094863563+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.094866218+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.094869400+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-07-02T19:56:37.102979468+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.104536389+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.104543327+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:37.104567084+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:56:37.104572092+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:37.104574212+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:37.104577446+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:37.104590618+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.104592564+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:56:37.104610987+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.104612745+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.104614227+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:37.104616928+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-07-02T19:56:37.104618677+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:37.104620184+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:37.104621710+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:37.108971504+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.109002685+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.109007165+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.109009666+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:56:37.109013119+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.109015010+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.109016703+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.109034750+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.109039333+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.109042540+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.109045477+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.109047624+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.109049919+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-07-02T19:56:37.109051390+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.109053009+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:56:37.109055937+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-07-02T19:56:37.109058345+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T19:56:37.109059842+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-07-02T19:56:37.110199678+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110239003+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-07-02T19:56:37.110244179+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-07-02T19:56:37.110246283+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T19:56:37.110249410+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.110254469+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:56:37.110262925+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.110264749+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110266246+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.110288665+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.110290277+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.110291798+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.111062696+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.111107876+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.111113035+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.111115927+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:56:37.111118655+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.111120225+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.111121717+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.111137866+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.111140025+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.111141752+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.111144046+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T19:56:37.111186837+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.111283286+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:37.111290564+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-07-02T19:56:37.111295988+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.111298526+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-07-02T19:56:37.265039056+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:56:37.265107847+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:37.265123751+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T19:56:37.265167286+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265170267+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.265173804+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:56:37.265187502+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.265254122+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265258670+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.265269499+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.265271199+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265272806+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.265887711+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.265897964+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.265901144+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.265903626+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:56:37.265906903+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.265908473+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.265909977+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.265918825+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.265920641+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.265931133+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.265933673+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T19:56:37.265938222+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.265941361+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:37.270424905+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:56:37.270435269+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:37.270437815+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-07-02T19:56:37.270441074+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270442705+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.270444308+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-07-02T19:56:37.270449474+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.270451041+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270452590+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.270458089+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.270459608+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270460996+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.270855256+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.270906571+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.270912380+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.270914941+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:56:37.270917612+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.270919356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.270920875+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.270936006+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.270938051+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.270939803+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.270948955+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-07-02T19:56:37.271155423+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.271163244+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:37.654395600+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-07-02T19:56:37.654490005+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:37.654496991+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-07-02T19:56:37.654500846+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654502762+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-07-02T19:56:37.654511381+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.654513148+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654514884+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.654522234+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.654523717+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.654525120+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.655182637+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:37.655345067+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.655350509+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.655353021+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-07-02T19:56:37.655355672+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.655357245+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.655359954+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.655367826+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:37.655430524+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.655436172+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:37.655463972+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 1623091896, Outbound SPI: 1359556424
2025-07-02T19:56:37.655479974+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.655482244+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-07-02T19:56:37.655484042+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-07-02T19:56:37.655486213+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:37.655488989+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:37.655490911+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:37.655492737+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:37.655494283+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:37.655500311+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.655501988+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.655503561+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.655676418+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:37.655729855+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:37.655734989+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:37.655800768+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.655807166+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.655810671+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:37.655812728+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:56:37.655823177+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.655825470+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-07-02T19:56:37.656162918+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:56:37.657031897+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:37.657958093+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:37.658568923+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-07-02T19:56:38.160019928+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:38.515187188+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:56:38.515276962+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-07-02T19:56:38.521294489+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-07-02T19:56:38.521720515+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-07-02T19:56:38.522812773+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-07-02T19:56:38.526042645+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:56:38.526158283+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:38.526166983+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:56:38.526183180+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526185499+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:38.526188219+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:38.526190372+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:38.526192361+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:38.526194279+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:38.526196807+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:38.526203683+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:38.526205530+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526207493+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:38.526229198+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:38.526232051+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.526233524+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:38.527640508+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:38.527696274+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:38.527701884+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.527704752+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:56:38.527707089+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 1867780097787842797
2025-07-02T19:56:38.527710135+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:38.527711878+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:38.527823579+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:38.527846750+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:38.527849157+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.527852179+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.527854361+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.527856528+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:38.527907846+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:38.527915213+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:38.527918979+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:56:38.528060891+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:38.528203765+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:38.528231856+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:56:38.529348323+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:38.530224905+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:56:39.084036041+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:56:39.084093311+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-07-02T19:56:39.087946718+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-07-02T19:56:39.088156559+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-07-02T19:56:39.091641849+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:56:39.091719794+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:39.091726910+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:56:39.091742578+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.091744819+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:39.091749583+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:39.091758945+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.091761097+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.091763130+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:39.091764949+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:39.091773094+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.091780476+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.091783425+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.091796672+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.091848693+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.091853608+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.092553468+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:39.092575412+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.092579272+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092582533+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:56:39.092584912+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 1867780097787842797
2025-07-02T19:56:39.092587840+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.092589453+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.092590963+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.092616888+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.092619340+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092622186+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092624330+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092626427+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.092669973+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:39.092677834+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:39.092680104+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:56:39.103292722+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-07-02T19:56:39.103524990+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:39.103643330+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:39.103674423+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:56:39.104918359+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:56:39.106517597+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:39.607590256+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:56:39.607758417+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-07-02T19:56:39.609270920+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-07-02T19:56:39.609411922+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-07-02T19:56:39.612787750+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:56:39.612981129+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:39.613018179+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:56:39.613042156+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613044667+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:39.613047340+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:39.613049308+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.613051164+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:39.613053196+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:39.613054802+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:39.613064122+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.613070078+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613073042+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.613087922+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.613135186+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613140595+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.613919416+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:39.613930927+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.613933136+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613935522+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:56:39.613944323+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 1867780097787842797
2025-07-02T19:56:39.613946764+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:39.613948334+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:39.613953097+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:39.613973746+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:39.613975836+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613979209+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613981367+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613983489+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:39.613988034+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:39.614010344+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:39.614012559+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:56:39.615704697+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-07-02T19:56:39.615858679+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:39.615997552+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:39.616016803+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:56:39.618412804+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:56:39.619406022+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-07-02T19:56:40.138874448+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-07-02T19:56:40.139179010+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-07-02T19:56:40.140542614+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-07-02T19:56:40.140776623+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-07-02T19:56:40.142484701+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-07-02T19:56:40.142671118+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:40.142679357+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-07-02T19:56:40.142710852+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.142713478+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-07-02T19:56:40.142717923+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-07-02T19:56:40.142720063+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:40.142723172+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-07-02T19:56:40.142725512+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:40.142727180+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-07-02T19:56:40.142743294+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:40.142745013+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.142746532+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:40.142759431+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:40.142760973+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.142762380+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:40.143517429+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-07-02T19:56:40.143531849+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:40.143534422+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143537382+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-07-02T19:56:40.143539510+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 1867780097787842797
2025-07-02T19:56:40.143548071+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-07-02T19:56:40.143549880+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-07-02T19:56:40.143551539+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-07-02T19:56:40.143592284+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-07-02T19:56:40.143595986+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143598710+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143600833+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143602970+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-07-02T19:56:40.143609687+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:40.143612873+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-07-02T19:56:40.143615308+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-07-02T19:56:40.146775228+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-07-02T19:56:40.146878943+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:40.146926293+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-07-02T19:56:40.146944837+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-07-02T19:56:40.152760652+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-07-02T19:56:51.640042836+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-07-02T19:56:51.640178942+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-07-02T19:56:51.640247928+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-07-02T19:56:51.640255897+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-07-02T19:56:51.640271140+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-07-02T19:56:51.678135859+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-07-02T19:56:51.678375661+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-07-02T19:56:51.678396837+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-07-02T19:56:51.678414656+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-07-02T19:56:51.678417525+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-07-02T19:56:51.678419429+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-07-02T19:56:51.995179795+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-07-02T19:56:51.995366696+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-07-02T19:56:51.995636197+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-07-02T19:56:51.995709221+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-07-02T19:56:51.995719522+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-07-02T19:56:51.995848098+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.171:37659: use of closed network connection
2025-07-02T19:56:51.995861100+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-07-02T19:56:51.995876156+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-07-02T19:56:51.995798629+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-07-02T19:56:51.995881117+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-07-02T19:56:51.995873997+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.171:37659: use of closed network connection
2025-07-02T19:56:51.995895175+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-07-02T19:56:51.995858325+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-07-02T19:56:51.995898884+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-07-02T19:56:51.995901517+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-07-02T19:56:51.995904787+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-07-02T19:56:51.995907639+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T19:56:51.996186967+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-07-02T19:56:51.996233255+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-07-02T19:56:51.996241262+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-07-02T19:56:51.996287610+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-07-02T19:56:51.996352097+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-07-02T19:56:51.996364434+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-07-02T19:56:51.996372866+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-07-02T19:56:51.996375038+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (92782): No such process
