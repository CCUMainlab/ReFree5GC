Run TestCN
os.Args: [/tmp/go-build2301730243/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-16T12:17:13.425937003+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.426055904+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.426067989+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.426078705+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-16T12:17:13.426097533+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-06-16T12:17:13.427029946+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.427038362+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.427044321+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.427126650+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-16T12:17:13.432773924+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.432843696+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.432856156+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.432864315+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-16T12:17:13.432889530+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-16T12:17:13.434296066+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:17:13.434583949+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.434642379+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.434649413+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.437175805+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.437236843+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.437314841+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.437328486+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-06-16T12:17:13.437789534+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-16T12:17:13.439185731+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.439250626+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.439257561+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.439261666+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-16T12:17:13.439283714+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-16T12:17:13.439370264+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.439377591+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.439380351+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.439947474+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.440005760+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.440012958+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.440031834+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 6122bd79-2002-429a-9590-84d5f7d8dc9f ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{6122bd79-2002-429a-9590-84d5f7d8dc9f nausf-auth 0xc000558a50 http REGISTERED   0xc000558a38  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000d31a40 false false}
2025-06-16T12:17:13.440145592+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-16T12:17:13.440476501+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:13.440536716+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-16T12:17:13.440543649+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:13.440546494+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-16T12:17:13.440565554+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-16T12:17:13.440636805+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-16T12:17:13.440711602+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-16T12:17:13.641947145+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-06-16T12:17:13.642376881+08:00[36m [INFO][AMF][Init] [0mServer started
2025-06-16T12:17:13.642627273+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-16T12:17:13.644704610+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:13.649832614+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:13.651985268+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 101537ed-9442-4842-b8d7-bf705b2742ba
2025-06-16T12:17:13.655094126+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/101537ed-9442-4842-b8d7-bf705b2742ba |  |
2025-06-16T12:17:13.655585884+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:13.655656448+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-16T12:17:13.843350102+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-16T12:17:13.845653042+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:13.852031274+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:13.853584550+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: dc62c26f-5f03-4f1e-9e8b-2e26e779a9b8
2025-06-16T12:17:13.856111587+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/dc62c26f-5f03-4f1e-9e8b-2e26e779a9b8 |  |
2025-06-16T12:17:13.856355374+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:13.856394317+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {dc62c26f-5f03-4f1e-9e8b-2e26e779a9b8 SMF REGISTERED 0 0xc0006475f0 0xc000647608 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc0004f5e80 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc000647548 false false []}
2025-06-16T12:17:13.856448459+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-16T12:17:13.856458806+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-16 12:17:13.856452039 +0800 CST m=+0.484319299]
2025-06-16T12:17:13.856473529+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-16T12:17:14.045124980+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:14.048385752+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:14.049851890+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: dcd4e537-a2cb-4b4c-83c1-aa6570b3d11b
2025-06-16T12:17:14.052202145+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/dcd4e537-a2cb-4b4c-83c1-aa6570b3d11b |  |
2025-06-16T12:17:14.052473335+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:14.052506718+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-16T12:17:14.052516412+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-16T12:17:14.052524965+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:17:14.052546920+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-16T12:17:14.245257623+08:00[36m [INFO][PCF][Init] [0mServer started
2025-06-16T12:17:14.246947152+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:14.251187511+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:14.253023322+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 72b592c8-59e5-4713-9f96-e21c5deb3a36
2025-06-16T12:17:14.254965685+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/72b592c8-59e5-4713-9f96-e21c5deb3a36 |  |
2025-06-16T12:17:14.255253761+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:14.255456723+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-16T12:17:14.446580278+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-16T12:17:14.446662762+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-16T12:17:14.447395897+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:14.452754414+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:14.454364122+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: c06dd9a5-14b2-4858-a102-3e913c970b06
2025-06-16T12:17:14.456727201+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/c06dd9a5-14b2-4858-a102-3e913c970b06 |  |
2025-06-16T12:17:14.457470860+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:14.457571830+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-16T12:17:14.647793285+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:14.651775312+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:14.653423877+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 4d7d3f09-4d7c-44db-94a5-161d632ceb59
2025-06-16T12:17:14.655346630+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/4d7d3f09-4d7c-44db-94a5-161d632ceb59 |  |
2025-06-16T12:17:14.655529163+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:14.655587842+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-16T12:17:14.655600865+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-16T12:17:14.847815145+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-06-16T12:17:14.850476347+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:14.857678433+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-16T12:17:14.859092030+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-16T12:17:14.860342933+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:14.861250206+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6122bd79-2002-429a-9590-84d5f7d8dc9f
2025-06-16T12:17:14.862590978+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6122bd79-2002-429a-9590-84d5f7d8dc9f |  |
2025-06-16T12:17:14.863018707+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:14.863034634+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-16T12:17:15.049768810+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-16T12:17:15.050605278+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-16T12:17:15.052588730+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:15.057240793+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:15.058603353+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 0d128ba1-02ca-40eb-8c05-ab6f37f4776f
2025-06-16T12:17:15.059362839+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/0d128ba1-02ca-40eb-8c05-ab6f37f4776f |  |
2025-06-16T12:17:15.059601769+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:15.059713136+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-16T12:17:21.318753635+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634
2025-06-16T12:17:21.322939422+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634
2025-06-16T12:17:21.323246613+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle NGSetupRequest
2025-06-16T12:17:21.323258323+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mMissing IE PagingDRX
2025-06-16T12:17:21.323285614+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3730278385/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-16T12:17:28.712819004+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.713036664+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.713053368+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:28.713068297+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:17:28.713079538+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:28.718606153+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.718724068+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.718754766+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:28.718770972+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:17:28.718782673+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:28.725875693+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.725971801+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.725983128+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.726512647+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.726524487+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.726528146+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.726530637+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-16T12:17:28.739129811+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.739242278+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:17:28.739254604+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:28.739262081+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:28.739266843+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:28.739308314+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.739315799+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.739319827+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.739337983+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.739345902+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.739351213+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.745239057+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.745392046+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.745427094+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.745451201+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.745469464+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.745496425+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.745679848+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.745719520+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.745739535+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.745756986+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.745772895+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.745787178+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-16T12:17:28.745940462+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.745962342+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:28.745982357+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:17:28.746016100+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.746064774+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.746291002+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.746335565+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.746355626+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.746371178+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.747696234+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle InitialUEMessage
2025-06-16T12:17:28.747834734+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-16T12:17:28.747900181+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-16T12:17:28.747978619+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-16T12:17:28.748099837+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-16T12:17:28.748120609+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-16T12:17:28.748130592+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-16T12:17:28.748140057+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-16T12:17:28.748149803+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-16T12:17:28.748154315+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-16T12:17:28.749324387+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.755946339+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-16T12:17:28.757818981+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-16T12:17:28.757837317+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-06-16T12:17:28.758913158+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.791916007+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-16T12:17:28.796332704+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-16T12:17:28.797011927+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-16T12:17:28.797166062+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-16T12:17:28.797204534+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-16T12:17:28.799163759+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.808686304+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-16T12:17:28.811776201+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:17:28.819639185+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:17:28.820027314+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-16T12:17:28.820804331+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-16T12:17:28.821631358+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-06-16T12:17:28.821654292+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 6261643963613137306539656365626335616139323064626563633061393935
2025-06-16T12:17:28.822064444+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-16T12:17:28.823053430+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-16T12:17:28.823451670+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend Downlink Nas Transport
2025-06-16T12:17:28.823997647+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-06-16T12:17:28.825350602+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.825393612+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.825400342+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.825405474+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.825412607+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.825628175+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.825663918+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.825670443+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.825675202+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.826649339+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.826662781+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:28.826667479+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:17:28.826681562+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.826685822+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.826689529+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.826706005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.826714053+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.826718087+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.828258125+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:28.828612761+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:28.829027478+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-16T12:17:28.829417939+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-16T12:17:28.829473749+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-06-16T12:17:28.831609943+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-16T12:17:28.831977001+08:00[36m [INFO][AUSF][5gAka] [0mres*: 6261643963613137306539656365626335616139323064626563633061393935
Xres*: 6261643963613137306539656365626335616139323064626563633061393935
2025-06-16T12:17:28.832004492+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-06-16T12:17:28.835691652+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-16T12:17:28.841294534+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-16T12:17:28.841505117+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-16T12:17:28.841644493+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-16T12:17:28.843459252+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-16T12:17:28.843964916+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-16T12:17:28.844373558+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend Downlink Nas Transport
2025-06-16T12:17:28.845353756+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-06-16T12:17:28.846013705+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.846110597+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.846122375+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.846128942+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.846133627+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.846137555+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.846484567+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.846501299+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.846507074+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.846563744+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.846666904+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:28.846678226+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:17:28.846698691+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.846703394+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.846707433+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.846723646+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.846727790+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.846731327+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.847964764+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:28.848417384+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:28.848862951+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-16T12:17:28.848937121+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-16T12:17:28.848952166+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-06-16T12:17:28.849359656+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-16T12:17:28.849956677+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-16T12:17:28.852538924+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.870430623+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:17:28.872703987+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-16T12:17:28.873935362+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:17:28.875836298+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-16T12:17:28.876870891+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:28.879201105+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.916791968+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:17:28.920058187+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-16T12:17:28.922699170+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-16T12:17:28.922921122+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-16T12:17:28.923642206+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-16T12:17:28.924249512+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:17:28.925334479+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:28.926896910+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:28.927447682+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-16T12:17:28.929780112+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-16T12:17:28.930882677+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:28.932010874+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-16T12:17:28.933426024+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-16T12:17:28.933747550+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-16T12:17:28.934064868+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-16T12:17:28.934261144+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-16T12:17:28.934434295+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-16T12:17:28.935147349+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.954606086+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-16T12:17:28.958992613+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-06-16T12:17:28.960709523+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:28.978142603+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-16T12:17:28.986931264+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-16T12:17:28.990119480+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.008552892+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-16T12:17:29.028092144+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-16T12:17:29.028220939+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-06-16T12:17:29.028255640+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-16T12:17:29.028642635+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-16T12:17:29.030436633+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-16T12:17:29.031366951+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend Initial Context Setup Request
2025-06-16T12:17:29.033141967+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-06-16T12:17:29.035434242+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.035475626+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.035482717+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.035489008+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.035493448+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.035511814+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.035933742+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.035954216+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.036354173+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.036361756+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:17:29.037122275+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.037143372+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:17:29.037149042+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:17:29.037636577+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.037655738+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.037661156+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.037677012+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.037681357+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.037685152+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.040272130+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.040723792+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.040730198+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040737576+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.040740611+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.040743762+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.040769144+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.040771933+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040775136+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040779894+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040784544+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040787724+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040791324+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.040794182+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-16T12:17:29.048941020+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle InitialContextSetupResponse
2025-06-16T12:17:29.049003240+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:17:29.049410187+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x9068a2c0
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000bef6e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fcff0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000ae8540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000b7ef20)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000bef700)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000bef720)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000b7ef5b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000b7ef73)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000b7ef79)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-16T12:17:29.055256168+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:29.055381324+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:29.055595937+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-16T12:17:29.055727094+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-16T12:17:29.055744952+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-06-16T12:17:29.055787828+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-16T12:17:29.055997270+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend Downlink Nas Transport
2025-06-16T12:17:29.056479864+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-16T12:17:29.555509945+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:29.555777527+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:29.555866930+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:17:29.555875714+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:17:29.555883514+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:17:29.555899647+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:17:29.561013573+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.571876932+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-16T12:17:29.575660153+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:17:29.575845089+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:17:29.576053233+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=101537ed-9442-4842-b8d7-bf705b2742ba&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:17:29.576851792+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:17:29.578607145+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.599951301+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:29.604089896+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:17:29.604323071+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:17:29.604373757+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:17:29.604379035+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:17:29.605209215+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.621785736+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:17:29.624022711+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:17:29.625391580+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:17:29.625466134+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:17:29.627198521+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:29.627544369+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:29.628208431+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:17:29+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc00097c060 0xc00097c080 0xc00097c0a0]
2025-06-16T12:17:29.628304146+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:17:29.628356115+08:00[36m [INFO][SMF][GSM] [0m&{[0xc00097c060 0xc00097c080 0xc00097c0a0]}
2025-06-16T12:17:29.628388776+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:17:29.629575972+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.631356588+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=101537ed-9442-4842-b8d7-bf705b2742ba&target-nf-type=AMF |  |
2025-06-16T12:17:29.631794557+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:17:29.631899765+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-16T12:17:29.631917333+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:17:29.631928824+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-16T12:17:29.631942506+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:17:29.632422766+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.651314541+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:17:29.653532093+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:17:29.653552477+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:17:29.662040056+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:17:29.663955120+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:29.673060136+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:17:29.674212277+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:17:29.675058665+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:17:29.677390082+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.678697993+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:17:29.679761675+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:17:29.681262300+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:17:29.682012923+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.690951636+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:17:29.692115656+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:17:29.694476110+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:17:29.694586713+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:17:29.694609427+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:17:29.694615523+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:17:29.694619335+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:17:29.694852209+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:17:29.695331072+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:17:29.695448737+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-16T12:17:29.695525712+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:17:29.695561621+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:29.695687000+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:17:29.695731028+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:29.695812323+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:17:29.696091191+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:17:29.696203942+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:17:29.697801565+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-16T12:17:29.711159311+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:17:29.714074776+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:17:29.714484516+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend PDU Session Resource Setup Request
2025-06-16T12:17:29.714926227+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:17:29.716160453+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.716316611+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.716329817+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-16T12:17:29.716532288+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.716539766+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.716545398+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.716605131+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.716671080+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.716680833+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.716684290+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.716687725+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.716690625+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.716693534+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 2 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-16T12:17:29.717486155+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.717583820+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:29.717597670+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.717605213+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.717609555+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:29.717630858+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.717635374+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.717639221+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.717662718+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.717763987+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.717778302+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xeb279183
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000befbe0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fd4a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c5f630)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00069cf74)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000c34750)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c30880)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00069cfa0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00069cfb0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000befc00)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000befc20)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000befc40)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:17:29.758864228+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:17:29.759173748+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:17:29.761491919+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:17:29.768221537+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:17:29.768496997+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:2d3fcb44-8ab4-4014-809a-c681e308df07/modify |  |
2025-06-16T12:17:29.769732762+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:29.769840635+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:29.769913919+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:17:29.769924202+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:17:29.769931894+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:17:29.769944894+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:17:29.772438377+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:17:29.773098142+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:17:29.773269623+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=101537ed-9442-4842-b8d7-bf705b2742ba&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:17:29.774826843+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:17:29.777300340+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.797902205+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:29.802622859+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:17:29.802953871+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:17:29.803006820+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:17:29.803013106+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:17:29.804001769+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.832477704+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:17:29.834017369+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:17:29.837406223+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:17:29.837541255+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:17:29.840947355+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:29.841555367+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:29.842033222+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:17:29+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000b94680 0xc000b946a0 0xc000b946c0]
2025-06-16T12:17:29.842131592+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:17:29.842156330+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000b94680 0xc000b946a0 0xc000b946c0]}
2025-06-16T12:17:29.842162468+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:17:29.844023750+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.846045231+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=101537ed-9442-4842-b8d7-bf705b2742ba&target-nf-type=AMF |  |
2025-06-16T12:17:29.847201049+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:17:29.848272893+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-16T12:17:29.848622057+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:17:29.849070455+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-16T12:17:29.849369336+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:17:29.850966759+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.903856524+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:17:29.909464994+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:17:29.909652514+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:17:29.911508067+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:17:29.916804130+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:29.925124379+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:17:29.925401941+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:17:29.925652588+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:17:29.926361868+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.927494953+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:17:29.927983253+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:17:29.928695279+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:17:29.931082764+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:29.939778275+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:17:29.941012639+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:17:29.942744908+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:17:29.942844949+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:17:29.942878013+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:17:29.942897023+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:17:29.942913349+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:17:29.942958349+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:17:29.943551131+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:17:29.943755729+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:17:29.943830811+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:29.943880676+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:17:29.943886417+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:29.943914361+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:17:29.944013790+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:17:29.944081476+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:17:29.944369749+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-16T12:17:29.961722349+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:17:29.963441126+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:17:29.963488213+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend PDU Session Resource Setup Request
2025-06-16T12:17:29.963725398+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:17:29.965400517+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.965445344+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.965453155+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-16T12:17:29.965550138+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.965555966+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.965558558+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.965593257+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.965596920+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.965603376+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.965611418+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.965615434+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.965618569+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.965621310+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:17:29.965666509+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.965669640+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:29.965673359+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.965676184+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.965679019+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:29.965690424+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.965692736+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.965694935+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.965708341+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.965711648+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.965713743+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000001020635c
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x5e9e5f02c2007d529117100374727a5d1ceabef64c9a055e99411f319a1964c6
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x6ea2a9e3f305dbd9a0773af1d04a7e837580dca5
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000042f9a64
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xaa8ff2d38406e30861799a6e491003931696ed1abaa6245e9aff5cacf13c4b1e
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x816413f993c21e61c5e5c97a93b2acb2879e4fb0
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xfe53d7b6
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0004eca60)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fd770)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0006a4000)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000014f9c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000c34900)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c30f80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000014fc0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000014fd0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0004eca80)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0004ecaa0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0004ecac0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:17:29.991438654+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:17:29.991560155+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:17:29.993665634+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:17:30.005582931+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:17:30.005749661+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:93c95bde-2d00-44eb-9b6d-529dbcc6141a/modify |  |
2025-06-16T12:17:30.183604276+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:30.183956037+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:30.184024829+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:17:30.184359574+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:17:30.184905142+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:17:30.185284633+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:17:30.186810482+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:17:30.187248540+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:17:30.187287435+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=101537ed-9442-4842-b8d7-bf705b2742ba&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:17:30.187711630+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:17:30.188578736+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.205107964+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:30.208139716+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:17:30.208537984+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:17:30.208657464+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:17:30.208684239+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:17:30.209377449+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.239020190+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:17:30.241128976+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:17:30.242115560+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:17:30.242518431+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:17:30.244322443+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:30.244646602+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:30.245194311+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:17:30+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc00084c0c0 0xc00084c0e0 0xc00084c100]
2025-06-16T12:17:30.245265867+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:17:30.245278943+08:00[36m [INFO][SMF][GSM] [0m&{[0xc00084c0c0 0xc00084c0e0 0xc00084c100]}
2025-06-16T12:17:30.245289116+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:17:30.246436744+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.248648133+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=101537ed-9442-4842-b8d7-bf705b2742ba&target-nf-type=AMF |  |
2025-06-16T12:17:30.249076315+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:17:30.249264775+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-16T12:17:30.249277298+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:17:30.249284448+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-16T12:17:30.249295282+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:17:30.249438691+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.270670488+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:17:30.273185504+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:17:30.273316473+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:17:30.274695549+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:17:30.277051689+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:30.283506764+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:17:30.283876219+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:17:30.284428910+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:17:30.285775150+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.287644367+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:17:30.287947600+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:17:30.288215852+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:17:30.288382224+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.300748297+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:17:30.301742939+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:17:30.303307812+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:17:30.303414303+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:17:30.303445647+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:17:30.303467323+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:17:30.303491346+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:17:30.303539981+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:17:30.304916619+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:17:30.305387740+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:17:30.305477801+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:30.305553458+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:17:30.305564705+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:30.305626415+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:17:30.305837758+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:17:30.306136310+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:17:30.306489615+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-16T12:17:30.320352273+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:17:30.323220026+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:17:30.323458268+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend PDU Session Resource Setup Request
2025-06-16T12:17:30.324204495+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:17:30.326088665+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:30.326293443+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.326308316+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-16T12:17:30.328695360+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.328810429+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.328821528+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.328878871+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.328885094+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.328893498+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.328901007+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.328906713+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.328913372+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.328918096+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:17:30.329017976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.329024169+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:30.329029934+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.329238779+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.329339643+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:30.329358490+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.329363187+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.329367021+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.329392510+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.329396564+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.329400062+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000043f76d1e
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x7d80c66e098193942676196f1f6c5ce6a95b65f77060ae4abc8a27c88c439ac2
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xc5f6d11bbc797479b072e1c39501a871003f8a81
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000000442bde3
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x033e8608af2ea1c2d7e6d916e40ede4b81b970a846e80809ad6a1b8e752b0873
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x2d0542e4697cd4dcf7528abf948f501c0b30cc98
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x6187d1c7
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006b61a0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c76000)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00013a820)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00051617c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000000090)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc0006b0100)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0005161a0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0005161b0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006b61c0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006b61e0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006b6200)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:17:30.386664187+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:17:30.386777139+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:17:30.387655110+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:17:30.392165890+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:17:30.392339692+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:bd177517-381b-4e8e-8dac-0b5860084517/modify |  |
2025-06-16T12:17:30.393081945+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport
2025-06-16T12:17:30.393178664+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:17:30.393250678+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:17:30.393261432+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:17:30.393268967+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:17:30.393281894+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:17:30.394723336+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:17:30.394898958+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:17:30.394934069+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=101537ed-9442-4842-b8d7-bf705b2742ba&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:17:30.395599818+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:17:30.397321942+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.416245847+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:17:30.420727645+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:17:30.421142711+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:17:30.422191390+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:17:30.422209558+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:17:30.423588034+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.455049805+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:17:30.457321421+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:17:30.461858736+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:17:30.463125608+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:17:30.467512010+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:30.470517423+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:30.471322397+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:17:30+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000702820 0xc000702840 0xc000702860]
2025-06-16T12:17:30.471427579+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:17:30.471451459+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000702820 0xc000702840 0xc000702860]}
2025-06-16T12:17:30.471469850+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:17:30.474243364+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.477415152+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=101537ed-9442-4842-b8d7-bf705b2742ba&target-nf-type=AMF |  |
2025-06-16T12:17:30.478517733+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:17:30.478723060+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-16T12:17:30.478735582+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:17:30.478741834+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-16T12:17:30.478751443+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:17:30.479158843+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.502774280+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:17:30.505087537+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:17:30.505208063+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:17:30.507474729+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:17:30.510476617+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:17:30.517750231+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:17:30.518690312+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:17:30.518969093+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:17:30.520051643+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.521647214+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:17:30.521905503+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:17:30.522223238+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:17:30.522546300+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:17:30.532896193+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:17:30.534018498+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:17:30.536659606+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:17:30.536748881+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:17:30.536762594+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:17:30.536766355+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:17:30.536769066+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:17:30.536796361+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:17:30.537559431+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:17:30.537970000+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:17:30.538080063+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:30.538388404+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:17:30.538416785+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:17:30.538457727+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:17:30.538590024+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:17:30.538698372+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:17:30.541084291+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-16T12:17:30.555585197+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:17:30.562858166+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:17:30.563262288+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mSend PDU Session Resource Setup Request
2025-06-16T12:17:30.565580070+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:17:30.566906174+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:30.566939803+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.566944592+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-16T12:17:30.566981095+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.566983921+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.566986762+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.567026359+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.567030871+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567039476+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567044145+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567047841+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567052782+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567055542+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:17:30.567099498+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.567102204+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:30.567105925+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.567108757+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.567111452+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:30.567118792+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.567120999+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.567123375+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.567137012+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.567139115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.567141200+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000bcb3310a
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x0d299c431964e30fb930036ff5c53d146db4a8c15f829ef6a6afb13ae3aee6c8
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xa4f1733a93e4109e92c7110fba28a72527bdf45e
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000001f689a5
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xd63626f8f7c6bbe15db1f5d58d2b8b073d20c4d89331042faf928d0564f557b9
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x9e702b1930b4655495f6a77391c0f8df2428aff0
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x660f71e3
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006b6f40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c762d0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00013b810)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000517fbc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000000240)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc0006b0800)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000517fe0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000517ff0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006b6f60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006b6f80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006b6fa0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-16T12:17:30.590777757+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:17:30.591053360+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57634] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:17:30.592977315+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:17:30.601890533+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:17:30.602074085+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:da2629ba-66aa-4166-a30b-e649a6fe80b7/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=788.055µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.1063ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=700.702µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=1.009073ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=645.796µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 645.796µs/849.985µs/1.1063ms/178.224µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (10.37s)
PASS
ok  	test	10.438s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (26.40s)
PASS
ok  	test	29.290s

--- STDERR ---
2025-06-16T12:17:09.081843816+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:17:09.081964906+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-16T12:17:09.082700834+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:17:09.082754567+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc00052bb80)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0005c21e0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0005c2390)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000588dc0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-16T12:17:09.082760724+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:17:09.082766629+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-16T12:17:09.082769129+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:09.082831881+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-16T12:17:09.082876631+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-16T12:17:09.094780563+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-16T12:17:09.094857765+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-16T12:17:09.094986368+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-16T12:17:09.095121650+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-16T12:17:09.095130515+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-16T12:17:09.095133167+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-16T12:17:14.858702994+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-16T12:17:14.858825372+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-16T12:17:21.308526338+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:17:21.309607765+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-16T12:17:21.310246780+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:21.310291994+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-16T12:17:21.310304507+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:21.310381918+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-16T12:17:21.310400464+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-16T12:17:21.313663043+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-16T12:17:21.313780398+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-16T12:17:21.316108135+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-16T12:17:21.319169501+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-16T12:17:21.319798288+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-16T12:17:21.325125607+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-16T12:17:21.325633996+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-16T12:17:21.325646855+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-16T12:17:21.327954531+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-16T12:17:28.713389752+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.713442099+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.713451747+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.713462401+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.713468842+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.713475025+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-16T12:17:28.725214839+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.725308819+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.725318058+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:28.725322758+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:17:28.725325951+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:28.725329226+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:28.725331836+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:28.725350681+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.725353114+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:17:28.725378301+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.725380820+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.725382988+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:28.725386569+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:17:28.725389163+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:28.725391537+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:28.725393805+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:28.740476496+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.740518746+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.740527955+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.740535776+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:17:28.740546385+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.740551688+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.740555609+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.740625189+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.740633070+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.740639104+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.740646686+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.740652677+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.740658640+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-16T12:17:28.740662153+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.740666142+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:17:28.740673863+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-16T12:17:28.740679510+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:17:28.740682850+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:17:28.744197247+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.744341271+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:17:28.744356283+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-16T12:17:28.744364489+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:17:28.744399029+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:28.744406977+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:17:28.744443506+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.744450744+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.744454893+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.744528128+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.744536653+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.744540256+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.746495250+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.746531063+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.746541988+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.746549384+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:17:28.746558800+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.746562780+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.746566906+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.746607932+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.746613620+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.746618135+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.746623994+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:17:28.746638499+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:28.746802608+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:28.746819470+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-16T12:17:28.746836389+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:28.746842334+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-16T12:17:28.824722393+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:17:28.824907906+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:28.824928159+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:17:28.824946019+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.824950684+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:28.824957934+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:17:28.824976634+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.824981563+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.824985532+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.825003429+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.825007646+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.825011149+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.827300601+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.827529262+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.827539173+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.827547552+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:17:28.827557322+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.827562782+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.827566753+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.827594449+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.827599935+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.827604287+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.827610887+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:17:28.827627595+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:28.827636810+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:28.845647021+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:17:28.845690134+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:28.845696844+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:17:28.845705677+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.845710689+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:28.845715962+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:17:28.845749593+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.845754564+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.845759564+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.845779562+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.845784186+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.845788363+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.846919330+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:28.846959220+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.846966906+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.846974840+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:17:28.846983848+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:28.846988011+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:28.846991840+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:28.847022389+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:28.847028322+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.847032635+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:28.847039049+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:17:28.847050256+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:28.847057453+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:29.033754469+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-16T12:17:29.033878235+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:29.033919918+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-16T12:17:29.033928220+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.033931469+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:17:29.033943755+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.033946881+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.033949232+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.033960051+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.033962354+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.033964948+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.038176447+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.038498143+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.038510728+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.038519485+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:17:29.038529115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.038533639+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.038538031+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.038563901+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.038569648+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.038701680+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.038764879+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 3266824292, Outbound SPI: 1381224426
2025-06-16T12:17:29.038808364+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.038886445+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:17:29.038896640+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:17:29.038902431+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:29.038909362+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.038914249+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.038924459+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:29.038928719+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:29.038945081+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.038949747+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.038953838+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.039331114+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.039405920+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.039415143+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.039776410+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.039789768+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.039795390+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:29.039798667+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:17:29.040048585+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.040071385+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-16T12:17:29.048509074+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.052158573+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:17:29.053763774+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:29.056957804+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:17:29.554846508+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:29.696786051+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:17:29.696823549+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-16T12:17:29.699613906+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-16T12:17:29.700195529+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-16T12:17:29.700496261+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-16T12:17:29.715325698+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:17:29.715581449+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:29.715656177+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:17:29.715692922+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.715699205+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:29.715718530+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:29.715760539+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.715771505+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.715775911+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:29.715779645+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:29.715823076+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.715893621+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.715903017+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.715941534+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.715946619+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.715950239+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.718473365+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.718632908+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.718645278+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.718654733+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:17:29.718660079+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 3997426162347941066
2025-06-16T12:17:29.718667298+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.718671816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.718675772+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.718768007+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.718945204+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.718970105+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.719080562+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.719092233+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.719191951+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.719214921+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:29.719222442+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:17:29.719492378+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.719727965+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.719866110+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:17:29.721707953+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:29.763514518+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:17:29.944983193+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:17:29.945113019+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-16T12:17:29.951297507+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-16T12:17:29.953176773+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-16T12:17:29.964726509+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:17:29.964843259+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:29.964853664+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:17:29.964887909+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.964892502+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:29.964898728+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:29.964903189+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.964909520+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:29.965227403+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:29.965243697+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:29.965265231+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.965268889+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.965271322+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.965294541+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.965301361+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.965303786+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.966493859+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:29.966525376+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.966534264+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.966538903+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:17:29.966547478+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 3997426162347941066
2025-06-16T12:17:29.966552461+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:29.966554937+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:29.966557189+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:29.966589623+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:29.966592973+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.966598711+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.966602268+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.966605720+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:29.966613343+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.966618624+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:29.966621680+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:17:29.975798764+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-16T12:17:29.978496483+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.978706272+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:29.978762229+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:17:29.981610022+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:29.994685326+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:17:30.307199970+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:17:30.307241547+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-16T12:17:30.313140503+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-16T12:17:30.316573335+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-16T12:17:30.325046952+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:17:30.325368484+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:30.325383732+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:17:30.325424577+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.325430928+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:30.325438023+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:30.325443234+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.325457086+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.325461945+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:30.325466412+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:30.325486119+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.325490510+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.325494591+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.325529031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.325657960+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.325669618+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.330079157+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:30.330114409+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.330120316+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.330127019+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:17:30.330132693+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 3997426162347941066
2025-06-16T12:17:30.330140713+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.330144819+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.330148521+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.330349396+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.330363274+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.330371501+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.330376735+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.330381484+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.330402906+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:30.330410489+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:30.330414909+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:17:30.335192386+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-16T12:17:30.335523813+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:30.338745935+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:30.338828757+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:17:30.347796600+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:17:30.388563134+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:17:30.539799629+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:17:30.539823187+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-16T12:17:30.547696339+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-16T12:17:30.549636603+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-16T12:17:30.565618266+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:17:30.565854105+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:30.565870550+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:17:30.565914176+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.566001168+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:17:30.566014380+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:17:30.566028874+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.566034458+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:17:30.566039057+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:30.566042863+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:17:30.566063954+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.566069037+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.566072964+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.566103218+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.566107493+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.566111176+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.567543268+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:17:30.567592521+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.567603335+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567621346+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:17:30.567631914+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 3997426162347941066
2025-06-16T12:17:30.567639887+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:17:30.567644474+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:17:30.567648574+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:17:30.567704898+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:17:30.567712075+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567720179+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567725415+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567730798+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:17:30.567743680+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:30.567767207+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:17:30.567773415+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:17:30.570023351+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-16T12:17:30.571329154+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:30.571526388+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:17:30.571575762+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:17:30.600021292+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:17:42.098413746+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-16T12:17:42.098443461+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-16T12:17:42.098588903+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-16T12:17:42.098597662+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-16T12:17:42.098605888+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-16T12:17:42.151121065+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-16T12:17:42.151178575+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-16T12:17:42.151197870+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-16T12:17:42.151220154+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-16T12:17:42.151222730+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-16T12:17:42.151224537+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-16T12:17:42.627988630+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-16T12:17:42.628053395+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-16T12:17:42.628158691+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-16T12:17:42.628446955+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-16T12:17:42.628469486+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-16T12:17:42.628633983+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-16T12:17:42.628621928+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.213:51289: use of closed network connection
2025-06-16T12:17:42.628644979+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-16T12:17:42.628632959+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.213:51289: use of closed network connection
2025-06-16T12:17:42.628806276+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-16T12:17:42.628850706+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-16T12:17:42.628858291+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-16T12:17:42.628865035+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-16T12:17:42.628879280+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-16T12:17:42.628884304+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:17:42.628903004+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-16T12:17:42.628906822+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:17:42.628912560+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-16T12:17:42.629237969+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-16T12:17:42.628652630+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-16T12:17:42.629497404+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-16T12:17:42.629856277+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-16T12:17:42.629870531+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-16T12:17:42.629880053+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-16T12:17:42.629882476+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (197340): No such process
