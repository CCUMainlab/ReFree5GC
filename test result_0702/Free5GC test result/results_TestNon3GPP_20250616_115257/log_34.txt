Run TestCN
os.Args: [/tmp/go-build247024596/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-16T12:17:51.633617849+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.633658028+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.633662237+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.633712187+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-16T12:17:51.633729841+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-06-16T12:17:51.634250270+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.634257256+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.634259405+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.634304431+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-16T12:17:51.638759374+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.638822465+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.638828741+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.638837774+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-16T12:17:51.638863702+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-16T12:17:51.639292752+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:17:51.639379374+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.639398115+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.639400960+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.649325267+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.650804298+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.650812931+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.650819153+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-06-16T12:17:51.651256355+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-16T12:17:51.652687584+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.652697154+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.652699554+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.652702248+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-16T12:17:51.652717822+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-16T12:17:51.652783625+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.652829146+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.652834082+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.653122937+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.653166686+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.653171688+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.653185952+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} daa6b3dc-2a48-42c1-ab7a-bf20952cfe06 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{daa6b3dc-2a48-42c1-ab7a-bf20952cfe06 nausf-auth 0xc0002889f0 http REGISTERED   0xc0002889d8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000ba72c0 false false}
2025-06-16T12:17:51.653245998+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-16T12:17:51.653791467+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-16T12:17:51.653798716+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-16T12:17:51.653801021+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:51.653803862+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-16T12:17:51.653820323+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-16T12:17:51.654131251+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-16T12:17:51.654408869+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-16T12:17:51.854522101+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-06-16T12:17:51.854703536+08:00[36m [INFO][AMF][Init] [0mServer started
2025-06-16T12:17:51.854973191+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-16T12:17:51.856242837+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:51.860325553+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:51.861004990+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 99ca2155-704c-46a6-8c9d-1787c50fd79b
2025-06-16T12:17:51.863921066+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/99ca2155-704c-46a6-8c9d-1787c50fd79b |  |
2025-06-16T12:17:51.864162653+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:51.864258579+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-16T12:17:52.056401823+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-16T12:17:52.058413111+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:52.061561905+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:52.062984878+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: e463934b-bf3f-48fe-81df-5036af16244d
2025-06-16T12:17:52.064537521+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/e463934b-bf3f-48fe-81df-5036af16244d |  |
2025-06-16T12:17:52.064751703+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:52.064862226+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {e463934b-bf3f-48fe-81df-5036af16244d SMF REGISTERED 0 0xc0005eae28 0xc0005eae58 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc0004dfdc0 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0005ead68 false false []}
2025-06-16T12:17:52.064985825+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-16T12:17:52.065058515+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-16 12:17:52.065051908 +0800 CST m=+0.483294997]
2025-06-16T12:17:52.064979906+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-16T12:17:52.262311201+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:52.266079415+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:52.268220556+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 610cb07a-de36-4f65-84fc-527622082850
2025-06-16T12:17:52.277126790+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/610cb07a-de36-4f65-84fc-527622082850 |  |
2025-06-16T12:17:52.277336128+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:52.277391448+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-16T12:17:52.277397035+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-16T12:17:52.277399782+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:17:52.277410413+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-16T12:17:52.461629883+08:00[36m [INFO][PCF][Init] [0mServer started
2025-06-16T12:17:52.462836821+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:52.466479949+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:52.467114232+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: dfdc9d9e-ea9e-4417-92b5-cd8697b50933
2025-06-16T12:17:52.467650068+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/dfdc9d9e-ea9e-4417-92b5-cd8697b50933 |  |
2025-06-16T12:17:52.468027294+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:52.468203958+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-16T12:17:52.662733009+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-16T12:17:52.662875483+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-16T12:17:52.663910886+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:52.668539036+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:52.669600384+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8fddbb65-94fe-4f7c-be4b-d79e36c68a64
2025-06-16T12:17:52.670759564+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8fddbb65-94fe-4f7c-be4b-d79e36c68a64 |  |
2025-06-16T12:17:52.670973848+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:52.671068117+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-16T12:17:52.864627185+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:52.868374546+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:52.870673133+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 5c66e654-668b-4d09-8877-ef6ab8097303
2025-06-16T12:17:52.871889323+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/5c66e654-668b-4d09-8877-ef6ab8097303 |  |
2025-06-16T12:17:52.872273910+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:52.872283961+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-16T12:17:52.872286691+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-16T12:17:53.065284896+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-16T12:17:53.066095932+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-06-16T12:17:53.066416205+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-16T12:17:53.070760000+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:53.073691995+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:53.074591112+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: daa6b3dc-2a48-42c1-ab7a-bf20952cfe06
2025-06-16T12:17:53.075924188+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/daa6b3dc-2a48-42c1-ab7a-bf20952cfe06 |  |
2025-06-16T12:17:53.076135331+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:53.076192387+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-16T12:17:53.269594655+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-16T12:17:53.270419828+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-16T12:17:53.276208826+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:17:53.279283775+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:17:53.280889345+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 5d54d28a-2670-405d-b32d-44525690ff22
2025-06-16T12:17:53.282000600+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/5d54d28a-2670-405d-b32d-44525690ff22 |  |
2025-06-16T12:17:53.282335353+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:17:53.282390745+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-16T12:18:00.026320911+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005
2025-06-16T12:18:00.027144074+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005
2025-06-16T12:18:00.027410491+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle NGSetupRequest
2025-06-16T12:18:00.027468411+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mMissing IE PagingDRX
2025-06-16T12:18:00.027493651+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2755282598/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-16T12:18:06.717205295+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.717497455+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.717953323+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:06.717999482+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:18:06.718005665+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:06.718468317+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.718475725+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.718659479+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:06.718664456+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:18:06.718666774+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:06.728094463+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.728159521+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.728167320+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.728172290+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.728174975+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.728177221+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.728179062+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-16T12:18:06.732442943+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.732494776+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:18:06.732500447+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:06.732503719+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:06.732507308+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:06.732603732+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.732608388+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.732610282+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.732621629+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.732623449+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.732625075+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.734744699+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.734780704+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.734793740+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.734801951+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.734803976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.734805761+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.734875952+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.734878214+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.734880731+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.734883146+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.734885490+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.734887762+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-16T12:18:06.734980925+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.734985360+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.734987421+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:18:06.734993341+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.734995190+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.734996920+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.735005353+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.735007304+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.735008910+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.736432571+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle InitialUEMessage
2025-06-16T12:18:06.736532811+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-16T12:18:06.736578210+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-16T12:18:06.736781496+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-16T12:18:06.736863024+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-16T12:18:06.736878936+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-16T12:18:06.736885702+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-16T12:18:06.736992143+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-16T12:18:06.737012375+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-16T12:18:06.737018264+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-16T12:18:06.737834065+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.744471802+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-16T12:18:06.746070147+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-16T12:18:06.746243139+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-06-16T12:18:06.746754744+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.759115389+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-16T12:18:06.763974143+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-16T12:18:06.764075039+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-16T12:18:06.764089088+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-16T12:18:06.764111958+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-16T12:18:06.764613120+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.772209228+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-16T12:18:06.776120160+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:18:06.778754750+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:18:06.779107208+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-16T12:18:06.779508058+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-16T12:18:06.779570886+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-06-16T12:18:06.779582242+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 6332323833353433373366316538383738306330383262626364666134336135
2025-06-16T12:18:06.779760295+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-16T12:18:06.780487631+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-16T12:18:06.780556981+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend Downlink Nas Transport
2025-06-16T12:18:06.780807570+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-06-16T12:18:06.781311129+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.781332200+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.781335325+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.781338157+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.781339986+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781341936+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.781358678+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.781360958+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.781363009+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.781596129+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781650255+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.781664435+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:18:06.781674480+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.781680240+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781683161+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.781694682+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.781699314+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781702280+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.782071598+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:06.782134605+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:06.782168846+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-16T12:18:06.782174731+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-16T12:18:06.782178318+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-06-16T12:18:06.783256177+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-16T12:18:06.783321877+08:00[36m [INFO][AUSF][5gAka] [0mres*: 6332323833353433373366316538383738306330383262626364666134336135
Xres*: 6332323833353433373366316538383738306330383262626364666134336135
2025-06-16T12:18:06.783340210+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-06-16T12:18:06.783948003+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-16T12:18:06.785607597+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-16T12:18:06.785953190+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-16T12:18:06.786029838+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-16T12:18:06.786141419+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-16T12:18:06.786185552+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-16T12:18:06.786205815+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend Downlink Nas Transport
2025-06-16T12:18:06.786308178+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-06-16T12:18:06.788383291+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.788404017+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.788407262+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.788410195+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.788413511+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788416035+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.788444674+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.788447398+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.788449508+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.788474282+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788476540+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.788478744+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:18:06.788486270+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.788488021+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788500237+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.788507632+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.788509427+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788511133+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.789057541+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:06.789081548+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:06.789127823+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-16T12:18:06.789139885+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-16T12:18:06.789149778+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-06-16T12:18:06.789228994+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-16T12:18:06.789261280+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-16T12:18:06.789834058+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.801514936+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:18:06.804224713+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-16T12:18:06.805077063+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:18:06.805907825+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-16T12:18:06.806106057+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:06.807207065+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.818244427+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:18:06.820365453+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-16T12:18:06.822724735+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-16T12:18:06.823000736+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-16T12:18:06.823380996+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-16T12:18:06.823782892+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:18:06.824403048+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:06.824538042+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:06.824695984+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-16T12:18:06.825733497+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-16T12:18:06.826018945+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:06.826350749+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-16T12:18:06.826941669+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-16T12:18:06.827137912+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-16T12:18:06.827351182+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-16T12:18:06.827502288+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-16T12:18:06.827600963+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-16T12:18:06.828022767+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.845541223+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-16T12:18:06.848207121+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-06-16T12:18:06.848896495+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.855446933+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-16T12:18:06.857031561+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-16T12:18:06.857404861+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:06.870585352+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-16T12:18:06.875043984+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-16T12:18:06.875207048+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-06-16T12:18:06.875234823+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-16T12:18:06.876055249+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-16T12:18:06.876368328+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-16T12:18:06.876520912+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend Initial Context Setup Request
2025-06-16T12:18:06.876711325+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-06-16T12:18:06.878418854+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.878456541+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.878469558+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.878474700+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.878478267+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.878481955+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.878505364+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.878575482+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.878594066+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.878598420+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:18:06.878722587+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.878729347+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:18:06.878731603+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:18:06.878743505+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.878745391+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.878747388+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.878760400+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.878762248+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.878763920+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.880308223+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.880330386+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.880333557+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880337219+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.880340197+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.880342374+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.880361472+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.880365043+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880370148+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880502767+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880509927+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880517306+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880520155+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.880522092+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-16T12:18:06.881558460+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle InitialContextSetupResponse
2025-06-16T12:18:06.881637920+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:18:06.881648964+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0xd8870962
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000cab040)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000ece10)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000cc8620)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000c94fb0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000cab060)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000cab080)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000c94feb)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000c95003)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000c95009)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-16T12:18:06.883460879+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:06.883493270+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:06.883581409+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-16T12:18:06.883597039+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-16T12:18:06.883628285+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-06-16T12:18:06.883904354+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-16T12:18:06.883950032+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend Downlink Nas Transport
2025-06-16T12:18:06.884130665+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-16T12:18:07.384552983+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:07.384615583+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:07.384660735+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:18:07.384665870+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:18:07.384669406+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:18:07.384685483+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:18:07.385154125+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.391495368+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-16T12:18:07.392783509+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:18:07.392872473+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:18:07.393008966+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:18:07.393304327+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:18:07.393994631+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.403933444+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:07.405860185+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:18:07.406011958+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:18:07.406268439+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:18:07.406309984+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:18:07.406791028+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.416890783+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:18:07.418359712+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:18:07.419066975+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:18:07.419141284+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:18:07.420135521+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.420648445+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.421095912+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:18:07+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000ed8c20 0xc000ed8c40 0xc000ed8c60]
2025-06-16T12:18:07.421159342+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:18:07.421165920+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000ed8c20 0xc000ed8c40 0xc000ed8c60]}
2025-06-16T12:18:07.421168230+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:18:07.421705287+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.423931755+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&target-nf-type=AMF |  |
2025-06-16T12:18:07.424186708+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:18:07.424425913+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-16T12:18:07.424432496+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:18:07.424435913+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-16T12:18:07.424446374+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:18:07.424530215+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.441675611+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:18:07.443431561+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:18:07.443489106+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:18:07.444363216+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:18:07.446143475+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.452505604+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:18:07.452739814+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:18:07.453255300+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:18:07.454435119+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.457001065+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:18:07.457413731+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:18:07.457681373+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:18:07.457772438+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.462027621+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:18:07.462649359+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:18:07.463794460+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:18:07.463876128+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:18:07.463885426+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:18:07.463888288+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:18:07.463890494+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:18:07.464038556+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:18:07.464262677+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:18:07.464349977+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:18:07.464374707+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:07.464409363+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:18:07.464422475+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:07.464451668+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:18:07.464572959+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:18:07.464697291+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:18:07.465158327+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-16T12:18:07.479375041+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:18:07.480611278+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:18:07.480644002+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend PDU Session Resource Setup Request
2025-06-16T12:18:07.480870688+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:18:07.482126826+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:07.482386336+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.482507646+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-16T12:18:07.482723318+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.482744607+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.482749923+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.482822697+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.482933942+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.482950173+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.482956646+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.482962413+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.482967094+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.482972365+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-16T12:18:07.483320445+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.483332197+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:07.483338375+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.483345250+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.483349737+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:07.483371675+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.483485212+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.483495814+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.483516763+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.483520819+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.483524198+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x796828dc
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b44460)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cdc1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b363c0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000bf48a4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007e6090)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b3e080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000bf4950)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000bf4980)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b44500)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b445c0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b44660)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:18:07.586326115+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:18:07.586361889+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:18:07.587657785+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:18:07.593400960+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:18:07.593533055+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:41e8bd4b-de95-4134-a547-deed4d5054c3/modify |  |
2025-06-16T12:18:07.594315827+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:07.594374006+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:07.594413327+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:18:07.594418071+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:18:07.594421424+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:18:07.594428772+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:18:07.595783155+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:18:07.595872678+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:18:07.595893160+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:18:07.596755166+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:18:07.598174490+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.608065754+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:07.612165149+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:18:07.612361015+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:18:07.612448274+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:18:07.612457726+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:18:07.612672342+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.628465325+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:18:07.629637630+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:18:07.631064711+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:18:07.631147501+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:18:07.633633241+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.633876666+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.633945078+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:18:07+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0006e4340 0xc0006e4360 0xc0006e43a0]
2025-06-16T12:18:07.634023364+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:18:07.634028482+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0006e4340 0xc0006e4360 0xc0006e43a0]}
2025-06-16T12:18:07.634030878+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:18:07.637229607+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.640270569+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&target-nf-type=AMF |  |
2025-06-16T12:18:07.640992629+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:18:07.641316310+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-16T12:18:07.641349945+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:18:07.641360372+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-16T12:18:07.641372554+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:18:07.641689472+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.655554085+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:18:07.656919462+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:18:07.656985730+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:18:07.657959641+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:18:07.659830665+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.663940637+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:18:07.664031587+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:18:07.664131733+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:18:07.664368217+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.665069343+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:18:07.665372972+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:18:07.665691840+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:18:07.665919417+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.672829439+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:18:07.673389427+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:18:07.674325339+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:18:07.674364157+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:18:07.674377671+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:18:07.674386752+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:18:07.674394766+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:18:07.674414599+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:18:07.674523523+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:18:07.674596755+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:18:07.674604041+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:07.674629156+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:18:07.674633623+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:07.674654997+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:18:07.674695570+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:18:07.674753816+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:18:07.676751336+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-16T12:18:07.683834936+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:18:07.686136999+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:18:07.686228794+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend PDU Session Resource Setup Request
2025-06-16T12:18:07.686565849+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:18:07.689094027+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:07.689132855+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.689137078+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-16T12:18:07.689175663+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.689178317+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.689180676+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.689219750+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.689222594+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689228446+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689231015+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689235153+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689237612+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689240287+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:18:07.689276225+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.689278458+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:07.689281601+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.689284009+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.689286446+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:07.689300168+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.689303245+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.689305679+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.689316600+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.689318466+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.689320265+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000005dbcc129
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x2ab5ddade15757f6fe531683186fbfa2db1366b3e20b8d22dc381591ac455124
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x302b866933aa2ef514a2153b75e38b872d00efee
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000b0186e41
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xe6d5f5243831575f074c342feb14001d083200399d83d74005e2b860ba9fd842
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x7816cf5772cafbc18502527bdc21d9d1d4abc6c2
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
2025-06-16T12:18:07.703005795+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse
Security header type: Integrity Protected And Ciphered
2025-06-16T12:18:07.703115798+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
cmac value: 0x6db41cde
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b45b00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cdc4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b37540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006149dc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007e6240)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b3e780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000614a00)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000614a10)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b45b20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b45b40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b45b60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:18:07.705369879+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:18:07.714966806+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:18:07.715210392+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:53166ae2-cf37-4dec-a64c-a45f394553da/modify |  |
2025-06-16T12:18:07.906561686+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:07.906656792+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:07.906708967+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:18:07.906722230+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:18:07.906731933+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:18:07.906744748+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:18:07.907484525+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:18:07.907541464+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:18:07.907562968+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:18:07.907850291+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:18:07.909065049+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.928518168+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:07.930694683+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:18:07.930789947+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:18:07.930814889+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:18:07.930817869+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:18:07.931277005+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.946966058+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:18:07.947980755+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:18:07.948524260+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:18:07.948587524+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:18:07.949858727+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.950557732+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.950688258+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:18:07+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000c66e20 0xc000c66e40 0xc000c66e60]
2025-06-16T12:18:07.950703652+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:18:07.950708088+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000c66e20 0xc000c66e40 0xc000c66e60]}
2025-06-16T12:18:07.950712106+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:18:07.951050960+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.952386732+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&target-nf-type=AMF |  |
2025-06-16T12:18:07.952729596+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:18:07.952821525+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-16T12:18:07.952827865+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:18:07.952832282+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-16T12:18:07.952836617+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:18:07.952894530+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.964712623+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:18:07.967487683+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:18:07.967551349+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:18:07.967988170+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:18:07.969932121+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:07.977141665+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:18:07.977746322+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:18:07.978014296+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:18:07.979035656+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.980324328+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:18:07.981040980+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:18:07.981403953+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:18:07.981655832+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:07.987683234+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:18:07.988886951+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:18:07.989912982+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:18:07.989931504+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:18:07.989937489+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:18:07.989940012+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:18:07.989942077+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:18:07.989960517+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:18:07.990293529+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:18:07.990379327+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:18:07.990387417+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:07.990411874+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:18:07.990462501+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:07.990495268+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:18:07.990527337+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:18:07.990620515+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:18:07.990903064+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-16T12:18:07.996810526+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:18:07.998039450+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:18:07.998356641+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend PDU Session Resource Setup Request
2025-06-16T12:18:07.998725693+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:18:07.999772687+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:07.999880913+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.999893399+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-16T12:18:07.999966196+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.999972108+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.999975728+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.001206952+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.002333534+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.002349723+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.002352987+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.002356818+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.002359489+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.002362291+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:18:08.002418535+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.002421565+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:08.002438832+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:08.002441400+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:08.002443698+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:08.002471070+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.002475520+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.002480499+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.002496590+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.002499781+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.002501695+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000055bee7ea
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xfb0990c7fec44b90ec2dffd27ef6e7985e9633709f4cd6bb51abb4322857ea60
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x4e310320c8db756f57e7d81b2cfc3114d5a2800d
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000003bef8e6e
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xa621e14a29cf6eaac4b721ab40ba911434922b207a77bc6f8446c6c91540a317
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xc6069dbc0b01519c6929d8155316e886edeccc42
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xf18850c1
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0007dc840)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cdc780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b37ef0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00068ee4c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007e63f0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b3ee80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00068ee80)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00068ee90)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0007dc860)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0007dc880)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0007dc8a0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:18:08.102861071+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:18:08.102921518+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:18:08.103435442+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:18:08.105651197+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:18:08.105862422+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:0bf68995-b5cd-4c10-a856-dd6f566d2537/modify |  |
2025-06-16T12:18:08.106600457+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport
2025-06-16T12:18:08.106613010+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:18:08.106642325+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:18:08.106646751+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:18:08.106650179+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:18:08.106656330+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:18:08.107721752+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:18:08.107808210+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:18:08.107824864+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:18:08.108087769+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:18:08.108912398+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:08.118316224+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:18:08.120732395+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:18:08.120878061+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:18:08.120904853+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:18:08.120907864+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:18:08.122255040+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:08.134072449+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:18:08.135018554+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:18:08.135923146+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:18:08.135948179+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:18:08.138359164+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:08.138519514+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:08.138596052+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:18:08+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0018033c0 0xc0018033e0 0xc001803400]
2025-06-16T12:18:08.138628695+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:18:08.138637721+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0018033c0 0xc0018033e0 0xc001803400]}
2025-06-16T12:18:08.138645232+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:18:08.138974105+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:08.140668547+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=99ca2155-704c-46a6-8c9d-1787c50fd79b&target-nf-type=AMF |  |
2025-06-16T12:18:08.141301208+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:18:08.141388386+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-16T12:18:08.141401804+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:18:08.141410295+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-16T12:18:08.141419885+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:18:08.141550746+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:08.160696022+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:18:08.161989978+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:18:08.162003656+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:18:08.163221787+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:18:08.165152891+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:18:08.170822335+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:18:08.171215564+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:18:08.171473576+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:18:08.174687788+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:08.175764528+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:18:08.175935592+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:18:08.176122739+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:18:08.176235186+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:18:08.180117099+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:18:08.180709960+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:18:08.211176072+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:18:08.211319258+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:18:08.211336942+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:18:08.211341405+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:18:08.211344986+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:18:08.211378978+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:18:08.211679870+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:18:08.211806011+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:18:08.211830469+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:08.211865516+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:18:08.211879694+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:18:08.211921956+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:18:08.212146004+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:18:08.212403495+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:18:08.212671810+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-16T12:18:08.221051083+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:18:08.222653034+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:18:08.222728649+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mSend PDU Session Resource Setup Request
2025-06-16T12:18:08.222892047+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:18:08.223614462+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:08.223639178+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.223646990+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-16T12:18:08.223740739+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.223744826+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223747006+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.223774893+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.223777464+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.223782258+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.223784625+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.223787735+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.223789952+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.223792118+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:18:08.223827446+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223829947+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:08.223837126+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:08.223839453+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:08.223842008+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:08.223849815+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.223851763+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223853441+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.223863511+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.223865216+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223868316+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000011ea6b40
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xf6be1f9805eb065f3ead3c39558fc17f5b0257d22d18ac4e1de7e5f4f5d19b3d
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xada536f790b7d13579ab3272e807a0ce7da95123
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000051a9a304
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x65f413bed8ae0aa8853116bf09bf6118de6648d2183560cc3164d26a5e414220
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xe7f2cd60e425a5feb1cc993b9d74c2463fae0626
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-06-16T12:18:08.236540982+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:18:08.236599917+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:53005] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x16ce6100
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0007dd540)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cdca50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0007de960)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  03 02 00 06 21 12 01 01  ff 02 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000ffebc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007e65a0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b3fd80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 03 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0000ffee0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000ffef0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0007dd560)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0007dd580)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0007dd5a0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-16T12:18:08.237351906+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:18:08.242424173+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:18:08.242540496+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:283b000d-d213-4ec7-a464-9251236b1d5d/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=849.381µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.32275ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=854.263µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=490.123µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=772.738µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 490.123µs/857.852µs/1.32275ms/267.837µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.93s)
PASS
ok  	test	9.978s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.72s)
PASS
ok  	test	28.624s

--- STDERR ---
2025-06-16T12:17:47.852950667+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:17:47.853208251+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-16T12:17:47.853834526+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:17:47.853905066+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0006204b0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc00008e4b0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc00008e660)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc00009a200)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-16T12:17:47.853908903+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:17:47.853914727+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-16T12:17:47.853916830+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-16T12:17:47.853928425+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-16T12:17:47.853931423+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-16T12:17:47.859079271+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-16T12:17:47.859166699+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-16T12:17:47.859310351+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-16T12:17:47.859600097+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-16T12:17:47.859782629+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-16T12:17:47.859809883+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-16T12:17:53.065820445+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-16T12:17:53.065866663+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-16T12:18:00.009405660+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:18:00.010467008+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-16T12:18:00.010842517+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-16T12:18:00.010870973+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-16T12:18:00.010880126+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-16T12:18:00.010944034+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-16T12:18:00.010958923+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-16T12:18:00.023636287+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-16T12:18:00.023837261+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-16T12:18:00.026258527+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-16T12:18:00.027417895+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-16T12:18:00.027546781+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-16T12:18:00.027729318+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-16T12:18:00.027873396+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-16T12:18:00.027879416+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-16T12:18:00.028019769+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-16T12:18:06.718672724+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.718702451+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.718708284+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.718717734+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.718721368+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.718724455+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-16T12:18:06.727343472+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.727400200+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.727406482+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:06.727409899+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:18:06.727415428+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:06.727417835+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:06.727419674+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:06.727433664+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.727435594+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:18:06.727454172+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.727457097+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.727458734+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:06.727460997+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:18:06.727462858+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:06.727464706+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:06.727466555+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:06.732807811+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.732940529+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.733047127+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.733054844+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:18:06.733060089+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.733062191+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.733064034+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.733082627+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.733085019+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.733087448+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.733091251+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.733093978+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.733096790+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-16T12:18:06.733098503+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.733101431+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:18:06.733105074+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-16T12:18:06.733107727+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:18:06.733109402+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:18:06.734438873+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.734444180+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:18:06.734457341+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-16T12:18:06.734460733+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:18:06.734464651+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.734466801+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:18:06.734482699+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.734485856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.734487769+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.734514451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.734516323+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.734517982+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.735257579+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.735293704+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.735309152+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.735317805+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:18:06.735326567+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.735334907+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.735343035+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.735361274+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.735489520+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.735515650+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.735542852+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:18:06.735563221+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.735601416+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:06.735611709+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-16T12:18:06.735623764+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.735632465+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-16T12:18:06.780957704+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:18:06.781037255+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:06.781047668+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:18:06.781056362+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781058721+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.781061137+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:18:06.781080264+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.781082658+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781084559+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.781094564+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.781096467+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781098244+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.781823680+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.781833873+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.781836462+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.781839411+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:18:06.781842985+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.781844821+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.781846570+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.781856446+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.781858523+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.781860408+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.781863464+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:18:06.781867932+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.781872111+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:06.788017735+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:18:06.788086171+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:06.788094393+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:18:06.788099176+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788101458+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.788103604+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:18:06.788117060+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.788119382+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788121171+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.788129549+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.788132826+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788134496+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.788853353+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.788876850+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.788880208+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.788883268+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:18:06.788887400+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.788890152+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.788891962+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.788908569+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.788910860+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.788912861+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.788915988+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:18:06.788921058+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.788924940+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:06.877655226+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-16T12:18:06.877761687+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:06.877774021+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-16T12:18:06.877784031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.877788197+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:18:06.877803999+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.877808437+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.877812334+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.877832069+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.877895772+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.877902949+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.879011175+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:06.879070622+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.879077258+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.879083047+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:18:06.879087288+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.879089259+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.879091034+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.879210779+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:06.879217674+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.879221624+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:06.879261233+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 3299039129, Outbound SPI: 351214957
2025-06-16T12:18:06.879335707+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.879341642+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:18:06.879344031+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:18:06.879347469+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:06.879350878+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:06.879353048+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:06.879355394+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:06.879358137+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:06.879364802+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.879366696+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.879368471+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.879953610+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:06.880099922+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:06.880106385+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:06.880187412+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.880548149+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.880560015+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:06.880563307+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:18:06.880577567+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.881092792+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-16T12:18:06.881423305+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:06.881979215+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:18:06.882983549+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:06.884323611+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:18:07.384173948+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:07.465147303+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:18:07.465303017+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-16T12:18:07.469761388+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-16T12:18:07.469821984+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-16T12:18:07.470663480+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-16T12:18:07.481307980+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:18:07.481516341+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:07.481527332+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:18:07.481546565+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.481549763+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:07.481553270+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:07.481556033+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.481558650+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.481560983+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:07.481563163+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:07.481570816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.481573332+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.481575255+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.481600656+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.481602784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.481604556+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.483684851+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:07.483767264+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.483778006+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.483783788+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:18:07.483787770+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 14335383238408150532
2025-06-16T12:18:07.483793413+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.483795699+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.483798852+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.483827086+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.483829822+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.483836319+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.483839008+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.483841957+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.483849756+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:07.483854254+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:07.483856948+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:18:07.484577375+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:07.485082885+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:07.485154537+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:18:07.486589415+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:07.588139788+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:18:07.676125719+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:18:07.676217268+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-16T12:18:07.679832164+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-16T12:18:07.680273730+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-16T12:18:07.686989936+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:18:07.687771159+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:07.687815333+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:18:07.688046134+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.688090722+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:07.688098078+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:07.688101025+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.688103865+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.688106423+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:07.688108543+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:07.688324068+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.688366871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.688372822+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.688392673+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.688394909+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.688396864+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.689606142+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:07.689619875+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.689622818+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689625643+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:18:07.689628220+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 14335383238408150532
2025-06-16T12:18:07.689631307+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.689633304+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.689635146+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.689658641+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:07.689661073+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689664789+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689671428+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689674177+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:07.689679393+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:07.689683858+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:07.689686360+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:18:07.702475860+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-16T12:18:07.702709058+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:07.702829617+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:07.702864720+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:18:07.704734781+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:07.706449961+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:18:07.991182581+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:18:07.991465078+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-16T12:18:07.994916284+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-16T12:18:07.995001310+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-16T12:18:07.998971648+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:18:07.999215935+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:07.999225132+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:18:07.999246549+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.999249459+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:07.999252838+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:07.999255361+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.999257637+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:07.999259966+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:07.999262811+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:07.999270969+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.999273463+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.999275217+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:07.999289714+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:07.999292275+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:07.999294028+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.003138155+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:08.003713277+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.004180506+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.004637238+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:18:08.005039581+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 14335383238408150532
2025-06-16T12:18:08.005414354+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.005485339+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.005495062+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.005561788+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.006619772+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.006634744+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.006638433+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.006809825+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.006877037+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:08.006886235+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:08.006889210+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:18:08.013028933+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-16T12:18:08.013782618+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:08.016671005+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:08.016707675+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:18:08.018704174+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:18:08.104538527+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:18:08.212960465+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:18:08.213006017+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-16T12:18:08.214426420+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-16T12:18:08.216199699+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-16T12:18:08.223124342+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:18:08.223231397+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:08.223239193+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:18:08.223256457+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223259422+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:18:08.223269354+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:18:08.223271909+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:08.223404195+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:18:08.223450649+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:08.223456173+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:18:08.223468916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.223471220+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223473041+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.223489212+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.223491129+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.223492834+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.223977414+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:18:08.224988585+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.224997272+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.225000590+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:18:08.225003072+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 14335383238408150532
2025-06-16T12:18:08.225007361+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:18:08.225009560+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:18:08.225012639+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:18:08.225035981+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:18:08.225038241+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.225043385+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.225046276+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.225048733+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:18:08.225054506+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:08.225058036+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:18:08.225060383+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:18:08.226600710+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-16T12:18:08.234717945+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:08.234887870+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:18:08.234932959+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:18:08.237755732+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:18:19.666032006+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-16T12:18:19.666254842+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-16T12:18:19.666466915+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-16T12:18:19.666477701+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-16T12:18:19.666487605+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-16T12:18:19.710562304+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-16T12:18:19.710584553+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-16T12:18:19.710600839+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-16T12:18:19.710617412+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-16T12:18:19.710620146+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-16T12:18:19.710622513+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-16T12:18:20.166575825+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-16T12:18:20.167047290+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-16T12:18:20.167202635+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-16T12:18:20.167287172+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-16T12:18:20.167309900+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-16T12:18:20.167328456+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-16T12:18:20.167333336+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-16T12:18:20.167339711+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-16T12:18:20.167300003+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-16T12:18:20.167478663+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.221:46775: use of closed network connection
2025-06-16T12:18:20.167483085+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.221:46775: use of closed network connection
2025-06-16T12:18:20.167486101+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-16T12:18:20.167506917+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-16T12:18:20.167560690+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-16T12:18:20.167569423+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-16T12:18:20.167583098+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-16T12:18:20.167586629+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:18:20.167595535+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-16T12:18:20.167598022+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:18:20.167602833+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-16T12:18:20.167674293+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-16T12:18:20.167689766+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-16T12:18:20.167701982+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-16T12:18:20.167711979+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-16T12:18:20.167714373+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (197685): No such process
