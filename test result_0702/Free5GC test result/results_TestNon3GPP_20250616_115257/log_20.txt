Run TestCN
os.Args: [/tmp/go-build123433520/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-16T12:08:59.791608161+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.791687001+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.791692886+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.791708211+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-16T12:08:59.791722495+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-06-16T12:08:59.792212652+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.792221283+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.792223594+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.792272852+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-16T12:08:59.795893878+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.795958513+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.795964744+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.795973885+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-16T12:08:59.796001568+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-16T12:08:59.797239708+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:08:59.797295293+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.797301081+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.797303210+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.803656943+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.803670908+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.803673857+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.803737667+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-06-16T12:08:59.804020336+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-16T12:08:59.804645817+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.804760940+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.804766697+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.804769997+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-16T12:08:59.804788741+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-16T12:08:59.804851894+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.804890432+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.804895070+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.805448193+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.805607079+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.805612756+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.805627820+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 134f250b-6b3e-48cd-b097-48240d5c2f44 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{134f250b-6b3e-48cd-b097-48240d5c2f44 nausf-auth 0xc00033aa80 http REGISTERED   0xc00033aa68  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000bb1a40 false false}
2025-06-16T12:08:59.805692348+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-16T12:08:59.806313822+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-16T12:08:59.806358918+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-16T12:08:59.806364583+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:59.806367012+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-16T12:08:59.806387171+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-16T12:08:59.806631913+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-16T12:08:59.806760972+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-16T12:09:00.008880602+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-06-16T12:09:00.008988599+08:00[36m [INFO][AMF][Init] [0mServer started
2025-06-16T12:09:00.012912408+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-16T12:09:00.016611918+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:00.021812810+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:00.022653117+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3fe3ec9d-51cf-4651-b65a-8aa9a575b068
2025-06-16T12:09:00.023627957+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3fe3ec9d-51cf-4651-b65a-8aa9a575b068 |  |
2025-06-16T12:09:00.024092180+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:00.024176497+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-16T12:09:00.209903785+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-16T12:09:00.211364331+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:00.215859867+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:00.216934846+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6c3a8202-14af-4423-810a-06c4e4c718d7
2025-06-16T12:09:00.218708829+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6c3a8202-14af-4423-810a-06c4e4c718d7 |  |
2025-06-16T12:09:00.219604204+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:00.219652793+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {6c3a8202-14af-4423-810a-06c4e4c718d7 SMF REGISTERED 0 0xc000643908 0xc000643920 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000270300 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc000643830 false false []}
2025-06-16T12:09:00.219852583+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-16T12:09:00.219924636+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-16T12:09:00.220401706+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-16 12:09:00.220323873 +0800 CST m=+0.462102451]
2025-06-16T12:09:00.412486161+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:00.414876583+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:00.415800797+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: ab8d2054-6340-42d5-a410-a026ef7a9f6a
2025-06-16T12:09:00.416709734+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/ab8d2054-6340-42d5-a410-a026ef7a9f6a |  |
2025-06-16T12:09:00.417187183+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:00.417247933+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-16T12:09:00.417253273+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-16T12:09:00.417260720+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:09:00.417271208+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-16T12:09:00.612544681+08:00[36m [INFO][PCF][Init] [0mServer started
2025-06-16T12:09:00.615810234+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:00.619029735+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:00.619967404+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: dd37b5b9-035c-40a9-a7df-cf30ed2adb15
2025-06-16T12:09:00.621027553+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/dd37b5b9-035c-40a9-a7df-cf30ed2adb15 |  |
2025-06-16T12:09:00.621204447+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:00.621277150+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-16T12:09:00.813721757+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-16T12:09:00.813822586+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-16T12:09:00.814472954+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:00.817595448+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:00.818739167+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: b7ea8ca5-7d36-433e-9b5f-8f94301d2519
2025-06-16T12:09:00.820658334+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/b7ea8ca5-7d36-433e-9b5f-8f94301d2519 |  |
2025-06-16T12:09:00.820959278+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:00.821057207+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-16T12:09:01.016935305+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:01.019926058+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:01.020763620+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8a10292d-39f8-4962-ad39-0ab64c168cc7
2025-06-16T12:09:01.022238763+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8a10292d-39f8-4962-ad39-0ab64c168cc7 |  |
2025-06-16T12:09:01.022559768+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:01.022588155+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-16T12:09:01.022597193+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-16T12:09:01.214487373+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-06-16T12:09:01.215250247+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:01.219818091+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:01.220355617+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 134f250b-6b3e-48cd-b097-48240d5c2f44
2025-06-16T12:09:01.220710485+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/134f250b-6b3e-48cd-b097-48240d5c2f44 |  |
2025-06-16T12:09:01.220995030+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:01.221049300+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-16T12:09:01.222367641+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-16T12:09:01.223863382+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-16T12:09:01.415806113+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-16T12:09:01.416445667+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-16T12:09:01.418486428+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:09:01.427679269+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:09:01.429048827+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 0b670227-ab8f-41f9-b40b-c7240489881d
2025-06-16T12:09:01.430303486+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/0b670227-ab8f-41f9-b40b-c7240489881d |  |
2025-06-16T12:09:01.430854099+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:09:01.430945532+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-16T12:09:08.043818565+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497
2025-06-16T12:09:08.046311244+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497
2025-06-16T12:09:08.047873053+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle NGSetupRequest
2025-06-16T12:09:08.047890147+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mMissing IE PagingDRX
2025-06-16T12:09:08.047911951+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2526822518/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-16T12:09:14.733524013+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.733770364+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.733780470+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:14.733792827+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:09:14.733795576+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:14.734111099+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.734118024+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.734120016+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:14.734228411+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:09:14.734235985+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:14.742602929+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.742666242+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.742674248+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.742679189+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.742681835+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.742684222+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.742686056+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-16T12:09:14.746815891+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.746924687+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:09:14.746933589+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:14.746938459+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:14.746940593+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:14.746967855+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.746975005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.746978508+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.746990208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.746993141+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.746997383+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.749006306+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.749196053+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.749470635+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.749744269+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.749769521+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.749777866+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.750110028+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.750316514+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750341048+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750351922+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750366182+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750373788+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-16T12:09:14.750445808+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.750459572+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.750468336+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:09:14.750479789+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.750487029+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.750493550+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.750505259+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.750512086+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.750518887+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.751415517+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle InitialUEMessage
2025-06-16T12:09:14.751493763+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-16T12:09:14.751530941+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-16T12:09:14.751708582+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-16T12:09:14.751727682+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-16T12:09:14.751736262+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-16T12:09:14.751740607+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-16T12:09:14.751744717+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-16T12:09:14.751751814+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-16T12:09:14.751755116+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-16T12:09:14.752517033+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.755708448+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-16T12:09:14.756437158+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-16T12:09:14.756488268+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-06-16T12:09:14.756716051+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.762365550+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-16T12:09:14.763474472+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-16T12:09:14.763571258+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-16T12:09:14.763577692+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-16T12:09:14.763580185+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-16T12:09:14.763989048+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.766819079+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-16T12:09:14.767882272+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:09:14.769977225+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:09:14.770078648+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-16T12:09:14.770145802+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-16T12:09:14.770151413+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-06-16T12:09:14.770154701+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3539343331323363326332666461346465306130623535303238373261323730
2025-06-16T12:09:14.770191654+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-16T12:09:14.770249827+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-16T12:09:14.770270182+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend Downlink Nas Transport
2025-06-16T12:09:14.770391924+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-06-16T12:09:14.771415489+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.771602218+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.771784135+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.771793665+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.771795788+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.771797765+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.771817605+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.771820291+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.771822350+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.772156629+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.772318742+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.772509893+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:09:14.772523799+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.772526777+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.772529318+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.772541392+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.772718439+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.772759686+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.773329003+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:14.773347362+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:14.773374303+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-16T12:09:14.773378298+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-16T12:09:14.773381098+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-06-16T12:09:14.774031605+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-16T12:09:14.774043289+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3539343331323363326332666461346465306130623535303238373261323730
Xres*: 3539343331323363326332666461346465306130623535303238373261323730
2025-06-16T12:09:14.774047045+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-06-16T12:09:14.774720340+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-16T12:09:14.776201499+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-16T12:09:14.776282117+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-16T12:09:14.776364137+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-16T12:09:14.776491819+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-16T12:09:14.776526394+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-16T12:09:14.776549256+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend Downlink Nas Transport
2025-06-16T12:09:14.776700353+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-06-16T12:09:14.777757299+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.777805968+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.777816315+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.777824415+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.777975872+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.777990380+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.778338349+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.778379509+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.778527354+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.778578532+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.778750400+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.778777301+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:09:14.778792061+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.778799628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.779033739+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.779363506+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.779631445+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.779675344+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.780315798+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:14.780375406+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:14.780412644+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-16T12:09:14.780418497+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-16T12:09:14.780422339+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-06-16T12:09:14.780442000+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-16T12:09:14.780487523+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-16T12:09:14.780793218+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.797846118+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:09:14.799988492+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-16T12:09:14.800695869+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:09:14.801365268+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-16T12:09:14.801507814+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:14.801836044+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.809567582+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:09:14.812414530+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-16T12:09:14.814609923+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-16T12:09:14.815174948+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-16T12:09:14.815801494+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-16T12:09:14.817064267+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:09:14.817983626+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:14.818540565+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:14.819072927+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-16T12:09:14.820409628+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-16T12:09:14.821044407+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:14.821444741+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-16T12:09:14.822278649+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-16T12:09:14.822577869+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-16T12:09:14.823392330+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-16T12:09:14.823986540+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-16T12:09:14.824109031+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-16T12:09:14.825306002+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.833105954+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-16T12:09:14.836645467+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-06-16T12:09:14.837226941+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.841339806+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-16T12:09:14.843341961+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-16T12:09:14.843928584+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:14.855859590+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-16T12:09:14.875233357+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-16T12:09:14.875429490+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-06-16T12:09:14.875546898+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-16T12:09:14.876466355+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-16T12:09:14.877163963+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-16T12:09:14.877356585+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend Initial Context Setup Request
2025-06-16T12:09:14.877576973+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-06-16T12:09:14.878799830+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.879197313+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.879526614+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.879855153+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.880185624+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.880516746+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.881133806+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.881209786+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.881493080+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.881555677+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:09:14.881886734+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.882151487+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:09:14.882517127+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:09:14.882599600+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.882607767+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.883185178+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.883526239+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.883858096+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.884201306+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.885602910+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.885677668+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.885686802+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885690527+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.885692489+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.885694730+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.885715155+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.885718227+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885721805+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885725206+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885791548+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885798146+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885801082+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.885803059+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-16T12:09:14.886327995+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle InitialContextSetupResponse
2025-06-16T12:09:14.886596110+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:09:14.886823379+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x0f9e9143
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc0006eafe0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000d53b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000aa0540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc0006d4e80)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc0006eb000)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc0006eb020)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc0006d4ebb)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc0006d4ed3)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc0006d4ed9)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-16T12:09:14.888966880+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:14.889008395+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:14.889074768+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-16T12:09:14.889098920+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-16T12:09:14.889119284+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-06-16T12:09:14.889479792+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-16T12:09:14.889903515+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend Downlink Nas Transport
2025-06-16T12:09:14.890068731+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-16T12:09:15.391066015+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:15.391124714+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:15.391299323+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:09:15.391337480+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:09:15.391349685+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:09:15.391373651+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:09:15.392140798+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.396222206+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-16T12:09:15.397737899+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:09:15.397952937+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:09:15.398202095+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:09:15.398779264+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:09:15.399809075+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.405966388+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:15.408855919+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:09:15.409048509+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:09:15.409129452+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:09:15.409135558+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:09:15.410303176+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.416791065+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:09:15.418991782+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:09:15.419971550+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:09:15.419987497+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:09:15.421457391+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.421772053+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.421941057+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:09:15+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0005b0340 0xc0005b0360 0xc0005b0380]
2025-06-16T12:09:15.421986367+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:09:15.421998137+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0005b0340 0xc0005b0360 0xc0005b0380]}
2025-06-16T12:09:15.422021956+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:09:15.422537693+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.424320035+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&target-nf-type=AMF |  |
2025-06-16T12:09:15.424824049+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:09:15.424956839+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-16T12:09:15.424986501+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:09:15.424996849+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-16T12:09:15.425007656+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:09:15.425214701+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.437832151+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:09:15.439337858+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:09:15.439394078+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:09:15.441283003+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:09:15.442695621+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.446716999+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:09:15.446945487+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:09:15.447949110+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:09:15.448946319+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.449671641+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:09:15.450251855+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:09:15.450960857+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:09:15.451778091+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.454990553+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:09:15.455488245+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:09:15.457231172+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:09:15.457303332+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:09:15.457401554+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:09:15.457451851+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:09:15.457458020+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:09:15.457710867+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:09:15.457931043+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:09:15.458314704+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:09:15.458349149+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:15.458386800+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:09:15.458400177+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:15.458434713+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:09:15.458670474+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:09:15.458792550+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:09:15.459266168+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-16T12:09:15.469523575+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:09:15.470711022+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:09:15.470788714+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend PDU Session Resource Setup Request
2025-06-16T12:09:15.470997947+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:09:15.473258683+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:15.473515322+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.473563009+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-16T12:09:15.473617885+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.473620442+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.473622412+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.473664800+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.473915288+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.473973349+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.473983486+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.473987048+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.473989793+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.473993087+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-16T12:09:15.474333312+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.474407221+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:15.474415341+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.474418897+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.474421313+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:15.474432380+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.474434597+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.474436426+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.474450381+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.474452324+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.474454026+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xab4ef9b9
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000af4460)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c241e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c82410)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000baa9c4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc00068a120)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000aec080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000baaa20)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000baaa40)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000af4500)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000af45c0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000af4660)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:09:15.574706604+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:09:15.574796230+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:09:15.575388754+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:09:15.578920186+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:09:15.579350374+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:be2b58d9-c67b-453c-a7ff-52748876fa71/modify |  |
2025-06-16T12:09:15.580257319+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:15.580336468+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:15.580371263+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:09:15.580376035+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:09:15.580379356+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:09:15.580385404+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:09:15.581510194+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:09:15.581561003+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:09:15.581577425+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:09:15.581635963+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:09:15.582510775+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.588051357+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:15.589334161+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:09:15.589421721+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:09:15.589452148+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:09:15.589534403+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:09:15.589859442+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.599150186+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:09:15.600429388+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:09:15.601248672+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:09:15.601309772+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:09:15.602590214+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.603471778+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.603971186+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:09:15+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000ee0b40 0xc000ee0b60 0xc000ee0b80]
2025-06-16T12:09:15.603990143+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:09:15.603994226+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000ee0b40 0xc000ee0b60 0xc000ee0b80]}
2025-06-16T12:09:15.603996563+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:09:15.604510186+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.605825921+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&target-nf-type=AMF |  |
2025-06-16T12:09:15.606155218+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:09:15.606210087+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-16T12:09:15.606213277+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:09:15.606215823+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-16T12:09:15.606220313+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:09:15.606746200+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.613552204+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:09:15.615493533+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:09:15.615566873+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:09:15.616228878+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:09:15.622831543+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.625626080+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:09:15.625797174+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:09:15.625972615+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:09:15.626499818+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.627093987+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:09:15.627334575+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:09:15.627961787+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:09:15.629710697+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.633776580+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:09:15.634218819+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:09:15.635172773+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:09:15.635321000+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:09:15.635330118+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:09:15.635332819+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:09:15.635334830+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:09:15.635350448+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:09:15.635454979+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:09:15.635898074+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:09:15.636116877+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:15.636343037+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:09:15.636390595+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:15.636583578+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:09:15.636689195+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:09:15.636717083+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:09:15.640275757+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-16T12:09:15.645011533+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:09:15.645991578+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:09:15.646038651+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend PDU Session Resource Setup Request
2025-06-16T12:09:15.646406636+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:09:15.648366588+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:15.648407218+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.648411774+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-16T12:09:15.648448152+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.648450897+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.648452691+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.648492426+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.648499055+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.648503699+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.648506009+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.648508555+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.648510829+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.648512845+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:09:15.648695336+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.648699964+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:15.648704696+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.648706826+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.648708908+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:15.648719029+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.648721077+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.648722855+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.648733478+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.648735105+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.648736816+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000aba5d03c
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x7e05a6f5f2de729e0c6d2d9669d66a11b1acab3ea36ed42feceb39c947d91d02
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xc10470ab82b8e8d9cf86f2705e80ef140039e567
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000c472dff5
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x8b1c251edcbf3b35871ac82847476f35ed7d15d7b5458f9202d960cee61e8035
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x94eb9292b4c229d789ad97970142f99fdc35d826
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x8f73c7db
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000af5b80)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c244b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c82dc0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00069481c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc00068a2d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000aec780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000694840)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000694850)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000af5ba0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000af5bc0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000af5be0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-06-16T12:09:15.668422197+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
2025-06-16T12:09:15.668782479+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:09:15.669654632+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:09:15.675856310+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:09:15.675914374+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:8247933f-ad19-4915-8c8c-91f5fbef5af3/modify |  |
2025-06-16T12:09:15.871113287+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:15.871178287+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:15.871219945+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:09:15.871226332+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:09:15.871229585+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:09:15.871235864+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:09:15.871798322+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:09:15.871952366+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:09:15.871970988+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:09:15.872261776+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:09:15.872826883+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.878393364+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:15.879639152+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:09:15.879760811+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:09:15.879855940+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:09:15.879898937+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:09:15.880348668+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.887123669+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:09:15.888565649+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:09:15.889200116+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:09:15.889263079+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:09:15.890564966+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.890783096+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.891021540+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:09:15+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000c98780 0xc000c987a0 0xc000c987c0]
2025-06-16T12:09:15.891100069+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:09:15.891104463+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000c98780 0xc000c987a0 0xc000c987c0]}
2025-06-16T12:09:15.891106558+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:09:15.891572228+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.892668747+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&target-nf-type=AMF |  |
2025-06-16T12:09:15.893105399+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:09:15.893186928+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-16T12:09:15.893203279+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:09:15.893212863+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-16T12:09:15.893227246+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:09:15.893448101+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.900409245+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:09:15.901231995+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:09:15.901315933+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:09:15.902626355+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:09:15.904440891+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:15.909643576+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:09:15.910074782+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:09:15.910477020+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:09:15.911036976+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.911892212+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:09:15.912063533+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:09:15.912545787+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:09:15.913861266+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:15.916917740+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:09:15.917551661+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:09:15.918845929+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:09:15.918922219+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:09:15.918930230+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:09:15.918932914+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:09:15.918935015+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:09:15.918952702+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:09:15.919102238+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:09:15.919259325+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:09:15.919268815+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:15.919293617+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:09:15.919297204+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:15.919317471+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:09:15.919420483+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:09:15.919500733+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:09:15.922081974+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-16T12:09:15.932671695+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:09:15.936367503+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:09:15.936453528+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend PDU Session Resource Setup Request
2025-06-16T12:09:15.936605270+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:09:15.939012212+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:15.939085289+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.939095691+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-16T12:09:15.939126113+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.939128250+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.939131077+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.939158983+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.939222071+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939230390+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939238063+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939240921+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939244994+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939247200+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:09:15.939282757+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.939286107+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:15.939288838+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.939291003+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.939293299+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:15.939300363+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.939302237+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.939303970+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.939317515+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.939319347+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.939320931+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000083e3136e
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xd96b0e50c089df9e9c612927a865c96f806b400cd2f3147a6fad8d2ff1c51348
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xec8b6767a54e83e94d4ab55416b6cdaccd69eb04
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000003a0096cc
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x40d2bb97348051dfea46bb68437621d90ff79c857c754689310b6fd944aecf61
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x942a210e662c8d7f8a8e24b25176a8136f724bfa
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x30ce63df
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006808e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c24780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c83770)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0007c0cec)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc00068a480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000aece80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0007c0d20)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0007c0d30)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000680900)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000680920)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000680940)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:09:16.041355228+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:09:16.041521042+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:09:16.042345094+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:09:16.045062245+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:09:16.045164177+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:6f970646-8393-43ce-adef-0151752799cc/modify |  |
2025-06-16T12:09:16.045541331+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport
2025-06-16T12:09:16.045593069+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:09:16.045639844+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:09:16.045644414+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:09:16.045647983+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:09:16.045654149+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:09:16.046422809+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:09:16.046513153+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:09:16.046531168+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:09:16.046820666+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:09:16.047383047+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:16.054037255+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:09:16.056104116+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:09:16.056362883+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:09:16.056393203+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:09:16.056396284+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:09:16.056942375+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:16.066557559+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:09:16.067402338+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:09:16.067962658+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:09:16.067988862+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:09:16.069343294+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:16.069471820+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:16.069529524+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:09:16+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001816960 0xc001816980 0xc0018169a0]
2025-06-16T12:09:16.069555828+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:09:16.069562114+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001816960 0xc001816980 0xc0018169a0]}
2025-06-16T12:09:16.069564523+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:09:16.069955363+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:16.070967077+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3fe3ec9d-51cf-4651-b65a-8aa9a575b068&target-nf-type=AMF |  |
2025-06-16T12:09:16.071496988+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:09:16.071588147+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-16T12:09:16.071594579+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:09:16.071597676+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-16T12:09:16.071602975+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:09:16.071885182+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:16.079728668+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:09:16.080543896+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:09:16.080608217+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:09:16.081649489+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:09:16.083889423+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:09:16.103785577+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:09:16.104551770+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:09:16.104948710+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:09:16.105896540+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:16.107225210+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:09:16.107465750+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:09:16.108358251+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:09:16.110788947+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:09:16.113566985+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:09:16.114288548+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:09:16.115539924+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:09:16.115586930+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:09:16.115603706+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:09:16.115613255+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:09:16.115620627+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:09:16.115642494+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:09:16.115790242+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:09:16.115992326+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:09:16.116029402+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:16.116066274+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:09:16.116079452+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:09:16.116109455+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:09:16.116154085+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:09:16.116232652+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:09:16.116531925+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-16T12:09:16.123359318+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:09:16.124526309+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:09:16.124590221+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mSend PDU Session Resource Setup Request
2025-06-16T12:09:16.124749731+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:09:16.125654018+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:16.125730181+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:16.125737661+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-16T12:09:16.125779462+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:16.125782246+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.125784326+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:16.125811359+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:16.125901398+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.125911082+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.125913787+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.125916862+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.125919290+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.126553245+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:09:16.126781278+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.126785675+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:16.126788907+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:16.126791242+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:16.126793718+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:16.126813408+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:16.126816693+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.126818532+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:16.126831383+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:16.126833242+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.126949867+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000d7aa200c
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x66f4bd98ce8e85c3ef32ad015a6679a5206fa3da7b3d1d1e34c744d6dbee9437
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x54cbc9ace436ee67089a48eeda4c451e3d2b43bc
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000007cefb808
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x83fe5231143627a4a1982aaad0dda07dead5f1da6610036714043a17b3ba1b0e
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xf15b5cb97112e912fd55d30c0c6f0007c46dcb3c
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x84ca0ec5
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000681720)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c24a50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000af0140)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  03 02 00 06 21 12 01 01  ff 02 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000612dac)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc00068a630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000aede00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 03 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000612dd0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000612de0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000681740)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000681760)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000681780)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-06-16T12:09:16.138126912+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-16T12:09:16.138194878+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:50497] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:09:16.140155540+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:09:16.145286612+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:09:16.145342556+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:4c68cd84-408f-4140-b07e-26492fac6275/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.180616ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=506.762µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=683.877µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=1.224702ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=2.222896ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 506.762µs/1.16377ms/2.222896ms/597.946µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.79s)
PASS
ok  	test	9.832s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.42s)
PASS
ok  	test	28.286s

--- STDERR ---
2025-06-16T12:08:55.894871455+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:08:55.898768711+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-16T12:08:55.900386384+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:08:55.900488752+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc000528b40)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0004865d0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc000486ae0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0004a40c0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-16T12:08:55.900664467+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:08:55.900716697+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-16T12:08:55.900740827+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-16T12:08:55.900865812+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-16T12:08:55.900919115+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-16T12:08:55.908195765+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-16T12:08:55.908322618+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-16T12:08:55.908504271+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-16T12:08:55.908577962+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-16T12:08:55.908601933+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-16T12:08:55.908613816+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-16T12:09:01.222989095+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-16T12:09:01.223086355+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-16T12:09:08.036363636+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:09:08.036958576+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-16T12:09:08.037307716+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-16T12:09:08.037356377+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-16T12:09:08.037362105+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-16T12:09:08.037432427+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-16T12:09:08.037481175+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-16T12:09:08.041209244+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-16T12:09:08.042261009+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-16T12:09:08.043616879+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-16T12:09:08.046814234+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-16T12:09:08.047372924+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-16T12:09:08.049926614+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-16T12:09:08.050116115+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-16T12:09:08.051556676+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-16T12:09:08.051605880+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-16T12:09:14.734148684+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.734269028+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.734274770+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.734281254+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.734284371+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.734287689+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-16T12:09:14.742294032+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.742370202+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.742377149+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:14.742380811+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:09:14.742383056+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:14.742385167+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:14.742387157+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:14.742400892+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.742402779+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:09:14.742418348+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.742420256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.742421941+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:14.742425176+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:09:14.742426926+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:14.742428709+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:14.742430446+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:14.747144964+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.747163282+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.747169416+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.747173107+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:09:14.747180534+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.747183509+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.747187789+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.747225608+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.747229752+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.747236934+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.747244395+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.747248224+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.747250970+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-16T12:09:14.747252767+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.747254434+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:09:14.747262115+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-16T12:09:14.747267677+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:09:14.747270337+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:09:14.748630280+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.748681600+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:09:14.748688077+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-16T12:09:14.748694808+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:09:14.748700396+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.748702620+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:09:14.748714084+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.748716208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.748719178+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.748745493+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.748795628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.748800606+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.750651649+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.750690095+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.750699831+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750709425+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:09:14.750718254+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.750835438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.750849025+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.750871223+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.750879679+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750886761+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.750894802+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:09:14.750968515+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.751033600+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:14.751052949+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-16T12:09:14.751107210+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.751135061+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-16T12:09:14.770909652+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:09:14.771016296+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:14.771025111+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:09:14.771033273+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.771035832+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.771037810+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:09:14.771048666+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.771050749+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.771052672+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.771062778+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.771064450+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.771066072+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.773124366+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.773141556+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.773144814+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.773147996+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:09:14.773152335+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.773154431+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.773156167+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.773168245+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.773170447+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.773172401+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.773175230+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:09:14.773180579+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.773183658+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:14.776792084+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:09:14.776811041+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:14.776814525+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:09:14.776818455+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.776820520+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.776822682+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:09:14.776831863+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.776879028+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.776884548+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.776893839+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.776895598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.776897465+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.780015168+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.780073457+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.780079817+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.780082827+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:09:14.780088468+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.780090379+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.780092503+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.780114959+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.780117335+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.780119773+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.780122793+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:09:14.780128756+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.780132349+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:14.877916693+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-16T12:09:14.878019371+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:14.878039819+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-16T12:09:14.878047234+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.878050062+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:09:14.878060680+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.878062851+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.878064879+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.878073647+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.878075460+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.878077149+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.884817641+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:14.884845796+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.884850160+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.884853997+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:09:14.884860556+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.884863116+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.884864913+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.884891731+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:14.884896530+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.884900265+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:14.884937402+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 1934040279, Outbound SPI: 2650127427
2025-06-16T12:09:14.884958104+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.884960264+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:09:14.884962391+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:09:14.884969599+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:14.884976410+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:14.884978866+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:14.884981225+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:14.884983333+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:14.884989185+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.884992143+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.884993886+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.885208832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:14.885214108+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:14.885216052+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:14.885367355+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.885379155+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.885383461+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:14.885392492+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:09:14.885406487+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.885409292+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-16T12:09:14.886890161+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:14.887540112+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:09:14.888374024+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:14.890262783+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:09:15.390741035+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:15.459370498+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:09:15.459391906+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-16T12:09:15.463133808+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-16T12:09:15.463156601+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-16T12:09:15.466462498+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-16T12:09:15.471374143+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:09:15.471731430+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:15.471933135+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:09:15.472151727+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.472159302+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:15.472163018+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:15.472166647+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.472410500+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.472469762+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:15.472476340+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:15.472487426+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.472489787+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.472491971+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.472712989+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.472771041+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.472777437+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.474715036+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:15.474737497+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.474740944+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.474744229+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:09:15.474747587+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17882219281973971282
2025-06-16T12:09:15.474751863+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.474753954+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.474757883+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.474786161+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.474983374+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.474991683+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.474995283+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.475002247+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.475014618+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.475065476+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:15.475071654+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:09:15.475197535+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.475370309+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.475410279+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:09:15.477762720+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:15.575965887+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:09:15.637111807+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:09:15.637920759+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-16T12:09:15.642872711+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-16T12:09:15.643756153+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-16T12:09:15.647035809+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:09:15.647376724+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:15.647386850+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:09:15.647409152+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.647411672+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:15.647418159+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:15.647421666+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.647613036+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.647657576+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:15.647664147+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:15.647676608+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.647680372+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.647683274+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.647714790+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.647978094+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.648036504+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.649566026+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:15.649637213+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.649648335+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.649657213+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:09:15.649664436+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17882219281973971282
2025-06-16T12:09:15.649673227+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.649678775+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.649685864+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.649771923+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.649782226+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.649792247+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.649799393+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.649806378+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.649822256+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.649832741+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:15.649839574+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:09:15.664042517+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-16T12:09:15.666366950+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.666591076+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.666634920+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:09:15.670374638+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:09:15.675434718+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:15.920032846+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:09:15.920088921+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-16T12:09:15.922536987+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-16T12:09:15.922811161+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-16T12:09:15.937555794+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:09:15.937656915+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:15.937667211+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:09:15.937686600+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.937689234+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:15.937692773+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:15.937695321+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.937698113+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:15.937700360+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:15.937702452+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:15.938374046+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.938385380+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.938387835+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.938409209+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.938413061+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.938414919+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.939650503+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:15.939668292+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.939671848+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939675177+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:09:15.939677938+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17882219281973971282
2025-06-16T12:09:15.939682093+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:15.939683916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:15.939685662+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:15.939718229+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:15.939721088+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939724687+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939727528+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939730149+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:15.939737584+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.939761438+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:15.939769077+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:09:15.949992279+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-16T12:09:15.958492886+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.958694586+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:15.958726907+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:09:15.963878820+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:09:16.042757419+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:09:16.117110064+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:09:16.117131243+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-16T12:09:16.119201937+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-16T12:09:16.119792091+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-16T12:09:16.125184586+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:09:16.125286326+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:16.125294583+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:09:16.125312293+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.125322494+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:09:16.125326194+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:09:16.125328708+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:16.125331367+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:09:16.125333713+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:16.125335713+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:09:16.125343979+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:16.125346051+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.125348935+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:16.125363685+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:16.125365531+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.125367240+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:16.127321099+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:09:16.127372393+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:16.127389587+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.127406020+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:09:16.127410101+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17882219281973971282
2025-06-16T12:09:16.127414176+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:09:16.127416203+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:09:16.127417980+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:09:16.127446040+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:09:16.127492159+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.127499718+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.127502953+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.127506038+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:09:16.127559817+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:16.127722136+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:09:16.127728937+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:09:16.133362672+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-16T12:09:16.133990887+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:16.136498867+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:09:16.136891154+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:09:16.141128715+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:09:27.544739488+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-16T12:09:27.544772110+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-16T12:09:27.544984477+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-16T12:09:27.544994486+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-16T12:09:27.545003944+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-16T12:09:27.591108455+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-16T12:09:27.591126540+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-16T12:09:27.591142784+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-16T12:09:27.591157255+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-16T12:09:27.591159967+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-16T12:09:27.591162263+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-16T12:09:28.013768906+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-16T12:09:28.013952521+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-16T12:09:28.014050967+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-16T12:09:28.014269491+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-16T12:09:28.014279960+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-16T12:09:28.014311520+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.64:41399: use of closed network connection
2025-06-16T12:09:28.014361105+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.64:41399: use of closed network connection
2025-06-16T12:09:28.014368103+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-16T12:09:28.014390404+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-16T12:09:28.014394393+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-16T12:09:28.014398508+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-16T12:09:28.014408888+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-16T12:09:28.014413234+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:09:28.014425211+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-16T12:09:28.014490016+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:09:28.014502055+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-16T12:09:28.014702511+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-16T12:09:28.014748284+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-16T12:09:28.014757769+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-16T12:09:28.014761643+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-16T12:09:28.014812348+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-16T12:09:28.014823845+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-16T12:09:28.014832623+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-16T12:09:28.014899525+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-16T12:09:28.014904866+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (192783): No such process
