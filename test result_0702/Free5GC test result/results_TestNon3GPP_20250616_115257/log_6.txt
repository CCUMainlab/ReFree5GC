Run TestCN
os.Args: [/tmp/go-build4267252941/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-16T11:59:16.708477413+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.708589241+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.708596312+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.708605652+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-16T11:59:16.708621481+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-06-16T11:59:16.710020122+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.710237247+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.710249437+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.710757638+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-16T11:59:16.716173551+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.716231646+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.716238263+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.716246187+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-16T11:59:16.716269127+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-16T11:59:16.718211226+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T11:59:16.718592701+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.718785972+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.718793213+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.721571538+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.721681131+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.721692071+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.721704242+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-06-16T11:59:16.721983242+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-16T11:59:16.723173284+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.723276464+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.723285195+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.723290791+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-16T11:59:16.723319127+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-16T11:59:16.723351649+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.723419978+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.723427255+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.723740458+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.723846922+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.723854553+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.723874795+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} a9ce9570-35cd-4a90-abcf-9b0253120a6b ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{a9ce9570-35cd-4a90-abcf-9b0253120a6b nausf-auth 0xc000013f80 http REGISTERED   0xc000013f68  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000cc3040 false false}
2025-06-16T11:59:16.723960597+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-16T11:59:16.724296678+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:16.724382778+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-16T11:59:16.724389629+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:16.724392982+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-16T11:59:16.724421396+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-16T11:59:16.724562620+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-16T11:59:16.724636575+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-16T11:59:16.929199991+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-06-16T11:59:16.929657597+08:00[36m [INFO][AMF][Init] [0mServer started
2025-06-16T11:59:16.929812965+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-16T11:59:16.932024990+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:16.936505815+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:16.937548412+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 58c2a133-b42d-473d-ac8a-a34fdd450be2
2025-06-16T11:59:16.939997712+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/58c2a133-b42d-473d-ac8a-a34fdd450be2 |  |
2025-06-16T11:59:16.940241065+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:16.940251914+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-16T11:59:17.128658930+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-16T11:59:17.129539136+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:17.132785956+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:17.133751007+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 77c6307d-2478-430e-a76b-f94b37fcfdbe
2025-06-16T11:59:17.135342315+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/77c6307d-2478-430e-a76b-f94b37fcfdbe |  |
2025-06-16T11:59:17.135762762+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:17.135816343+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {77c6307d-2478-430e-a76b-f94b37fcfdbe SMF REGISTERED 0 0xc0005a3638 0xc0005a3650 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc0004dfac0 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0005a3590 false false []}
2025-06-16T11:59:17.137538443+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-16T11:59:17.137581848+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-16 11:59:17.137571049 +0800 CST m=+0.469050167]
2025-06-16T11:59:17.137565159+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-16T11:59:17.338800012+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:17.342517712+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:17.343788507+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8b152d87-0c56-4042-a1ff-5cb10100c0e2
2025-06-16T11:59:17.345330755+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8b152d87-0c56-4042-a1ff-5cb10100c0e2 |  |
2025-06-16T11:59:17.345517479+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:17.345680392+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-16T11:59:17.345706035+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-16T11:59:17.345715003+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T11:59:17.345728779+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-16T11:59:17.543220231+08:00[36m [INFO][PCF][Init] [0mServer started
2025-06-16T11:59:17.544694189+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:17.549276512+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:17.550632606+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a61d94fc-ef1d-468e-b8d5-eb362dcb5eb9
2025-06-16T11:59:17.552828301+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a61d94fc-ef1d-468e-b8d5-eb362dcb5eb9 |  |
2025-06-16T11:59:17.552990043+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:17.553054462+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-16T11:59:17.744085489+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-16T11:59:17.744118141+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-16T11:59:17.744658804+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:17.749157342+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:17.749982236+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 066582ea-f6a6-4d0c-8f9f-b8a1fadde162
2025-06-16T11:59:17.752997889+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/066582ea-f6a6-4d0c-8f9f-b8a1fadde162 |  |
2025-06-16T11:59:17.753189949+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:17.753244809+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-16T11:59:17.947518023+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:17.950794462+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:17.951674053+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: d5bcf618-ec23-46d6-8525-c69bc30db196
2025-06-16T11:59:17.952928065+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d5bcf618-ec23-46d6-8525-c69bc30db196 |  |
2025-06-16T11:59:17.958760321+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:17.958914216+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-16T11:59:17.958972591+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-16T11:59:18.138878714+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-16T11:59:18.139977159+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-16T11:59:18.148161883+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-06-16T11:59:18.148894182+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:18.152181244+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:18.153463571+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a9ce9570-35cd-4a90-abcf-9b0253120a6b
2025-06-16T11:59:18.155917811+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a9ce9570-35cd-4a90-abcf-9b0253120a6b |  |
2025-06-16T11:59:18.156236142+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:18.156310558+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-16T11:59:18.348224222+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-16T11:59:18.348877317+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-16T11:59:18.350535430+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T11:59:18.358053142+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T11:59:18.358675517+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6d4e5bbf-7feb-47c6-8116-6daa1b33a763
2025-06-16T11:59:18.358975138+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6d4e5bbf-7feb-47c6-8116-6daa1b33a763 |  |
2025-06-16T11:59:18.359186934+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T11:59:18.359270276+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-16T11:59:24.634448376+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118
2025-06-16T11:59:24.636131434+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118
2025-06-16T11:59:24.636387778+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle NGSetupRequest
2025-06-16T11:59:24.636447364+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mMissing IE PagingDRX
2025-06-16T11:59:24.636496576+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3121295459/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-16T11:59:31.676909650+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.677026441+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.677032818+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:31.677036356+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T11:59:31.677038526+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T11:59:31.677192002+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.677235823+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.677240802+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:31.677243543+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T11:59:31.677245539+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T11:59:31.699041822+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.699153118+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.699165478+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.699181725+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.699185572+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.699188951+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.699190828+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-16T11:59:31.703379524+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.703452094+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T11:59:31.703458268+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:31.703461895+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:31.703464140+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:31.703481652+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.703485412+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.703488501+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.703496199+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.703498015+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.703499817+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.707020051+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.707509591+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.707517304+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.707521068+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.707522913+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.707662770+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.707853696+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.707905447+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.707911965+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.707916062+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.707918697+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.707934163+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-16T11:59:31.707981771+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.707984097+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.707985995+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T11:59:31.707991810+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.707993667+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.707996147+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.708002901+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.708004591+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.708006922+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.708807721+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle InitialUEMessage
2025-06-16T11:59:31.708889688+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-16T11:59:31.708922757+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-16T11:59:31.708961672+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-16T11:59:31.709090681+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-16T11:59:31.709139636+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-16T11:59:31.709147767+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-16T11:59:31.709152116+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-16T11:59:31.709159205+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-16T11:59:31.709162703+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-16T11:59:31.709700657+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.711421841+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-16T11:59:31.712329228+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-16T11:59:31.712402844+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-06-16T11:59:31.712956721+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.716113270+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-16T11:59:31.718685182+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-16T11:59:31.718940982+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-16T11:59:31.718988519+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-16T11:59:31.718994438+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-16T11:59:31.719755936+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.721421701+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-16T11:59:31.722964190+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T11:59:31.725352290+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T11:59:31.725519444+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-16T11:59:31.725813527+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-16T11:59:31.725929485+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-06-16T11:59:31.725938135+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 6134333635326164626264363962636663336164336365396134343536623535
2025-06-16T11:59:31.725979187+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-16T11:59:31.726656326+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-16T11:59:31.726826706+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend Downlink Nas Transport
2025-06-16T11:59:31.727333571+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-06-16T11:59:31.728601406+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.728796610+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.728805383+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.728810084+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.728813280+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.728938131+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.728972491+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.729164855+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.729172721+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.729422722+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.729472155+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.729482567+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T11:59:31.729494008+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.729498758+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.729500728+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.729509900+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.729512608+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.729516587+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.732479449+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport
2025-06-16T11:59:31.732638736+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T11:59:31.732681097+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-16T11:59:31.732692128+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-16T11:59:31.732702173+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-06-16T11:59:31.734138917+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-16T11:59:31.734382464+08:00[36m [INFO][AUSF][5gAka] [0mres*: 6134333635326164626264363962636663336164336365396134343536623535
Xres*: 6134333635326164626264363962636663336164336365396134343536623535
2025-06-16T11:59:31.734390102+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-06-16T11:59:31.735109611+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-16T11:59:31.737545015+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-16T11:59:31.737663002+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-16T11:59:31.737715112+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-16T11:59:31.738103913+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-16T11:59:31.738405986+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-16T11:59:31.738425337+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend Downlink Nas Transport
2025-06-16T11:59:31.738479743+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-06-16T11:59:31.739342442+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.739585155+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.739593034+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.739595814+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.739598123+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.739600030+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.739612690+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.739614967+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.739618464+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.739644822+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.739648086+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.739651639+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T11:59:31.739756345+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.739764644+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.739766738+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.739778276+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.739780153+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.739781879+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.741366018+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport
2025-06-16T11:59:31.741379244+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T11:59:31.741420474+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-16T11:59:31.741478132+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-16T11:59:31.741485310+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-06-16T11:59:31.741503858+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-16T11:59:31.741507781+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-16T11:59:31.742525630+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.748651482+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T11:59:31.750689674+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-16T11:59:31.751982242+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T11:59:31.753187436+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-16T11:59:31.753777652+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T11:59:31.755346836+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.758766021+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T11:59:31.760428623+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-16T11:59:31.762495917+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-16T11:59:31.762627564+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-16T11:59:31.763347790+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-16T11:59:31.763477084+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T11:59:31.763866558+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T11:59:31.764113279+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T11:59:31.764233456+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-16T11:59:31.764482997+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-16T11:59:31.764614290+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T11:59:31.764727811+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-16T11:59:31.764943231+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-16T11:59:31.765075090+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-16T11:59:31.765255670+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-16T11:59:31.765361144+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-16T11:59:31.765442163+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-16T11:59:31.765840093+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.768213192+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-16T11:59:31.769273879+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-06-16T11:59:31.769615406+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.770789427+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-16T11:59:31.771230548+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-16T11:59:31.771393944+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:31.773585433+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-16T11:59:31.774235781+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-16T11:59:31.774273601+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-06-16T11:59:31.774312019+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-16T11:59:31.774462712+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-16T11:59:31.774574948+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-16T11:59:31.774615628+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend Initial Context Setup Request
2025-06-16T11:59:31.775058018+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-06-16T11:59:31.777007484+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.777071640+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.777078542+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.777081617+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.777083601+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777087410+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.777103987+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.777106359+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.777113331+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777115411+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T11:59:31.777132361+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777135815+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T11:59:31.777137789+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T11:59:31.777144124+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.777145814+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777147616+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.777152644+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.777154258+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777155836+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.778053175+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle InitialContextSetupResponse
2025-06-16T11:59:31.778088828+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T11:59:31.778101800+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend Downlink Nas Transport
2025-06-16T11:59:31.778970246+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.779170407+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.779177945+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779378130+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.779382804+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.779385066+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.779546433+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.779559890+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779563880+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779568450+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779573509+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779576760+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779581455+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.779583280+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
Security header type: Integrity Protected And Ciphered
cmac value: 0xdf0f32cf
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000bbf640)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fce10)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc0007ac700)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000bbb0d0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000bbf660)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000bbf680)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000bbb10b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000bbb1a3)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000bbb1a9)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-16T11:59:31.793206737+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport
2025-06-16T11:59:31.793336908+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T11:59:31.793439922+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-16T11:59:31.793460738+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-16T11:59:31.793472706+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-06-16T11:59:31.793805059+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-16T11:59:31.793997794+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend Downlink Nas Transport
2025-06-16T11:59:31.794383483+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-16T11:59:32.289304407+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport
2025-06-16T11:59:32.289364735+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T11:59:32.289415799+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T11:59:32.289429005+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T11:59:32.289438775+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T11:59:32.289451954+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T11:59:32.290089696+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.292382239+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-16T11:59:32.293293875+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T11:59:32.293338751+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T11:59:32.293528349+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=58c2a133-b42d-473d-ac8a-a34fdd450be2&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T11:59:32.293661346+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T11:59:32.293754891+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.297286821+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T11:59:32.299078185+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T11:59:32.299193692+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T11:59:32.299434419+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T11:59:32.299460508+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T11:59:32.327514326+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.330770698+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T11:59:32.331139291+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T11:59:32.331988026+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T11:59:32.332060968+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T11:59:32.333168130+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T11:59:32.333506840+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T11:59:32.333722468+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T11:59:32+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0005ccb00 0xc0005ccb20 0xc0005ccb40]
2025-06-16T11:59:32.333773077+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T11:59:32.333788234+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0005ccb00 0xc0005ccb20 0xc0005ccb40]}
2025-06-16T11:59:32.333798158+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T11:59:32.336561983+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.338490882+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=58c2a133-b42d-473d-ac8a-a34fdd450be2&target-nf-type=AMF |  |
2025-06-16T11:59:32.338830809+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T11:59:32.338951211+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-16T11:59:32.338996377+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T11:59:32.339002513+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-16T11:59:32.339007683+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T11:59:32.339263792+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.343248078+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T11:59:32.343598581+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T11:59:32.343670764+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T11:59:32.344386929+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T11:59:32.346442395+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T11:59:32.351166733+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T11:59:32.351504105+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T11:59:32.351867351+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T11:59:32.352510146+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.353336158+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T11:59:32.353799177+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T11:59:32.354672710+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T11:59:32.355780909+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T11:59:32.357300706+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T11:59:32.357642708+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T11:59:32.359097959+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T11:59:32.359149203+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T11:59:32.359181025+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T11:59:32.359192850+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T11:59:32.359200443+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T11:59:32.359448767+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T11:59:32.359742243+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T11:59:32.359781150+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-16T11:59:32.359812300+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T11:59:32.359863798+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T11:59:32.359893702+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T11:59:32.359897175+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T11:59:32.359959475+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T11:59:32.360064434+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T11:59:32.360153355+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T11:59:32.360492714+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-16T11:59:32.368181157+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T11:59:32.369706994+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T11:59:32.369733593+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend PDU Session Resource Setup Request
2025-06-16T11:59:32.369919855+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T11:59:32.371162275+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:32.371221753+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:32.371227998+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-16T11:59:32.371298869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:32.371487971+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.371492725+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:32.371521473+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:32.371525289+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.371530260+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.371533091+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.371535881+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.371538042+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.371540474+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 2 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-16T11:59:32.372054403+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.372060347+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:32.372063364+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:32.372065998+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:32.372067943+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T11:59:32.372074524+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:32.372076276+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.372077903+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:32.372102064+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:32.372328613+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.372365920+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:32.474887893+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T11:59:32.474928999+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T11:59:32.475742077+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T11:59:32.479258347+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T11:59:32.479376047+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:41693d37-5e3c-4db7-9286-55bbfa7d702b/modify |  |
2025-06-16T12:00:02.365433977+08:00[36m [INFO][SMF][Charging] [0mbuild MultiUnitUsageFromUsageReport
2025-06-16T12:00:02.365510256+08:00[36m [INFO][SMF][Charging] [0mNo report need to be charged
2025-06-16T12:00:32.375701255+08:00[36m [INFO][SMF][Charging] [0mbuild MultiUnitUsageFromUsageReport
2025-06-16T12:00:32.375786248+08:00[36m [INFO][SMF][Charging] [0mNo report need to be charged
2025-06-16T12:00:33.841109302+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UEContextReleaseRequest
2025-06-16T12:00:33.841435414+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UEContextReleaseRequest (RAN UE NGAP ID: 0)
2025-06-16T12:00:33.841555331+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mCause RadioNetwork[21]
2025-06-16T12:00:33.841574059+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mUe Context in GMM-Registered
2025-06-16T12:00:33.842436122+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:00:33.842677811+08:00[33m [WARN][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mUnexpected state, expect: [InActivePending], actual:[Active]
2025-06-16T12:00:33.842702428+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Modification Request
2025-06-16T12:00:33.845684441+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Response
2025-06-16T12:00:33.845781805+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Modification Request
2025-06-16T12:00:33.849907209+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Response
2025-06-16T12:00:33.849996052+08:00[36m [INFO][SMF][Charging] [0mbuild MultiUnitUsageFromUsageReport
2025-06-16T12:00:33.850012640+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:00:33.850774367+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataUpdate
2025-06-16T12:00:33.850847472+08:00[36m [INFO][CHF][ChargingPost] [0mIn BuildConvergedChargingDataUpdateResopone
2025-06-16T12:00:33.850858805+08:00[36m [INFO][CHF][ChargingPost] [0mCredit Control are not required for rating group: 2
2025-06-16T12:00:33.850861566+08:00[36m [INFO][CHF][ChargingPost] [0mCredit Control are not required for rating group: 1
2025-06-16T12:00:33.851256270+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:00:33.851344244+08:00[36m [INFO][CHF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata/imsi-2089300007487SMF0/update |  |
2025-06-16T12:00:33.851474594+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Update] successfully
2025-06-16T12:00:33.851481692+08:00[36m [INFO][SMF][Charging] [0mDo not have urr that need to update charging information
2025-06-16T12:00:33.855430155+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:00:33.855622721+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:41693d37-5e3c-4db7-9286-55bbfa7d702b/modify |  |
2025-06-16T12:00:33.855946729+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mSend UE Context Release Command
    non3gpp_test.go:1792: Read NAS Message Fail:EOF
2025-06-16T12:00:33.860409942+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UEContextReleaseComplete
2025-06-16T12:00:33.860504385+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mHandle UEContextReleaseComplete (RAN UE NGAP ID: 0)
2025-06-16T12:00:33.860537874+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mRelease Ue Context in GMM-Registered
2025-06-16T12:00:33.865027926+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:00:33.865189603+08:00[33m [WARN][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mUnexpected state, expect: [InActivePending], actual:[Active]
2025-06-16T12:00:33.865214651+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Modification Request
2025-06-16T12:00:33.867356996+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Response
2025-06-16T12:00:33.867501005+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Modification Request
2025-06-16T12:00:33.869951485+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Response
2025-06-16T12:00:33.870366358+08:00[36m [INFO][SMF][Charging] [0mbuild MultiUnitUsageFromUsageReport
2025-06-16T12:00:33.870440796+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:00:33.872283108+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataUpdate
2025-06-16T12:00:33.872451796+08:00[36m [INFO][CHF][ChargingPost] [0mIn BuildConvergedChargingDataUpdateResopone
2025-06-16T12:00:33.872462959+08:00[36m [INFO][CHF][ChargingPost] [0mCredit Control are not required for rating group: 1
2025-06-16T12:00:33.873299781+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:00:33.873979014+08:00[36m [INFO][CHF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata/imsi-2089300007487SMF0/update |  |
2025-06-16T12:00:33.877919414+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Update] successfully
2025-06-16T12:00:33.877938059+08:00[36m [INFO][SMF][Charging] [0mDo not have urr that need to update charging information
2025-06-16T12:00:33.880762771+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:00:33.880849097+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:41693d37-5e3c-4db7-9286-55bbfa7d702b/modify |  |
2025-06-16T12:00:33.881332616+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47118] [0mRelease UE[imsi-2089300007487] Context : N2 Connection Release
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- FAIL: TestNon3GPPUE (62.23s)
FAIL
exit status 1
FAIL	test	62.319s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (77.76s)
PASS
ok  	test	80.658s

--- STDERR ---
2025-06-16T11:59:12.362634959+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T11:59:12.362896605+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-16T11:59:12.363603523+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T11:59:12.363735383+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc00051a780)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc00044d7a0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc00044d950)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000515e20)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-16T11:59:12.363746725+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T11:59:12.363754342+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-16T11:59:12.363759194+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:12.363788767+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-16T11:59:12.363795956+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-16T11:59:12.410198917+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-16T11:59:12.410747665+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-16T11:59:12.411163597+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-16T11:59:12.411999037+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-16T11:59:12.412576229+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-16T11:59:12.413624028+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-16T11:59:18.139612524+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-16T11:59:18.139695478+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-16T11:59:24.622568718+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T11:59:24.624126296+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-16T11:59:24.625129992+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-16T11:59:24.625231861+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-16T11:59:24.625244574+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-16T11:59:24.625434467+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-16T11:59:24.625444754+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-16T11:59:24.632568113+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-16T11:59:24.632647929+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-16T11:59:24.634716143+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-16T11:59:24.638305702+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-16T11:59:24.638557494+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-16T11:59:24.638761798+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-16T11:59:24.638833134+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-16T11:59:24.638836289+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-16T11:59:24.638950322+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-16T11:59:31.677511582+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.677685169+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.677691975+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.677696550+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.677699360+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.677702057+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-16T11:59:31.698191791+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.698449731+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.698464263+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:31.698471552+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T11:59:31.698475220+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T11:59:31.698478358+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:31.698483031+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:31.698502292+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.698505683+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T11:59:31.698530898+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.698532842+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.698534734+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:31.698537151+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T11:59:31.698540583+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T11:59:31.698542524+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:31.698545979+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:31.703640219+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.703656284+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.703659930+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.703663317+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T11:59:31.703669201+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.703933978+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.703940375+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.704078461+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.704085839+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.704088458+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.704092207+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.704094883+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.704097846+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-16T11:59:31.704104723+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.704107247+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T11:59:31.704111679+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-16T11:59:31.704172949+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T11:59:31.704178168+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T11:59:31.705509371+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.705588834+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T11:59:31.705595031+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-16T11:59:31.705597418+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T11:59:31.705599818+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.705601797+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T11:59:31.705620692+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.705624136+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.705639056+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.706514295+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.706602667+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.706609424+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.708298876+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.708311993+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.708314773+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.708317641+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T11:59:31.708321210+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.708323162+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.708324864+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.708341115+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.708343534+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.708345455+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.708349442+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T11:59:31.708354403+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.708379735+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:31.708382201+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-16T11:59:31.708386907+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.708389756+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-16T11:59:31.727638703+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T11:59:31.728236403+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:31.728246798+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T11:59:31.728255510+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.728257908+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.728260121+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T11:59:31.728276856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.728279379+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.728281213+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.728293408+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.728295272+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.728296969+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.730012129+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.731710918+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.731748797+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.731917153+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T11:59:31.731948864+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.731958256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.731965358+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.732114023+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.732140873+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.732150262+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.732159250+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T11:59:31.732179156+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.732193848+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T11:59:31.738889688+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T11:59:31.738925240+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:31.738938635+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T11:59:31.738954976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.738963072+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.738971138+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T11:59:31.738985326+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.738993125+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.739000201+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.739013505+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.739020632+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.739027682+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.740418458+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.740472582+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.740479241+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.740482352+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T11:59:31.740486594+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.740488527+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.740723916+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.740744392+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.740747210+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.740750581+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.740754062+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T11:59:31.741004150+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.741011710+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T11:59:31.776242915+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-16T11:59:31.776520309+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:31.776530164+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-16T11:59:31.776535715+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.776537934+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T11:59:31.776548721+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.776550983+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.776553113+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.776562133+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.776564107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.776565829+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.777367797+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:31.777381618+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.777387158+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.777397885+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T11:59:31.777403203+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.777406110+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777407878+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.777418087+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:31.777420935+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.777429953+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:31.777461475+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 2919747862, Outbound SPI: 2296203143
2025-06-16T11:59:31.777484422+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777486979+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T11:59:31.777489198+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T11:59:31.777491649+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:31.777495101+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:31.777497274+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:31.777499478+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:31.777501452+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:31.777507707+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.777509644+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777511296+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.777667401+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:31.777671571+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:31.777673488+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:31.777804816+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.777812610+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.777816008+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:31.777818533+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T11:59:31.777860897+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.777866782+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-16T11:59:31.778181194+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T11:59:31.785220272+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:31.792170395+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T11:59:31.794564453+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T11:59:32.288740419+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T11:59:32.360866688+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T11:59:32.360920046+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-16T11:59:32.363295616+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-16T11:59:32.363305350+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-16T11:59:32.363559141+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-16T11:59:32.370527153+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T11:59:32.370679045+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:32.370687399+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T11:59:32.370705843+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.370708576+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T11:59:32.370711660+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T11:59:32.370714087+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:32.370716772+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T11:59:32.370718838+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:32.370720704+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T11:59:32.370728296+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:32.370730340+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.370732031+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:32.370751105+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:32.370752917+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.370754559+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:32.372882801+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T11:59:32.372934412+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:32.372940183+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.372943066+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T11:59:32.372945596+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 259899519965154853
2025-06-16T11:59:32.372950184+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T11:59:32.372951959+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T11:59:32.372953749+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T11:59:32.373000257+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T11:59:32.373004474+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.373163596+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.373171234+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.373174128+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T11:59:32.373183741+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:32.373187410+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T11:59:32.373189644+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T11:59:32.373311672+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:32.373577203+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T11:59:32.373811256+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T11:59:32.476226840+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:02.364524475+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_TIMEOUT][{eType:3 lSeid:0 urrid:0 period:30000000000}]
2025-06-16T12:00:02.364885794+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mserveUSAReport
2025-06-16T12:00:02.365797518+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionReportResponse
2025-06-16T12:00:31.838526367+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:00:31.838604033+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:00:32.374970382+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_TIMEOUT][{eType:3 lSeid:0 urrid:0 period:30000000000}]
2025-06-16T12:00:32.375221136+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mserveUSAReport
2025-06-16T12:00:32.376164659+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionReportResponse
2025-06-16T12:00:33.840479219+08:00[31m [ERRO][N3IWF][IKE] [0mUE is down
2025-06-16T12:00:33.840619478+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:00:33.840638262+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send UE Context Release Request
2025-06-16T12:00:33.843209578+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:33.846128428+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:33.852378250+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:33.856435451+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle UE Context Release Command
2025-06-16T12:00:33.856567025+08:00[33m [WARN][N3IWF][NGAP] [0mCause RadioNetwork[21]
2025-06-16T12:00:33.856581651+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send UE Context Release Complete
2025-06-16T12:00:33.857092151+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:00:33.857179619+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKEDeleteRequest event
2025-06-16T12:00:33.857165484+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.59:51823: use of closed network connection
2025-06-16T12:00:33.857183570+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.59:51823: use of closed network connection
2025-06-16T12:00:33.857196633+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:00:33.857196745+08:00[36m [INFO][N3IWF][IKE] [0m[Delete] marshal(): Start marshalling
2025-06-16T12:00:33.857212370+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:00:33.857217220+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:00:33.857220908+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:00:33.857236107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:00:33.857269368+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:00:33.857280830+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:00:33.865702789+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:33.868097505+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:33.878798429+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:00:36.938270418+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-16T12:00:36.938634228+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-16T12:00:36.938728705+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-16T12:00:36.938742242+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-16T12:00:36.938759178+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-16T12:00:36.993175737+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-16T12:00:36.993845427+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-16T12:00:36.993968110+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-16T12:00:36.993985720+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-16T12:00:36.993991583+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-16T12:00:36.993996267+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-16T12:00:37.249471165+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-16T12:00:37.249598366+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-16T12:00:37.249843394+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-16T12:00:37.250120029+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-16T12:00:37.250135246+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-16T12:00:37.250145226+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-16T12:00:37.250171293+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-16T12:00:37.250177364+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-16T12:00:37.250184841+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-16T12:00:37.250200719+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-16T12:00:37.250208182+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:00:37.250220541+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-16T12:00:37.250224306+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:00:37.250230384+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-16T12:00:37.250373939+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-16T12:00:37.250548724+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-16T12:00:37.250558813+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-16T12:00:37.250573960+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-16T12:00:37.250659014+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-16T12:00:37.250664487+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (187861): No such process
