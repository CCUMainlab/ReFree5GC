Run TestCN
os.Args: [/tmp/go-build2312024732/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-16T12:04:34.932198585+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.934287529+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.934316428+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.934343698+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-16T12:04:34.934386278+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
AMF Config failed: Invalid T3555: non zero value required
2025-06-16T12:04:34.936478992+08:00[36m [INFO][AMF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.936500719+08:00[36m [INFO][AMF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.936511735+08:00[36m [INFO][AMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.936697752+08:00[36m [INFO][AMF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-16T12:04:34.940086385+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.940188674+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.940206907+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.940371768+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-16T12:04:34.940418157+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-16T12:04:34.941208880+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:04:34.941377873+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.941397749+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.941412751+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.942730649+08:00[36m [INFO][PCF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.942809807+08:00[36m [INFO][PCF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.942827434+08:00[36m [INFO][PCF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.942842351+08:00[36m [INFO][PCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[PCF initial test configuration]
2025-06-16T12:04:34.943206704+08:00[36m [INFO][PCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-16T12:04:34.944916015+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.945009810+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.945034018+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.945053326+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-16T12:04:34.945103890+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-16T12:04:34.945752393+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.945807774+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.945821513+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.946224188+08:00[36m [INFO][AUSF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.946275970+08:00[36m [INFO][AUSF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.946579921+08:00[36m [INFO][AUSF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.946626467+08:00[36m [INFO][AUSF][Init] [0mausfconfig Info: Version[1.0.3] Description[AUSF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 3888ea8c-709e-4fa5-ba00-f114100e65e3 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{3888ea8c-709e-4fa5-ba00-f114100e65e3 nausf-auth 0xc0005dcf90 http REGISTERED   0xc0005dcf78  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc00065ef00 false false}
2025-06-16T12:04:34.946898428+08:00[36m [INFO][AUSF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-16T12:04:34.947632523+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:34.947675607+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-16T12:04:34.947687412+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:34.947698067+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-16T12:04:34.947729756+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-16T12:04:34.947950332+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-16T12:04:34.947991923+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-16T12:04:35.149447418+08:00[36m [INFO][AMF][Util] [0mamfconfig Info: Version[1.0.9]
2025-06-16T12:04:35.149553589+08:00[36m [INFO][AMF][Init] [0mServer started
2025-06-16T12:04:35.149722181+08:00[36m [INFO][AMF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-16T12:04:35.152632018+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:35.160226532+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:35.162515008+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 836dd53b-d26f-4cdd-9176-c65b5664439e
2025-06-16T12:04:35.166851612+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/836dd53b-d26f-4cdd-9176-c65b5664439e |  |
2025-06-16T12:04:35.167301018+08:00[36m [INFO][AMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:35.167448008+08:00[36m [INFO][AMF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-16T12:04:35.350862698+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-16T12:04:35.354510276+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:35.367646461+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:35.371530921+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: bc4dacbf-3f4a-4b35-b606-fbedb7e7c985
2025-06-16T12:04:35.374776901+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/bc4dacbf-3f4a-4b35-b606-fbedb7e7c985 |  |
2025-06-16T12:04:35.377691301+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:35.378122665+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {bc4dacbf-3f4a-4b35-b606-fbedb7e7c985 SMF REGISTERED 0 0xc0007a2648 0xc0007a2660 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc00053be80 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0007a2570 false false []}
2025-06-16T12:04:35.378846655+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-16T12:04:35.379287337+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-16T12:04:35.379828086+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-16 12:04:35.379410757 +0800 CST m=+0.524853055]
2025-06-16T12:04:35.562950700+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:35.570397395+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:35.571791189+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 0b6b58fc-34c2-4f30-8acb-eb265ff71e0e
2025-06-16T12:04:35.573379599+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/0b6b58fc-34c2-4f30-8acb-eb265ff71e0e |  |
2025-06-16T12:04:35.574019115+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:35.574038142+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-16T12:04:35.574044416+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-16T12:04:35.574050486+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-16T12:04:35.574069816+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-16T12:04:35.774775753+08:00[36m [INFO][PCF][Init] [0mServer started
2025-06-16T12:04:35.777236028+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:35.796828892+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:35.800721486+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a8d4a919-93d0-431a-b79f-df0086fd7a6c
2025-06-16T12:04:35.803324724+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a8d4a919-93d0-431a-b79f-df0086fd7a6c |  |
2025-06-16T12:04:35.804590021+08:00[36m [INFO][PCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:35.804710489+08:00[36m [INFO][PCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-16T12:04:35.975792928+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-16T12:04:35.975864354+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-16T12:04:35.977163368+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:35.983217965+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:35.984934450+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 76a2a7f1-e239-4011-a5e4-29f2d50defbf
2025-06-16T12:04:35.989001926+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/76a2a7f1-e239-4011-a5e4-29f2d50defbf |  |
2025-06-16T12:04:35.989337302+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:35.989351286+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-16T12:04:36.178075642+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:36.185745658+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:36.188152592+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 85e4f2d1-126b-486b-92e3-ca792dc759e0
2025-06-16T12:04:36.189032440+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/85e4f2d1-126b-486b-92e3-ca792dc759e0 |  |
2025-06-16T12:04:36.189359659+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:36.189440109+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-16T12:04:36.189468042+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-16T12:04:36.376612338+08:00[36m [INFO][AUSF][Init] [0mServer started
2025-06-16T12:04:36.377831166+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:36.381515335+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-16T12:04:36.383121077+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-16T12:04:36.384319257+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:36.385949685+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3888ea8c-709e-4fa5-ba00-f114100e65e3
2025-06-16T12:04:36.388685332+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3888ea8c-709e-4fa5-ba00-f114100e65e3 |  |
2025-06-16T12:04:36.388992717+08:00[36m [INFO][AUSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:36.389008031+08:00[36m [INFO][AUSF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-16T12:04:36.577437317+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-16T12:04:36.579025182+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-16T12:04:36.588967107+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-16T12:04:36.598676681+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-16T12:04:36.601152607+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: cd9529fa-ced0-40a6-ade2-f43a4e5da413
2025-06-16T12:04:36.604035318+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/cd9529fa-ced0-40a6-ade2-f43a4e5da413 |  |
2025-06-16T12:04:36.604984730+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-16T12:04:36.605219744+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-16T12:04:42.099126401+08:00[36m [INFO][AMF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176
2025-06-16T12:04:42.099645797+08:00[36m [INFO][AMF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176
2025-06-16T12:04:42.099845024+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle NGSetupRequest
2025-06-16T12:04:42.099852541+08:00[33m [WARN][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mMissing IE PagingDRX
2025-06-16T12:04:42.099871248+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2242121881/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-16T12:04:48.597458469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.597590082+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.597595892+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:48.597601887+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:04:48.597607125+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:48.602405769+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.602447451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.602456190+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:48.602473997+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:04:48.602481456+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:48.607197858+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.607223801+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.607227630+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.607232001+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.607235026+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.607237305+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.607238878+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-16T12:04:48.611051719+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.611132155+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:04:48.611138267+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:48.611141168+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:48.611143181+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:48.611157784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.611160731+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.611162409+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.611169190+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.611170707+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.611172280+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.615663423+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.615708883+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.615718300+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.615727103+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.615735172+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.615741331+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.615805132+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.615813353+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.615820725+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.615827547+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.615834378+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.615840548+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-16T12:04:48.615991829+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.616015280+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.616021928+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:04:48.616031964+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.616038294+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.616050746+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.616061371+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.616067594+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.616073524+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.617006252+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle InitialUEMessage
2025-06-16T12:04:48.617038653+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-16T12:04:48.617062811+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-16T12:04:48.617099587+08:00[36m [INFO][AMF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-16T12:04:48.617156224+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-16T12:04:48.617168999+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-16T12:04:48.617173286+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-16T12:04:48.617176939+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-16T12:04:48.617182451+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-16T12:04:48.617185639+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-16T12:04:48.617695161+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.620217060+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-16T12:04:48.621032840+08:00[36m [INFO][AUSF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-16T12:04:48.621084082+08:00[36m [INFO][AUSF][UeAuth] [0mServing network authorized
2025-06-16T12:04:48.621166666+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.625920747+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-16T12:04:48.626932208+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-16T12:04:48.626960398+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-16T12:04:48.626963828+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-16T12:04:48.626965954+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-16T12:04:48.627604496+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.629557370+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-16T12:04:48.632922922+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:04:48.636231834+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-16T12:04:48.636587707+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-16T12:04:48.636903107+08:00[36m [INFO][AUSF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-16T12:04:48.636951919+08:00[36m [INFO][AUSF][UeAuth] [0mUse 5G AKA auth method
2025-06-16T12:04:48.636960411+08:00[36m [INFO][AUSF][5gAka] [0mXresStar = 3436376330373237653163653132633037306436373936336335343139643230
2025-06-16T12:04:48.637129556+08:00[36m [INFO][AUSF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-16T12:04:48.637234238+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-16T12:04:48.637452432+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend Downlink Nas Transport
2025-06-16T12:04:48.638274138+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStart T3560 timer
2025-06-16T12:04:48.639012311+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.639223140+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.639269564+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.639275087+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.639294225+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.639299315+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.639326167+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.639457470+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.639492214+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.639960668+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.640003579+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.640008868+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:04:48.640015105+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.640016888+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.640018483+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.640023455+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.640024946+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.640026505+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.640656412+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:48.640717227+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:48.640744215+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-16T12:04:48.640747520+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-16T12:04:48.640750354+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mStop T3560 timer
2025-06-16T12:04:48.642037764+08:00[36m [INFO][AUSF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-16T12:04:48.643465313+08:00[36m [INFO][AUSF][5gAka] [0mres*: 3436376330373237653163653132633037306436373936336335343139643230
Xres*: 3436376330373237653163653132633037306436373936336335343139643230
2025-06-16T12:04:48.643470941+08:00[36m [INFO][AUSF][5gAka] [0m5G AKA confirmation succeeded
2025-06-16T12:04:48.644284550+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-16T12:04:48.645198532+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-16T12:04:48.645486814+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-16T12:04:48.645979548+08:00[36m [INFO][AUSF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-16T12:04:48.646572367+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-16T12:04:48.647311916+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-16T12:04:48.647346634+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend Downlink Nas Transport
2025-06-16T12:04:48.647555402+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3560 timer
2025-06-16T12:04:48.648770298+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.648995374+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.649204672+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.649398292+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.649705762+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.649753160+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.649926524+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.650087002+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.650133814+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.650166847+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.650169452+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.650534237+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:04:48.650545265+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.650548233+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.650551862+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.650714797+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.650717858+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.650719629+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.651739894+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:48.651845043+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:48.651905110+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-16T12:04:48.651915162+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-16T12:04:48.651921125+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3560 timer
2025-06-16T12:04:48.652018782+08:00[36m [INFO][AMF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-16T12:04:48.652027800+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-16T12:04:48.652627373+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.656957641+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:04:48.658055324+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-16T12:04:48.658388804+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:04:48.659431480+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-16T12:04:48.659574431+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:48.659945823+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.671608217+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-16T12:04:48.672857737+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-16T12:04:48.675825715+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-16T12:04:48.676261205+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-16T12:04:48.677025917+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-16T12:04:48.677667595+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-16T12:04:48.678317539+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:48.678524914+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:48.678884869+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-16T12:04:48.679686505+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-16T12:04:48.679899226+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:48.680503262+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-16T12:04:48.680976505+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-16T12:04:48.681102263+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-16T12:04:48.681649598+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-16T12:04:48.681810695+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-16T12:04:48.681878265+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-16T12:04:48.682637893+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.687793946+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-16T12:04:48.689654801+08:00[36m [INFO][PCF][AmPol] [0mHandle AM Policy Create Request
2025-06-16T12:04:48.692498045+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.694610969+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-16T12:04:48.696141050+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-16T12:04:48.698005068+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:48.703585865+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-16T12:04:48.704816707+08:00[36m [INFO][AMF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-16T12:04:48.704878103+08:00[36m [INFO][AMF][Comm] [0mnew AMF Status Subscription[1]
2025-06-16T12:04:48.704891147+08:00[36m [INFO][AMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-16T12:04:48.705192430+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-16T12:04:48.705439409+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-16T12:04:48.705502043+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend Initial Context Setup Request
2025-06-16T12:04:48.705733507+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStart T3550 timer
2025-06-16T12:04:48.707126865+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.707180894+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.707186702+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.707189767+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.707191584+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707193448+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.707221413+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.707223613+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.707230575+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707232688+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:04:48.707248079+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707282054+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:04:48.707286625+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:04:48.707292993+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.707294598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707296136+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.707300976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.707302487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707303893+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.708064622+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.708075446+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.708077689+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708080092+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.708082886+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.708089375+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.708167776+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.708173768+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708176016+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708314287+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708321141+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708323372+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708325693+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.708327315+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-16T12:04:48.709380966+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle InitialContextSetupResponse
2025-06-16T12:04:48.709511613+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:04:48.709524404+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x40e05f79
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000ad9600)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013cc30)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000a88540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000b8d6e0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000ad9620)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000ad9700)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 fe dc ba 04 01 11  22 33                    |........"3|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000b8d71b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000b8d733)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 73
        			}),
        			T3502Value: (*nasType.T3502Value)(0xc000b8d739)({
        				Iei: (uint8) 22,
        				Len: (uint8) 1,
        				Octet: (uint8) 44
        			}),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-16T12:04:48.711144774+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:48.711196558+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:48.711227017+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-16T12:04:48.711230724+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-16T12:04:48.711233777+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mStop T3550 timer
2025-06-16T12:04:48.711290283+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-16T12:04:48.711297442+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend Downlink Nas Transport
2025-06-16T12:04:48.711391150+08:00[36m [INFO][AMF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-16T12:04:49.212879403+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:49.212936833+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.212986466+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:04:49.212990559+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:04:49.213010276+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:04:49.213017139+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:04:49.213787161+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.216273705+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-16T12:04:49.217559772+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:04:49.217604057+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:04:49.217700517+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=836dd53b-d26f-4cdd-9176-c65b5664439e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:04:49.217912956+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:04:49.218481984+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.222614171+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:49.224390536+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:04:49.224712172+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:04:49.224760880+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:04:49.224764019+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:04:49.225338497+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.234508730+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:04:49.235241256+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:04:49.236105724+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:04:49.236211087+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:04:49.237835875+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.238121601+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.238498349+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:04:49+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0007f2080 0xc0007f20a0 0xc0007f20c0]
2025-06-16T12:04:49.238514056+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:04:49.238540499+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0007f2080 0xc0007f20a0 0xc0007f20c0]}
2025-06-16T12:04:49.238543677+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:04:49.239158683+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.240557329+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=836dd53b-d26f-4cdd-9176-c65b5664439e&target-nf-type=AMF |  |
2025-06-16T12:04:49.240973370+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:04:49.241095769+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-16T12:04:49.241101786+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:04:49.241104234+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-16T12:04:49.241107882+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:04:49.241251301+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.245675882+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:04:49.246300999+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:04:49.246333887+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:04:49.247088269+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:04:49.248017482+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.254606729+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:04:49.254679185+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:04:49.254827895+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:04:49.255540100+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.255927249+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:04:49.256445955+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:04:49.256911684+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-16T12:04:49.257873681+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.259910620+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:04:49.260115257+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:04:49.261488479+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:04:49.261530750+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:04:49.261543076+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:04:49.261551199+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:04:49.261558294+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:04:49.261677845+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:04:49.262030860+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:04:49.262327671+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:04:49.262376013+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.262406156+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:04:49.262410106+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.262508703+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:04:49.262608569+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:04:49.262722603+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:04:49.263373387+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-16T12:04:49.271782998+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:04:49.272757003+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:04:49.272808033+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend PDU Session Resource Setup Request
2025-06-16T12:04:49.272968432+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:04:49.274118230+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.274341220+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.274351337+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-16T12:04:49.274402734+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.274405212+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.274407547+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.274445925+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.274450660+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.274457362+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.274461705+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.274464988+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.274467937+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.274471145+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-16T12:04:49.274631234+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.274635031+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.274638019+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.274641010+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.274642822+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.274649249+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.274724749+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.274730100+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.274740124+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.274741778+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.274743326+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xf3df2618
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000c38420)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00028c1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c0c500)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000672454)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0004dde60)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00068a080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000672480)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000672490)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000c38440)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000c38460)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000c38480)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:04:49.385710745+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:04:49.385779408+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.386861186+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:04:49.392294371+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:04:49.392582895+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:eace0b2b-7c2e-4824-99d9-94a8c6320cfd/modify |  |
2025-06-16T12:04:49.393106189+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:49.393159837+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.393204688+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:04:49.393211036+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:04:49.393214704+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:04:49.393361954+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:04:49.394567077+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:04:49.394629248+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:04:49.394658324+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=836dd53b-d26f-4cdd-9176-c65b5664439e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:04:49.395011423+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:04:49.395837301+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.399907978+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:49.403786759+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:04:49.403907082+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:04:49.404063952+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:04:49.404091855+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:04:49.404740398+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.409723414+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:04:49.410500551+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:04:49.411097165+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:04:49.411152774+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:04:49.412498717+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.412810282+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.413127259+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:04:49+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0008f1140 0xc0008f1160 0xc0008f1180]
2025-06-16T12:04:49.413169400+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:04:49.413178122+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0008f1140 0xc0008f1160 0xc0008f1180]}
2025-06-16T12:04:49.413185400+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:04:49.413865292+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.415055707+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=836dd53b-d26f-4cdd-9176-c65b5664439e&target-nf-type=AMF |  |
2025-06-16T12:04:49.415203791+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:04:49.415287190+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-16T12:04:49.415293023+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:04:49.415296244+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-16T12:04:49.415300628+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:04:49.415522536+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.427909941+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:04:49.428549750+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:04:49.428927495+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:04:49.429704894+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:04:49.431678318+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.437329228+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:04:49.437534740+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:04:49.437663702+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:04:49.437915605+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.438817658+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:04:49.439182090+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:04:49.439464581+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-16T12:04:49.439695926+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.441497122+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:04:49.441812245+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:04:49.442715277+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:04:49.442754195+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:04:49.442768033+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:04:49.442777249+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:04:49.442785340+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:04:49.442809060+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:04:49.442902232+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:04:49.442988932+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-16T12:04:49.443043939+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:04:49.443099028+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.443133013+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:04:49.443137593+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.443164158+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:04:49.443276523+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:04:49.443373167+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:04:49.443593536+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-16T12:04:49.451168325+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:04:49.452159859+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:04:49.452217987+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend PDU Session Resource Setup Request
2025-06-16T12:04:49.452444038+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:04:49.453253801+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.453289245+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.453294386+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-16T12:04:49.453323806+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.453325738+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.453328005+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.453360124+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.453363627+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453367455+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453369636+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453372004+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453374095+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453376079+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 2 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:04:49.453406949+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.453408866+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.453411540+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.453413460+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.453415540+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.453422492+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.453424233+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.453425730+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.453435356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.453436851+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.453438626+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000b763b2ef
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x89f91f554e4fbd207945361a07b57461d351a63b31687cf0a5d03c9f24e50fb2
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x242d9e71ed6c319b9e52c5651496d7f91d697867
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000ff44a546
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x5e83c8fdca640e3c3fdf4a08ee1441431e6efd13ca29aae1302eb765c2b7f03c
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x9be53c4f814066a22e8a44fd2b6299b1a5acdda7
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x25d37528
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000c39100)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00028c4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c0ceb0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  03 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 02 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000673d6c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006841b0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00068ac00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 03 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000673d90)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000673da0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000c39120)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000c39140)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000c39160)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:04:49.472146057+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:04:49.472175773+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.472979248+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:04:49.476091024+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:04:49.476135673+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:8955cf27-e82a-450c-9edf-49c1f3ae14fa/modify |  |
2025-06-16T12:04:49.674767013+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:49.674963999+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.675002346+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:04:49.675006869+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:04:49.675010051+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:04:49.675016435+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:04:49.675619710+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:04:49.675699862+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:04:49.675716877+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=836dd53b-d26f-4cdd-9176-c65b5664439e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:04:49.675926497+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:04:49.676417229+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.680182327+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:49.681942414+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:04:49.682066525+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:04:49.682273498+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:04:49.682280542+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:04:49.682612007+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.686937999+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:04:49.688201158+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:04:49.689624618+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:04:49.689687331+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:04:49.691775447+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.692085484+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.692484715+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:04:49+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0015801e0 0xc001580200 0xc001580220]
2025-06-16T12:04:49.692531762+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:04:49.692540667+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0015801e0 0xc001580200 0xc001580220]}
2025-06-16T12:04:49.692547714+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:04:49.693627883+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.695029904+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=836dd53b-d26f-4cdd-9176-c65b5664439e&target-nf-type=AMF |  |
2025-06-16T12:04:49.695413079+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:04:49.695527658+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-16T12:04:49.695533866+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:04:49.695536867+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-16T12:04:49.695541119+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:04:49.695600794+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.700878595+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:04:49.701505425+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:04:49.701542495+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:04:49.702176084+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:04:49.703892854+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.708690506+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:04:49.708903236+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:04:49.709030890+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:04:49.709429233+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.710278378+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:04:49.710662695+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:04:49.710785753+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-16T12:04:49.710852708+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.712711766+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:04:49.713054727+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:04:49.714115541+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:04:49.714158926+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:04:49.714172725+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:04:49.714195534+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:04:49.714208271+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:04:49.714227471+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:04:49.714730327+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:04:49.714812111+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:04:49.714858190+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.714904142+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:04:49.714907914+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.714942598+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:04:49.715037356+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:04:49.715311872+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:04:49.715610023+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-16T12:04:49.720138745+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:04:49.720979231+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:04:49.721237517+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend PDU Session Resource Setup Request
2025-06-16T12:04:49.721478046+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:04:49.722351749+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.722406781+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.722412690+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-16T12:04:49.722443292+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.722445404+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.722447481+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.722472779+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.722474993+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.722478962+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.722481098+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.722483449+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.722485484+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.722487348+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:04:49.722529031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.722572798+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.722578863+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.722581760+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.722584324+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.722590409+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.722591974+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.722593497+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.722603857+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.722605424+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.722606964+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000057a1007d
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x4737c1aa04adc5a8938f501d37d731bdbf556ce44cbb23b76faaad81fe486555
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x94defbbcfdc6c343188d5804dab0469951016f55
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000009bc93086
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x8d033f60ef53b63824248573b64a223a4e5b9aaf243f4728775cb793a75bba10
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xda9bcf6f29743fc29d2b2cfab6fb12784a0c42c9
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x37f3017c
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000c39e00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00028c780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000c0d860)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00061874c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000684360)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00068bd80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000618770)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000618780)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000c39e20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000c39e40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000c39e60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-16T12:04:49.822669150+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:04:49.822723706+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.823339126+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-16T12:04:49.827399705+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:04:49.827460632+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:4848388b-2694-47b1-803c-2870cb40e3a6/modify |  |
2025-06-16T12:04:49.827878730+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport
2025-06-16T12:04:49.827928655+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.827958514+08:00[36m [INFO][AMF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-16T12:04:49.827963049+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-16T12:04:49.827966424+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-16T12:04:49.827972581+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-16T12:04:49.829378147+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-16T12:04:49.829621352+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-16T12:04:49.829677036+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=836dd53b-d26f-4cdd-9176-c65b5664439e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-16T12:04:49.830032847+08:00[33m [WARN][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-16T12:04:49.830803690+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.839045866+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-16T12:04:49.840832569+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-16T12:04:49.841045341+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-16T12:04:49.841074437+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-16T12:04:49.841077828+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-16T12:04:49.841639241+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.845700483+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-16T12:04:49.846228214+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-16T12:04:49.847383321+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-16T12:04:49.847445693+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-16T12:04:49.848895617+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.849315522+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.849482244+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-16T12:04:49+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001580340 0xc001580360 0xc001580380]
2025-06-16T12:04:49.849520626+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-16T12:04:49.849533992+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001580340 0xc001580360 0xc001580380]}
2025-06-16T12:04:49.849541478+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-16T12:04:49.850334560+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.851352834+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=836dd53b-d26f-4cdd-9176-c65b5664439e&target-nf-type=AMF |  |
2025-06-16T12:04:49.851486411+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-16T12:04:49.851544581+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-16T12:04:49.851555615+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-16T12:04:49.851563287+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-16T12:04:49.851571870+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:04:49.851624432+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.855961552+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=SMF&target-nf-type=PCF |  |
2025-06-16T12:04:49.856783569+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:04:49.856821394+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:04:49.857481435+08:00[36m [INFO][PCF][SMpolicy] [0mHandle CreateSmPolicy
2025-06-16T12:04:49.859700224+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-16T12:04:49.863070733+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-16T12:04:49.863175190+08:00[36m [INFO][PCF][SMpolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-16T12:04:49.863320316+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-16T12:04:49.887235213+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.888021129+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-16T12:04:49.888186024+08:00[36m [INFO][PCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-16T12:04:49.888628184+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-16T12:04:49.889093190+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-16T12:04:49.892067254+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-16T12:04:49.892317845+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-16T12:04:49.893033140+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-16T12:04:49.893179934+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-16T12:04:49.893200943+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-16T12:04:49.893203270+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-16T12:04:49.893205205+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-16T12:04:49.893218936+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-16T12:04:49.893345043+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-16T12:04:49.893455366+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-16T12:04:49.893503384+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.893532693+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-16T12:04:49.893538182+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-16T12:04:49.893558970+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-16T12:04:49.893658029+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-16T12:04:49.893770407+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-16T12:04:49.894953986+08:00[36m [INFO][AMF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-16T12:04:49.902861715+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-16T12:04:49.903716711+08:00[36m [INFO][AMF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-16T12:04:49.903787668+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mSend PDU Session Resource Setup Request
2025-06-16T12:04:49.904032889+08:00[36m [INFO][AMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-16T12:04:49.906923044+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.907202371+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.907259463+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-16T12:04:49.907291241+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.907293678+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.907295322+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.907319230+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.907330763+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.907336461+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.907341638+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.907458874+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.907503879+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.907509541+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-16T12:04:49.907643469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.907686061+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.907692566+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.907694625+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.907710673+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.907724991+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.907730542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.907732216+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.907742239+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.907743891+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.907745364+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000bc22af89
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x954eed99ef5d3c759e0173d30057e3bd237138ff121353e8cf47f5b2830ce9a0
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xc67e8494b9ce4cff40414a454d79bea2d8b390ff
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000005edcaa85
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x1bc85426c0d66bf77ee456b35e91c7d53a811e0e017e5457d59a8b60d3c35eb6
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x2eaf73834fcf9065758c116ee895bec8c1811db0
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-06-16T12:04:49.912746267+08:00[36m [INFO][AMF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse
2025-06-16T12:04:49.912818560+08:00[36m [INFO][AMF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:41176] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-16T12:04:49.914943750+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xe4a3cb0e
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0000e4b40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00028ca50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0006602d0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00047377c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000684510)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00061cb00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0004737d0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0004737e0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0000e4b60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0000e4b80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0000e4ba0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-16T12:04:49.921480293+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-16T12:04:49.921703006+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:9dca7b53-a5ae-44b8-b825-b988706809a8/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=495.198µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=909.612µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=687.733µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=954.331µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=601.712µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 495.198µs/729.718µs/954.331µs/176.612µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.83s)
PASS
ok  	test	9.866s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (24.12s)
PASS
ok  	test	27.060s

--- STDERR ---
2025-06-16T12:04:29.838350707+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:04:29.838506356+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-16T12:04:29.838790251+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:04:29.838849943+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc00059a690)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000015800)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0000159b0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000597ee0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-16T12:04:29.838857713+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-16T12:04:29.838861699+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-16T12:04:29.838864529+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:29.838949244+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-16T12:04:29.838959201+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-16T12:04:29.847312716+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-16T12:04:29.847524574+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-16T12:04:29.847675594+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-16T12:04:29.847801937+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-16T12:04:29.847975498+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-16T12:04:29.847989834+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-16T12:04:36.382516741+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-16T12:04:36.382679047+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-16T12:04:42.081005559+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-16T12:04:42.082311142+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-16T12:04:42.083253235+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-16T12:04:42.083317706+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-16T12:04:42.083325196+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-16T12:04:42.083394936+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-16T12:04:42.083399113+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-16T12:04:42.092911519+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-16T12:04:42.092999134+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-16T12:04:42.096946436+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-16T12:04:42.097868441+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-16T12:04:42.097997270+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-16T12:04:42.099390325+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-16T12:04:42.100814146+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-16T12:04:42.100904146+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-16T12:04:42.101445617+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-16T12:04:48.597827172+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.597885128+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.597891898+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.597900645+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.597903772+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.597906925+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-16T12:04:48.606899788+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.606954451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.606960034+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:48.606963230+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:04:48.606965331+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:48.606967774+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:48.606969551+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:48.606982228+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.606983942+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:04:48.607000765+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.607013028+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.607014914+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:48.607017115+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-16T12:04:48.607018651+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:48.607028943+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:48.607032252+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:48.611984701+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.613210397+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.613218297+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.613221423+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:04:48.613226581+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.613228330+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.613229996+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.613345059+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.613351652+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.613354107+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.613357525+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.613360256+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.613362974+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-16T12:04:48.613367261+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.613368876+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:04:48.613372817+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-16T12:04:48.613375546+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:04:48.613376991+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-16T12:04:48.615088238+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.615128870+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-16T12:04:48.615134201+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-16T12:04:48.615136870+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:04:48.615142599+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.615144502+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:04:48.615280937+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.615286473+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.615288207+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.615329013+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.615367752+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.615371999+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.616332184+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.616400836+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.616408017+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.616410775+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:04:48.616414363+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.616416067+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.616417638+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.616428514+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.616430673+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.616432506+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.616435052+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:04:48.616476022+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.616507121+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:48.616510909+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-16T12:04:48.616515351+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.616517768+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-16T12:04:48.638110092+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:04:48.638280107+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:48.638290839+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:04:48.638305358+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.638308999+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.638310968+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:04:48.638321204+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.638632517+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.638678408+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.638697840+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.638699766+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.638701277+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.640240529+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.640295425+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.640301653+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.640304403+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:04:48.640330885+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.640332733+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.640334371+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.640343817+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.640346036+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.640347788+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.640350401+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:04:48.640356001+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.640359416+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:48.648217288+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:04:48.648278103+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:48.648284538+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-16T12:04:48.648288780+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.648291935+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.648293820+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-16T12:04:48.648307508+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.648309622+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.648311079+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.648319150+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.648321214+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.648322723+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.650920391+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.650969540+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.650979387+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.650982737+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:04:48.650987235+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.651019807+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.651022737+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.651041908+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.651045445+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.651047226+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.651050271+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-16T12:04:48.651089513+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.651284355+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:48.706275465+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-16T12:04:48.706389495+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:48.706398646+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-16T12:04:48.706403716+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.706405821+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-16T12:04:48.706417590+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.706419519+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.706421354+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.706505819+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.706511621+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.706513283+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.707460503+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:48.707471053+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.707477188+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.707479968+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-16T12:04:48.707485236+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.707486955+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707488449+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.707502386+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:48.707507442+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.707513994+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:48.707544216+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 4136354854, Outbound SPI: 2555049865
2025-06-16T12:04:48.707602874+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707607758+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-16T12:04:48.707609634+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-16T12:04:48.707611749+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:48.707617745+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:48.707620539+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:48.707622609+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:48.707624293+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:48.707629983+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.707640764+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707642721+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.707807478+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:48.707886775+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:48.707892425+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:48.707961539+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.707967808+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.707970632+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:48.707976194+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:04:48.707984921+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.708022887+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-16T12:04:48.709478969+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:48.709835063+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:04:48.710843551+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:48.711775318+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-16T12:04:49.212373042+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:49.263182142+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:04:49.263263000+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-16T12:04:49.267118358+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-16T12:04:49.267186027+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-16T12:04:49.267462093+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-16T12:04:49.273398748+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:04:49.273629307+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.273640208+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:04:49.273668064+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.273671046+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.273675011+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.273680973+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.273684240+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.273687096+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.273689517+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.273701008+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.273703836+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.273709303+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.273728345+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.273786215+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.273792774+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.276247070+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.276340200+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.276349456+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.276370006+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:04:49.276376149+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18288277647611605589
2025-06-16T12:04:49.276381791+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.276384433+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.276388909+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.276431490+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.276678021+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.276739119+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.277113472+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.277342274+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.277818308+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.278498748+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.278506283+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:04:49.280225779+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.281054935+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.281112994+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:04:49.282690077+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:49.387303853+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:04:49.443733192+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:04:49.443796011+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-16T12:04:49.448822248+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-16T12:04:49.449628847+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-16T12:04:49.452523167+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:04:49.452599021+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.452606053+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:04:49.452629224+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.452632759+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.452643634+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.452732723+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.452744561+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.452747624+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.452750469+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.452763404+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.452766727+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.452769274+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.452791005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.452793832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.452796298+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.453624266+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.453661527+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.453665652+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453668931+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:04:49.453672555+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18288277647611605589
2025-06-16T12:04:49.453676601+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.453678355+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.453679965+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.453702576+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.453704931+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453708547+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453710850+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453713457+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.453777182+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.453786093+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.453788486+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:04:49.466833640+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-16T12:04:49.470721998+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.470852300+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.471673875+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:04:49.471901262+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:49.473556451+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:04:49.716040702+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:04:49.716109306+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-16T12:04:49.718048101+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-16T12:04:49.718291879+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-16T12:04:49.721729968+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:04:49.721774236+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.721778396+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:04:49.721794412+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.721803472+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.721806409+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.721808547+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.721810656+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.721813592+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.721815459+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.721824031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.721825936+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.721828169+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.721841026+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.721880228+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.721885181+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.722942322+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.722987530+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.722993249+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.722996168+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:04:49.723000628+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18288277647611605589
2025-06-16T12:04:49.723004468+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.723013184+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.723016436+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.723052381+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.723054797+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.723058320+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.723060516+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.723062665+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.723282151+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.723291235+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.723307571+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:04:49.731422170+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-16T12:04:49.733126974+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.733226812+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.733259813+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:04:49.736400525+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-16T12:04:49.823722299+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:04:49.894692328+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-16T12:04:49.894893667+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-16T12:04:49.898406963+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-16T12:04:49.898551175+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-16T12:04:49.904327074+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-16T12:04:49.904651761+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.905108454+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-16T12:04:49.905406023+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.906092255+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-16T12:04:49.906433666+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-16T12:04:49.906498157+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.906505865+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-16T12:04:49.906508143+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.906509977+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-16T12:04:49.906741002+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.906795095+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.906800226+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.906819532+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.906821354+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.906822888+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.907991199+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-16T12:04:49.908006257+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.908009182+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.908018102+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-16T12:04:49.908020600+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18288277647611605589
2025-06-16T12:04:49.908023992+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-16T12:04:49.908027858+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-16T12:04:49.908029471+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-16T12:04:49.908060764+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-16T12:04:49.908064736+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.908068108+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.908070516+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.908072807+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-16T12:04:49.908080447+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.908084539+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-16T12:04:49.908086832+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-16T12:04:49.910517597+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-16T12:04:49.910776111+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.910845903+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-16T12:04:49.910878730+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-16T12:04:49.917463747+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-16T12:05:01.454113517+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-16T12:05:01.454144337+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-16T12:05:01.454185362+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-16T12:05:01.454190995+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-16T12:05:01.454210019+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-16T12:05:01.503973109+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-16T12:05:01.503992276+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-16T12:05:01.504008751+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-16T12:05:01.504023321+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-16T12:05:01.504025719+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-16T12:05:01.504027639+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-16T12:05:01.877423595+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-16T12:05:01.877543702+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-16T12:05:01.877756659+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-16T12:05:01.877846005+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-16T12:05:01.877862176+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-16T12:05:01.877924948+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.193:53093: use of closed network connection
2025-06-16T12:05:01.877935938+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.193:53093: use of closed network connection
2025-06-16T12:05:01.877944213+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-16T12:05:01.877974073+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-16T12:05:01.877981985+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-16T12:05:01.877992446+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-16T12:05:01.878027397+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-16T12:05:01.878042512+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:05:01.878101074+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-16T12:05:01.878123040+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-16T12:05:01.878140861+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-16T12:05:01.878208448+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-16T12:05:01.878219125+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-16T12:05:01.878226397+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-16T12:05:01.878510441+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-16T12:05:01.878721412+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-16T12:05:01.878838380+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-16T12:05:01.878859269+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-16T12:05:01.878876293+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-16T12:05:01.878881752+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (190314): No such process
