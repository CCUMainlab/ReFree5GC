Run TestCN
os.Args: [/tmp/go-build3346893403/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-15T14:01:52.113980352+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.114251400+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.114275852+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.114292001+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-15T14:01:52.114327434+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-15T14:01:52.116573136+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.116601330+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.116615866+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.116838169+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-15T14:01:52.125517761+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.125833830+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.125850288+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.125863442+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-15T14:01:52.126802551+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-15T14:01:52.128725346+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:01:52.128917271+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.128926844+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.128934486+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.130867208+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.131004502+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.131014845+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.131018979+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-15T14:01:52.131052160+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-15T14:01:52.131149660+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.131158690+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.131161899+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-15T14:01:52.131596309+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.131605599+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.131608309+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.131629466+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 63e2c2a0-0218-4548-92b5-75fd70fcdf58 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{63e2c2a0-0218-4548-92b5-75fd70fcdf58-auth nausf-auth 0xc0000d4e70 http REGISTERED   0xc0000d4e58  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{63e2c2a0-0218-4548-92b5-75fd70fcdf58-policyauthorization npcf-policyauthorization 0xc0000d4ed0 http REGISTERED   0xc0000d4eb8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{63e2c2a0-0218-4548-92b5-75fd70fcdf58-smpolicycontrol npcf-smpolicycontrol 0xc0000d4ea0 http REGISTERED   0xc0000d4e88  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc0006166e0 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc00026cd20 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-15T14:01:52.131789349+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-15T14:01:52.132239648+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.132336657+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.132344984+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.132351050+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-15T14:01:52.132857280+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-15T14:01:52.133924045+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:52.134581756+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-15T14:01:52.134590888+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:52.134594794+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-15T14:01:52.134638934+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-15T14:01:52.134798109+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-15T14:01:52.134951092+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-15T14:01:52.338756546+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-15T14:01:52.338915198+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-15T14:01:52.340850438+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-15T14:01:52.343199996+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:52.348331888+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:52.349302149+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 433e24ce-1302-446c-9bfc-18508450d2ad
2025-06-15T14:01:52.351231631+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/433e24ce-1302-446c-9bfc-18508450d2ad |  |
2025-06-15T14:01:52.351774078+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:52.352002388+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-15T14:01:52.539366347+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-15T14:01:52.540476580+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:52.543697572+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:52.545359423+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 2f5807d7-77a9-4a36-9f7d-63621a21920f
2025-06-15T14:01:52.547858920+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/2f5807d7-77a9-4a36-9f7d-63621a21920f |  |
2025-06-15T14:01:52.548188397+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:52.548270448+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {2f5807d7-77a9-4a36-9f7d-63621a21920f SMF REGISTERED 0 0xc0005cf170 0xc0005cf188 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000246440 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0005cf0c8 false false []}
2025-06-15T14:01:52.548460678+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-15T14:01:52.548503745+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-15 14:01:52.548497122 +0800 CST m=+0.495228749]
2025-06-15T14:01:52.548535644+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-15T14:01:52.741317777+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:52.745871210+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:52.748303821+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: e3394742-9e30-4e7c-8872-f6e6dce2585a
2025-06-15T14:01:52.751245562+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/e3394742-9e30-4e7c-8872-f6e6dce2585a |  |
2025-06-15T14:01:52.752226916+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:52.752319217+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-15T14:01:52.752327010+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-15T14:01:52.752331028+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:01:52.752349125+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-15T14:01:52.980133074+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-15T14:01:52.981045851+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-15T14:01:52.983471315+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:52.987165537+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:52.989074383+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: eb2232b8-f6c1-4502-8b16-c2bb1d1b2bd2
2025-06-15T14:01:52.990311839+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/eb2232b8-f6c1-4502-8b16-c2bb1d1b2bd2 |  |
2025-06-15T14:01:52.991543868+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:52.991720047+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-15T14:01:53.181751455+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:53.184627436+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:53.185501112+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6cdddfa6-74f9-4f63-bf37-52ed366486a6
2025-06-15T14:01:53.185888980+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6cdddfa6-74f9-4f63-bf37-52ed366486a6 |  |
2025-06-15T14:01:53.186405674+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:53.186417463+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-15T14:01:53.186420995+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-15T14:01:53.381118413+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-15T14:01:53.382401423+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:53.385269319+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:53.386865062+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 63e2c2a0-0218-4548-92b5-75fd70fcdf58
2025-06-15T14:01:53.388786389+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/63e2c2a0-0218-4548-92b5-75fd70fcdf58 |  |
2025-06-15T14:01:53.389037150+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:53.389081565+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-15T14:01:53.549956308+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-15T14:01:53.551588812+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-15T14:01:53.582655009+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-15T14:01:53.583879920+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:53.586845485+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:53.588835172+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 091ad3f5-aadd-45f1-879e-2a94d5465b5b
2025-06-15T14:01:53.590312098+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/091ad3f5-aadd-45f1-879e-2a94d5465b5b |  |
2025-06-15T14:01:53.591325662+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:53.591428581+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-15T14:01:53.786508497+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-15T14:01:53.787593440+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-15T14:01:53.791598338+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:01:53.795564377+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:01:53.796804458+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 77ede10e-73ab-40c3-80ac-a1dbeed38214
2025-06-15T14:01:53.798612113+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/77ede10e-73ab-40c3-80ac-a1dbeed38214 |  |
2025-06-15T14:01:53.799161501+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:01:53.799341475+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-15T14:02:00.030818035+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012
2025-06-15T14:02:00.033777662+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012
2025-06-15T14:02:00.034205958+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle NGSetupRequest
2025-06-15T14:02:00.034227334+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mMissing IE PagingDRX
2025-06-15T14:02:00.034265398+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build1136456174/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-15T14:02:08.677785318+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.678068553+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.678089650+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:08.678100437+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:02:08.678106665+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:08.678319027+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.678331852+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.678336830+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:08.678342995+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:02:08.678347764+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:08.698422641+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.698472134+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.698480430+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.698489483+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.698495907+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.698500699+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.698506671+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-15T14:02:08.706054684+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.706185946+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:02:08.706198804+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:08.706206797+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:08.706211746+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:08.706243471+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.706249777+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.706253810+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.706270840+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.706274846+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.706278850+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.712939960+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.713606756+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.713688951+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.713715590+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.713732812+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.713781338+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.713971448+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.714006976+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.714992324+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.715158495+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.715189882+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.715209394+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-15T14:02:08.715575353+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.715618844+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.715636164+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:02:08.715675172+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.715693101+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.715713602+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.715745012+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.715762313+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.715780286+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.719478028+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle InitialUEMessage
2025-06-15T14:02:08.719584465+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-15T14:02:08.719646465+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-15T14:02:08.719753716+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-15T14:02:08.719858040+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-15T14:02:08.719879285+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-15T14:02:08.719889358+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-15T14:02:08.719902678+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-15T14:02:08.719918273+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-15T14:02:08.719924723+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-15T14:02:08.725517563+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.741897150+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-15T14:02:08.744334233+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-15T14:02:08.744425913+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-15T14:02:08.744652773+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.768498870+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-15T14:02:08.772226563+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-15T14:02:08.772303250+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-15T14:02:08.772312591+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-15T14:02:08.772320169+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-15T14:02:08.773129658+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.781713791+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-15T14:02:08.785919884+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:02:08.790253401+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:02:08.790939947+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-15T14:02:08.791464388+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-15T14:02:08.791567224+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-15T14:02:08.791583892+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 6464613665393461623738653066323162616631616239363439393136393861
2025-06-15T14:02:08.791669976+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-15T14:02:08.792053536+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-15T14:02:08.792358926+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend Downlink Nas Transport
2025-06-15T14:02:08.795412834+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.795587118+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.795620994+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.795680933+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.795700991+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.795723668+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.795777360+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.795798373+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.795815876+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.796820487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.797466276+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.797522589+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:02:08.797843687+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.797898676+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.797919236+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.797966520+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.798013645+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.798040928+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.800751029+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:08.800945788+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:08.801067361+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-15T14:02:08.801107736+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-15T14:02:08.802766239+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-15T14:02:08.802919912+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 6464613665393461623738653066323162616631616239363439393136393861
Xres*: 6464613665393461623738653066323162616631616239363439393136393861
2025-06-15T14:02:08.802957375+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-15T14:02:08.804759067+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-15T14:02:08.807561239+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-15T14:02:08.808038601+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-15T14:02:08.808632785+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-15T14:02:08.809364193+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-15T14:02:08.809462479+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-15T14:02:08.809567121+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend Downlink Nas Transport
2025-06-15T14:02:08.811179871+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.811212598+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.811223828+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.811233403+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.811237881+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.811241602+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.811266315+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.811270645+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.811275383+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.811331451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.811337065+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.811341360+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:02:08.811353124+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.811356677+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.811362789+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.811376608+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.811380356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.811384271+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.812292426+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:08.812365026+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:08.812462821+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-15T14:02:08.812494412+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-15T14:02:08.812529554+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-15T14:02:08.812546752+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-15T14:02:08.813603466+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.842652381+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:02:08.848499812+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-15T14:02:08.849982753+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:02:08.851865860+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-15T14:02:08.853372517+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:08.857188857+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.875421647+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:02:08.879066847+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-15T14:02:08.883315142+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-15T14:02:08.883644930+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-15T14:02:08.884055258+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-15T14:02:08.884949227+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:02:08.886718394+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:08.887076293+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:08.887769369+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-15T14:02:08.889839307+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-15T14:02:08.890329203+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:08.890895076+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-15T14:02:08.893052071+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-15T14:02:08.893276918+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-15T14:02:08.893774904+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-15T14:02:08.894297576+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-15T14:02:08.894508525+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-15T14:02:08.895152912+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.906681322+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-15T14:02:08.909491484+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:02:08.910559058+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.918786753+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-15T14:02:08.923051277+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:02:08.924249291+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:08.951239183+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-15T14:02:08.955198594+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-15T14:02:08.955594244+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-15T14:02:08.955636994+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-15T14:02:08.956306949+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:02:08.956770031+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-15T14:02:08.956895740+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend Initial Context Setup Request
2025-06-15T14:02:08.958353186+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.958389911+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.958397924+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.958403788+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.958408186+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.958412010+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.958453231+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.958460215+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.958480545+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.958486996+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:02:08.959050657+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.959150625+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:02:08.959178711+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:02:08.959204332+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.959209885+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.959214045+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.959227626+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.959233493+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.959237364+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.970486467+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.970530957+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.970539036+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970546543+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.970570038+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.970575147+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.970612937+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.970618350+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970642856+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970654028+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970664697+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970618733+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle InitialContextSetupResponse
2025-06-15T14:02:08.970669946+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970676855+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970681449+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.970666604+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:02:08.970685020+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend Downlink Nas Transport
    non3gpp_test.go:1517: Get Authentication from N3IWF
Security header type: Integrity Protected And Ciphered
cmac value: 0xa19d41b9
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000c1f360)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000a6a5a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000b18540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000bfef20)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000c1f380)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000c1f3a0)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000bfef5b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000bfef73)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-15T14:02:08.975559681+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:08.975595401+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:08.975664055+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-15T14:02:08.975888893+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-15T14:02:08.975931193+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-15T14:02:08.975942842+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend Downlink Nas Transport
2025-06-15T14:02:08.976140238+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-15T14:02:09.477026279+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:09.477315048+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:09.477402528+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:02:09.477413654+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:02:09.477422232+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:02:09.477438256+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:02:09.478963315+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.489082658+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-15T14:02:09.492961322+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:02:09.493180136+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:02:09.493413163+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=433e24ce-1302-446c-9bfc-18508450d2ad&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:02:09.494653216+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:02:09.495644081+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.508402156+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:09.512267862+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:02:09.512709575+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:02:09.512877950+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:02:09.512890495+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:02:09.514773436+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.533249520+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:02:09.536242284+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:02:09.538844513+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:02:09.539172409+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:02:09.542023721+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.542571752+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.542859387+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:02:09+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc00152f740 0xc00152f760 0xc00152f780]
2025-06-15T14:02:09.543195517+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:02:09.543221973+08:00[36m [INFO][SMF][GSM] [0m&{[0xc00152f740 0xc00152f760 0xc00152f780]}
2025-06-15T14:02:09.543236203+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:02:09.544192610+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.548263870+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=433e24ce-1302-446c-9bfc-18508450d2ad&target-nf-type=AMF |  |
2025-06-15T14:02:09.548850645+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:02:09.549149004+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-15T14:02:09.549236222+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:02:09.549248010+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-15T14:02:09.549265697+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:02:09.549275155+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:02:09.549283822+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:02:09.549291184+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:02:09.552321247+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:02:09.553449463+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.569929247+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-15T14:02:09.574957774+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:02:09.578272107+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:02:09.579702352+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:02:09.581064280+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-15T14:02:09.582359126+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.588973040+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-15T14:02:09.593235277+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.602266788+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:02:09.602925539+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:02:09.603583949+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:02:09.605154840+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.607168712+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:02:09.608132282+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:02:09.608993650+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:02:09.609963639+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.615956702+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:02:09.617443381+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:02:09.621857391+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:02:09.622074487+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:02:09.622093763+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:02:09.622100843+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:02:09.622105531+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:02:09.622847413+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:02:09.623552122+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:02:09.623687494+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-15T14:02:09.623783557+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:02:09.623821248+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:09.623872502+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:02:09.623893468+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:09.623943886+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:02:09.624375468+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:02:09.624613218+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:02:09.625000433+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-15T14:02:09.639926338+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:02:09.643080886+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:02:09.643155804+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend PDU Session Resource Setup Request
2025-06-15T14:02:09.643601254+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:02:09.646081138+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:09.646131039+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.646139210+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-15T14:02:09.646244193+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.646250800+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.646255603+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.646357143+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.646372212+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.646386536+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.646392756+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.646398270+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.646403206+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.646408929+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 2 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-15T14:02:09.646580048+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.646588741+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:09.646596757+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.646602184+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.646606592+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:09.646628387+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.646632755+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.646638712+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.646662815+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.646666503+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.646670571+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x66f1e14f
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000764420)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c6e1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0006324b0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00049e744)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000f8120)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063e200)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00049e770)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00049e780)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000764440)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000764460)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000764480)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:02:09.685331408+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:02:09.685755350+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:02:09.687996501+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:02:09.692575503+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:02:09.692799978+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:49d114da-decc-487c-8468-d36d4da5aa12/modify |  |
2025-06-15T14:02:09.694043953+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:09.694155694+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:09.694221235+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:02:09.694436377+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:02:09.694872261+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:02:09.694894662+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:02:09.695544268+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:02:09.695713116+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:02:09.695762953+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=433e24ce-1302-446c-9bfc-18508450d2ad&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:02:09.696528916+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:02:09.698732950+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.713608390+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:09.718159918+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:02:09.718745875+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:02:09.719335261+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:02:09.719459726+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:02:09.720843507+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.742461910+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:02:09.745873636+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:02:09.747767221+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:02:09.748085601+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:02:09.753597388+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.754495477+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.755171902+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:02:09+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0018381c0 0xc0018381e0 0xc001838200]
2025-06-15T14:02:09.755298680+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:02:09.755308893+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0018381c0 0xc0018381e0 0xc001838200]}
2025-06-15T14:02:09.755313777+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:02:09.756217028+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.759115135+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=433e24ce-1302-446c-9bfc-18508450d2ad&target-nf-type=AMF |  |
2025-06-15T14:02:09.760388085+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:02:09.760613552+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-15T14:02:09.760628751+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:02:09.760636702+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-15T14:02:09.760724129+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:02:09.760740776+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:02:09.760747882+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:02:09.760755081+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:02:09.762642441+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:02:09.766639394+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.776414282+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:02:09.776550251+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:02:09.777009250+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:02:09.779370798+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.780635911+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:02:09.781241022+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:02:09.781661713+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:02:09.784175091+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.792307669+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:02:09.793292696+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:02:09.794372818+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:02:09.794515402+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:02:09.794543620+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:02:09.794561090+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:02:09.794576298+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:02:09.794620601+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:02:09.794831936+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:02:09.795291713+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:02:09.795731776+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:09.796409811+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:02:09.796429618+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:09.796486240+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:02:09.796675165+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:02:09.797016548+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:02:09.797636163+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-15T14:02:09.813695176+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:02:09.815645465+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:02:09.815811255+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend PDU Session Resource Setup Request
2025-06-15T14:02:09.816201927+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:02:09.817331755+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:09.817395656+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.817408214+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-15T14:02:09.817474672+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.817480935+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817485238+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.817549616+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.817565853+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.817575181+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.817580235+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.817585144+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.817590922+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.817595850+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:02:09.817754447+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817762489+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:09.817768929+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.817773536+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.817778014+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:09.817789775+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.817795662+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817799338+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.817824169+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.817828429+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817832226+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000734e438f
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x45d76053a1d7a210a77e9da46baf1f72c598b20fc04e11e5f23b162677dc7a3a
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x5c6fc07cfe328c3e79a3415a61fefc2b26be3e15
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000009c6e44d7
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xa6af4f9294c28d4999638f3d95edf54b165da8dacc689917ceda2c643eab5d91
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x437de2c06714c1662961c045486578ca72eb6f8a
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x3a55a059
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000765100)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c6e4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000632e60)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00001496c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000f82d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063e900)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000014990)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000149a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000765120)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000765140)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000765160)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:02:09.888276071+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:02:09.888320928+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:02:09.889864615+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:02:09.895276381+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:02:09.895423834+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:89eecb50-4fc3-4d8b-87fe-38bfd9a3e821/modify |  |
2025-06-15T14:02:09.895838814+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:09.895943136+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:09.896014576+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:02:09.896028403+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:02:09.896036484+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:02:09.896048494+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:02:09.896721845+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:02:09.896887439+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:02:09.896921720+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=433e24ce-1302-446c-9bfc-18508450d2ad&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:02:09.897147059+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:02:09.900586314+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.915795043+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:09.918794323+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:02:09.919160108+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:02:09.919220053+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:02:09.919318194+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:02:09.920401272+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.936621115+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:02:09.938332797+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:02:09.939441153+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:02:09.939593662+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:02:09.941914429+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.942942719+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.943539595+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:02:09+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000b2cb00 0xc000b2cb20 0xc000b2cb40]
2025-06-15T14:02:09.943923186+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:02:09.943940394+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000b2cb00 0xc000b2cb20 0xc000b2cb40]}
2025-06-15T14:02:09.943945674+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:02:09.945910920+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.949195964+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=433e24ce-1302-446c-9bfc-18508450d2ad&target-nf-type=AMF |  |
2025-06-15T14:02:09.950288834+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:02:09.950418729+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-15T14:02:09.950488628+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:02:09.950498288+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-15T14:02:09.950642466+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:02:09.950661766+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:02:09.950671572+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:02:09.950677438+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:02:09.952776553+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:02:09.956293399+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:09.969212676+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:02:09.969524170+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:02:09.970001934+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:02:09.971206687+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.972788558+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:02:09.973073294+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:02:09.973485001+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:02:09.973621196+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:09.980150513+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:02:09.980923053+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:02:09.982044165+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:02:09.983926154+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:02:09.983952774+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:02:09.983958524+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:02:09.983963545+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:02:09.984004817+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:02:09.984402921+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:02:09.985669394+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:02:09.985693288+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:09.985751349+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:02:09.985759577+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:09.985805971+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:02:09.985865460+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:02:09.986060267+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:02:09.986938434+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-15T14:02:09.995982656+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:02:09.997337365+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:02:09.997510237+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend PDU Session Resource Setup Request
2025-06-15T14:02:09.997830155+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:02:09.999244161+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:09.999430624+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.999451211+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-15T14:02:09.999641056+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.999649227+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.999653633+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.999701108+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.999706883+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.999713898+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.999720191+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.999725270+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.999729911+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.999734129+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:02:09.999801710+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.999862181+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:09.999935589+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.999944953+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.999949404+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:09.999967288+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.999971562+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.999974852+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.999995879+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.000061348+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.000068795+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000047f1323b
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xb6f787a64062d4a12d830b01c66d3b3c4f3496e31777ebec2996931c28cf967a
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x0fad4ebb27ac276a771c27da48d67e2cb032fac6
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000866e3502
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x237a375ac1d26bc3ad1e076b7b18bd8b1b79e380acb879b90ae1acb3853d3d24
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xdef844127b92e7cd59e799095687a413ea155f3d
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x4a8ef89e
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000765e00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c6e780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000633810)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0003380ec)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000f8480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063f000)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000338120)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000338130)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000765e20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000765e40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000765e60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:02:10.091859593+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:02:10.091960500+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:02:10.093410864+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:02:10.095195070+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:02:10.095319477+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:466c4fc8-736e-4b00-97e8-4b8463f170ca/modify |  |
2025-06-15T14:02:10.095913036+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport
2025-06-15T14:02:10.096000100+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:02:10.096064434+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:02:10.096074618+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:02:10.096082508+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:02:10.096095016+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:02:10.096975639+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:02:10.097125190+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:02:10.097197849+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=433e24ce-1302-446c-9bfc-18508450d2ad&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:02:10.097559383+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:02:10.098693861+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:10.121405914+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:02:10.124378436+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:02:10.124622202+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:02:10.124673227+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:02:10.124679102+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:02:10.126009696+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:10.143507353+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:02:10.145065045+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:02:10.147336635+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:02:10.147436423+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:02:10.174562719+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:10.175183088+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:10.175447596+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:02:10+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001b95f60 0xc001b95f80 0xc001b95fa0]
2025-06-15T14:02:10.175476425+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:02:10.175484852+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001b95f60 0xc001b95f80 0xc001b95fa0]}
2025-06-15T14:02:10.175489358+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:02:10.176073423+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:10.179127456+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=433e24ce-1302-446c-9bfc-18508450d2ad&target-nf-type=AMF |  |
2025-06-15T14:02:10.179896923+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:02:10.180072604+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-15T14:02:10.180083393+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:02:10.180089723+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-15T14:02:10.180101372+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:02:10.180108251+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:02:10.180111321+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:02:10.180115485+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:02:10.181292940+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:02:10.184389704+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:02:10.194603986+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:02:10.195076836+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:02:10.195964098+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:02:10.197387213+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:10.199276569+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:02:10.199691394+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:02:10.200736212+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:02:10.201882482+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:02:10.207877453+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:02:10.208324813+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:02:10.209451675+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:02:10.209544556+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:02:10.209556216+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:02:10.209559702+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:02:10.209562473+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:02:10.209586222+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:02:10.209814993+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:02:10.210222731+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:02:10.210293850+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:10.210347064+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:02:10.210352582+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:02:10.210381843+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:02:10.210428253+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:02:10.210547748+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:02:10.210753648+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-15T14:02:10.220640646+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:02:10.222479977+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:02:10.222593701+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mSend PDU Session Resource Setup Request
2025-06-15T14:02:10.222844475+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:02:10.224861732+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:10.224927524+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:10.224961159+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-15T14:02:10.225747692+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.225763801+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.225768592+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.225823558+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:10.225831016+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.225838995+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.225844732+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.225849844+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.225855049+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.225859609+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:02:10.226155302+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.226164086+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:10.226170597+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:10.226175372+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:10.226179435+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:10.226198218+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.226202951+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.226206537+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.226403833+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.226416171+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.226424360+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000e7c504bb
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x86004e199e351cb32da2f4922f12177f6774ad6155f2d9e888bafecf641c5072
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xe11feac78fa79e14c8f54c7b2efc0498d6f9cc42
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000c0f65073
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xda495673819f1ca56e9ec4e1b4b726a09e223c47a582e3a2d4152ab85b79e222
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x03d79ef0854abcb9985a5ff3ccb2dc12d3a96be9
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x404527b7
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000664b60)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c6ea50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000138ff0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000339e5c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000f8630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00063f700)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000339e80)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000339ea0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000664b80)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000664ba0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000664bc0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-15T14:02:10.299555834+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:02:10.299662116+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:57012] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:02:10.300547926+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:02:10.306885104+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:02:10.307117402+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:17d9db71-06db-45d0-8b50-c02ed63a5f68/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=774.379µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=626.108µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=1.070621ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=1.157475ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=1.110531ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 626.108µs/947.823µs/1.157475ms/209.327µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.97s)
PASS
ok  	test	10.058s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (27.12s)
PASS
ok  	test	30.063s

--- STDERR ---
2025-06-15T14:01:47.777886963+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:01:47.778045133+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-15T14:01:47.778641005+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:01:47.778709229+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0000798b0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0004977a0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc000497950)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc00047b2a0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-15T14:01:47.778716988+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:01:47.778720623+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-15T14:01:47.778723211+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:47.778803278+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-15T14:01:47.778856126+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-15T14:01:47.785342345+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-15T14:01:47.785480248+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-15T14:01:47.785566329+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-15T14:01:47.785960078+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-15T14:01:47.786447148+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-15T14:01:47.786523689+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-15T14:01:53.551204418+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-15T14:01:53.551318847+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-15T14:01:59.986162767+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:01:59.989498747+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-15T14:01:59.990135547+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-15T14:01:59.990225047+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-15T14:01:59.990237650+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-15T14:01:59.990376265+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-15T14:01:59.990490888+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-15T14:02:00.012667363+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-15T14:02:00.012764934+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-15T14:02:00.033064863+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-15T14:02:00.035526089+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-15T14:02:00.035782909+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-15T14:02:00.036645915+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-15T14:02:00.037092274+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-15T14:02:00.037137260+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-15T14:02:00.039356880+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-15T14:02:08.678812352+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.678935338+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.678949923+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.678966960+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.678973109+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.678979464+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-15T14:02:08.697516470+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.697660208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.697678260+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:08.697689048+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:02:08.697695470+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:08.697700097+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:08.697723954+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:08.697776299+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.697785274+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:02:08.697833132+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.697838625+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.697842313+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:08.697848006+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:02:08.697852008+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:08.697856274+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:08.697861069+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:08.707019998+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.707065985+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.707073740+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.707080696+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:02:08.707090522+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.707095542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.707099726+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.707330173+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.707349017+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.707361660+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.707370197+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.707380286+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.707387727+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-15T14:02:08.707392141+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.707396112+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:02:08.707406669+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-15T14:02:08.707411741+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:02:08.707413941+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:02:08.711416916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.711651909+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:02:08.711671481+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-15T14:02:08.711702847+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:02:08.711712471+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.711717121+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:02:08.711757856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.711766451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.711771176+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.711835912+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.711927368+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.711938396+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.716239496+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.716376135+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.716408187+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.716430991+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:02:08.716700902+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.716783162+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.716819707+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.717073436+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.717422834+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.717977612+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.718058278+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:02:08.718117710+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.718225132+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:08.718307158+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-15T14:02:08.718349633+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.718371753+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-15T14:02:08.793076229+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:02:08.793394007+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:08.793495195+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:02:08.793523136+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.793529538+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.793534887+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:02:08.793563227+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.793567990+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.793572506+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.793620254+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.793629000+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.793632803+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.799866512+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.800028944+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.800041956+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.800053309+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:02:08.800065183+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.800071720+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.800075872+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.800111876+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.800117059+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.800122812+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.800129067+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:02:08.800155302+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.800164371+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:08.810571830+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:02:08.810700765+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:08.810715762+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:02:08.810725418+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.810729930+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.810734609+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:02:08.810761073+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.810765865+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.810769934+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.810797310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.810879968+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.810890128+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.811727123+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.811752462+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.811759035+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.811765773+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:02:08.811773434+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.811778220+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.811781974+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.811810093+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.811891011+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.811901997+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.811909084+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:02:08.811920092+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.811927097+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:08.957637018+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-15T14:02:08.957827200+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:08.957847435+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-15T14:02:08.957859108+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.957863932+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:02:08.957881444+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.957886254+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.957890116+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.957916428+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.957988170+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.957998241+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.959642657+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:08.959677064+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.959704179+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.959899405+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:02:08.960173489+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.960187755+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.960193335+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.960234951+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:08.960241167+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.960254681+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:08.960557554+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 2130833019, Outbound SPI: 1333640398
2025-06-15T14:02:08.960612678+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.960626113+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:02:08.960631501+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:02:08.961908659+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:08.961942001+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:08.961949087+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:08.961957998+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:08.961963343+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:08.961987757+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.961992800+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.961998099+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.969228655+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:08.969425805+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:08.969446465+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:08.969774983+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.969793845+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.969805371+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:08.969811254+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:02:08.969844956+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.969851582+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-15T14:02:08.971156665+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:02:08.972831409+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:08.974938576+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:08.976868247+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:02:09.476373727+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:09.625477561+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:02:09.625519072+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-15T14:02:09.630759795+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-15T14:02:09.630820824+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-15T14:02:09.631537730+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-15T14:02:09.645209345+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:02:09.645521451+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:09.645538815+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:02:09.645580960+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.645587003+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:09.645594051+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:09.645600533+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.645608298+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.645613229+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:09.645619130+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:09.645636914+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.645649521+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.645654224+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.645688533+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.645693616+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.645697618+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.648173479+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:09.648363748+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.648382017+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.648394730+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:02:09.648400712+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10444948253213436445
2025-06-15T14:02:09.648414258+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.648423476+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.648428201+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.648505193+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.648512235+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.648523486+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.648607052+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.648619506+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.648639041+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:09.648649326+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:09.648656552+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:02:09.649011944+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:09.649398849+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:09.649477365+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:02:09.652310135+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:09.689222727+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:02:09.798400978+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:02:09.799629177+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-15T14:02:09.807885625+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-15T14:02:09.808844889+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-15T14:02:09.816768234+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:02:09.816965275+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:09.816976694+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:02:09.817003675+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817008293+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:09.817012855+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:09.817016413+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.817019478+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.817025770+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:09.817028685+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:09.817039187+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.817041653+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817044127+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.817071178+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.817161142+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.817170295+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.818130445+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:09.818346347+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.818363389+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.818373181+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:02:09.818379409+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10444948253213436445
2025-06-15T14:02:09.818385131+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.818388235+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.818391472+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.818448994+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:09.818454849+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.818462575+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.818467879+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.818471322+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:09.818549487+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:09.818643593+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:09.818654730+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:02:09.825428460+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-15T14:02:09.825893805+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:09.826589094+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:09.826659315+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:02:09.840022030+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:09.891191170+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:02:09.987242155+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:02:09.987363698+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-15T14:02:09.992701688+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-15T14:02:09.992995774+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-15T14:02:09.998537290+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:02:09.998758531+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:09.998775510+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:02:09.998814719+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.998835480+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:09.998842093+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:09.998847214+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.998854933+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:09.998860146+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:09.998864156+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:09.998888693+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.998892833+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.998896721+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:09.998925142+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:09.998929228+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:09.998932766+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.001493690+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:10.001523658+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:10.001528128+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.001547947+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:02:10.001560167+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10444948253213436445
2025-06-15T14:02:10.001570910+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.001575854+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.001948693+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.002296606+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:10.002392772+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.002409320+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.002416346+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.002422326+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.002521453+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:10.002539811+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:10.002545746+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:02:10.009829555+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-15T14:02:10.010594630+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:10.010791369+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:10.010843370+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:02:10.035854673+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:02:10.094438475+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:02:10.211238730+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:02:10.211324549+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-15T14:02:10.214095055+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-15T14:02:10.217058917+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-15T14:02:10.223556113+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:02:10.223832829+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:10.223872259+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:02:10.223915785+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.223921918+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:02:10.223928687+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:02:10.223933381+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:10.223938327+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:02:10.223942963+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:10.223947060+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:02:10.223962747+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.224054202+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.224064515+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.224093936+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.224098529+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.224102647+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.228276464+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:02:10.228412978+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:10.228428787+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.228440066+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:02:10.228447524+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 10444948253213436445
2025-06-15T14:02:10.228463151+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:02:10.228473868+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:02:10.228478796+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:02:10.228567306+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:02:10.228577424+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.228587248+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.228593511+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.228599822+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:02:10.228709599+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:10.228728836+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:02:10.228735311+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:02:10.236005309+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-15T14:02:10.239942326+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:10.240156647+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:02:10.240212277+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:02:10.301512796+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:02:21.649301702+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-15T14:02:21.649368249+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-15T14:02:21.649412121+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-15T14:02:21.649417585+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-15T14:02:21.649425967+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-15T14:02:21.687037518+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-15T14:02:21.687058802+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-15T14:02:21.687075159+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-15T14:02:21.687092221+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-15T14:02:21.687095642+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-15T14:02:21.687097847+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-15T14:02:22.080765987+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-15T14:02:22.080878957+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-15T14:02:22.081326477+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-15T14:02:22.081336280+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-15T14:02:22.081390510+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-15T14:02:22.081403363+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-15T14:02:22.081436866+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-15T14:02:22.081716649+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-15T14:02:22.081767058+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-15T14:02:22.081929081+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.114:43769: use of closed network connection
2025-06-15T14:02:22.081969203+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.114:43769: use of closed network connection
2025-06-15T14:02:22.081997800+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-15T14:02:22.082150144+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-15T14:02:22.082158011+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-15T14:02:22.082162963+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-15T14:02:22.082401903+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-15T14:02:22.082446938+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:02:22.082463039+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-15T14:02:22.082465547+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:02:22.082469939+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-15T14:02:22.082523716+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-15T14:02:22.082583471+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-15T14:02:22.082595140+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-15T14:02:22.082604541+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-15T14:02:22.082606757+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (105767): No such process
