Run TestCN
os.Args: [/tmp/go-build1954172344/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-15T14:23:00.053571831+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.053672901+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.053680218+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.053686867+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-15T14:23:00.053703975+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-15T14:23:00.056751244+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.056762159+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.056765133+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.056986705+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-15T14:23:00.059860951+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.059916742+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.059923321+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.059930856+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-15T14:23:00.059951072+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-15T14:23:00.063637036+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:23:00.063810434+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.063817807+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.063888389+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.067305216+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.067385621+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.067394118+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.067400703+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-15T14:23:00.067449980+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-15T14:23:00.067492705+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.067498018+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.067502285+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-15T14:23:00.068299445+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.068314242+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.068318313+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.068340448+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 3a32384c-9c57-4d1a-816e-853426071877 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{3a32384c-9c57-4d1a-816e-853426071877-auth nausf-auth 0xc000d8dc08 http REGISTERED   0xc000d8dbf0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{3a32384c-9c57-4d1a-816e-853426071877-policyauthorization npcf-policyauthorization 0xc000d8dc68 http REGISTERED   0xc000d8dc50  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{3a32384c-9c57-4d1a-816e-853426071877-smpolicycontrol npcf-smpolicycontrol 0xc000d8dc38 http REGISTERED   0xc000d8dc20  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000c27a40 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc0006907e0 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-15T14:23:00.068577689+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-15T14:23:00.069127448+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.069237926+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.069245501+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.069251562+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-15T14:23:00.069356944+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-15T14:23:00.072566268+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:00.072621606+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-15T14:23:00.072627892+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:00.072631564+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-15T14:23:00.072655402+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-15T14:23:00.072685156+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-15T14:23:00.072718140+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-15T14:23:00.273304640+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-15T14:23:00.273459009+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-15T14:23:00.273583121+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-15T14:23:00.275844959+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:00.279659289+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:00.280558808+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 672cac82-c3ec-43f3-989f-0cae004629d0
2025-06-15T14:23:00.281649453+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/672cac82-c3ec-43f3-989f-0cae004629d0 |  |
2025-06-15T14:23:00.282396549+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:00.282496703+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-15T14:23:00.477262686+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-15T14:23:00.478459921+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:00.481162363+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:00.481901772+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a3cebe57-264c-4b1d-abb5-42a4ff06eabf
2025-06-15T14:23:00.482587877+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a3cebe57-264c-4b1d-abb5-42a4ff06eabf |  |
2025-06-15T14:23:00.482938810+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:00.482985064+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {a3cebe57-264c-4b1d-abb5-42a4ff06eabf SMF REGISTERED 0 0xc0000e98d8 0xc0000e98f0 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc00072ad80 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0000e97e8 false false []}
2025-06-15T14:23:00.483037420+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-15T14:23:00.483061024+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-15 14:23:00.483056404 +0800 CST m=+0.467629768]
2025-06-15T14:23:00.483083180+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-15T14:23:00.679255744+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:00.681526937+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:00.682403030+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8815a0a7-bc64-45a1-8143-f9f6bf5fffe4
2025-06-15T14:23:00.682968998+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8815a0a7-bc64-45a1-8143-f9f6bf5fffe4 |  |
2025-06-15T14:23:00.683299139+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:00.683349103+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-15T14:23:00.683355150+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-15T14:23:00.683358160+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:23:00.683381608+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-15T14:23:00.883165816+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-15T14:23:00.883623730+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-15T14:23:00.884768854+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:00.888280163+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:00.889418094+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: db4fcb51-8788-482f-8eb6-c7d36d92023f
2025-06-15T14:23:00.891187169+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/db4fcb51-8788-482f-8eb6-c7d36d92023f |  |
2025-06-15T14:23:00.891393341+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:00.891486423+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-15T14:23:01.085392473+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:01.087859784+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:01.088668126+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 34512516-9b35-43ca-b7b2-31f4ba61b40f
2025-06-15T14:23:01.089974317+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/34512516-9b35-43ca-b7b2-31f4ba61b40f |  |
2025-06-15T14:23:01.090586723+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:01.090650844+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-15T14:23:01.090656726+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-15T14:23:01.285961319+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-15T14:23:01.287043064+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:01.290086482+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:01.290928622+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3a32384c-9c57-4d1a-816e-853426071877
2025-06-15T14:23:01.291594898+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3a32384c-9c57-4d1a-816e-853426071877 |  |
2025-06-15T14:23:01.291909158+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:01.292017672+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-15T14:23:01.484705698+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-15T14:23:01.486630264+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-15T14:23:01.486752311+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-15T14:23:01.487666349+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:01.492252431+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:01.493157982+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 0ef73d50-268c-48cb-b943-1346e9ffc28b
2025-06-15T14:23:01.495173039+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/0ef73d50-268c-48cb-b943-1346e9ffc28b |  |
2025-06-15T14:23:01.496817333+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:01.496907584+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-15T14:23:01.687013040+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-15T14:23:01.687614052+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-15T14:23:01.689433137+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:23:01.693385807+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:23:01.694029501+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 32d1d182-eced-404a-a261-ce7d745869cf
2025-06-15T14:23:01.694731533+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/32d1d182-eced-404a-a261-ce7d745869cf |  |
2025-06-15T14:23:01.694922064+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:23:01.694977205+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-15T14:23:08.027863767+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394
2025-06-15T14:23:08.028083410+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394
2025-06-15T14:23:08.028277991+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle NGSetupRequest
2025-06-15T14:23:08.028285641+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mMissing IE PagingDRX
2025-06-15T14:23:08.028302423+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3981545647/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-15T14:23:14.868832170+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.869238998+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.869256869+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:14.869711093+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:23:14.869725100+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:14.870710731+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.870875997+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.870897892+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:14.870908919+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:23:14.870918231+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:14.888366150+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.888480558+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.888492488+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.888503501+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.888508506+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.888512986+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.888516543+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-15T14:23:14.894251009+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.894338929+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:23:14.894349112+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:14.894354871+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:14.894360044+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:14.894398832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.894406109+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.894411642+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.894429620+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.894433504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.894436856+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.897585318+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.897645896+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.897653495+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.897658525+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.897661012+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897663250+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.897773512+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.897834015+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.897842331+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.897845872+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.897849044+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.897851698+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-15T14:23:14.897912125+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897915187+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:14.897917404+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:23:14.897926233+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.897930064+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897933376+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.897945745+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.897948021+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897949980+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.899184832+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle InitialUEMessage
2025-06-15T14:23:14.899296257+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-15T14:23:14.899336097+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-15T14:23:14.899388121+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-15T14:23:14.899461670+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-15T14:23:14.899474985+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-15T14:23:14.899480416+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-15T14:23:14.899485253+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-15T14:23:14.899491988+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-15T14:23:14.899495838+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-15T14:23:14.900362412+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:14.914466533+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-15T14:23:14.916888948+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-15T14:23:14.916991416+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-15T14:23:14.917912428+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:14.943767708+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-15T14:23:14.947015236+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-15T14:23:14.947136309+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-15T14:23:14.947152536+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-15T14:23:14.947162267+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-15T14:23:14.948751644+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:14.956713270+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-15T14:23:14.959476733+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:23:14.962375524+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:23:14.962655366+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-15T14:23:14.962760721+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-15T14:23:14.962767095+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-15T14:23:14.962771392+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 6435303465656633326230353861336465386532313736643363373962663334
2025-06-15T14:23:14.962839433+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-15T14:23:14.963114406+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-15T14:23:14.963174031+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend Downlink Nas Transport
2025-06-15T14:23:14.964043313+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.964067887+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.964071877+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.964075585+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.964081714+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.964091993+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.964107578+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.964110229+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.964113706+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.964221483+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.964226090+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:14.964228938+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:23:14.964236714+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.964239115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.964241161+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.964249306+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.964252420+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.964254454+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.965072093+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:14.965113811+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:14.965150421+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-15T14:23:14.965163534+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-15T14:23:14.966825406+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-15T14:23:14.966870620+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 6435303465656633326230353861336465386532313736643363373962663334
Xres*: 6435303465656633326230353861336465386532313736643363373962663334
2025-06-15T14:23:14.966890031+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-15T14:23:14.967621058+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-15T14:23:14.969694858+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-15T14:23:14.969865788+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-15T14:23:14.970069301+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-15T14:23:14.970681203+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-15T14:23:14.970754495+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-15T14:23:14.970773751+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend Downlink Nas Transport
2025-06-15T14:23:14.971987317+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.972012476+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.972017705+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.972023596+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.972033793+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.972036113+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.972050783+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.972053581+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.972055998+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.972082129+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.972087309+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:14.972089758+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:23:14.972096376+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.972099307+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.972101447+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.972107953+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.972109865+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.972111798+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.972965061+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:14.973037841+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:14.973090075+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-15T14:23:14.973095170+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-15T14:23:14.973112589+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-15T14:23:14.973117106+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-15T14:23:14.973811853+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:14.998708549+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:23:15.003031436+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-15T14:23:15.003712884+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:23:15.004460937+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-15T14:23:15.004701753+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:15.005221380+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.023206989+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:23:15.025385730+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-15T14:23:15.027660053+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-15T14:23:15.027851575+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-15T14:23:15.028396661+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-15T14:23:15.028554226+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:23:15.029645356+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:15.029862642+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:15.030027052+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-15T14:23:15.030740385+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-15T14:23:15.030881832+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:15.031015289+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-15T14:23:15.031527015+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-15T14:23:15.031677148+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-15T14:23:15.031836193+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-15T14:23:15.031947961+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-15T14:23:15.032036355+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-15T14:23:15.032344272+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.055595962+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-15T14:23:15.059846057+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:23:15.060966753+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.071526719+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-15T14:23:15.074670687+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:23:15.075533838+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.108500884+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-15T14:23:15.111532362+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-15T14:23:15.111612178+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-15T14:23:15.111636472+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-15T14:23:15.111816043+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:23:15.112092417+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-15T14:23:15.112181154+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend Initial Context Setup Request
2025-06-15T14:23:15.113153404+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.113177623+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.113182096+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.113185418+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.113187819+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.113190032+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.113208926+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.113211908+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.113219673+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.113222198+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:23:15.113365638+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.113373475+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:23:15.113376030+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:23:15.113384214+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.113391869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.113394122+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.113402350+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.113404404+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.113406425+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.114745869+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.114974718+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.114983867+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.114987895+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.114990093+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.114992080+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.115008846+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.115011394+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.115015867+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.115032853+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.115037240+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.115039826+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.115042622+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.115044789+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-15T14:23:15.115289115+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle InitialContextSetupResponse
2025-06-15T14:23:15.115518829+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:23:15.115532848+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x00491521
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc0006991e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0006b6690)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc0006d6700)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc0006af0f0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000699200)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000699220)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc0006af12b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc0006af143)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-15T14:23:15.117451118+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:15.117537306+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:15.117577451+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-15T14:23:15.117583818+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-15T14:23:15.117600564+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-15T14:23:15.117606447+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend Downlink Nas Transport
2025-06-15T14:23:15.117713842+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-15T14:23:15.620640964+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:15.620712607+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:15.620762893+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:23:15.620768296+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:23:15.620771878+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:23:15.620788759+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:23:15.621580003+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.632480891+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-15T14:23:15.634847167+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:23:15.634964378+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:23:15.635078316+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=672cac82-c3ec-43f3-989f-0cae004629d0&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:23:15.635291855+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:23:15.635950399+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.650856982+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:15.656658503+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:23:15.656895050+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:23:15.656959251+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:23:15.657033191+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:23:15.657945698+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.684864965+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:23:15.686492748+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:23:15.687201515+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:23:15.687274281+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:23:15.688565417+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:15.688984327+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:15.689283275+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:23:15+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0012cc8a0 0xc0012cc8c0 0xc0012cc8e0]
2025-06-15T14:23:15.689356996+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:23:15.689364533+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0012cc8a0 0xc0012cc8c0 0xc0012cc8e0]}
2025-06-15T14:23:15.689367066+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:23:15.690779467+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.692475481+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=672cac82-c3ec-43f3-989f-0cae004629d0&target-nf-type=AMF |  |
2025-06-15T14:23:15.692944118+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:23:15.693086823+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-15T14:23:15.693095748+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:23:15.693099367+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-15T14:23:15.693107250+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:23:15.693112398+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:23:15.693115283+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:23:15.693119718+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:23:15.694922407+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:23:15.695422345+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.711157606+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-15T14:23:15.713879158+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:23:15.715372218+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:23:15.715580277+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:23:15.716088181+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-15T14:23:15.717421805+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.731534179+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-15T14:23:15.735149643+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:15.740635874+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:23:15.741091382+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:23:15.741940951+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:23:15.743623276+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.745034933+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:23:15.746118965+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:23:15.746347485+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:23:15.748916330+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.758437411+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:23:15.759301487+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:23:15.762492172+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:23:15.762600536+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:23:15.762612423+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:23:15.762615966+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:23:15.762618817+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:23:15.762834606+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:23:15.763250501+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:23:15.763439949+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-15T14:23:15.763552651+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:23:15.763593448+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:15.763652642+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:23:15.763690825+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:15.763767484+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:23:15.764019436+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:23:15.764136400+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:23:15.764380986+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-15T14:23:15.781655196+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:23:15.783377660+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:23:15.783478975+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend PDU Session Resource Setup Request
2025-06-15T14:23:15.784236812+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:23:15.785068300+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.785101228+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.785105878+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-15T14:23:15.785154159+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.785156687+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.785159458+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.785205271+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.785210337+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785215502+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785218642+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785221931+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785224635+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785227041+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 2 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-15T14:23:15.785302152+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.785306009+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:15.785310818+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.785313372+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.785315919+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:15.785324698+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.785327237+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.785330950+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.785345782+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.785347912+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.785349931+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x1ad4a4e1
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000699600)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0006b6960)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0006a1b30)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006affd4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006be5a0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00069e900)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000c70000)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000c70010)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000699620)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000699640)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000699660)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:23:15.823598672+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:23:15.823631317+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:23:15.824379521+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:23:15.827467083+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:23:15.827570394+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:5b761427-2256-4f77-9ea2-dec997ed2cd0/modify |  |
2025-06-15T14:23:15.827815515+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:15.827916489+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:15.827976583+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:23:15.827988723+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:23:15.827994374+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:23:15.828002415+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:23:15.828553438+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:23:15.828604708+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:23:15.828620888+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=672cac82-c3ec-43f3-989f-0cae004629d0&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:23:15.829041445+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:23:15.830313413+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.848801018+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:15.852339375+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:23:15.852523150+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:23:15.852558231+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:23:15.852564009+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:23:15.853217030+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.880484364+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:23:15.882208507+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:23:15.883052152+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:23:15.883121040+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:23:15.885223911+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:15.885953662+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:15.886114743+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:23:15+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0012020e0 0xc001202100 0xc001202120]
2025-06-15T14:23:15.886222278+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:23:15.886228177+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0012020e0 0xc001202100 0xc001202120]}
2025-06-15T14:23:15.886231731+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:23:15.887379078+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.889249024+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=672cac82-c3ec-43f3-989f-0cae004629d0&target-nf-type=AMF |  |
2025-06-15T14:23:15.889539454+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:23:15.889632986+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-15T14:23:15.889648737+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:23:15.889663904+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-15T14:23:15.889678271+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:23:15.889689635+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:23:15.889698877+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:23:15.889709563+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:23:15.890202016+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:23:15.891817343+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:15.899354250+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:23:15.899735180+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:23:15.900060081+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:23:15.900716029+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.901681489+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:23:15.901952533+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:23:15.902576348+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:23:15.902945634+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:15.913329141+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:23:15.914797881+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:23:15.921235274+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:23:15.921319875+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:23:15.921331818+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:23:15.921334885+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:23:15.921337358+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:23:15.921362922+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:23:15.921500553+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:23:15.921606993+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:23:15.921617996+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:15.921801251+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:23:15.921813638+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:15.921841317+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:23:15.921877384+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:23:15.921950855+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:23:15.922701436+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-15T14:23:15.932199770+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:23:15.933344064+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:23:15.933438923+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend PDU Session Resource Setup Request
2025-06-15T14:23:15.933627633+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:23:15.934832219+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.935021987+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.935030706+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-15T14:23:15.935063884+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.935066418+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.935069327+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.935106409+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.935109497+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935118847+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935123883+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935126849+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935131578+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935134037+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:23:15.935176852+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.935179565+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:15.935183010+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.935185593+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.935188430+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:15.935204795+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.935256736+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.935262874+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.935278818+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.935281040+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.935284176+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000000447b2c4
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x679ef142f950ce8f3362305485336279ef670c0fae64371433d7182dc1db2204
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x8b9a69db7ad4ff9574a11c4182e98f5cd87403a9
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000003d9f23e4
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xb1507af95f7ccf232f22295d09153471354678b286b22704c1059fe2d4ebaecb
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x3baa410dacc4749476da0a7af61f8b7a1d7db230
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x49c296d9
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000c743e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0006b6c30)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000638690)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00001415c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006be750)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00069f000)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000014180)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000014190)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000c74640)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000c74660)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000c74680)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:23:16.031255435+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:23:16.031317144+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:23:16.032138315+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:23:16.036269990+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:23:16.036370561+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:301f4eec-d9ac-4c0c-bec6-f6871cea67bb/modify |  |
2025-06-15T14:23:16.036932863+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:16.036993036+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:16.037030441+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:23:16.037035263+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:23:16.037038709+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:23:16.037045283+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:23:16.037860624+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:23:16.037951596+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:23:16.037971421+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=672cac82-c3ec-43f3-989f-0cae004629d0&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:23:16.038555512+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:23:16.039337083+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.057590009+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:16.064064052+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:23:16.064228834+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:23:16.064264175+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:23:16.064270937+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:23:16.066085993+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.086995523+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:23:16.088484909+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:23:16.089261228+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:23:16.089347463+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:23:16.090874896+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:16.091332972+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:16.091745920+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:23:16+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001860160 0xc001860180 0xc0018601a0]
2025-06-15T14:23:16.091820473+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:23:16.091825925+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001860160 0xc001860180 0xc0018601a0]}
2025-06-15T14:23:16.091828648+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:23:16.092344207+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.094704243+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=672cac82-c3ec-43f3-989f-0cae004629d0&target-nf-type=AMF |  |
2025-06-15T14:23:16.095267264+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:23:16.095400459+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-15T14:23:16.095409596+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:23:16.095412995+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-15T14:23:16.095419537+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:23:16.095424266+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:23:16.095426857+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:23:16.095430268+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:23:16.096770642+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:23:16.098763536+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:16.105615897+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:23:16.105831259+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:23:16.106673367+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:23:16.107653613+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.108630783+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:23:16.108845722+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:23:16.109196815+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:23:16.109421689+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.116692930+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:23:16.118436371+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:23:16.119213271+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:23:16.119229779+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:23:16.119235086+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:23:16.119238047+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:23:16.119241031+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:23:16.119260306+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:23:16.119630950+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:23:16.119763677+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:23:16.119773501+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:16.119838319+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:23:16.119851993+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:16.119896342+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:23:16.120014203+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:23:16.120113017+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:23:16.120920452+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-15T14:23:16.125220907+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:23:16.126745323+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:23:16.126861875+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend PDU Session Resource Setup Request
2025-06-15T14:23:16.128210977+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:23:16.128583905+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:16.128664668+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.128672995+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-15T14:23:16.128703369+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.128706164+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128708390+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.128739338+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.128742110+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.128747098+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.128755254+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.128758922+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.128761852+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.128764222+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:23:16.128813509+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128816130+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:16.128819655+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.128822099+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.128824613+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:16.128841340+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.128844757+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128846749+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.128861965+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.128866426+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128868354+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000001f7636d8
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x99da1e301fe0653863d1445f2aedf134d5263793a784e700111ac904e4cf4813
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xb1133dd725ba25d3b21abbb915e2134200e0bd64
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000007ebaaf9e
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xa026d2f366d0aec1dc0c5a8da67998cf155f28a72fd51bc8dacd1c4a8f589a40
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x609216127312a6d2f180c3f239c0ba31d099f38d
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x00755650
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000c75320)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0006b6f00)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000639040)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00071233c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006be900)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00069f700)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000712370)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000712380)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000c75340)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000c75360)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000c75380)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:23:16.244312461+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:23:16.244555946+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:23:16.247185502+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:23:16.250082624+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:23:16.250536153+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:645b05ab-97c0-4ece-b57e-fc55770f122c/modify |  |
2025-06-15T14:23:16.251039580+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport
2025-06-15T14:23:16.251080773+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:23:16.251124592+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:23:16.251137653+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:23:16.251147540+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:23:16.251164150+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:23:16.252255920+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:23:16.252504473+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:23:16.252526003+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=672cac82-c3ec-43f3-989f-0cae004629d0&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:23:16.253151958+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:23:16.253777696+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.274287992+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:23:16.277508033+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:23:16.277693476+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:23:16.277734643+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:23:16.277739338+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:23:16.278898530+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.299296384+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:23:16.301313955+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:23:16.301974795+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:23:16.302111302+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:23:16.304283043+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:16.304583381+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:16.304747625+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:23:16+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0006f2c60 0xc0006f2c80 0xc0006f2ca0]
2025-06-15T14:23:16.304769530+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:23:16.304777495+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0006f2c60 0xc0006f2c80 0xc0006f2ca0]}
2025-06-15T14:23:16.304784687+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:23:16.305182065+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.308028742+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=672cac82-c3ec-43f3-989f-0cae004629d0&target-nf-type=AMF |  |
2025-06-15T14:23:16.308722121+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:23:16.308851069+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-15T14:23:16.308866845+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:23:16.308877689+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-15T14:23:16.308915100+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:23:16.308927784+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:23:16.308936823+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:23:16.308948820+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:23:16.309350665+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:23:16.311927374+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:23:16.318758774+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:23:16.318999340+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:23:16.319307840+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:23:16.319842695+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.321050510+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:23:16.321362003+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:23:16.321685020+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:23:16.321940260+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:23:16.330541631+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:23:16.331420242+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:23:16.332601145+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:23:16.332665477+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:23:16.332675416+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:23:16.332678472+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:23:16.332681012+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:23:16.332699581+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:23:16.333137246+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:23:16.333268956+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:23:16.333279288+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:16.333308673+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:23:16.333368865+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:23:16.333407306+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:23:16.333495227+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:23:16.333597450+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:23:16.333960151+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-15T14:23:16.341928642+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:23:16.347203193+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:23:16.347607499+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mSend PDU Session Resource Setup Request
2025-06-15T14:23:16.348329156+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:23:16.348938075+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:16.348969292+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.348973848+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-15T14:23:16.349069506+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.349074852+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.349077187+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.349110846+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.349116030+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.349121288+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.349131665+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.349135216+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.349138044+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.349141014+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:23:16.349186492+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.349189249+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:16.349192981+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.349195722+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.349198287+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:16.349213578+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.349217409+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.349219489+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.349238541+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.349290105+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.349296253+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000065e53a15
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x3ab2d19e86c1544dd45a1bd42713b03ecf780bb96c0fd67a86aaa4842467d164
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xda99c81feee5ccb7b62c062b6b7ee9b473ac41be
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000eb7a27c7
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x597b8bbfcc187d1af690e063883208791f3008cde72e9369e253c0c106f55295
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x3df0d7b24b2e7f2efb12e314fde68eac93d4df2b
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xd79801ec
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00005e060)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0006b71d0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc0006399f0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  03 02 00 06 21 12 01 01  ff 02 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000ffafc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006beab0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00069fe00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 03 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0000ffb20)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000ffb30)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00005e080)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00005e0a0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00005e0c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-15T14:23:16.448461084+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:23:16.448744722+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:47394] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:23:16.449971225+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:23:16.453050495+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:23:16.453150294+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:120baff5-377c-4950-a2af-5707732d2fb2/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=707.779µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=613.44µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=1.15082ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=451.865µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=1.998762ms
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 451.865µs/984.533µs/1.998762ms/557.557µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.91s)
PASS
ok  	test	9.963s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.42s)
PASS
ok  	test	28.298s

--- STDERR ---
2025-06-15T14:22:55.845894202+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:22:55.846050331+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-15T14:22:55.846417053+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:22:55.846603852+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc000079220)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0005ad860)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0005ada10)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000033bc0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-15T14:22:55.846611409+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:22:55.846614806+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-15T14:22:55.846617439+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-15T14:22:55.846708995+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-15T14:22:55.846717433+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-15T14:22:55.852137907+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-15T14:22:55.852342908+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-15T14:22:55.852537953+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-15T14:22:55.852601041+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-15T14:22:55.852631761+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-15T14:22:55.852649445+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-15T14:23:01.485795879+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-15T14:23:01.485895920+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-15T14:23:08.006386070+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:23:08.007524867+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-15T14:23:08.008318507+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-15T14:23:08.008395686+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-15T14:23:08.008404213+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-15T14:23:08.008523426+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-15T14:23:08.008532721+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-15T14:23:08.013104272+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-15T14:23:08.013201843+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-15T14:23:08.015831168+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-15T14:23:08.017629689+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-15T14:23:08.017940156+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-15T14:23:08.018123011+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-15T14:23:08.018286341+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-15T14:23:08.018292799+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-15T14:23:08.029356522+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-15T14:23:14.870272261+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.870670462+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.870686834+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.870752708+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.870770398+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.870775404+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-15T14:23:14.887196621+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.887317654+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.887331565+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:14.887343081+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:23:14.887352492+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:14.887361882+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:14.887371959+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:14.887395878+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.887404849+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:23:14.887431831+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.887440701+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.887449001+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:14.887458321+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:23:14.887466732+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:14.887490787+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:14.887508412+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:14.894777153+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.894897268+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.894909326+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.894922576+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:23:14.894934111+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.894939989+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.894943728+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.894995926+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.895002792+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.895008495+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.895017421+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.895022945+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.895028324+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-15T14:23:14.895031931+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.895035589+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:23:14.895042654+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-15T14:23:14.895048961+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:23:14.895052256+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:23:14.896960061+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897073239+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:23:14.897100631+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-15T14:23:14.897106735+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:23:14.897116782+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:14.897119918+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:23:14.897139510+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.897144616+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897157876+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.897194203+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.897196428+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.897198413+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.898349589+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.898373734+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.898378181+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.898382549+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:23:14.898388634+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.898391962+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.898394535+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.898413477+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.898417108+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.898420125+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.898424255+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:23:14.898435338+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:14.898549862+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:14.898616496+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-15T14:23:14.898637271+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:14.898644048+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-15T14:23:14.963559560+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:23:14.963641623+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:14.963650776+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:23:14.963661856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.963664986+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:14.963667541+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:23:14.963680596+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.963683362+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.963686090+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.963704148+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.963706527+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.963708417+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.964688401+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.964791408+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.964808427+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.964814284+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:23:14.964819492+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.964821754+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.964823884+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.964836772+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.964839277+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.964841648+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.964845363+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:23:14.964854356+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:14.964858615+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:14.971576328+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:23:14.971676161+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:14.971686497+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:23:14.971693353+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.971696079+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:14.971698493+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:23:14.971713522+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.971716183+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.971718346+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.971729319+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.971731418+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.971733462+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.972344018+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:14.972544111+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.972715538+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.972723716+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:23:14.972729316+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:14.972731784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:14.972733822+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:14.972750050+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:14.972752797+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.972755187+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:14.972758589+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:23:14.972818647+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:14.972827958+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:15.112740424+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-15T14:23:15.112820289+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:15.112828746+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-15T14:23:15.112834487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.112837542+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:23:15.112847924+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.112850550+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.112852748+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.112871513+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.112875681+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.112877957+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.113895389+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.113912202+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.113915979+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.113922944+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:23:15.113928628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.113931177+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.113933493+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.113946592+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.113949654+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.113959328+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.114000285+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 3290921573, Outbound SPI: 4112160063
2025-06-15T14:23:15.114024830+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.114027359+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:23:15.114030681+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:23:15.114033593+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:15.114037374+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.114039845+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.114044961+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:15.114048065+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:15.114054871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.114104320+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.114110910+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.114320101+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.114379659+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.114387085+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.114506308+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.114516587+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.114523536+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:15.114526345+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:23:15.114532206+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.114545302+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-15T14:23:15.115904012+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.116118157+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:23:15.117186735+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:15.117995987+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:23:15.620151667+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:15.765300551+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:23:15.765459883+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-15T14:23:15.770621636+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-15T14:23:15.770643087+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-15T14:23:15.772510614+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-15T14:23:15.784410674+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:23:15.784569363+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:15.784580587+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:23:15.784603392+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.784611456+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:15.784616057+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:15.784619149+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.784622502+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.784625052+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:15.784627394+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:15.784645626+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.784649862+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.784651991+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.784674588+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.784723630+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.784729720+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.785561324+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.785587091+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.785593907+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785598383+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:23:15.785601486+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 2078401158857273057
2025-06-15T14:23:15.785606135+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.785608652+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.785610762+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.785640660+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.785697214+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785706897+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785710251+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785713296+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.785723551+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.785728047+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:15.785732213+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:23:15.786117579+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.786450718+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.786492224+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:23:15.787810913+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:15.825013586+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:23:15.922321283+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:23:15.922344281+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-15T14:23:15.925868935+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-15T14:23:15.929456988+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-15T14:23:15.933918681+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:23:15.934087099+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:15.934097849+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:23:15.934120939+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.934296511+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:15.934305848+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:15.934309292+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.934312711+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:15.934315170+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:15.934317543+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:15.934327880+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.934330319+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.934332467+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.934446683+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.934454923+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.934457442+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.935513864+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:15.935547178+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.935561335+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935566416+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:23:15.935570106+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 2078401158857273057
2025-06-15T14:23:15.935574262+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:15.935576941+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:15.935579169+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:15.935615697+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:15.935618923+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935623791+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935627071+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935630394+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:15.935694133+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.935751900+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:15.935758583+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:23:15.938578598+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-15T14:23:15.950763212+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.950942183+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:15.950988928+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:23:15.953014507+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:16.032948994+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:23:16.120656609+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:23:16.120727094+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-15T14:23:16.122480529+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-15T14:23:16.122602721+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-15T14:23:16.127325783+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:23:16.127970165+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:16.127985721+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:23:16.128020734+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128024062+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:16.128027796+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:16.128031839+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.128034621+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.128037573+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:16.128039866+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:16.128048513+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.128052072+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128058693+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.128074743+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.128077004+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.128078955+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.129327462+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:16.129401717+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.129410111+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.129413709+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:23:16.129425356+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 2078401158857273057
2025-06-15T14:23:16.129430562+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.129432861+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.129435015+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.129478945+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.129533527+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.129542560+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.129545650+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.129549064+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.129557096+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:16.129561661+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:16.129564368+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:23:16.132279406+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-15T14:23:16.132476598+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:16.132566056+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:16.132593969+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:23:16.148338679+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:23:16.247925478+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:23:16.334879736+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:23:16.334983783+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-15T14:23:16.338365729+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-15T14:23:16.338932637+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-15T14:23:16.348479955+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:23:16.348597248+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:16.348607509+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:23:16.348632871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.348652662+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:23:16.348656996+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:23:16.348660261+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.348663233+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:23:16.348665778+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:16.348676281+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:23:16.348690008+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.348750102+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.348756928+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.348778799+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.348781126+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.348783175+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.350343143+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:23:16.350528126+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.350543534+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.350548240+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:23:16.350551497+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 2078401158857273057
2025-06-15T14:23:16.350556757+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:23:16.350559617+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:23:16.350561859+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:23:16.350596752+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:23:16.350599813+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.350607438+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.350610825+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.350614082+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:23:16.350671937+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:16.350683151+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:23:16.350686328+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:23:16.353724655+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-15T14:23:16.353881460+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:16.353950393+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:23:16.353981583+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:23:16.450767915+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:23:27.802772647+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-15T14:23:27.802949327+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-15T14:23:27.803320143+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-15T14:23:27.803396983+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-15T14:23:27.803412124+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-15T14:23:27.842828744+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-15T14:23:27.842950148+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-15T14:23:27.842984674+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-15T14:23:27.843024730+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-15T14:23:27.843031684+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-15T14:23:27.843036353+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-15T14:23:28.275057408+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-15T14:23:28.275136412+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-15T14:23:28.275353218+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-15T14:23:28.275452803+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-15T14:23:28.275468142+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-15T14:23:28.275565987+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-15T14:23:28.275859364+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-15T14:23:28.275911944+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-15T14:23:28.275922066+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-15T14:23:28.275575774+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.203:33583: use of closed network connection
2025-06-15T14:23:28.275934840+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.203:33583: use of closed network connection
2025-06-15T14:23:28.275578188+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-15T14:23:28.275974986+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-15T14:23:28.275981779+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-15T14:23:28.275988062+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-15T14:23:28.276007367+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-15T14:23:28.276063681+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:23:28.276084496+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-15T14:23:28.276089266+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:23:28.276095849+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-15T14:23:28.276175858+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-15T14:23:28.276402621+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-15T14:23:28.276478421+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-15T14:23:28.276493998+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-15T14:23:28.276497105+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (116682): No such process
