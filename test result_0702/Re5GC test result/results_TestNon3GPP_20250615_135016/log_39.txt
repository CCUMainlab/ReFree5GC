Run TestCN
os.Args: [/tmp/go-build1385163997/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-15T14:15:56.679969957+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.680124111+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.680133317+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.680147939+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-15T14:15:56.680176439+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-15T14:15:56.686038994+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.686111522+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.686114218+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.686666724+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-15T14:15:56.692998618+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.693054219+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.693067530+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.693071748+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-15T14:15:56.693091794+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-15T14:15:56.693808314+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:15:56.693863788+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.693869104+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.693871170+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.695317130+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.695591981+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.695650770+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.695657297+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-15T14:15:56.695685560+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-15T14:15:56.695748828+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.695754284+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.695756358+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-15T14:15:56.696052843+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.696059376+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.696061517+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.696072556+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 089ff2bb-6671-40aa-8a87-b053bad6a93a ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{089ff2bb-6671-40aa-8a87-b053bad6a93a-auth nausf-auth 0xc000811ab8 http REGISTERED   0xc000811aa0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{089ff2bb-6671-40aa-8a87-b053bad6a93a-policyauthorization npcf-policyauthorization 0xc000811b18 http REGISTERED   0xc000811b00  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{089ff2bb-6671-40aa-8a87-b053bad6a93a-smpolicycontrol npcf-smpolicycontrol 0xc000811ae8 http REGISTERED   0xc000811ad0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000c0e780 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc0001fc630 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-15T14:15:56.696331089+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-15T14:15:56.696815091+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.696867006+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.696872795+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.696877935+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-15T14:15:56.697036225+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-15T14:15:56.702766873+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-15T14:15:56.702827447+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-15T14:15:56.702833446+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:56.702837130+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-15T14:15:56.702863847+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-15T14:15:56.703083963+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-15T14:15:56.703119744+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-15T14:15:56.908022010+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-15T14:15:56.908540898+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-15T14:15:56.908631614+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-15T14:15:56.910530435+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:56.915138571+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:56.916639482+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 7e37c52e-a7ed-4212-ae45-298c5cd0e315
2025-06-15T14:15:56.918871318+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/7e37c52e-a7ed-4212-ae45-298c5cd0e315 |  |
2025-06-15T14:15:56.919074051+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:56.919102457+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-15T14:15:57.109987685+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-15T14:15:57.111423338+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:57.115620520+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:57.117360504+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 01b5da4c-4d5d-45c2-a3cc-f0843dca2a67
2025-06-15T14:15:57.119710124+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/01b5da4c-4d5d-45c2-a3cc-f0843dca2a67 |  |
2025-06-15T14:15:57.120075969+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:57.120171329+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {01b5da4c-4d5d-45c2-a3cc-f0843dca2a67 SMF REGISTERED 0 0xc000581878 0xc000581890 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc00007a000 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0005817d0 false false []}
2025-06-15T14:15:57.120223220+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-15T14:15:57.120233354+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-15 14:15:57.120227237 +0800 CST m=+0.477238665]
2025-06-15T14:15:57.120249138+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-15T14:15:57.312671944+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:57.320184145+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:57.323553753+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 7d66a279-2eaf-4bf6-8c55-af81af5d3397
2025-06-15T14:15:57.326384000+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/7d66a279-2eaf-4bf6-8c55-af81af5d3397 |  |
2025-06-15T14:15:57.327177601+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:57.327463167+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-15T14:15:57.327597730+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-15T14:15:57.327617491+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:15:57.327790877+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-15T14:15:57.512171628+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-15T14:15:57.512252042+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-15T14:15:57.513096615+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:57.516023492+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:57.517565534+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: a9514a75-c766-48c9-9001-81b1817676ab
2025-06-15T14:15:57.519366378+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/a9514a75-c766-48c9-9001-81b1817676ab |  |
2025-06-15T14:15:57.519638528+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:57.519685188+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-15T14:15:57.715100966+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:57.743587629+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:57.745434519+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 38ac422d-f2b2-46e5-933c-880ee1772984
2025-06-15T14:15:57.747184393+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/38ac422d-f2b2-46e5-933c-880ee1772984 |  |
2025-06-15T14:15:57.747626369+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:57.747658032+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-15T14:15:57.747667228+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-15T14:15:57.918526614+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-15T14:15:57.919371056+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:57.922168014+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:57.922821701+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 089ff2bb-6671-40aa-8a87-b053bad6a93a
2025-06-15T14:15:57.923361179+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/089ff2bb-6671-40aa-8a87-b053bad6a93a |  |
2025-06-15T14:15:57.923697828+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:57.923750753+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-15T14:15:58.119120936+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-15T14:15:58.120230151+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:58.120609617+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-15T14:15:58.122068575+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-15T14:15:58.124884295+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:58.126252940+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: eee11620-3114-41f0-b2e4-9ba6072fd22c
2025-06-15T14:15:58.127599186+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/eee11620-3114-41f0-b2e4-9ba6072fd22c |  |
2025-06-15T14:15:58.127797899+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:58.127869331+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-15T14:15:58.321192758+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-15T14:15:58.321766960+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-15T14:15:58.326955512+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:15:58.329442513+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:15:58.330498785+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8ff71eaf-2aad-43b1-88ec-26b80cf55a64
2025-06-15T14:15:58.332175851+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8ff71eaf-2aad-43b1-88ec-26b80cf55a64 |  |
2025-06-15T14:15:58.332477262+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:15:58.332544976+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-15T14:16:04.047344081+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139
2025-06-15T14:16:04.051579283+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139
2025-06-15T14:16:04.051884149+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle NGSetupRequest
2025-06-15T14:16:04.051900438+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mMissing IE PagingDRX
2025-06-15T14:16:04.051923580+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2924928883/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-15T14:16:10.678117789+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.678266158+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.678273550+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:10.678278204+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:16:10.678281031+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:10.678420768+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.678431358+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.678433697+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:10.678436753+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:16:10.678438974+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:10.688407463+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.688480355+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.688493543+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.688505822+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.688515224+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.688523824+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.688531507+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-15T14:16:10.692887042+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.692935057+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:16:10.692944332+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:10.692956649+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:10.692965752+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:10.692990898+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.693007989+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.693016464+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.693030569+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.693037823+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.693045053+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.698836486+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.698913870+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.698928187+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.698938211+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.698947595+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.698955213+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.699054239+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.699073430+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699082812+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699092646+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699104228+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699113398+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-15T14:16:10.699194817+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.699203498+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.699210847+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:16:10.699223308+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.699230908+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.699251407+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.699263610+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.699271975+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.699279073+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.700269270+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle InitialUEMessage
2025-06-15T14:16:10.700456892+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-15T14:16:10.700486876+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-15T14:16:10.700521621+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-15T14:16:10.700538123+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-15T14:16:10.700546406+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-15T14:16:10.700550861+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-15T14:16:10.700555083+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-15T14:16:10.700560980+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-15T14:16:10.700564128+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-15T14:16:10.701150038+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.710023772+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-15T14:16:10.712269629+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-15T14:16:10.712282674+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-15T14:16:10.712976360+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.733089687+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-15T14:16:10.735027489+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-15T14:16:10.735239681+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-15T14:16:10.735248015+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-15T14:16:10.735259688+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-15T14:16:10.735947766+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.742211534+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-15T14:16:10.743880873+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:16:10.746824995+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:16:10.747143313+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-15T14:16:10.747381232+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-15T14:16:10.747435737+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-15T14:16:10.747444110+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 3032336564376138336237313830343265343164363438646363306562633630
2025-06-15T14:16:10.747506286+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-15T14:16:10.747805672+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-15T14:16:10.747879946+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend Downlink Nas Transport
2025-06-15T14:16:10.749113313+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.749168387+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.749180263+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.749189285+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.749196998+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.749204691+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.749224788+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.749284882+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.749314016+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.749767547+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.749799087+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.749812749+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:16:10.749827983+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.749835994+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.749844782+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.749857793+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.749865529+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.749872658+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.750364001+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:10.750435992+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:10.750488178+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-15T14:16:10.750493144+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-15T14:16:10.751875679+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-15T14:16:10.751935935+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 3032336564376138336237313830343265343164363438646363306562633630
Xres*: 3032336564376138336237313830343265343164363438646363306562633630
2025-06-15T14:16:10.751942609+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-15T14:16:10.752574045+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-15T14:16:10.753804198+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-15T14:16:10.756504921+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-15T14:16:10.757304294+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-15T14:16:10.758058237+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-15T14:16:10.758132367+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-15T14:16:10.758155726+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend Downlink Nas Transport
2025-06-15T14:16:10.759212000+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.759264094+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.759277152+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.759287045+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.759295620+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.759307615+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.759330686+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.759339223+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.759347095+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.759379654+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.759405792+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.759422640+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:16:10.759436777+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.759446251+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.759453655+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.759465928+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.759473330+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.759480980+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.760038082+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:10.760115743+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:10.760152891+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-15T14:16:10.760157565+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-15T14:16:10.760174077+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-15T14:16:10.760177731+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-15T14:16:10.761575881+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.782246610+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:16:10.784232036+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-15T14:16:10.785533797+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:16:10.786999938+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-15T14:16:10.787926647+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:10.789110252+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.811718529+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:16:10.813952508+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-15T14:16:10.815675719+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-15T14:16:10.815932304+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-15T14:16:10.816649005+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-15T14:16:10.816946230+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:16:10.817530129+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:10.817818699+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:10.818609854+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-15T14:16:10.819868033+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-15T14:16:10.820100589+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:10.820954484+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-15T14:16:10.822243459+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-15T14:16:10.822814713+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-15T14:16:10.824140800+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-15T14:16:10.824685526+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-15T14:16:10.824832946+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-15T14:16:10.825277626+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.847259932+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-15T14:16:10.850934627+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:16:10.851850098+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.871412831+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-15T14:16:10.875997316+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:16:10.891509025+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:10.909276108+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-15T14:16:10.911770302+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-15T14:16:10.911846860+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-15T14:16:10.911869087+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-15T14:16:10.912179690+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:16:10.912577830+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-15T14:16:10.912657687+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend Initial Context Setup Request
2025-06-15T14:16:10.913671348+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.913769441+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.913777901+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.913781240+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.913787190+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.913926598+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.913951227+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.913954776+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.913963170+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.913966045+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:16:10.914319905+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.914409242+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:16:10.914416945+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:16:10.914426902+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.914429321+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.914431622+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.914439769+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.914441860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.914443973+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.915781347+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.915806457+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.915811351+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.915819550+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.915823047+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.915826176+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.915856199+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.915855283+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle InitialContextSetupResponse
2025-06-15T14:16:10.915952464+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.915983262+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.915989783+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.915996516+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.916000838+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.916005427+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.916008844+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-15T14:16:10.916060230+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:16:10.916078902+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0xe6c6e79a
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000c86f80)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fcc30)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc0006c6540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000ca4e70)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000c86fa0)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000c86fc0)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000ca4eab)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000ca4ec3)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-15T14:16:10.918902377+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:10.918941999+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:10.918985649+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-15T14:16:10.918999062+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-15T14:16:10.919021709+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-15T14:16:10.919037503+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend Downlink Nas Transport
2025-06-15T14:16:10.919145900+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-15T14:16:11.425146016+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:11.425213616+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:11.425261397+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:16:11.425266157+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:16:11.425269829+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:16:11.425277676+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:16:11.426689884+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.434019573+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-15T14:16:11.436128080+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:16:11.436289132+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:16:11.436455960+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:16:11.437416684+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:16:11.438687954+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.458871644+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:11.460677282+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:16:11.460868063+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:16:11.460908007+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:16:11.460993964+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:16:11.462319543+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.476656045+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:16:11.479049652+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:16:11.479881241+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:16:11.479922997+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:16:11.481421224+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.481679686+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.481931877+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:16:11+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001645a80 0xc001645aa0 0xc001645ac0]
2025-06-15T14:16:11.481987080+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:16:11.482000695+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001645a80 0xc001645aa0 0xc001645ac0]}
2025-06-15T14:16:11.482010156+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:16:11.482724399+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.483953435+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&target-nf-type=AMF |  |
2025-06-15T14:16:11.484582171+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:16:11.484652936+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-15T14:16:11.484656928+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:16:11.484660111+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-15T14:16:11.484665489+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:16:11.484669870+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:16:11.484672434+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:16:11.484676175+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:16:11.485656954+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:16:11.486456381+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.498490501+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-15T14:16:11.502885845+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:16:11.504597718+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:16:11.505898485+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:16:11.506360247+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-15T14:16:11.507047671+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.512997893+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-15T14:16:11.515688417+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.519177083+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:16:11.519623824+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:16:11.520008636+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:16:11.520413580+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.521461860+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:16:11.522226118+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:16:11.522667312+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:16:11.523529172+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.528962848+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:16:11.529404191+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:16:11.531004561+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:16:11.531185570+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:16:11.531197586+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:16:11.531201709+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:16:11.531204161+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:16:11.531352111+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:16:11.531669187+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:16:11.531754503+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:16:11.531793777+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:11.531993179+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:16:11.532013581+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:11.532051333+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:16:11.532182906+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:16:11.532331229+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:16:11.532552911+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-15T14:16:11.543809441+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:16:11.545234291+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:16:11.545378669+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend PDU Session Resource Setup Request
2025-06-15T14:16:11.545718093+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:16:11.547226776+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:11.547254058+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.547257824+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-15T14:16:11.547306883+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.547309215+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.547311220+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.547348417+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.547351995+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547359867+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547362614+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547368789+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547380419+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547395912+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-15T14:16:11.547462834+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.547465740+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:11.547469061+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.547471757+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.547473920+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:11.547480043+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.547481845+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.547483728+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.547497423+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.547500251+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.547502020+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xf47f5a87
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000bbea00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0007ac1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b6c460)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000bce534)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000744480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c8a280)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000bce560)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000bce570)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000bbea20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000bbea40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000bbea60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:16:11.626655487+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:16:11.626721195+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:16:11.627838834+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:16:11.630059345+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:16:11.630327489+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:a1f0b0c1-689d-4536-83d1-8ddbb5a564a8/modify |  |
2025-06-15T14:16:11.631360957+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:11.631414959+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:11.631447159+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:16:11.631450973+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:16:11.631454059+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:16:11.631459864+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:16:11.633149959+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:16:11.633337013+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:16:11.633395212+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:16:11.634016160+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:16:11.635328874+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.647828258+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:11.649365565+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:16:11.649524239+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:16:11.649552836+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:16:11.649600122+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:16:11.650242976+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.667894639+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:16:11.669322807+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:16:11.670564335+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:16:11.670633116+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:16:11.672684640+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.673024819+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.673379592+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:16:11+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0005c2160 0xc0005c2180 0xc0005c21a0]
2025-06-15T14:16:11.673399886+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:16:11.673404777+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0005c2160 0xc0005c2180 0xc0005c21a0]}
2025-06-15T14:16:11.673407386+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:16:11.673861507+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.675430859+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&target-nf-type=AMF |  |
2025-06-15T14:16:11.675822924+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:16:11.675935370+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-15T14:16:11.675980493+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:16:11.675987058+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-15T14:16:11.675993960+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:16:11.675999164+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:16:11.676001923+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:16:11.676005395+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:16:11.676831803+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:16:11.678080625+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.683856192+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:16:11.684109031+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:16:11.684653704+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:16:11.685140148+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.685893380+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:16:11.686008231+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:16:11.686488519+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:16:11.686702756+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.693631168+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:16:11.694335630+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:16:11.699878517+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:16:11.699940524+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:16:11.699955021+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:16:11.699957796+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:16:11.699959889+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:16:11.699998279+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:16:11.700337052+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:16:11.700459086+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:16:11.700481205+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:11.700516065+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:16:11.700529094+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:11.700561091+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:16:11.700756026+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:16:11.700911459+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:16:11.701089820+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-15T14:16:11.706762096+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:16:11.707689264+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:16:11.707768329+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend PDU Session Resource Setup Request
2025-06-15T14:16:11.707912951+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:16:11.708591794+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:11.708624453+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.708628971+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-15T14:16:11.708794357+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.708798910+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708804409+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.708835168+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.708838164+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.708842123+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.708844453+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.708847480+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.708849733+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.708851889+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:16:11.708887820+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708889994+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:11.708893769+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.708896052+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.708898163+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:11.708904339+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.708906189+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708908416+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.708918347+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.708920393+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708925175+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000cf61a724
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x90e7557860131061f7d0cb24d3155494f4290c0f8c4fbcf6cd67a9aa741ee904
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xbbb229223b2beddaeed1d3e0e2ca5d63391b1055
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000060ccafd1
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x9e68d9d631c49928b8d36a9c041b21ac291d261c85bdec5f78db736e0a6bf3e8
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xd60a6e6be69144934d5d853238b31b4f92025930
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x5febea11
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000bbf6e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0007ac4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b6ce60)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006adb7c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000744630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c8a980)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0006adbf0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0006adc00)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000bbf700)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000bbf720)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000bbf740)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:16:11.814379113+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:16:11.814444685+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:16:11.815206463+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:16:11.817452534+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:16:11.817533692+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:f9e6ecc3-4f6a-4e54-837e-153927f02b48/modify |  |
2025-06-15T14:16:11.817713832+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:11.817771130+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:11.817820525+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:16:11.817832117+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:16:11.817836031+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:16:11.817842227+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:16:11.818604878+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:16:11.818701678+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:16:11.818730453+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:16:11.818969457+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:16:11.820076277+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.833335392+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:11.835562586+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:16:11.835867046+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:16:11.835956102+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:16:11.835979346+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:16:11.836600358+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.864323661+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:16:11.866250946+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:16:11.867073509+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:16:11.867098533+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:16:11.868261031+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.868573759+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.869079499+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:16:11+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0006513c0 0xc0006513e0 0xc000651400]
2025-06-15T14:16:11.869458982+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:16:11.869637616+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0006513c0 0xc0006513e0 0xc000651400]}
2025-06-15T14:16:11.869962841+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:16:11.871060198+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.872913877+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&target-nf-type=AMF |  |
2025-06-15T14:16:11.873423968+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:16:11.873549955+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-15T14:16:11.873576749+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:16:11.873587830+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-15T14:16:11.873602379+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:16:11.873614474+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:16:11.873623189+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:16:11.873633288+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:16:11.874862724+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:16:11.876679001+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:11.881375202+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:16:11.881795603+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:16:11.882966142+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:16:11.883980072+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.884873773+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:16:11.885220749+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:16:11.885576186+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:16:11.885812310+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:11.891824549+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:16:11.892535180+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:16:11.894268116+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:16:11.894334899+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:16:11.894344086+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:16:11.894346916+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:16:11.894349991+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:16:11.894367399+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:16:11.894939305+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:16:11.895049514+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:16:11.895073848+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:11.895110017+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:16:11.895124177+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:11.895157693+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:16:11.895281282+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:16:11.895391117+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:16:11.895960516+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-15T14:16:11.901617280+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:16:11.902261803+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:16:11.902344765+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend PDU Session Resource Setup Request
2025-06-15T14:16:11.903281462+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:16:11.903439080+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:11.903473377+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.903479964+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-15T14:16:11.903509750+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.903513265+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903515329+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.903547547+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.903550826+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.903556875+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.903559479+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.903562885+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.903566469+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.903568728+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:16:11.903666813+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903671702+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:11.903675122+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.903677658+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.903680048+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:11.903693256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.903695488+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903697476+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.903711380+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.903713284+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903715036+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000004c6c85b
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x3a1211805724bcb4cdf6be28a4367cda95c215f13f187defecc3a345a9dc2ff9
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x03c5c1095d930e074f3e6d94439a99da8be67ae3
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000fc3f2adc
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x79e035997a63994d723445290c438748487fb38b43f2bf6e810f8d71941dd726
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x2146ddcba17f7ce1d1d14ac12ae31bd4e8b4f211
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
2025-06-15T14:16:11.911094339+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:16:11.911118234+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
Security header type: Integrity Protected And Ciphered
cmac value: 0xba57851d
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000782460)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0007ac780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00007c050)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00078de5c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007447e0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c8b080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00078dec0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00078ded0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000782480)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0007824a0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0007824c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-06-15T14:16:11.913171587+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:16:11.952497784+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:16:11.952549569+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:8818bd83-32ba-4930-a778-54d369d7e0e2/modify |  |
2025-06-15T14:16:12.116095944+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport
2025-06-15T14:16:12.116186767+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:16:12.116233357+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:16:12.116238832+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:16:12.116242364+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:16:12.116250500+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:16:12.117264831+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:16:12.117498492+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:16:12.117519887+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:16:12.118442997+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:16:12.119120922+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:12.130279359+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:16:12.132438245+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:16:12.132577735+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:16:12.132618093+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:16:12.132633979+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:16:12.133034777+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:12.149972779+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:16:12.151479609+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:16:12.152576259+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:16:12.152671160+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:16:12.153914137+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:12.154384145+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:12.154682990+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:16:12+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc00170e4e0 0xc00170e500 0xc00170e520]
2025-06-15T14:16:12.154748336+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:16:12.154761270+08:00[36m [INFO][SMF][GSM] [0m&{[0xc00170e4e0 0xc00170e500 0xc00170e520]}
2025-06-15T14:16:12.154770050+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:16:12.155468575+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:12.156959081+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=7e37c52e-a7ed-4212-ae45-298c5cd0e315&target-nf-type=AMF |  |
2025-06-15T14:16:12.157456409+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:16:12.157578201+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-15T14:16:12.157585432+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:16:12.157588418+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-15T14:16:12.157594509+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:16:12.157598873+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:16:12.157601621+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:16:12.157604718+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:16:12.158625405+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:16:12.160005540+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:16:12.164451642+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:16:12.164612553+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:16:12.165007768+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:16:12.165554358+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:12.166397093+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:16:12.166538216+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:16:12.166914570+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:16:12.167107705+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:16:12.172796428+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:16:12.173563835+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:16:12.174469184+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:16:12.174514946+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:16:12.174536382+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:16:12.174548564+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:16:12.174556565+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:16:12.174577089+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:16:12.174777096+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:16:12.174987356+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-15T14:16:12.175093051+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:16:12.175105458+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:12.175191799+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:16:12.175201637+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:16:12.175228413+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:16:12.175348691+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:16:12.175427320+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:16:12.175675407+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-15T14:16:12.181941343+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:16:12.182967012+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:16:12.183038055+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mSend PDU Session Resource Setup Request
2025-06-15T14:16:12.183148529+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:16:12.183921861+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:12.183991436+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:12.183998705+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-15T14:16:12.184042165+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:12.184044983+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.184046967+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:12.184073818+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:12.184076946+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184081151+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184083642+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184086322+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184088697+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184090910+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 2 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:16:12.184133197+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.184215578+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:12.184223388+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:12.184230059+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:12.184232984+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:12.184248825+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:12.184252251+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.184254238+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:12.184265861+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:12.184267696+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.184270127+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000099165af9
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x89e8eafa1eded0030d36d8475f977804d5fe528b391557aa6e8cb4b7a42cc553
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xcc193845c2b9e26d4ff9e7a82cf0e1df304d56e6
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000dfb144e8
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xd4af5366551212145a76979f00367585926d3c9f3e1b4bce93b2f41c0ccdce16
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xb8975d8b629cea361be5388f08b3af4e4d55bfe3
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x7514d4ea
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000783220)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0007aca50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00007caf0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000151ec)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000744990)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000c8b780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000015220)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000015230)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000783260)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000783280)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0007832c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-15T14:16:12.289448590+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:16:12.289475937+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60139] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:16:12.290291167+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:16:12.294636641+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:16:12.294683239+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:735799ab-eb9c-4bfc-b799-5be9b1e306e0/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=640.158µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=942.461µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=568.482µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=882.035µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=821.661µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 568.482µs/770.959µs/942.461µs/143.127µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.93s)
PASS
ok  	test	9.978s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (24.57s)
PASS
ok  	test	27.466s

--- STDERR ---
2025-06-15T14:15:51.802982221+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:15:51.803368517+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-15T14:15:51.803968207+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:15:51.804050645+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc00041c4b0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0005e8d50)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0005e8f00)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc00042c800)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-15T14:15:51.804080225+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:15:51.804108945+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-15T14:15:51.804127015+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-15T14:15:51.804356782+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-15T14:15:51.804450051+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-15T14:15:51.819690580+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-15T14:15:51.819891300+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-15T14:15:51.820163670+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-15T14:15:51.820263008+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-15T14:15:51.820297612+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-15T14:15:51.820318519+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-15T14:15:58.121465339+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-15T14:15:58.121597873+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-15T14:16:04.039933932+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:16:04.040484520+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-15T14:16:04.041110418+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-15T14:16:04.041139811+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-15T14:16:04.041148801+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-15T14:16:04.041207390+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-15T14:16:04.041219853+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-15T14:16:04.043098172+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-15T14:16:04.043167962+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-15T14:16:04.049803876+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-15T14:16:04.051287575+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-15T14:16:04.051629006+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-15T14:16:04.052622150+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-15T14:16:04.052905003+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-15T14:16:04.053231097+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-15T14:16:04.053265180+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-15T14:16:10.678583294+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.678624819+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.678630253+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.678636143+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.678683900+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.678690464+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-15T14:16:10.687843912+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.687929126+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.687936757+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:10.687950297+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:16:10.687955327+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:10.687957647+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:10.687959788+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:10.687985249+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.687988028+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:16:10.688010827+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.688013014+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.688014934+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:10.688017698+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:16:10.688019807+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:10.688021918+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:10.688023842+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:10.693231496+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.693262286+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.693266436+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.693269828+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:16:10.693289554+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.693292550+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.693294770+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.693318864+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.693322552+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.693325292+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.693329515+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.693332778+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.693337048+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-15T14:16:10.693338851+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.693340702+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:16:10.694354974+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-15T14:16:10.694379361+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:16:10.694382584+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:16:10.698154898+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.698498439+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:16:10.698516545+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-15T14:16:10.698526331+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:16:10.698541150+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.698549738+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:16:10.698592350+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.698605860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.698614039+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.698652083+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.698662303+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.698669831+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.699402013+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.699413230+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.699416859+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699420278+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:16:10.699424678+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.699426759+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.699428526+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.699446642+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.699449295+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699451866+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.699455125+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:16:10.699460741+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.699492692+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:10.699495549+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-15T14:16:10.699501069+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.699505098+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-15T14:16:10.748346060+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:16:10.748459957+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:10.748469024+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:16:10.748477481+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.748479952+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.748482147+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:16:10.748498443+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.748500757+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.748502761+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.748516005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.748518133+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.748519876+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.749974662+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.750037374+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.750044191+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.750047240+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:16:10.750051433+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.750053543+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.750055553+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.750066873+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.750069466+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.750071704+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.750074595+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:16:10.750087149+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.750092516+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:10.758781937+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:16:10.758844991+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:10.758854001+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:16:10.758859728+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.758862072+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.758864307+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:16:10.758883708+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.758886225+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.758888353+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.758901890+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.758904164+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.758905974+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.759674254+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.759695216+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.759699360+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.759703093+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:16:10.759707310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.759709939+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.759711912+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.759727430+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.759730260+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.759734986+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.759738299+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:16:10.759744148+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.759748473+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:10.913278721+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-15T14:16:10.913360211+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:10.913369217+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-15T14:16:10.913374645+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.913377336+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:16:10.913388293+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.913392764+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.913395359+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.913406338+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.913408571+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.913410619+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.914602523+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:10.914677102+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.914689265+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.914693129+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:16:10.914698068+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.914700476+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.914702655+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.914715199+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:10.914718302+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.914727417+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:10.914763342+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 1332946021, Outbound SPI: 3746293974
2025-06-15T14:16:10.914974121+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.915049533+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:16:10.915057277+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:16:10.915060567+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:10.915064580+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:10.915067312+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:10.915070260+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:10.915072544+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:10.915081592+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.915083852+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.915085799+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.915271813+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:10.915358321+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:10.915366304+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:10.915504075+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.915515123+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.915520680+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:10.915523560+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:16:10.915531930+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.915550889+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-15T14:16:10.916926115+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:16:10.917460970+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:10.918423222+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:10.919352109+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:16:11.424693210+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:11.533019330+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:16:11.533086470+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-15T14:16:11.539012255+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-15T14:16:11.539372726+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-15T14:16:11.539528118+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-15T14:16:11.546212287+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:16:11.546772752+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:11.546784479+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:16:11.546804492+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.546807420+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:11.546811295+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:11.546814018+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.546820443+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.546823838+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:11.546825954+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:11.546834622+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.546836939+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.546840050+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.546865726+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.546940045+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.546946141+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.547661002+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:11.547722536+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.547729795+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547732980+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:16:11.547737590+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15379697421897606888
2025-06-15T14:16:11.547740996+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.547742990+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.547745434+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.547774288+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.547825493+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547832792+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547835618+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547838846+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.547847248+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.547850758+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:11.547853212+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:16:11.548031371+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.548154221+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.548231430+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:16:11.549581901+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:11.628256694+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:16:11.701484417+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:16:11.701547153+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-15T14:16:11.704059647+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-15T14:16:11.704315528+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-15T14:16:11.708170890+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:16:11.708229161+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:11.708234488+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:16:11.708255366+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708259610+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:11.708264185+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:11.708268133+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.708270482+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.708272758+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:11.708274735+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:11.708284437+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.708286628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708288435+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.708306217+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.708309038+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.708310738+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.709068036+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:11.709084800+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.709089871+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.709092722+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:16:11.709095273+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15379697421897606888
2025-06-15T14:16:11.709099323+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.709101410+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.709103402+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.709135875+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.709138471+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.709141892+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.709144491+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.709147027+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.709152717+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.709156097+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:11.709158821+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:16:11.711447489+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-15T14:16:11.712427353+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.712527138+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.712552620+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:16:11.716583602+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:11.815641214+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:16:11.895770926+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:16:11.895838318+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-15T14:16:11.899214114+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-15T14:16:11.899334578+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-15T14:16:11.902697913+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:16:11.902767793+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:11.902773177+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:16:11.902982420+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.902990123+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:11.902995021+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:11.903001017+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.903004156+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:11.903006554+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:11.903008632+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:11.903017210+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.903019385+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903021423+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.903038755+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.903040832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903042759+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.903876240+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:11.903895871+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.903899415+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.903902756+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:16:11.903910967+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15379697421897606888
2025-06-15T14:16:11.903915881+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:11.903919068+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:11.903922174+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:11.904091938+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:11.904162928+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.904174544+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.904179156+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.904183716+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:11.904256390+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.904269334+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:11.904274649+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:16:11.910402697+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-15T14:16:11.910636382+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.910774865+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:11.910805783+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:16:11.913701855+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:16:11.951424222+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:16:12.176142055+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:16:12.176203643+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-15T14:16:12.179418317+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-15T14:16:12.179797442+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-15T14:16:12.183398086+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:16:12.183499852+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:12.183549930+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:16:12.183582225+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.183585832+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:16:12.183589608+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:16:12.183599467+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:12.183602217+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:16:12.183605573+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:12.183607998+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:16:12.183616691+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:12.183618822+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.183620919+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:12.183637109+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:12.183639105+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.183640839+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:12.184616432+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:16:12.184652266+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:12.184658286+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184661810+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:16:12.184664508+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15379697421897606888
2025-06-15T14:16:12.184668249+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:16:12.184670269+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:16:12.184672241+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:16:12.184698915+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:16:12.184701306+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184707138+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184710297+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184712993+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:16:12.184719706+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:12.184723341+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:16:12.184725850+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:16:12.186028061+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-15T14:16:12.186384773+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:12.186499266+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:16:12.186527620+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:16:12.290772424+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:16:23.620055588+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-15T14:16:23.620215101+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-15T14:16:23.620476304+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-15T14:16:23.620542936+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-15T14:16:23.620559770+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-15T14:16:23.680237403+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-15T14:16:23.680306557+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-15T14:16:23.680325811+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-15T14:16:23.680379050+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-15T14:16:23.680387473+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-15T14:16:23.680398269+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-15T14:16:24.065684907+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-15T14:16:24.065879371+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-15T14:16:24.066028289+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-15T14:16:24.066081414+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-15T14:16:24.066088942+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-15T14:16:24.066245940+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.215:41631: use of closed network connection
2025-06-15T14:16:24.066257987+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.215:41631: use of closed network connection
2025-06-15T14:16:24.066262017+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-15T14:16:24.066283522+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-15T14:16:24.066289531+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-15T14:16:24.066294468+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-15T14:16:24.066304634+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-15T14:16:24.066308087+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:16:24.066318392+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-15T14:16:24.066413132+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:16:24.066425437+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-15T14:16:24.066518388+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-15T14:16:24.066532653+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-15T14:16:24.066536788+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-15T14:16:24.066542100+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-15T14:16:24.066835522+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-15T14:16:24.066920045+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-15T14:16:24.066935080+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-15T14:16:24.066944913+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-15T14:16:24.066947548+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (112781): No such process
