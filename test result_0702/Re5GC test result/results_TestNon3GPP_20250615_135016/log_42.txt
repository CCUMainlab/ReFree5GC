Run TestCN
os.Args: [/tmp/go-build2685613271/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-15T14:17:52.461410651+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.461540478+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.461550450+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.461563216+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-15T14:17:52.461597389+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-15T14:17:52.462904368+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.462916189+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.462919230+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.463012446+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-15T14:17:52.463834050+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.463905327+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.463912971+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.463918428+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-15T14:17:52.463941815+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-15T14:17:52.464176595+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:17:52.464248480+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.464255689+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.464258477+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.464758943+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.464825938+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.464833469+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.464837285+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-15T14:17:52.464859921+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-15T14:17:52.464885753+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.464890246+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.464892752+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-15T14:17:52.465236002+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.465244321+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.465247076+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.465264587+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 6b4d19ed-4397-48df-9fce-f7f58e97a58b ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{6b4d19ed-4397-48df-9fce-f7f58e97a58b-auth nausf-auth 0xc0004ef2d8 http REGISTERED   0xc0004ef2c0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{6b4d19ed-4397-48df-9fce-f7f58e97a58b-policyauthorization npcf-policyauthorization 0xc0004ef338 http REGISTERED   0xc0004ef320  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{6b4d19ed-4397-48df-9fce-f7f58e97a58b-smpolicycontrol npcf-smpolicycontrol 0xc0004ef308 http REGISTERED   0xc0004ef2f0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc0009daf00 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc0005b63f0 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-15T14:17:52.465407482+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-15T14:17:52.465889174+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.465958824+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.465966439+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.465972195+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-15T14:17:52.466078922+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-15T14:17:52.466683978+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:52.466765110+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-15T14:17:52.466772752+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:52.466777949+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-15T14:17:52.466798817+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-15T14:17:52.467016056+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-15T14:17:52.467207108+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-15T14:17:52.670437486+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-15T14:17:52.670557453+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-15T14:17:52.671041919+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-15T14:17:52.673261763+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:52.679458953+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:52.680852762+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40
2025-06-15T14:17:52.682653964+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40 |  |
2025-06-15T14:17:52.683137921+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:52.683276184+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-15T14:17:52.870859777+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-15T14:17:52.872441370+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:52.876913995+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:52.878928332+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 5cf82880-c2a7-4505-b6de-629d5895285e
2025-06-15T14:17:52.881230921+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/5cf82880-c2a7-4505-b6de-629d5895285e |  |
2025-06-15T14:17:52.881858750+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:52.881959533+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {5cf82880-c2a7-4505-b6de-629d5895285e SMF REGISTERED 0 0xc0007c13c8 0xc0007c13e0 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000292600 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0007c12c0 false false []}
2025-06-15T14:17:52.882114176+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-15T14:17:52.882331247+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-15 14:17:52.882317211 +0800 CST m=+0.512316049]
2025-06-15T14:17:52.882392335+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-15T14:17:53.073489193+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:53.078437575+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:53.080215891+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 2e02ac83-d823-4fa9-b0d8-458902df6c75
2025-06-15T14:17:53.083777750+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/2e02ac83-d823-4fa9-b0d8-458902df6c75 |  |
2025-06-15T14:17:53.084617730+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:53.084779379+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-15T14:17:53.084829904+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-15T14:17:53.084850526+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:17:53.084930900+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-15T14:17:53.272166576+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-15T14:17:53.272340878+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-15T14:17:53.275386645+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:53.282964300+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:53.284898165+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: eefb546a-9d07-406b-84c8-1aea0d211bae
2025-06-15T14:17:53.291606716+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/eefb546a-9d07-406b-84c8-1aea0d211bae |  |
2025-06-15T14:17:53.292173114+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:53.292299379+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-15T14:17:53.476290034+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:53.482778436+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:53.485189306+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 209ad2fe-a032-4803-89de-09d6e9c19a76
2025-06-15T14:17:53.488679235+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/209ad2fe-a032-4803-89de-09d6e9c19a76 |  |
2025-06-15T14:17:53.489378371+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:53.489479387+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-15T14:17:53.489492191+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-15T14:17:53.698459667+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-15T14:17:53.701233510+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:53.705915544+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:53.709093495+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6b4d19ed-4397-48df-9fce-f7f58e97a58b
2025-06-15T14:17:53.711737582+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6b4d19ed-4397-48df-9fce-f7f58e97a58b |  |
2025-06-15T14:17:53.712582583+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:53.712670201+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-15T14:17:53.885630248+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-15T14:17:53.886974873+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-15T14:17:53.899165505+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-15T14:17:53.901249521+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:53.913610290+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:53.915655889+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 815edb14-c09e-4d17-9972-27b93d55054f
2025-06-15T14:17:53.917252668+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/815edb14-c09e-4d17-9972-27b93d55054f |  |
2025-06-15T14:17:53.917647261+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:53.917749761+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-15T14:17:54.104393055+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-15T14:17:54.106202903+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-15T14:17:54.110114425+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:17:54.115803877+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:17:54.121574065+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6529b478-6166-4069-88ea-bf46ca6450a9
2025-06-15T14:17:54.125975742+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6529b478-6166-4069-88ea-bf46ca6450a9 |  |
2025-06-15T14:17:54.128378199+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:17:54.128640363+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-15T14:17:59.954547766+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873
2025-06-15T14:17:59.955723379+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873
2025-06-15T14:17:59.956176951+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle NGSetupRequest
2025-06-15T14:17:59.956203134+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mMissing IE PagingDRX
2025-06-15T14:17:59.956236493+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build1394032355/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-15T14:18:09.400229493+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.401367189+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.401380830+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:09.401392616+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:18:09.401399573+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:09.401633229+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.401646307+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.401651604+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:09.401658481+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:18:09.401663224+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:09.422962940+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.423038861+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.423050256+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.423059665+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.423065552+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.423070867+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.423074843+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-15T14:18:09.432042966+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.432082348+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:18:09.432089055+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:09.432096641+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:09.432103029+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:09.432153467+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.432169605+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.432174307+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.432254914+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.432266304+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.432284242+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.439405313+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.439556412+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.439569120+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.439577949+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.439582422+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.439589589+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.439742220+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.439752902+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.439758772+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.439764889+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.439770394+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.439774542+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-15T14:18:09.439870363+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.439877060+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.439881308+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:18:09.439893781+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.439898015+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.439901993+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.439917615+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.439922057+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.439925627+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.442047822+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle InitialUEMessage
2025-06-15T14:18:09.442160135+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-15T14:18:09.442529431+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-15T14:18:09.442758999+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-15T14:18:09.442826870+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-15T14:18:09.442853840+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-15T14:18:09.442866442+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-15T14:18:09.442877133+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-15T14:18:09.442899697+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-15T14:18:09.442910525+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-15T14:18:09.444551871+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.467841997+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-15T14:18:09.472437654+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-15T14:18:09.472542006+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-15T14:18:09.474501202+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.518477401+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-15T14:18:09.523715446+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-15T14:18:09.523789484+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-15T14:18:09.523797214+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-15T14:18:09.523966233+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-15T14:18:09.524887258+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.541610420+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-15T14:18:09.545380732+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:18:09.551825464+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:18:09.552647526+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-15T14:18:09.552945902+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-15T14:18:09.553047470+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-15T14:18:09.553064753+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 6161353730356265643632333734633432396438656531396632656666393936
2025-06-15T14:18:09.553170959+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-15T14:18:09.553468411+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-15T14:18:09.553587109+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend Downlink Nas Transport
2025-06-15T14:18:09.559243833+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.559277706+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.559292877+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.559298988+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.559303385+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.559308031+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.559333626+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.559337941+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.559341864+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.559523467+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.559530028+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.559533889+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:18:09.559546340+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.559549825+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.559553144+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.559584826+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.559590890+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.559594423+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.560656973+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:09.560742608+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:09.560806960+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-15T14:18:09.560824002+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-15T14:18:09.562150801+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-15T14:18:09.562438892+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 6161353730356265643632333734633432396438656531396632656666393936
Xres*: 6161353730356265643632333734633432396438656531396632656666393936
2025-06-15T14:18:09.562467653+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-15T14:18:09.563607561+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-15T14:18:09.565983915+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-15T14:18:09.566247691+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-15T14:18:09.566437164+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-15T14:18:09.567181601+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-15T14:18:09.567286754+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-15T14:18:09.567352785+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend Downlink Nas Transport
2025-06-15T14:18:09.568916742+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.569054622+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.569070760+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.569077666+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.569082741+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.569088237+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.569118930+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.569124327+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.569128903+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.569180621+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.569191589+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.569196837+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:18:09.569208869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.569212453+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.569218095+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.569230206+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.569233649+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.569237174+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.570539991+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:09.570685764+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:09.570761590+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-15T14:18:09.570849092+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-15T14:18:09.570894812+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-15T14:18:09.570902855+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-15T14:18:09.572125296+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.618313532+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:18:09.623131335+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-15T14:18:09.624479949+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:18:09.625786339+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-15T14:18:09.626129219+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:09.627436113+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.657267006+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:18:09.663550703+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-15T14:18:09.666895669+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-15T14:18:09.667584810+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-15T14:18:09.668094901+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-15T14:18:09.668464775+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:18:09.669813861+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:09.670242403+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:09.671073365+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-15T14:18:09.673608382+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-15T14:18:09.673973900+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:09.675038123+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-15T14:18:09.676964352+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-15T14:18:09.677588334+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-15T14:18:09.678076225+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-15T14:18:09.678285931+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-15T14:18:09.678420645+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-15T14:18:09.678944300+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.711610750+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-15T14:18:09.725938147+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:18:09.727207253+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.740581562+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-15T14:18:09.745484595+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:18:09.765599514+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:09.795722289+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-15T14:18:09.803248514+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-15T14:18:09.803345587+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-15T14:18:09.803382833+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-15T14:18:09.803974372+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:18:09.804790675+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-15T14:18:09.804906201+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend Initial Context Setup Request
2025-06-15T14:18:09.806538396+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.806633065+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.806644424+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.806650648+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.806655065+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.806659145+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.806713356+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.806720933+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.806735213+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.806802666+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:18:09.806840032+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.806847003+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:18:09.806851282+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:18:09.806866056+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.806974926+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.806984456+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.806997566+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.807009019+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.807025353+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.808456056+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.808510547+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.808517927+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808524920+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.808529158+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.808532924+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.808564879+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.808570640+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808576233+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808585594+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808593510+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808598531+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808605375+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.808609449+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-15T14:18:09.808752446+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle InitialContextSetupResponse
2025-06-15T14:18:09.808871529+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:18:09.808896265+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x04bbd3be
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000b5d4a0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00015ee10)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000abe540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000b52f20)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000b5d4c0)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000b5d4e0)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000b52f5b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000b52f73)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-15T14:18:09.812433802+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:09.812511275+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:09.812595990+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-15T14:18:09.812632472+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-15T14:18:09.812677458+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-15T14:18:09.812698185+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend Downlink Nas Transport
2025-06-15T14:18:09.812898023+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-15T14:18:10.315609554+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:10.315732969+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:10.315832726+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:18:10.315843914+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:18:10.315852030+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:18:10.315868062+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:18:10.317067376+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.342032602+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-15T14:18:10.345331965+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:18:10.345429105+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:18:10.345646774+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:18:10.346017516+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:18:10.347107951+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.366162037+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:10.370854898+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:18:10.371113219+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:18:10.371213651+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:18:10.371221924+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:18:10.372309561+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.392814862+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:18:10.396861639+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:18:10.399377616+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:18:10.399487118+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:18:10.402376568+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:10.403333180+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:10.403488539+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:18:10+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0007ea740 0xc0007ea760 0xc0007ea780]
2025-06-15T14:18:10.403521835+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:18:10.403534184+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0007ea740 0xc0007ea760 0xc0007ea780]}
2025-06-15T14:18:10.403539444+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:18:10.405329943+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.408169946+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&target-nf-type=AMF |  |
2025-06-15T14:18:10.409034654+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:18:10.409276091+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-15T14:18:10.409287749+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:18:10.409294329+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-15T14:18:10.409304513+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:18:10.409312969+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:18:10.409319019+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:18:10.409325429+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:18:10.411431425+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:18:10.412182455+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.442698485+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-15T14:18:10.447219616+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:18:10.450351542+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:18:10.451671062+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:18:10.452746711+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-15T14:18:10.453708518+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.467442539+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-15T14:18:10.472792459+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:10.481848318+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:18:10.482099901+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:18:10.482741481+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:18:10.483975591+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.486097295+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:18:10.487381846+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:18:10.488443445+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:18:10.489583218+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.500947390+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:18:10.503495628+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:18:10.507276030+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:18:10.507443617+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:18:10.507469720+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:18:10.507485166+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:18:10.507500347+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:18:10.507794960+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:18:10.508167089+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:18:10.508383643+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:18:10.508404846+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:10.508565289+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:18:10.508581710+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:10.508741263+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:18:10.509141759+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:18:10.509424616+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:18:10.509814275+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-15T14:18:10.524924804+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:18:10.528637534+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:18:10.528773041+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend PDU Session Resource Setup Request
2025-06-15T14:18:10.530188846+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:18:10.532810403+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:10.532881209+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.532894146+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-15T14:18:10.532986770+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.532992287+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.532996337+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.533069268+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.533079180+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.533092220+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.533098828+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.533104033+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.533108980+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.533114167+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-15T14:18:10.533401130+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.533421522+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:10.533431366+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.533437940+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.533441995+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:10.533468470+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.533473347+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.533477506+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.533501792+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.533505613+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.533509482+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xf1f832a2
2025-06-15T14:18:10.535674541+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse
err <nil>
2025-06-15T14:18:10.535712393+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d98400)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c101e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d90460)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000cae4b4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000d941b0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000d9e100)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000cae4e0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000cae4f0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d98420)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d98440)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d98460)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-06-15T14:18:10.536791286+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:18:10.546435246+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:18:10.547693269+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:48b36958-447e-4d61-8d66-fc40b2b53240/modify |  |
2025-06-15T14:18:10.740460453+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:10.740576058+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:10.740661806+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:18:10.740674068+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:18:10.740681582+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:18:10.740695243+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:18:10.741890571+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:18:10.742054495+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:18:10.742089860+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:18:10.742981785+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:18:10.744088146+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.776549941+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:10.779685652+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:18:10.779924255+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:18:10.779996007+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:18:10.780002356+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:18:10.781154125+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.807759831+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:18:10.810598346+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:18:10.811880029+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:18:10.811932505+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:18:10.814027255+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:10.815166418+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:10.815426664+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:18:10+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000285b00 0xc000285b20 0xc000285b40]
2025-06-15T14:18:10.815536665+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:18:10.815547276+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000285b00 0xc000285b20 0xc000285b40]}
2025-06-15T14:18:10.815552410+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:18:10.816255195+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.819990733+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&target-nf-type=AMF |  |
2025-06-15T14:18:10.820382119+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:18:10.820583266+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-15T14:18:10.820658647+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:18:10.820670987+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-15T14:18:10.820680691+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:18:10.820691403+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:18:10.820696057+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:18:10.820702957+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:18:10.821683513+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:18:10.823532462+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:10.831630342+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:18:10.832078039+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:18:10.832482631+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:18:10.837532091+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.841090927+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:18:10.841577980+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:18:10.842510744+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:18:10.843740833+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.855389684+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:18:10.857013409+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:18:10.858979293+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:18:10.859080422+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:18:10.859094845+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:18:10.859099750+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:18:10.859103841+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:18:10.859134752+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:18:10.859289562+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:18:10.859441733+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:18:10.859535970+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:10.859606204+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:18:10.859616645+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:10.859665029+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:18:10.859790584+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:18:10.859974687+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:18:10.860229752+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-15T14:18:10.872308385+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:18:10.874994623+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:18:10.875139225+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend PDU Session Resource Setup Request
2025-06-15T14:18:10.875420238+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:18:10.876734967+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:10.877290865+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.877368660+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-15T14:18:10.877443931+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.877449791+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.877454145+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.877531890+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.877540415+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.877549077+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.877554101+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.877559555+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.877564954+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.877571865+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:18:10.877674989+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.877680990+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:10.877687183+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.877691986+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.877699366+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:10.877710536+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.877715041+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.877719013+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.877743559+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.877822775+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.877832787+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000dc84c843
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x34a17e2b9854fcb7349dae62687368bcbfbaa25972817b7cc06700b1b6828f29
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x532839085088d4fa8b305a3a25e57e473494aadc
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000000d848f92
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xd04e03e1ba0f990e5c7c58810a8f2124f2e7e2e0ac62c9398318a70ec52f5687
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xce73e6dea55cd03a41d7003e9b018d2bae9088e4
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x1c5463a3
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000ca60c0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d56000)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000cb81e0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000d016c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cac2d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cd6080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0000d0190)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000d01a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000ca60e0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000ca6100)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000ca6120)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:18:10.946555535+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:18:10.946678028+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:18:10.948111929+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:18:10.955262378+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:18:10.955433145+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:2bffbd26-f2c5-42f3-a68c-f61ae272f21f/modify |  |
2025-06-15T14:18:10.962974179+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:10.963098879+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:10.963180653+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:18:10.963192816+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:18:10.963200924+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:18:10.963214062+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:18:10.964384591+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:18:10.964564270+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:18:10.964600055+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:18:10.965107869+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:18:10.966878399+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:10.993059823+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:10.997439555+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:18:10.997595547+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:18:10.997642624+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:18:10.997651792+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:18:10.998876845+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.031314425+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:18:11.033869855+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:18:11.035877385+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:18:11.036028274+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:18:11.038698949+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:11.039256280+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:11.039440468+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:18:11+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0015bfb80 0xc0015bfba0 0xc0015bfbc0]
2025-06-15T14:18:11.039460211+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:18:11.039465395+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0015bfb80 0xc0015bfba0 0xc0015bfbc0]}
2025-06-15T14:18:11.039469946+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:18:11.040279549+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.043923099+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&target-nf-type=AMF |  |
2025-06-15T14:18:11.044395538+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:18:11.044604282+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-15T14:18:11.044616920+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:18:11.044624246+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-15T14:18:11.044633644+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:18:11.044646635+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:18:11.044651849+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:18:11.044658026+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:18:11.046329920+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:18:11.048229111+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:11.057407780+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:18:11.057663106+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:18:11.058589856+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:18:11.059992746+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.062722800+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:18:11.063162530+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:18:11.063491441+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:18:11.064072069+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.076744227+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:18:11.083094481+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:18:11.086575248+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:18:11.086701378+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:18:11.086719441+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:18:11.086726180+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:18:11.086731005+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:18:11.086767445+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:18:11.087433692+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:18:11.087694448+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:18:11.087832644+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:11.087929682+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:18:11.087943603+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:11.087995927+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:18:11.088254293+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:18:11.088586368+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:18:11.089363769+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-15T14:18:11.101770841+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:18:11.103788011+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:18:11.103935441+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend PDU Session Resource Setup Request
2025-06-15T14:18:11.105256952+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:11.105406207+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.105420377+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-15T14:18:11.105495975+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.105502890+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.105507373+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.105578052+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.105585384+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.105594542+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.105600831+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.105611378+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.105617073+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.105622345+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:18:11.105798013+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.105809027+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:11.105816219+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.105821261+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.105828204+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:11.105844375+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.105848889+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.105852628+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.105876917+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.105881253+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.105886326+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000546b741d
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x29a3ffefa3abfd064c59aa8bfeba56eed9d58b20140224983445a2988e150897
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x2d245f707b3424ffcac6a55ad0e6a5b8d9bfffb9
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000eef5e890
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xc4d5b99e3fdf4729a60e4945c6ef700b8d4b40e3c825c06611c54c90f26830a6
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x56b8d6df654db2f951406f42688ce11dbe716d7e
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-06-15T14:18:11.107268861+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x3a1b9cc2
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b5de40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00015f0e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d100f0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000d9a984)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000076120)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000bf6a00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000d9a9a0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000d9a9b6)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b5de60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b5de80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b5dea0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:18:11.151883982+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:18:11.151999183+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:18:11.153875533+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:18:11.160684189+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:18:11.160840380+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:fd401516-c344-446b-84da-8ea69a76bd2a/modify |  |
2025-06-15T14:18:11.162448843+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport
2025-06-15T14:18:11.162532077+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:18:11.162593157+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:18:11.162604284+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:18:11.162617108+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:18:11.162630167+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:18:11.163589552+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:18:11.163708760+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:18:11.163736222+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:18:11.164318617+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:18:11.165620336+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.187438390+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:18:11.189993679+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:18:11.190585542+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:18:11.190639464+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:18:11.190646295+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:18:11.191540878+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.214342142+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:18:11.216298465+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:18:11.217329253+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:18:11.217481598+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:18:11.241090724+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:11.241537846+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:11.242225442+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:18:11+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001432840 0xc001432da0 0xc001432dc0]
2025-06-15T14:18:11.242317729+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:18:11.242341592+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001432840 0xc001432da0 0xc001432dc0]}
2025-06-15T14:18:11.242360202+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:18:11.244179540+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.247389996+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=bf0db9ed-5f30-4b9e-a0ba-2896dbb1ad40&target-nf-type=AMF |  |
2025-06-15T14:18:11.248240797+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:18:11.248505484+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-15T14:18:11.248517420+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:18:11.248523307+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-15T14:18:11.248649022+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:18:11.248664304+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:18:11.248669708+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:18:11.248676770+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:18:11.251008464+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:18:11.254306615+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:18:11.263900993+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:18:11.264165649+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:18:11.264373831+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:18:11.265326248+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.267363013+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:18:11.267765905+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:18:11.268152560+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:18:11.268361648+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:18:11.290841032+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:18:11.292095212+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:18:11.293683832+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:18:11.293814712+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:18:11.293829342+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:18:11.293834835+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:18:11.293839391+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:18:11.293873523+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:18:11.294625882+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:18:11.294864039+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:18:11.294912790+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:11.294989432+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:18:11.295021620+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:18:11.295089983+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:18:11.295273927+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:18:11.295488948+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:18:11.296023754+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-15T14:18:11.306353670+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:18:11.307826169+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:18:11.307961062+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mSend PDU Session Resource Setup Request
2025-06-15T14:18:11.308247494+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:18:11.309069681+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:11.309110299+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.309116177+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-15T14:18:11.309153751+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.309156618+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.309159187+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.309203640+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.309207521+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309213051+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309216476+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309224932+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309227968+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309230997+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:18:11.309347391+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.309354472+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:11.309359018+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.309362112+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.309364962+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:11.309383565+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.309387410+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.309389643+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.309421916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.309426707+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.309429184+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000007d98e414
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xc2432a694e67c42a1028fa82b8aefd5ff5b2efcbf5395eac193d0bc0d8248261
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x21d6a4fbb655abc8f2db7e1ad2ac44386ad142f5
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000823c9388
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xee10e440bc46d57872c5100c00e0f52f1b0c2afee8c293def5d554462fd2532f
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xa1fbd573c480c244e88e8938ae3ebdea4a921791
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xd431cb65
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00053ad20)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00015f3b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d10aa0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0000da3bc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000762d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000bf7100)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0000da3e0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0000da3f0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00053ad40)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00053ad60)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00053ad80)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-15T14:18:11.371904379+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:18:11.372091452+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:51873] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:18:11.379871752+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:18:11.386022149+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:18:11.386398482+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:befa309b-539f-4bfe-8689-f82dde061f9c/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.003075ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.234631ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=661.639µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=690.061µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=973.328µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 661.639µs/912.547µs/1.234631ms/213.58µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (10.59s)
PASS
ok  	test	10.692s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (28.15s)
PASS
ok  	test	31.095s

--- STDERR ---
2025-06-15T14:17:47.707114962+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:17:47.707255000+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-15T14:17:47.707534325+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:17:47.707603650+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0003111d0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc0005975f0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0005977a0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000409d00)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-15T14:17:47.707611623+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:17:47.707615394+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-15T14:17:47.707627360+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:47.707700245+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-15T14:17:47.707709217+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-15T14:17:47.717846180+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-15T14:17:47.718083152+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-15T14:17:47.718423862+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-15T14:17:47.719036883+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-15T14:17:47.719191103+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-15T14:17:47.719202432+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-15T14:17:53.886499626+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-15T14:17:53.886636560+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-15T14:17:59.917596922+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:17:59.919373069+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-15T14:17:59.921135019+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-15T14:17:59.921268557+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-15T14:17:59.921283565+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-15T14:17:59.921457463+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-15T14:17:59.921467099+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-15T14:17:59.948134259+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-15T14:17:59.948266333+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-15T14:17:59.953228918+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-15T14:17:59.958571245+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-15T14:17:59.958885645+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-15T14:17:59.959182255+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-15T14:17:59.959329144+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-15T14:17:59.959352804+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-15T14:17:59.959548110+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-15T14:18:09.401904101+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.401960052+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.401970250+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.401990257+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.401997175+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.402004834+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-15T14:18:09.420731796+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.420903949+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.420921491+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:09.420930828+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:18:09.420936316+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:09.420941088+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:09.420945685+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:09.420977941+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.420982737+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:18:09.421028750+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.421033723+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.421037694+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:09.421048589+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:18:09.421052930+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:09.421057423+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:09.421061512+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:09.434551504+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.434593268+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.434601884+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.434608905+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:18:09.434618404+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.434692947+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.434703492+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.434864064+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.434882018+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.434893520+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.434902349+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.434910656+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.434917289+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-15T14:18:09.434920970+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.434925196+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:18:09.434933350+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-15T14:18:09.434939367+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:18:09.434943016+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:18:09.438650307+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.438767251+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:18:09.438780343+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-15T14:18:09.438801688+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:18:09.438816753+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.438823464+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:18:09.438855864+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.438864157+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.438868471+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.438926692+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.438931832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.438935588+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.440474031+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.440569676+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.440597098+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.440617327+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:18:09.440650756+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.440681764+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.440697721+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.440788859+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.440820066+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.440837735+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.440857515+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:18:09.440881769+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.441066930+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:09.441127951+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-15T14:18:09.441163081+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.441183274+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-15T14:18:09.558458376+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:18:09.558649950+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:09.558665162+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:18:09.558678334+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.558682867+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.558687109+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:18:09.558705315+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.558717772+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.558724844+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.558742598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.558746306+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.558751127+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.560124202+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.560159800+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.560168108+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.560179095+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:18:09.560188465+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.560193205+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.560198090+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.560222472+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.560227839+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.560232276+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.560238272+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:18:09.560251113+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.560259266+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:09.567947825+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:18:09.568276259+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:09.568293535+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:18:09.568303249+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.568307727+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.568311858+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:18:09.568330335+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.568334310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.568341748+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.568372300+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.568442484+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.568455481+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.569516240+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.569542484+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.569755002+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.569763778+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:18:09.569772812+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.569776861+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.569780501+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.569807518+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.569812327+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.569829117+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.569835798+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:18:09.569910886+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.569923439+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:09.805718464+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-15T14:18:09.805827022+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:09.805840564+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-15T14:18:09.805850150+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.805855666+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:18:09.805882418+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.805886925+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.805890648+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.805913230+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.805920543+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.805926256+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.807297665+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:09.807321023+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.807327232+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.807333256+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:18:09.807340335+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.807344233+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.807348635+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.807380997+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:09.807386770+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.807391990+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:09.807443481+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 1624636521, Outbound SPI: 624703217
2025-06-15T14:18:09.807566675+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.807578108+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:18:09.807582752+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:18:09.807587258+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:09.807594223+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:09.807601154+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:09.807605718+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:09.807609532+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:09.807623058+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.807687711+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.807704726+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.808035839+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:09.808122535+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:09.808133742+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:09.808357226+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.808452199+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.808468181+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:09.808474094+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:18:09.808492366+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.808498733+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-15T14:18:09.809301335+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:18:09.810324450+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:09.811726580+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:09.813578591+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:18:10.314908527+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:10.510502735+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:18:10.510610193+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-15T14:18:10.520033876+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-15T14:18:10.520142340+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-15T14:18:10.520909907+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-15T14:18:10.530851849+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:18:10.532170045+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:10.532253924+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:18:10.532296308+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.532309369+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:10.532316058+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:10.532321585+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.532329319+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.532337325+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:10.532341680+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:10.532359487+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.532363721+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.532370538+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.532419722+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.532426816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.532431400+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.533954814+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:10.534027056+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.534036420+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.534045672+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:18:10.534051318+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9781307283159720866
2025-06-15T14:18:10.534061506+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.534067664+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.534075544+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.534172884+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.534184769+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.534199298+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.534207201+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.534212955+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.534228452+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:10.534408264+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:10.534421550+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:18:10.534802907+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:10.535232671+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:10.535328165+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:18:10.537432278+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:10.538780138+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:18:10.861067583+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:18:10.861123786+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-15T14:18:10.868968151+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-15T14:18:10.869359569+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-15T14:18:10.875822163+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:18:10.876093921+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:10.876108039+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:18:10.876170839+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.876178164+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:10.876186907+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:10.876192426+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.876198619+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:10.876203608+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:10.876208762+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:10.876225994+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.876231033+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.876235279+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.876270742+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.876350986+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.876359641+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.878562923+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:10.878602978+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.878610436+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.878616861+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:18:10.878622209+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9781307283159720866
2025-06-15T14:18:10.878629427+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:10.878633606+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:10.878637893+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:10.878702588+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:10.878709185+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.878716728+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.878722086+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.878727567+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:10.878827288+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:10.878920815+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:10.878938886+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:18:10.880636917+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-15T14:18:10.881571390+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:10.881686544+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:10.881742014+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:18:10.897387116+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:10.949503738+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:18:11.089242048+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:18:11.089431793+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-15T14:18:11.095302159+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-15T14:18:11.095973353+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-15T14:18:11.104665787+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:18:11.104865916+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:11.104937098+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:18:11.104978796+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.104983645+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:11.104989736+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:11.104994372+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.105001603+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.105008220+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:11.105012139+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:11.105026974+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.105030787+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.105034678+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.105064718+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.105068400+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.105071815+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.107153225+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:11.107238300+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.107247635+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.107257787+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:18:11.107261796+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9781307283159720866
2025-06-15T14:18:11.107267523+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.107270240+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.107272888+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.107322940+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.107327099+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.107333257+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.107336728+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.107340204+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.107350470+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:11.107356302+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:11.107362972+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:18:11.125777786+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-15T14:18:11.126269468+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:11.126835655+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:11.126895719+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:18:11.135363238+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:18:11.155092241+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:18:11.296494985+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:18:11.296591897+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-15T14:18:11.302023166+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-15T14:18:11.302863007+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-15T14:18:11.308589327+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:18:11.308717676+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:11.308727397+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:18:11.308757943+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.308761366+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:18:11.308767136+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:18:11.308772196+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.308775284+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:18:11.308778822+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:11.308781588+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:18:11.308791793+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.308794527+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.308797084+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.308871158+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.308877989+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.308880524+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.309701174+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:18:11.309727750+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.309735327+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309741149+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:18:11.309746604+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9781307283159720866
2025-06-15T14:18:11.309752211+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:18:11.309756232+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:18:11.309760103+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:18:11.309819049+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:18:11.309826226+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309833511+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309838677+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309844096+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:18:11.309854797+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:11.309862056+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:18:11.309868117+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:18:11.316588999+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-15T14:18:11.317339894+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:11.317582291+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:18:11.317646500+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:18:11.380730251+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:18:22.996503627+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-15T14:18:22.996607302+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-15T14:18:22.996682553+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-15T14:18:22.996726056+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-15T14:18:22.996736761+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-15T14:18:23.034646321+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-15T14:18:23.034668908+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-15T14:18:23.034685758+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-15T14:18:23.034704829+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-15T14:18:23.034708090+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-15T14:18:23.034710162+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-15T14:18:23.426589215+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-15T14:18:23.426642806+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-15T14:18:23.426798081+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-15T14:18:23.426922831+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-15T14:18:23.426935244+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-15T14:18:23.427009091+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.75:54847: use of closed network connection
2025-06-15T14:18:23.427020818+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.75:54847: use of closed network connection
2025-06-15T14:18:23.427027137+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-15T14:18:23.427049769+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-15T14:18:23.427055245+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-15T14:18:23.427062377+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-15T14:18:23.427077472+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-15T14:18:23.427084636+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:18:23.427098742+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-15T14:18:23.427104438+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:18:23.427113163+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-15T14:18:23.427265611+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-15T14:18:23.427278390+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-15T14:18:23.427352031+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-15T14:18:23.427366619+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-15T14:18:23.427447531+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-15T14:18:23.427469485+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-15T14:18:23.427488550+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-15T14:18:23.427505323+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-15T14:18:23.427509687+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (113857): No such process
