Run TestCN
os.Args: [/tmp/go-build4179655692/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-15T14:20:26.486034682+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.486137131+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.486147097+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.486154157+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-15T14:20:26.486171309+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-15T14:20:26.487009500+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.487051343+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.487056132+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.487132152+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-15T14:20:26.488518239+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.488586134+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.488600447+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.488609054+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-15T14:20:26.488623827+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-15T14:20:26.489227282+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:20:26.489332812+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.489341408+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.489343482+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.490092556+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.490159648+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.490172371+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.490176839+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-15T14:20:26.490194881+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-15T14:20:26.490215744+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.490218322+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.490220219+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-15T14:20:26.490935137+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.490947123+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.490949506+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.490966666+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} e45c4e07-3885-40fe-8bba-833317707d4b ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{e45c4e07-3885-40fe-8bba-833317707d4b-auth nausf-auth 0xc000e284e0 http REGISTERED   0xc000e284c8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{e45c4e07-3885-40fe-8bba-833317707d4b-policyauthorization npcf-policyauthorization 0xc000e28540 http REGISTERED   0xc000e28528  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{e45c4e07-3885-40fe-8bba-833317707d4b-smpolicycontrol npcf-smpolicycontrol 0xc000e28510 http REGISTERED   0xc000e284f8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000d8f400 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc000e345a0 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-15T14:20:26.491173140+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-15T14:20:26.492537075+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.492686226+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.492703026+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.492713069+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-15T14:20:26.496490294+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-15T14:20:26.500236582+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:26.500392561+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-15T14:20:26.500398937+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:26.500402018+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-15T14:20:26.500567531+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-15T14:20:26.500993569+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-15T14:20:26.501145441+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-15T14:20:26.701441145+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-15T14:20:26.701616744+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-15T14:20:26.701836442+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-15T14:20:26.703974588+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:26.707817088+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:26.709709572+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3d3b0ec6-1509-41b3-b732-1315beb6fc57
2025-06-15T14:20:26.713110089+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3d3b0ec6-1509-41b3-b732-1315beb6fc57 |  |
2025-06-15T14:20:26.713602589+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:26.713650143+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-15T14:20:26.912965841+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-15T14:20:26.914059150+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:26.916761671+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:26.918009567+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 487d83ee-42be-47f1-82b3-c65dd8ddcfcf
2025-06-15T14:20:26.919504209+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/487d83ee-42be-47f1-82b3-c65dd8ddcfcf |  |
2025-06-15T14:20:26.919699211+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:26.919721023+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {487d83ee-42be-47f1-82b3-c65dd8ddcfcf SMF REGISTERED 0 0xc00025c378 0xc00025c390 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000e82d00 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc00025c2d0 false false []}
2025-06-15T14:20:26.919811681+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-15T14:20:26.919828628+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-15 14:20:26.919822791 +0800 CST m=+0.475149349]
2025-06-15T14:20:26.919853221+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-15T14:20:27.114587462+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:27.117710243+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:27.118904364+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: d5480056-7fde-4947-b281-32aab9ccd509
2025-06-15T14:20:27.120113926+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d5480056-7fde-4947-b281-32aab9ccd509 |  |
2025-06-15T14:20:27.120264176+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:27.120285751+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-15T14:20:27.120293933+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-15T14:20:27.120301794+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-15T14:20:27.120333841+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-15T14:20:27.319811920+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-15T14:20:27.319901111+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-15T14:20:27.320638747+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:27.323337421+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:27.324741833+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 621271cf-cd97-40f8-a28b-9d6333dcaedd
2025-06-15T14:20:27.327301297+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/621271cf-cd97-40f8-a28b-9d6333dcaedd |  |
2025-06-15T14:20:27.327590114+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:27.327639580+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-15T14:20:27.521968269+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:27.525300256+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:27.526934709+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 312aa3e3-dbab-4dd7-96b3-d58e5b5c3c1e
2025-06-15T14:20:27.527970421+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/312aa3e3-dbab-4dd7-96b3-d58e5b5c3c1e |  |
2025-06-15T14:20:27.528253341+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:27.528304140+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-15T14:20:27.528309459+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-15T14:20:27.723271784+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-15T14:20:27.724067679+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:27.728011868+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:27.729575345+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: e45c4e07-3885-40fe-8bba-833317707d4b
2025-06-15T14:20:27.731243216+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/e45c4e07-3885-40fe-8bba-833317707d4b |  |
2025-06-15T14:20:27.731837206+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:27.731927524+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-15T14:20:27.919952875+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-15T14:20:27.920736312+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-15T14:20:27.926023343+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-15T14:20:27.927482110+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:27.931875146+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:27.933058545+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 81d731dd-5e23-4e7d-b248-301138f43041
2025-06-15T14:20:27.934998563+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/81d731dd-5e23-4e7d-b248-301138f43041 |  |
2025-06-15T14:20:27.935651758+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:27.935718991+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-15T14:20:28.127175953+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-15T14:20:28.127762848+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-15T14:20:28.130667813+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-15T14:20:28.133079297+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-15T14:20:28.134429053+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 7660cb9a-9c38-4ea2-a39f-92481b9e2e67
2025-06-15T14:20:28.135312221+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/7660cb9a-9c38-4ea2-a39f-92481b9e2e67 |  |
2025-06-15T14:20:28.135438706+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-15T14:20:28.135486558+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-15T14:20:34.963121050+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947
2025-06-15T14:20:34.965031579+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947
2025-06-15T14:20:34.965462576+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle NGSetupRequest
2025-06-15T14:20:34.965475955+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mMissing IE PagingDRX
2025-06-15T14:20:34.965501413+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build991723688/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-15T14:20:41.552007558+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.552151594+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.552161919+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:41.552166412+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:20:41.552168941+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:41.552304865+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.552311542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.552313505+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:41.552316672+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:20:41.552318733+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:41.562571223+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.562637411+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.562650672+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.562688339+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.562700031+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.562708444+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.562718756+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-15T14:20:41.567192029+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.567277786+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:20:41.567293969+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:41.567304549+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:41.567319041+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:41.567358110+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.567375858+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.567383780+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.567398160+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.567405736+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.567413130+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.570105492+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.570352502+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.570362507+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.570368380+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.570370612+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.570374109+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.570448708+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.570524939+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.570531921+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.570535418+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.570538235+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.570540452+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-15T14:20:41.570593159+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.570595504+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.570597482+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:20:41.570604744+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.570607817+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.570609613+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.570619395+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.570621312+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.570623150+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.571905179+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle InitialUEMessage
2025-06-15T14:20:41.572104227+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-15T14:20:41.572184993+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-15T14:20:41.572246656+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-15T14:20:41.572313225+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-15T14:20:41.572324443+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-15T14:20:41.572329189+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-15T14:20:41.572333810+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-15T14:20:41.572340805+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-15T14:20:41.572344200+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-15T14:20:41.572994006+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.583036954+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-15T14:20:41.585923154+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-15T14:20:41.585980502+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-15T14:20:41.586627819+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.609254617+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-15T14:20:41.611706551+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-15T14:20:41.611819085+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-15T14:20:41.611827131+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-15T14:20:41.611830602+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-15T14:20:41.612549568+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.619304385+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-15T14:20:41.621055569+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:20:41.623867535+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-15T14:20:41.624024404+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-15T14:20:41.624384300+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-15T14:20:41.624438617+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-15T14:20:41.624446530+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 3066616631316235373565363962356662326664386361303265343439306366
2025-06-15T14:20:41.624495301+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-15T14:20:41.624860377+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-15T14:20:41.624889862+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend Downlink Nas Transport
2025-06-15T14:20:41.625866782+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.625887099+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.625890565+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.625893634+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.625898725+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.625902460+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.625917008+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.625919750+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.625921754+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.626014345+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.626076801+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.626082827+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:20:41.626090238+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.626093281+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.626095021+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.626101317+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.626106872+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.626108646+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.626691704+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:41.626773552+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:41.626815878+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-15T14:20:41.626821282+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-15T14:20:41.627443844+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-15T14:20:41.627454791+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 3066616631316235373565363962356662326664386361303265343439306366
Xres*: 3066616631316235373565363962356662326664386361303265343439306366
2025-06-15T14:20:41.627457715+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-15T14:20:41.627918385+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-15T14:20:41.629399337+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-15T14:20:41.629500877+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-15T14:20:41.629922453+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-15T14:20:41.630333190+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-15T14:20:41.630413237+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-15T14:20:41.630431660+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend Downlink Nas Transport
2025-06-15T14:20:41.631240270+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.631260383+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.631266761+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.631269927+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.631272143+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.631274149+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.631287037+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.631289669+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.631291917+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.631320778+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.631323234+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.631325331+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:20:41.631332450+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.631334416+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.631336154+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.631341862+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.631343609+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.631345319+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.632237197+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:41.632432663+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:41.632633944+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-15T14:20:41.632821299+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-15T14:20:41.633025716+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-15T14:20:41.633072815+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-15T14:20:41.633902666+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.657481968+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:20:41.660121366+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-15T14:20:41.660485065+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:20:41.660952203+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-15T14:20:41.661144421+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:41.661665506+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.678801931+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-15T14:20:41.684034863+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-15T14:20:41.685868125+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-15T14:20:41.686082746+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-15T14:20:41.686447972+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-15T14:20:41.686942660+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-15T14:20:41.687441691+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:41.687584651+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:41.687760072+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-15T14:20:41.688244444+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-15T14:20:41.688405090+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:41.688567019+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-15T14:20:41.689166577+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-15T14:20:41.689378282+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-15T14:20:41.689855207+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-15T14:20:41.690008376+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-15T14:20:41.690143115+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-15T14:20:41.690662337+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.705025440+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-15T14:20:41.707629335+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:20:41.708186277+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.714417129+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-15T14:20:41.716175048+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:20:41.716747189+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:41.727756343+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-15T14:20:41.735613585+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-15T14:20:41.735716493+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-15T14:20:41.735746729+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-15T14:20:41.736051709+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:20:41.736406539+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-15T14:20:41.736475318+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend Initial Context Setup Request
2025-06-15T14:20:41.737586670+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.737664464+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.737671907+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.737675514+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.737681436+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737693725+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.737708959+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.737755910+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.737768311+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737770619+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:20:41.737790735+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737794656+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:20:41.737799729+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:20:41.737806213+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.737808008+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737810636+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.737816283+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.737818142+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737955656+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.738923115+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.738937657+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.738979594+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.738985728+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.738987783+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.738990113+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.739005673+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.739008023+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.739011351+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.739014580+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.739018416+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.739021177+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.739024512+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.739026418+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-15T14:20:41.739169058+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle InitialContextSetupResponse
2025-06-15T14:20:41.739193484+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:20:41.739205150+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x6514794a
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc0004ed1a0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cb4690)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000b3a700)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000bc3010)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc0004ed1c0)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc0004ed1e0)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000bc304b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000bc3063)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-15T14:20:41.741586647+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:41.741625318+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:41.741671855+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-15T14:20:41.741688554+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-15T14:20:41.741711446+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-15T14:20:41.741725981+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend Downlink Nas Transport
2025-06-15T14:20:41.741863420+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-15T14:20:42.244535173+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:42.244669074+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.244713444+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:20:42.244725095+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:20:42.244733811+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:20:42.244745028+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:20:42.245395232+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.253306082+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-15T14:20:42.254730845+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:20:42.254909687+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:20:42.255052508+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:20:42.255399788+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:20:42.256044797+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.268044193+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:42.270838003+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:20:42.271002233+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:20:42.271221137+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:20:42.271264667+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:20:42.271949632+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.285939882+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:20:42.287445920+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:20:42.288254476+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:20:42.288333309+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:20:42.289475879+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.289655759+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.289744734+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:20:42+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000b183c0 0xc000b183e0 0xc000b18400]
2025-06-15T14:20:42.289780510+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:20:42.289803383+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000b183c0 0xc000b183e0 0xc000b18400]}
2025-06-15T14:20:42.289816059+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:20:42.290176599+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.291357613+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&target-nf-type=AMF |  |
2025-06-15T14:20:42.291586406+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:20:42.291698459+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-15T14:20:42.291705017+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:20:42.291707717+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-15T14:20:42.291713197+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:20:42.291717103+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:20:42.291719602+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:20:42.291722765+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:20:42.292355266+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:20:42.292843046+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.310978536+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-15T14:20:42.312405492+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-15T14:20:42.313419973+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-15T14:20:42.313575252+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-15T14:20:42.314011537+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-15T14:20:42.314509761+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.322285698+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-15T14:20:42.324393956+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.328879658+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:20:42.328963580+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:20:42.329274125+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:20:42.329802304+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.330777779+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:20:42.331237227+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:20:42.331457379+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-15T14:20:42.331818940+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.337650905+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:20:42.338588604+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:20:42.339912811+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:20:42.339997839+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:20:42.340015653+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:20:42.340018466+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:20:42.340020369+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:20:42.340167311+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:20:42.340530595+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:20:42.340590905+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:20:42.340597795+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.340618178+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:20:42.340669402+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.340705552+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:20:42.340815233+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:20:42.340916466+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:20:42.341075711+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-15T14:20:42.351361507+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:20:42.352342360+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:20:42.352403636+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend PDU Session Resource Setup Request
2025-06-15T14:20:42.352587049+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:20:42.353486352+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.353558816+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.353565832+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-15T14:20:42.353606172+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.353608362+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353615271+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.353646346+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.353692064+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.353699934+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.353703238+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.353705996+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.353708358+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.353710595+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-15T14:20:42.353813677+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353818995+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.353822295+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.353824719+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.353826998+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.353833621+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.353839129+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353840927+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.353851809+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.353853910+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353855499+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x92e4eef4
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cb2600)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fc5a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000cb0820)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000ca8564)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000718480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b74200)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000ca8590)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000ca85a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000cb2620)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000cb2640)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000cb2660)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:20:42.447751853+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:20:42.447962145+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.448630943+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:20:42.451443105+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:20:42.451718751+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:45cf4e86-5610-49d2-bd0f-6f99726e3940/modify |  |
2025-06-15T14:20:42.452809556+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:42.452852386+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.452893779+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:20:42.452908774+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:20:42.452919614+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:20:42.452932366+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:20:42.453929646+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:20:42.453973745+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:20:42.453989494+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:20:42.455934312+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:20:42.458919804+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.485884161+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:42.487897467+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:20:42.488035046+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:20:42.488067644+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:20:42.488070923+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:20:42.488570988+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.504420298+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:20:42.505983796+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:20:42.506588189+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:20:42.506658474+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:20:42.507992673+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.508395123+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.508539612+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:20:42+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001302860 0xc001302880 0xc0013028a0]
2025-06-15T14:20:42.508556771+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:20:42.508560956+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001302860 0xc001302880 0xc0013028a0]}
2025-06-15T14:20:42.508563358+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:20:42.509009156+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.511122653+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&target-nf-type=AMF |  |
2025-06-15T14:20:42.511482687+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:20:42.511603087+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-15T14:20:42.511611028+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:20:42.511614580+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-15T14:20:42.511659978+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:20:42.511667572+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:20:42.511670025+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:20:42.511672984+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:20:42.512069634+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:20:42.513425999+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.518004215+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:20:42.518369470+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:20:42.518781094+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:20:42.519517040+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.520392433+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:20:42.520574621+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:20:42.520936016+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-15T14:20:42.521308966+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.527980123+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:20:42.528543278+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:20:42.529388142+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:20:42.529452576+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:20:42.529460956+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:20:42.529464082+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:20:42.529466198+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:20:42.529483026+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:20:42.529741610+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:20:42.529820493+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-15T14:20:42.529900416+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:20:42.529983676+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.530022018+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:20:42.530026469+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.530055421+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:20:42.530309363+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:20:42.530417001+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:20:42.530748583+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-15T14:20:42.536366138+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:20:42.537761134+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:20:42.537850141+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend PDU Session Resource Setup Request
2025-06-15T14:20:42.538241245+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:20:42.539385202+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.539615378+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.539666984+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-15T14:20:42.539709166+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.539711830+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.539714104+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.539749430+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.539800288+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.539808455+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.539811651+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.539814943+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.539819053+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.539821679+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 2 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:20:42.539867398+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.539915822+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.539923178+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.539925858+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.539928302+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.539937992+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.539940173+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.539943476+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.539956032+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.539957761+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.539959517+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000815e2220
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x7017e235656896cce47e2c89b3fe21877e4b32bc50d9e61e7fec68934e7b2cab
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x502d2b39f4f500e5e1ac13d75b6a3dc9cc2ce1c0
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000003a5a4b04
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xe03bd0a28975d812f13e64ffbcd2b15f35440c4255518bdb0d5a6710b582cb50
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x86f13517a484ed55f746f08c2b68050358b03d2b
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x14740301
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cb32e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fc870)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000cb11d0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000ca9e7c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000718630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b74900)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000ca9ea0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000ca9eb0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000cb3300)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000cb3320)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000cb3340)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:20:42.654507982+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:20:42.654591474+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.654981112+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:20:42.657605874+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:20:42.657819428+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:7ef54e08-933b-4f6e-a316-89d7806f45ad/modify |  |
2025-06-15T14:20:42.658061062+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:42.658072972+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.658102767+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:20:42.658107559+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:20:42.658110820+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:20:42.658116618+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:20:42.658660166+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:20:42.658820142+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:20:42.658846017+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:20:42.659127975+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:20:42.659731330+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.671263190+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:42.673203495+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:20:42.673342944+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:20:42.673388151+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:20:42.673399524+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:20:42.674300766+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.687884383+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:20:42.689134418+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:20:42.690533329+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:20:42.690617727+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:20:42.691916178+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.692271956+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.692472056+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:20:42+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0015be7a0 0xc0015be7c0 0xc0015be7e0]
2025-06-15T14:20:42.692489338+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:20:42.692494680+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0015be7a0 0xc0015be7c0 0xc0015be7e0]}
2025-06-15T14:20:42.692541081+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:20:42.693037845+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.694449324+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&target-nf-type=AMF |  |
2025-06-15T14:20:42.694654507+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:20:42.694765168+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-15T14:20:42.694771511+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:20:42.694774446+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-15T14:20:42.694779435+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:20:42.694783009+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:20:42.694785093+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:20:42.694788484+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:20:42.695352488+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:20:42.696300224+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.699247028+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:20:42.699352890+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:20:42.699471078+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:20:42.699983883+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.701197450+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:20:42.701976095+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:20:42.702375982+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-15T14:20:42.702649012+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.714192263+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:20:42.715212526+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:20:42.715875763+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:20:42.715930926+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:20:42.715938808+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:20:42.715941531+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:20:42.715943636+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:20:42.715959107+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:20:42.716247831+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:20:42.716306887+08:00[36m [INFO][SMF][CTX] [0mNo Default Data Path
2025-06-15T14:20:42.716364971+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:20:42.716381628+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.716411646+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:20:42.716434422+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.716478895+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:20:42.716569493+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:20:42.716640297+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:20:42.716867816+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-15T14:20:42.722559974+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:20:42.724620774+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:20:42.724719269+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend PDU Session Resource Setup Request
2025-06-15T14:20:42.724919283+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:20:42.725661391+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.725735117+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.725745531+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-15T14:20:42.725785772+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.725790507+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725794132+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.725827655+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.725868776+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.725878464+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.725884445+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.725887891+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.725891696+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.725895278+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 2 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:20:42.725942851+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725947627+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.725951885+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.725955463+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.725958512+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.725965892+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.725968718+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725970291+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.725983699+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.725988005+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725989649+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000407fc7c5
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xfa7e3ae73c3a5d7b8e2cf1b56f51157ebf4615b2f37d18febeedf571543ce8d3
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x3cf3223b79aad2742cdbd151b820be1e2c7dd098
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000003e10fdc6
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x4039df7468a583fe47e38decc2b00c466ffe642664eea103cafeff8c22f8d523
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x146535cfcaba7ef9cd33e327c6da4f8ff6b58a08
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x2b83ceb9
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cb3fe0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fcb40)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000cb1b80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  02 02 00 06 21 12 01 01  ff 03 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 02  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00069d20c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007187e0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b75000)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 02 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00069d230)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00069d240)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000bda000)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 02 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000bda520)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000bda540)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-15T14:20:42.859585357+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:20:42.859657019+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.860180072+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:20:42.865619208+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:20:42.865762787+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:5f42529e-fb15-4080-816e-bff1be45391a/modify |  |
2025-06-15T14:20:42.866576597+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport
2025-06-15T14:20:42.866681921+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-15T14:20:42.866743899+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-15T14:20:42.866753258+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-15T14:20:42.866759002+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-15T14:20:42.866769673+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-15T14:20:42.867709311+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-15T14:20:42.867830348+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-15T14:20:42.867849137+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-15T14:20:42.868092487+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-15T14:20:42.868824909+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.881368790+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-15T14:20:42.883512274+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-15T14:20:42.883703647+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-15T14:20:42.883747080+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-15T14:20:42.883802604+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-15T14:20:42.884480871+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.899200971+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-15T14:20:42.901900506+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-15T14:20:42.902897515+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-15T14:20:42.902977320+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-15T14:20:42.904537323+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.904815195+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.905168633+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-15T14:20:42+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0006f1dc0 0xc0006f1de0 0xc0006f1e00]
2025-06-15T14:20:42.905237859+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-15T14:20:42.905243145+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0006f1dc0 0xc0006f1de0 0xc0006f1e00]}
2025-06-15T14:20:42.905245516+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-15T14:20:42.905845807+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.907602559+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3d3b0ec6-1509-41b3-b732-1315beb6fc57&target-nf-type=AMF |  |
2025-06-15T14:20:42.907890064+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-15T14:20:42.907949290+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-15T14:20:42.908011807+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-15T14:20:42.908018669+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-15T14:20:42.908024040+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:20:42.908028117+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-15T14:20:42.908030620+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:20:42.908034144+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:20:42.908597416+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-15T14:20:42.911051917+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-15T14:20:42.918833860+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-15T14:20:42.919097898+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-15T14:20:42.919375512+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-15T14:20:42.919794489+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.920671579+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-15T14:20:42.921038446+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-15T14:20:42.921298522+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-15T14:20:42.923593547+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-15T14:20:42.930169288+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-15T14:20:42.931379683+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-15T14:20:42.932301600+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-15T14:20:42.932360247+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-15T14:20:42.932375392+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-15T14:20:42.932510017+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-15T14:20:42.932525940+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-15T14:20:42.932551851+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-15T14:20:42.932809855+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-15T14:20:42.932965588+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-15T14:20:42.932981622+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.933025418+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-15T14:20:42.933097602+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-15T14:20:42.933146690+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-15T14:20:42.933204440+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-15T14:20:42.933325831+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-15T14:20:42.934546442+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-15T14:20:42.940178427+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-15T14:20:42.941663671+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-15T14:20:42.941780456+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mSend PDU Session Resource Setup Request
2025-06-15T14:20:42.942107440+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-15T14:20:42.942934915+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.942960359+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.942963846+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-15T14:20:42.942997225+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.942999913+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.943002128+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.943032346+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.943035469+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943040775+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943043474+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943046395+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943048839+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943051079+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-15T14:20:42.943104699+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.943107563+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.943110842+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.943113198+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.943115652+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.943126975+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.943130078+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.943132020+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.943143298+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.943145243+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.943147043+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000bbdbcbf9
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x0594a0df2c7a271bc384b794ea6bb9223dec7d27899218c1f066764ac3e27536
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xcf40d14ddd2a81b6b92166afe935e5902398bb4a
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000005ebfe365
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x6cfc4046a431408e5b1fdfd590bf59adecd7eaaaa84cfb94d1ff2539044cf147
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x333b668f90cbf133e816c0ad650ca9c644500b7a
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x314f45fa
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000bdb1e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fce10)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000b64550)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00026e8ec)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000718990)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc00070a400)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00026e920)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00026e930)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000bdb200)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000bdb220)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000bdb240)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-15T14:20:43.072892536+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse
2025-06-15T14:20:43.073065635+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:60947] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-15T14:20:43.073645572+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-15T14:20:43.077519955+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-15T14:20:43.077734709+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:09db8637-0b86-4878-bdca-080c8575e802/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.756077ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.145676ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=887.873µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=951.423µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=605.428µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 605.428µs/1.069296ms/1.756077ms/384.573µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.78s)
PASS
ok  	test	9.824s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.42s)
PASS
ok  	test	28.318s

--- STDERR ---
2025-06-15T14:20:22.772645435+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:20:22.772798327+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-15T14:20:22.774272471+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:20:22.774415200+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0000a5a90)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc00055c090)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc00055c240)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000512cc0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-15T14:20:22.774422141+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-15T14:20:22.774426459+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-15T14:20:22.774429097+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:22.774443987+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-15T14:20:22.774447978+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-15T14:20:22.782789028+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-15T14:20:22.782960237+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-15T14:20:22.783341063+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-15T14:20:22.783947382+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-15T14:20:22.784401440+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-15T14:20:22.785516571+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-15T14:20:27.920405204+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-15T14:20:27.920449226+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-15T14:20:34.955401938+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-15T14:20:34.955949874+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-15T14:20:34.956362738+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-15T14:20:34.956421286+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-15T14:20:34.956427803+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-15T14:20:34.956516023+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-15T14:20:34.956521234+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-15T14:20:34.961201737+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-15T14:20:34.961275442+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-15T14:20:34.962505761+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-15T14:20:34.964162642+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-15T14:20:34.964401357+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-15T14:20:34.964896637+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-15T14:20:34.964987234+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-15T14:20:34.964992842+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-15T14:20:34.966212302+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-15T14:20:41.552493565+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.552584561+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.552593821+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.552601250+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.552604809+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.552608653+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-15T14:20:41.561625588+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.561723609+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.561732299+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:41.561736896+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:20:41.561739792+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:41.561742427+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:41.561744731+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:41.561760987+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.561777711+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:20:41.561800792+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.561803048+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.561804912+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:41.561807622+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-15T14:20:41.561809686+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:41.561812137+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:41.561813992+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:41.567934990+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.567995691+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.568002678+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.568007213+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:20:41.568013907+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.568015988+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.568017928+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.568051995+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.568056434+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.568059574+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.568063538+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.568071307+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.568077033+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-15T14:20:41.568079535+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.568081778+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:20:41.568089509+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-15T14:20:41.568093491+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:20:41.568095266+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-15T14:20:41.569621971+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.569674785+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-15T14:20:41.569682912+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-15T14:20:41.569685880+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:20:41.569692918+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.569695180+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:20:41.569714171+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.569717532+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.569719477+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.569748004+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.569749978+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.569754763+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.570908090+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.570948598+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.570961999+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.571104706+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:20:41.571132956+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.571142941+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.571150825+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.571177164+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.571186864+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.571194654+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.571204087+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:20:41.571264055+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.571369646+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:41.571400511+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-15T14:20:41.571466823+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.571497550+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-15T14:20:41.625248993+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:20:41.625345597+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:41.625377426+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:20:41.625393598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.625402882+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.625410721+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:20:41.625429520+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.625438265+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.625445940+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.625476522+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.625489956+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.625499046+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.626384652+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.626398708+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.626402249+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.626405239+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:20:41.626409429+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.626411498+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.626413326+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.626425127+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.626427512+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.626434587+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.626438113+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:20:41.626443780+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.626447413+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:41.630764986+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:20:41.630866869+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:41.630876190+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-15T14:20:41.630881787+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.630884025+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.630886201+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-15T14:20:41.630898378+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.630900683+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.630902639+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.630917643+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.630919781+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.630921506+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.631648621+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.631691403+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.631703980+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.631713407+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:20:41.631723791+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.631732082+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.631739436+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.631762601+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.631772107+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.631779712+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.631789286+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-15T14:20:41.631850822+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.631884100+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:41.737041242+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-15T14:20:41.737220067+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:41.737269768+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-15T14:20:41.737278584+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737281127+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-15T14:20:41.737290916+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.737302092+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737304104+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.737314901+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.737316799+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.737318667+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.738010495+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:41.738023425+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.738257569+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.738267041+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-15T14:20:41.738271695+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.738273947+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.738275821+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.738288483+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:41.738293254+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.738296159+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:41.738343278+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 1412098597, Outbound SPI: 3217418062
2025-06-15T14:20:41.738373598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.738376433+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-15T14:20:41.738378690+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-15T14:20:41.738381315+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:41.738385940+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:41.738389074+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:41.738391350+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:41.738394208+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:41.738400278+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.738402108+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.738403864+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.738580976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:41.738585426+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:41.738587254+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:41.738741536+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.738752179+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.738756068+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:41.738758414+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:20:41.738768239+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.738771280+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-15T14:20:41.739635276+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:20:41.740491983+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:41.741353165+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:41.742027288+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-15T14:20:42.244094178+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:42.341437955+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:20:42.341513724+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-15T14:20:42.346751290+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-15T14:20:42.346845747+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-15T14:20:42.348921557+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-15T14:20:42.352913677+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:20:42.353093499+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.353101993+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:20:42.353120396+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353225434+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.353271980+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.353277829+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.353280136+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.353282405+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.353284464+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.353297747+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.353300116+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353301930+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.353318178+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.353320467+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.353322143+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.354083409+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.354147016+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.354158938+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.354162314+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:20:42.354164770+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13922974621732086919
2025-06-15T14:20:42.354168193+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.354170101+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.354172037+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.354198109+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.354348721+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.354356453+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.354359250+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.354361812+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.354414682+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.354423096+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.354425752+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:20:42.354599059+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.354679450+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.354752396+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:20:42.355930683+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:42.449251347+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:20:42.531072569+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:20:42.531137973+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-15T14:20:42.533812473+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-15T14:20:42.534614029+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-15T14:20:42.538618172+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:20:42.538858059+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.538926319+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:20:42.538968546+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.538973742+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.538979232+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.538985531+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.538995959+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.538999946+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.539003333+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.539017169+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.539089195+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.539097615+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.539129060+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.539132730+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.539135961+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.541108760+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.541175857+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.541183795+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.541187498+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:20:42.541190670+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13922974621732086919
2025-06-15T14:20:42.541195334+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.541197705+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.541205472+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.541252586+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.541260315+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.541267912+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.541271047+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.541274004+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.541285771+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.541290740+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.541294584+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:20:42.543442066+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-15T14:20:42.544847861+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.544937647+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.544968146+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:20:42.551917432+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:42.655545558+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:20:42.717206672+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:20:42.717228099+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-15T14:20:42.719814753+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-15T14:20:42.719943468+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-15T14:20:42.725185167+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:20:42.725313756+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.725325469+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:20:42.725365307+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725442553+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.725453563+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.725459350+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.725462332+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.725464831+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.725469847+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.725480637+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.725483891+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725488433+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.725515031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.725520778+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.725524121+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.726400456+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.726420527+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.726424129+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.726427570+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:20:42.726430898+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13922974621732086919
2025-06-15T14:20:42.726434825+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.726449716+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.726454202+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.726488830+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.726502852+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.726506809+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.726509851+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.726513342+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.726528970+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.726534589+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.726539092+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:20:42.732158414+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-15T14:20:42.732405184+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.733547331+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.733605118+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:20:42.736932651+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-15T14:20:42.862021746+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:20:42.933919455+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-15T14:20:42.934050599+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-15T14:20:42.936517853+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-15T14:20:42.936909131+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-15T14:20:42.942514186+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-15T14:20:42.942693568+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.942701972+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-15T14:20:42.942735697+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.942740472+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-15T14:20:42.942751264+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-15T14:20:42.942754239+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.942756881+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-15T14:20:42.942759182+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.942761316+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-15T14:20:42.942775220+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.942779229+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.942782270+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.942799197+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.942801218+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.942803027+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.943416102+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-15T14:20:42.943438237+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.943444125+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943450992+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-15T14:20:42.943454117+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 13922974621732086919
2025-06-15T14:20:42.943458836+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-15T14:20:42.943461107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-15T14:20:42.943463121+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-15T14:20:42.943489838+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-15T14:20:42.943492502+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943498203+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943501339+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943504257+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-15T14:20:42.943510562+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.943517068+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-15T14:20:42.943519910+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-15T14:20:42.948166856+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-15T14:20:42.948427962+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.948665715+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-15T14:20:42.948694479+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-15T14:20:43.074439808+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-15T14:20:54.345750910+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-15T14:20:54.345960113+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-15T14:20:54.346301486+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-15T14:20:54.346387386+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-15T14:20:54.346406879+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-15T14:20:54.386896722+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-15T14:20:54.386964393+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-15T14:20:54.386984419+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-15T14:20:54.386990237+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-15T14:20:54.386992625+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-15T14:20:54.386994832+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-15T14:20:54.728232219+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-15T14:20:54.728281469+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-15T14:20:54.728460779+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-15T14:20:54.728507552+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-15T14:20:54.728514798+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-15T14:20:54.728873269+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-15T14:20:54.728901696+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-15T14:20:54.728907225+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-15T14:20:54.728915897+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-15T14:20:54.728993083+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.2:40397: use of closed network connection
2025-06-15T14:20:54.729004134+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.2:40397: use of closed network connection
2025-06-15T14:20:54.729008597+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-15T14:20:54.729029601+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-15T14:20:54.729032982+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-15T14:20:54.729042258+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-15T14:20:54.729052912+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-15T14:20:54.729058435+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:20:54.729068787+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-15T14:20:54.729072366+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-15T14:20:54.729077688+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-15T14:20:54.729148766+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-15T14:20:54.729330513+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-15T14:20:54.729354443+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-15T14:20:54.729373233+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-15T14:20:54.729377984+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (115272): No such process
