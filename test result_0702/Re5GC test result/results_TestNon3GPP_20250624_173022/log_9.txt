Run TestCN
os.Args: [/tmp/go-build1568981222/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-24T17:35:22.124118967+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.124203014+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.124208373+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.124216014+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-24T17:35:22.124229755+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-24T17:35:22.126048243+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.126056225+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.126061207+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.126846967+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-24T17:35:22.134169244+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.134220768+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.134226410+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.134231079+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-24T17:35:22.134249344+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-24T17:35:22.134418459+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:35:22.134466879+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.134472130+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.134473846+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.134838903+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.134882663+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.134888119+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.134891216+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-24T17:35:22.134907282+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-24T17:35:22.134976695+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.134981915+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.134983681+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-24T17:35:22.135169784+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.135175775+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.135177649+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.135188442+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 422c2adc-634e-447c-a187-029f4f99cafd ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{422c2adc-634e-447c-a187-029f4f99cafd-auth nausf-auth 0xc000dabc68 http REGISTERED   0xc000dabc50  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{422c2adc-634e-447c-a187-029f4f99cafd-policyauthorization npcf-policyauthorization 0xc000dabcc8 http REGISTERED   0xc000dabcb0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{422c2adc-634e-447c-a187-029f4f99cafd-smpolicycontrol npcf-smpolicycontrol 0xc000dabc98 http REGISTERED   0xc000dabc80  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000c7d220 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc0004ee930 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-24T17:35:22.135325297+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-24T17:35:22.135964569+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.136055276+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.136061290+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.136066301+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-24T17:35:22.136209064+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-24T17:35:22.136537236+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:22.136670102+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-24T17:35:22.136681616+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:22.136683908+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-24T17:35:22.136761198+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-24T17:35:22.137242691+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-24T17:35:22.137408124+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-24T17:35:22.338655445+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-24T17:35:22.338780649+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-24T17:35:22.339062166+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-24T17:35:22.340709389+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:22.346949390+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:22.347697966+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 5e619fb8-67e9-4323-9faf-f70a9879d44e
2025-06-24T17:35:22.349726899+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/5e619fb8-67e9-4323-9faf-f70a9879d44e |  |
2025-06-24T17:35:22.350509887+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:22.350604782+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-24T17:35:22.539837777+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-24T17:35:22.541936534+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:22.547313058+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:22.548301888+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8cd9f6a3-6ae2-48f2-ac2f-bc4b6393ab26
2025-06-24T17:35:22.550103467+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8cd9f6a3-6ae2-48f2-ac2f-bc4b6393ab26 |  |
2025-06-24T17:35:22.550308771+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:22.550517119+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {8cd9f6a3-6ae2-48f2-ac2f-bc4b6393ab26 SMF REGISTERED 0 0xc0006c6c18 0xc0006c6c30 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000d0d400 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0006c6b70 false false []}
2025-06-24T17:35:22.550674978+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-24T17:35:22.550685629+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-24 17:35:22.550681551 +0800 CST m=+0.459381327]
2025-06-24T17:35:22.550753548+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-24T17:35:22.741706077+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:22.748579861+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:22.753478804+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 82ec5d80-c16f-427e-b412-8dd984c450fc
2025-06-24T17:35:22.755048366+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/82ec5d80-c16f-427e-b412-8dd984c450fc |  |
2025-06-24T17:35:22.756031059+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:22.756070761+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-24T17:35:22.756076063+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-24T17:35:22.756078912+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:35:22.756088527+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-24T17:35:22.944038291+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-24T17:35:22.944106359+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-24T17:35:22.944998882+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:22.950228534+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:22.951006673+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: d90d6d3a-ce7d-4af9-9191-c90d0f40d13f
2025-06-24T17:35:22.951907270+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d90d6d3a-ce7d-4af9-9191-c90d0f40d13f |  |
2025-06-24T17:35:22.952239193+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:22.952392205+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-24T17:35:23.145149515+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:23.152264908+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:23.153462245+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: b6cc007e-dc29-41c2-ae00-5937098f2e67
2025-06-24T17:35:23.154409048+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/b6cc007e-dc29-41c2-ae00-5937098f2e67 |  |
2025-06-24T17:35:23.154600968+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:23.154649683+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-24T17:35:23.154656066+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-24T17:35:23.345966908+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-24T17:35:23.347192783+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:23.352008743+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:23.353049434+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 422c2adc-634e-447c-a187-029f4f99cafd
2025-06-24T17:35:23.354507501+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/422c2adc-634e-447c-a187-029f4f99cafd |  |
2025-06-24T17:35:23.354667063+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:23.354769522+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-24T17:35:23.546909959+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-24T17:35:23.547900462+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:23.551580201+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-24T17:35:23.551896179+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:23.552604618+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 99c4c112-a7a9-41cc-b4ad-f490f19320e8
2025-06-24T17:35:23.552852968+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-24T17:35:23.552967153+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/99c4c112-a7a9-41cc-b4ad-f490f19320e8 |  |
2025-06-24T17:35:23.553352475+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:23.553487365+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-24T17:35:23.747875944+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-24T17:35:23.748715419+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-24T17:35:23.750595860+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:35:23.760294332+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:35:23.768204518+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9a434fbe-39b7-41ac-89ed-cf1f95508fc2
2025-06-24T17:35:23.769287820+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9a434fbe-39b7-41ac-89ed-cf1f95508fc2 |  |
2025-06-24T17:35:23.769515216+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:35:23.769547650+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-24T17:35:30.668927255+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831
2025-06-24T17:35:30.671397328+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831
2025-06-24T17:35:30.671581431+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle NGSetupRequest
2025-06-24T17:35:30.671587873+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mMissing IE PagingDRX
2025-06-24T17:35:30.671731048+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3378840504/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-24T17:35:37.270839566+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.270948828+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.270957631+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.270965601+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:35:37.270977459+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:37.271757907+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.271797128+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.271818046+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.272502170+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:35:37.272649791+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:37.281034867+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.281111642+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.281122001+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.281127079+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.281132487+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.281136230+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.281138037+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-24T17:35:37.285684496+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.285738797+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:35:37.285744252+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.285747183+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.285749323+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.285760841+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.285762582+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.285764250+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.285771469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.285772982+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.285774421+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.288447537+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.288482371+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.288485359+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288488373+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.288492862+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.288495879+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.288555993+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.288591241+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288595932+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288598178+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288600366+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288603206+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-24T17:35:37.288646195+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.288648200+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.288649787+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:35:37.288654679+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.288656783+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.288658272+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.288664516+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.288666751+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.288668156+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.289436828+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle InitialUEMessage
2025-06-24T17:35:37.289580608+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-24T17:35:37.289661517+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-24T17:35:37.289702085+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-24T17:35:37.289716078+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-24T17:35:37.289723465+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-24T17:35:37.289727247+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-24T17:35:37.289730889+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-24T17:35:37.289736997+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-24T17:35:37.289740386+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-24T17:35:37.290472423+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.293169672+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-24T17:35:37.294041586+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-24T17:35:37.294050610+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-24T17:35:37.294437430+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.298035332+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-24T17:35:37.298971374+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-24T17:35:37.299003544+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-24T17:35:37.299006293+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-24T17:35:37.299008472+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-24T17:35:37.299427553+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.301052589+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-24T17:35:37.302412203+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:35:37.305105555+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:35:37.305205161+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-24T17:35:37.305549126+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-24T17:35:37.305579211+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-24T17:35:37.305591851+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 3361633838646433633663313637656362323066633965343838633433393962
2025-06-24T17:35:37.305638895+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-24T17:35:37.306094921+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-24T17:35:37.306120488+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend Downlink Nas Transport
2025-06-24T17:35:37.307323293+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.307367142+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.307376850+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.307388903+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.307397831+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.307404191+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.307426069+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.307433357+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.307439635+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.307754872+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.307781376+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.307789284+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:35:37.307800695+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.307807380+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.307815426+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.307829562+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.307837880+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.307845256+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.308377238+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:37.308427321+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:37.308463544+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-24T17:35:37.308468306+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-24T17:35:37.309196259+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-24T17:35:37.309231598+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 3361633838646433633663313637656362323066633965343838633433393962
Xres*: 3361633838646433633663313637656362323066633965343838633433393962
2025-06-24T17:35:37.309241665+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-24T17:35:37.310024246+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-24T17:35:37.311360580+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-24T17:35:37.311427745+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-24T17:35:37.311479151+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-24T17:35:37.311918922+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-24T17:35:37.311973306+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-24T17:35:37.311995047+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend Downlink Nas Transport
2025-06-24T17:35:37.312750570+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.312933648+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.312940336+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.312942822+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.312944626+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.312946366+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.312957403+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.313183308+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.313224023+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.313383146+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.313561287+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.313630441+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:35:37.313992624+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.314185759+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.314190722+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.314340194+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.314387143+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.314572532+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.315318409+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:37.315507515+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:37.315543331+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-24T17:35:37.315602225+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-24T17:35:37.315634855+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-24T17:35:37.315639119+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-24T17:35:37.320156597+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.323089106+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:35:37.324686662+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-24T17:35:37.325240470+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:35:37.325754227+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-24T17:35:37.326013265+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:37.326962970+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.330530695+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:35:37.331576459+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-24T17:35:37.332761887+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-24T17:35:37.332931073+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-24T17:35:37.333068751+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-24T17:35:37.333222419+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:35:37.333459395+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:37.333577491+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:37.333719952+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-24T17:35:37.334000307+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-24T17:35:37.334129806+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:37.334260330+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-24T17:35:37.334499931+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-24T17:35:37.334649577+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-24T17:35:37.334831550+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-24T17:35:37.335050070+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-24T17:35:37.335423374+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-24T17:35:37.335828576+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.343993924+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-24T17:35:37.346847883+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:35:37.347420198+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.349092248+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-24T17:35:37.350538879+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:35:37.351127512+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.356213692+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-24T17:35:37.357318159+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-24T17:35:37.357352601+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-24T17:35:37.357382386+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-24T17:35:37.357879229+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:35:37.358475210+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-24T17:35:37.358542657+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend Initial Context Setup Request
2025-06-24T17:35:37.359385835+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.359463098+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.359469215+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.359471853+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359476739+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359478512+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.359494513+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.359496810+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.359503072+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359504989+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:35:37.359520017+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359523974+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:35:37.359526247+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:35:37.359531885+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359533533+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359535007+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.359539421+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359540946+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359542394+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.360305900+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.360581513+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.360621932+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360629508+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.360634312+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.360636017+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.360657811+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.360659989+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360662381+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360665297+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360668750+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360670895+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360674815+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.360676380+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-24T17:35:37.361468114+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle InitialContextSetupResponse
2025-06-24T17:35:37.361799371+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:35:37.361874290+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x32cc3260
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000cab2e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cf6690)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000af4700)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000cbd140)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000cab300)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000cab320)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000cbd17b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000cbd193)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-24T17:35:37.363068312+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:37.363118696+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:37.363152437+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-24T17:35:37.363156666+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-24T17:35:37.363169337+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-24T17:35:37.363174950+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend Downlink Nas Transport
2025-06-24T17:35:37.363404717+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-24T17:35:37.864295203+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:37.864367579+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:37.864411967+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:35:37.864416604+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:35:37.864421096+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:35:37.864435976+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:35:37.865276753+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.867633769+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-24T17:35:37.884896291+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:35:37.885186914+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:35:37.885358724+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:35:37.885938819+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:35:37.886551835+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.889676898+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:37.890763153+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:35:37.890943367+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:35:37.890981100+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:35:37.890984794+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:35:37.891433691+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.894369734+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:35:37.894678010+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:35:37.895246334+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:35:37.895269322+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:35:37.898913949+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:37.899151715+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:37.899656247+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:35:37+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0002ad300 0xc0002ad320 0xc0002ad340]
2025-06-24T17:35:37.899672452+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:35:37.899698159+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0002ad300 0xc0002ad320 0xc0002ad340]}
2025-06-24T17:35:37.899809687+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:35:37.900246414+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.901242428+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&target-nf-type=AMF |  |
2025-06-24T17:35:37.901400442+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:35:37.901503593+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-24T17:35:37.901548049+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:35:37.901554960+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-24T17:35:37.901559211+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:35:37.901562892+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:35:37.901564917+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:35:37.901567382+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:35:37.901950771+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:35:37.902124964+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.904775386+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-24T17:35:37.905679205+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:35:37.906668601+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:35:37.906871756+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:35:37.907073678+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-24T17:35:37.907486223+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.909329027+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-24T17:35:37.911074392+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:37.915090785+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:35:37.915442519+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:35:37.915636390+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:35:37.915964377+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.916657820+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:35:37.917066152+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:35:37.917398955+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:35:37.917584964+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:37.918851650+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:35:37.919199208+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:35:37.920369800+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:35:37.920461686+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:35:37.920469990+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:35:37.920473308+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:35:37.920475316+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:35:37.920605747+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:35:37.920903046+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:35:37.920958875+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:35:37.921003961+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:37.921032896+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:35:37.921037187+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:37.921055731+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:35:37.921178923+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:35:37.921265964+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:35:37.922043888+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-24T17:35:37.928310177+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:35:37.929682547+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:35:37.929862517+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend PDU Session Resource Setup Request
2025-06-24T17:35:37.930465669+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:35:37.930854002+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.930889429+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.930894539+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-24T17:35:37.930959401+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.930961928+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.930963877+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.930997899+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.931000414+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931009035+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931013363+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931015854+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931021633+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931023759+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-24T17:35:37.931079277+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.931085636+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.931088983+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.931091035+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.931092889+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:37.931101467+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.931104980+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.931106711+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.931124342+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.931126918+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.931128479+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xf2daba56
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cab700)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cf6960)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000cb1cc0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000022044)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cfe360)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000caee00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000022070)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000022080)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000cab720)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000cab740)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000cab760)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:35:38.040375981+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:35:38.040404077+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:35:38.041179927+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:35:38.044690664+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:35:38.044802372+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:e8bd0f49-a166-4b60-b716-74a20dea4a76/modify |  |
2025-06-24T17:35:38.045971689+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:38.046148381+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:38.046238579+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:35:38.046246018+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:35:38.046249714+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:35:38.046426438+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:35:38.046834287+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:35:38.046938890+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:35:38.046957296+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:35:38.047101094+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:35:38.047409104+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.053848197+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:38.056275220+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:35:38.056452087+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:35:38.056687435+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:35:38.056693940+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:35:38.057852654+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.062107402+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:35:38.063807205+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:35:38.064465302+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:35:38.064526323+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:35:38.065934321+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.066084494+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.066359447+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:35:38+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0018b2320 0xc0018b2340 0xc0018b2360]
2025-06-24T17:35:38.066400023+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:35:38.066408899+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0018b2320 0xc0018b2340 0xc0018b2360]}
2025-06-24T17:35:38.066416468+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:35:38.066738058+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.068608382+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&target-nf-type=AMF |  |
2025-06-24T17:35:38.069480632+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:35:38.069585723+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-24T17:35:38.069591475+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:35:38.069593879+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-24T17:35:38.069598195+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:35:38.069601684+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:35:38.069603597+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:35:38.069606124+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:35:38.070656905+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:35:38.073349661+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.077683991+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:35:38.077793255+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:35:38.078072570+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:35:38.078529779+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.079270276+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:35:38.079656898+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:35:38.080217463+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:35:38.080520231+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.082957383+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:35:38.083309655+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:35:38.084221601+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:35:38.084271172+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:35:38.084279064+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:35:38.084281393+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:35:38.084283228+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:35:38.084295802+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:35:38.084992599+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:35:38.085128373+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:35:38.085172359+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:38.085203080+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:35:38.085206828+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:38.085226399+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:35:38.085340198+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:35:38.085320104+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:35:38.085525895+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-24T17:35:38.090692629+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:35:38.091324876+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:35:38.091354611+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend PDU Session Resource Setup Request
2025-06-24T17:35:38.091504926+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:35:38.092362340+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:38.092403584+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.092407131+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-24T17:35:38.092433704+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.092435675+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092437646+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.092488103+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.092492405+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092496871+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092499252+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092503732+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092505944+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092508017+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:35:38.092552191+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092554406+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:38.092557066+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.092558961+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.092560897+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:38.092573917+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.092576724+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092578649+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.092588826+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.092590344+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092591770+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000076951324
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x80779964b928ff980f06497bf3c2bc614d4788f84587fd974e1456fde39684cd
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x203b06584e065a8f2658c829009716e772f3ee3a
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000003f58e573
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xd9d985e6dad52d910704d94c986a6077055f7041d3c16e581575e6476cc631a7
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x16eddbff1980a81a99ac0679e36dead34b6a706f
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-06-24T17:35:38.095144647+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:35:38.095160148+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:35:38.095586998+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x04135d20
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00005e4a0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cf6c30)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00069e690)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00002395c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cfe510)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000caf500)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000023980)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000023990)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00005e4c0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00005e4e0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00005e500)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:35:38.106983609+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:35:38.107234491+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:0e638bf3-a2f1-4138-9214-ebf7f57d3990/modify |  |
2025-06-24T17:35:38.297110681+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:38.297288607+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:38.297349305+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:35:38.297362055+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:35:38.297370397+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:35:38.297381792+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:35:38.298760063+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:35:38.298848217+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:35:38.298868311+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:35:38.299085920+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:35:38.299804493+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.302688281+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:38.303934740+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:35:38.304026615+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:35:38.304109668+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:35:38.304116642+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:35:38.321995605+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.325211222+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:35:38.325903021+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:35:38.326735878+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:35:38.326766081+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:35:38.328534011+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.328700733+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.329091980+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:35:38+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0018b3020 0xc0018b3040 0xc0018b3060]
2025-06-24T17:35:38.329186827+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:35:38.329191415+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0018b3020 0xc0018b3040 0xc0018b3060]}
2025-06-24T17:35:38.329193695+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:35:38.329628202+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.330757656+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&target-nf-type=AMF |  |
2025-06-24T17:35:38.330942774+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:35:38.330990839+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-24T17:35:38.331057594+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:35:38.331064105+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-24T17:35:38.331068806+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:35:38.331072630+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:35:38.331074674+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:35:38.331077184+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:35:38.331592962+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:35:38.332901890+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.336980140+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:35:38.337160173+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:35:38.337308763+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:35:38.337686637+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.338227969+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:35:38.338322170+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:35:38.338663199+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:35:38.338897173+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.340461682+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:35:38.340755415+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:35:38.341308237+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:35:38.341366306+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:35:38.341374460+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:35:38.341378101+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:35:38.341380163+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:35:38.341392784+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:35:38.341651015+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:35:38.341771124+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:35:38.341822629+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:38.341858176+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:35:38.341862517+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:38.341881528+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:35:38.342000347+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:35:38.341982770+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:35:38.342301490+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-24T17:35:38.347469286+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:35:38.348701684+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:35:38.348746419+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend PDU Session Resource Setup Request
2025-06-24T17:35:38.348964131+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:35:38.351581578+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:38.351720987+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.351728801+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-24T17:35:38.351754466+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.351756684+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.351758364+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.351784884+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.351823491+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.351830362+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.351834498+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.351837094+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.351839246+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.351841189+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:35:38.351884036+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.351887008+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:38.351889876+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.351930009+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.351934434+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:38.351940346+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.351942196+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.351943777+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.351954647+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.351956159+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.351957612+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000004876a1ea
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xc4d9d150d40b8cddf8b6c5dc7dd65aaba9c31f661a1e98ce021e53a21b935928
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x2fc48effd975a6d53a00c82bc9c9b76cc52327ce
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000a95b8496
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x92c9582095101622d159e8e0decd7fb5d13ee5f321734d66be85a38ff83e9f70
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x51628da4a6fe2f31647a59edd2e4968601b1b915
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x85a311a8
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00005f1e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cf6f00)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00069f040)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000698ebc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cfe6c0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cafc00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000698ee0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000698ef0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00005f200)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00005f220)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00005f240)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:35:38.453236368+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:35:38.453352780+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:35:38.454456997+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:35:38.458542534+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:35:38.458639951+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:5c67b969-53c8-41ae-8d9a-56264a89dbf1/modify |  |
2025-06-24T17:35:38.459194800+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport
2025-06-24T17:35:38.459233037+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:35:38.459282574+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:35:38.459293358+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:35:38.459303213+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:35:38.459321780+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:35:38.460158243+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:35:38.460279538+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:35:38.460315554+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:35:38.460571273+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:35:38.461050405+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.464145391+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:35:38.465313517+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:35:38.465393063+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:35:38.465435376+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:35:38.465487268+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:35:38.466118613+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.470799475+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:35:38.474734375+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:35:38.479028037+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:35:38.479167365+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:35:38.481741556+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.482855141+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.483654747+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:35:38+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000b00080 0xc000b000a0 0xc000b000c0]
2025-06-24T17:35:38.483895227+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:35:38.483904905+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000b00080 0xc000b000a0 0xc000b000c0]}
2025-06-24T17:35:38.483912089+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:35:38.484314314+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.485686705+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=5e619fb8-67e9-4323-9faf-f70a9879d44e&target-nf-type=AMF |  |
2025-06-24T17:35:38.485943301+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:35:38.486052543+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-24T17:35:38.486058411+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:35:38.486061160+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-24T17:35:38.486133494+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:35:38.486140325+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:35:38.486142566+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:35:38.486145553+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:35:38.486546935+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:35:38.487912058+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:35:38.492365126+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:35:38.492437829+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:35:38.492711277+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:35:38.493476800+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.493898807+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:35:38.494056563+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:35:38.494163842+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:35:38.494547971+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:35:38.496354568+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:35:38.496575120+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:35:38.497891633+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:35:38.497944068+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:35:38.497951416+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:35:38.497953737+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:35:38.497955633+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:35:38.497974371+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:35:38.498302544+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:35:38.498375102+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:35:38.498426892+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:38.498459128+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:35:38.498463477+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:35:38.498480621+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:35:38.498550179+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:35:38.498585744+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:35:38.498791050+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-24T17:35:38.504223922+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:35:38.505128152+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:35:38.505176812+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mSend PDU Session Resource Setup Request
2025-06-24T17:35:38.505321468+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:35:38.506147933+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:38.506209758+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.506216383+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-24T17:35:38.506288619+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.506293620+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.506296926+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.506322985+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.506325567+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.506329750+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.506332007+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.506334583+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.506336620+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.506340600+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:35:38.506416410+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.506420097+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:38.506422766+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.506425327+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.506427326+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:38.506437629+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.506478243+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.506482498+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.506496504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.506499058+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.506500575+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000005eb0446f
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x6197b68f503ddaeea71580d261d29d4be5b0bfdbbcdcc5262f19fcf002eb2b83
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x2200bb1ee3ff5261a6922afe552891708328fbbc
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000c784f1c1
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x060cdd5f95dd7a1adf695cf539a9d5713311cb63bcb021031f6e5b9b2d8f6adc
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xa7038b03937831067e2bf3dc835b2e443f302b7f
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
2025-06-24T17:35:38.516347048+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:35:38.516662871+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37831] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
Security header type: Integrity Protected And Ciphered
cmac value: 0x90c9ec1d
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00005ff20)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000cf71d0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00069fa40)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00049ff1c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cfe870)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc0006b2300)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00049ff90)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00049ffc0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00005ff40)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00005ff60)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00005ff80)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-24T17:35:38.518613021+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:35:38.523492223+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:35:38.523587585+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:1b26fef6-1aa9-410f-830e-3f81c793294a/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.090062ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=936.661µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=823.76µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=777.627µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=651.406µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 651.406µs/855.905µs/1.090062ms/148.548µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.78s)
PASS
ok  	test	9.822s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.54s)
PASS
ok  	test	28.411s

--- STDERR ---
2025-06-24T17:35:18.530085701+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:35:18.530216195+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-24T17:35:18.530413972+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:35:18.530441244+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc000597860)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000487e90)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc000601050)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0004a4320)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-24T17:35:18.530449933+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:35:18.530460064+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-24T17:35:18.530468504+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:18.530652018+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-24T17:35:18.530678689+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-24T17:35:18.537122979+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-24T17:35:18.537220521+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-24T17:35:18.538112826+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-24T17:35:18.538391988+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-24T17:35:18.538467234+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-24T17:35:18.538473768+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-24T17:35:23.552325780+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-24T17:35:23.552365662+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-24T17:35:30.656532809+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:35:30.657133854+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-24T17:35:30.658534606+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-24T17:35:30.658544442+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-24T17:35:30.658546760+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-24T17:35:30.658594521+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-24T17:35:30.658597637+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-24T17:35:30.666359549+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-24T17:35:30.666379037+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-24T17:35:30.669305529+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-24T17:35:30.671646962+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-24T17:35:30.672414449+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-24T17:35:30.672585234+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-24T17:35:30.676226048+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-24T17:35:30.676578234+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-24T17:35:30.677991364+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-24T17:35:37.271856278+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.271931857+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.271939720+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.271952102+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.271955449+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.271958920+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-24T17:35:37.280539648+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.280617688+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.280623537+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.280627122+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:35:37.280629321+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:37.280631725+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.280633519+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.280647890+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.280649542+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:35:37.280666212+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.280684292+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.280685927+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.280693330+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:35:37.280701778+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:37.280703595+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.280705227+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.286087556+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.286103606+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.286106808+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.286109753+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:35:37.286114596+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.286116384+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.286118148+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.286149056+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.286185334+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.286194445+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.286198002+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.286200337+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.286202739+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-24T17:35:37.286204299+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.286205817+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:35:37.286209395+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-24T17:35:37.286212129+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:35:37.286213559+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:35:37.287880288+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.287887470+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:35:37.287891120+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-24T17:35:37.287900250+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:35:37.287903925+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.287906045+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:35:37.287915323+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.287917018+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.287918606+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.288062295+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.288068682+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.288070437+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.288895031+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.288907029+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.288909500+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288911925+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:35:37.288917130+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.288918752+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.288920280+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.288931604+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.288933647+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288935332+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.288937754+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:35:37.288954639+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.288983502+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.289020579+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-24T17:35:37.289032035+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.289034942+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-24T17:35:37.306639212+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:35:37.306845925+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.306856161+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:35:37.306864795+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.306916966+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.306922057+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:35:37.306938320+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.306940435+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.306942252+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.306953112+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.306958334+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.306975489+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.308056591+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.308068535+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.308071724+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.308074390+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:35:37.308078156+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.308079904+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.308081494+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.308091797+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.308093809+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.308095632+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.308098452+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:35:37.308102571+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.308105723+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:37.312303199+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:35:37.312378230+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.312385749+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:35:37.312389983+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.312391942+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.312394207+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:35:37.312402789+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.312404878+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.312406544+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.312433367+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.312435140+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.312436628+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.314872387+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.314884521+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.314887364+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.314893862+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:35:37.314897744+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.314899627+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.314901319+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.314912340+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.314914325+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.314916606+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.314919212+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:35:37.314939029+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.314942139+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:37.358989590+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-24T17:35:37.359077761+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.359085944+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-24T17:35:37.359090153+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359092409+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:35:37.359101427+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359106569+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359108233+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.359116979+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359118536+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359120017+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.359582813+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.359593289+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.359596202+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.359598921+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:35:37.359615707+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359617448+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359619072+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.359643884+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.359646133+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.359648203+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.359674902+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 4110349075, Outbound SPI: 2988874826
2025-06-24T17:35:37.359805105+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359811958+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:35:37.359816857+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:35:37.359819315+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.359825184+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.359828488+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.359830642+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.359832373+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.359837842+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.359839506+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.359841095+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.360007906+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.360011513+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.360014225+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.360052431+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.360056765+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.360059745+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.360061854+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:35:37.360070006+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.360072395+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-24T17:35:37.361693881+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.362025095+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:35:37.362835232+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:37.365610132+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:35:37.863894856+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:37.921674100+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:35:37.921699960+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-24T17:35:37.924010531+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-24T17:35:37.924160960+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-24T17:35:37.925001370+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-24T17:35:37.930474803+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:35:37.930684294+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.930691284+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:35:37.930707128+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.930709478+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:37.930712490+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:37.930717436+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.930719640+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:37.930721604+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.930723345+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:37.930730670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.930732849+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.930734400+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.930749567+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.930751241+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.930752679+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.931316135+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:37.931333500+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.931336179+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931340488+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:35:37.931342840+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 11753755915961165005
2025-06-24T17:35:37.931346086+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:37.931347861+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:37.931349623+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:37.931378899+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:37.931381335+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931387470+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931390399+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931392607+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:37.931400484+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.931404688+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:37.931411227+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:35:37.931726627+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.931828761+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:37.931860765+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:35:37.933198193+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:38.041796000+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:35:38.085682007+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:35:38.085701748+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-24T17:35:38.089326395+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-24T17:35:38.089455242+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-24T17:35:38.092035621+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:35:38.092095960+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:38.092099524+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:35:38.092115117+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092117409+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:38.092122515+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:38.092124706+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.092142353+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.092144519+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:38.092146283+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:38.092157166+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.092159088+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092160728+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.092175263+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.092176985+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092178468+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.092803151+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:38.092820963+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.092823847+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092826532+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:35:38.092828956+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 11753755915961165005
2025-06-24T17:35:38.092832553+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.092834476+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.092836140+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.092871404+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.092874431+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092878831+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092881109+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092892943+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.092898810+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.092902048+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:38.092904339+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:35:38.094675493+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-24T17:35:38.094867293+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.094926352+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.094956903+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:35:38.100874660+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:38.103039825+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:35:38.342337495+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:35:38.342355497+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-24T17:35:38.345252245+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-24T17:35:38.345404594+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-24T17:35:38.350460908+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:35:38.350592751+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:38.350606993+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:35:38.350767682+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.350812141+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:38.350917286+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:38.350924906+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.350927582+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.350929545+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:38.350931266+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:38.350939403+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.350942931+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.350944498+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.351239648+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.351292552+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.351303146+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.352370454+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:38.352432706+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.352438372+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.352441114+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:35:38.352443257+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 11753755915961165005
2025-06-24T17:35:38.352447868+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.352449715+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.352451349+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.352479107+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.352528164+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.352534340+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.352536657+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.352538843+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.352548665+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.352559147+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:38.352561628+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:35:38.358823909+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-24T17:35:38.359140056+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.359225247+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.359256256+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:35:38.362317047+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:35:38.455396122+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:35:38.499878866+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:35:38.500003311+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-24T17:35:38.502676707+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-24T17:35:38.503096523+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-24T17:35:38.505754120+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:35:38.505890152+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:38.505906874+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:35:38.505937031+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.505939946+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:35:38.505942971+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:35:38.505945373+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.505947979+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:35:38.505951065+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:38.505995893+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:35:38.506006920+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.506008924+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.506010914+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.506026502+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.506028161+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.506029686+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.507187489+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:35:38.507241876+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.507252725+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.507256239+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:35:38.507258505+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 11753755915961165005
2025-06-24T17:35:38.507261234+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:35:38.507263077+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:35:38.507264692+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:35:38.507466533+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:35:38.507520463+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.507528272+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.507535026+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.507537714+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:35:38.508897578+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.509129004+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:35:38.509139469+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:35:38.512655895+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-24T17:35:38.515111621+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.515261682+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:35:38.515322581+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:35:38.519439298+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:35:50.070110741+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-24T17:35:50.070177650+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-24T17:35:50.070222616+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-24T17:35:50.070229936+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-24T17:35:50.070237577+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-24T17:35:50.123028514+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-24T17:35:50.123084229+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-24T17:35:50.123103308+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-24T17:35:50.123108717+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-24T17:35:50.123111007+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-24T17:35:50.123112789+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-24T17:35:50.469809076+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-24T17:35:50.469872648+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-24T17:35:50.470031139+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-24T17:35:50.470070571+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-24T17:35:50.470082628+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-24T17:35:50.470086113+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-24T17:35:50.470093877+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-24T17:35:50.470301335+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-24T17:35:50.470309622+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-24T17:35:50.470470430+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.153:33753: use of closed network connection
2025-06-24T17:35:50.470522975+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.153:33753: use of closed network connection
2025-06-24T17:35:50.470545357+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-24T17:35:50.470658063+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-24T17:35:50.470696116+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-24T17:35:50.470700332+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-24T17:35:50.470708168+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-24T17:35:50.470711908+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:35:50.470719479+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-24T17:35:50.470722135+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:35:50.470726155+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-24T17:35:50.470983145+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-24T17:35:50.471087634+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-24T17:35:50.471128828+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-24T17:35:50.471142348+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-24T17:35:50.471144681+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (66472): No such process
