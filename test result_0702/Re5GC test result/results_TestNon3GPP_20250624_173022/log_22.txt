Run TestCN
os.Args: [/tmp/go-build789953851/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-24T17:43:24.434659110+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.434784908+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.434790242+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.434800369+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-24T17:43:24.434820200+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-24T17:43:24.435640084+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.435645979+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.435647846+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.435733540+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-24T17:43:24.437131784+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.437207583+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.437213587+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.437217205+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-24T17:43:24.437231844+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-24T17:43:24.437527306+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:43:24.437604763+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.437609505+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.437611076+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.440313590+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.440395157+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.440506864+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.440514648+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-24T17:43:24.440553328+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-24T17:43:24.440779983+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.440864745+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.440870080+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-24T17:43:24.441827758+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.441844894+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.441846960+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.441946382+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 1da96480-5411-4a7a-a055-c2cc7dd0ab35 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{1da96480-5411-4a7a-a055-c2cc7dd0ab35-auth nausf-auth 0xc000d844b0 http REGISTERED   0xc000d84498  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{1da96480-5411-4a7a-a055-c2cc7dd0ab35-policyauthorization npcf-policyauthorization 0xc000d84510 http REGISTERED   0xc000d844f8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{1da96480-5411-4a7a-a055-c2cc7dd0ab35-smpolicycontrol npcf-smpolicycontrol 0xc000d844e0 http REGISTERED   0xc000d844c8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000723680 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc000d43f20 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-24T17:43:24.442235034+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-24T17:43:24.446793880+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.446907998+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.446914535+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.446920179+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-24T17:43:24.447361078+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-24T17:43:24.448581211+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:24.448634934+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-24T17:43:24.448640235+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:24.448642598+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-24T17:43:24.448672001+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-24T17:43:24.448731334+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-24T17:43:24.449174814+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-24T17:43:24.650943733+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-24T17:43:24.651194431+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-24T17:43:24.651618743+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-24T17:43:24.653258881+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:24.661660741+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:24.664381416+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6f4efc30-2c40-4a3f-95d8-689da9676c99
2025-06-24T17:43:24.666571937+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6f4efc30-2c40-4a3f-95d8-689da9676c99 |  |
2025-06-24T17:43:24.666832099+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:24.666890717+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-24T17:43:24.851653529+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-24T17:43:24.852874147+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:24.858408279+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:24.860509620+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9261f5e9-3f91-4d36-9194-afb1967a2be5
2025-06-24T17:43:24.862483940+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9261f5e9-3f91-4d36-9194-afb1967a2be5 |  |
2025-06-24T17:43:24.862880504+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:24.862961984+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {9261f5e9-3f91-4d36-9194-afb1967a2be5 SMF REGISTERED 0 0xc00063f3f8 0xc00063f410 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000752740 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc00063f350 false false []}
2025-06-24T17:43:24.863154696+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-24T17:43:24.863186997+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-24 17:43:24.863181502 +0800 CST m=+0.465261973]
2025-06-24T17:43:24.863171226+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-24T17:43:25.053359023+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:25.058678112+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:25.060064713+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 903e5e5a-4987-47a7-a99a-d14070d28193
2025-06-24T17:43:25.061546484+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/903e5e5a-4987-47a7-a99a-d14070d28193 |  |
2025-06-24T17:43:25.061837984+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:25.061892117+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-24T17:43:25.061897414+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-24T17:43:25.061901873+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:43:25.061917654+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-24T17:43:25.257791552+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-24T17:43:25.258061486+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-24T17:43:25.259601268+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:25.269401013+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:25.270184308+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 8644b8bf-2932-4eb3-9904-058ad60eaa07
2025-06-24T17:43:25.270937149+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/8644b8bf-2932-4eb3-9904-058ad60eaa07 |  |
2025-06-24T17:43:25.271238635+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:25.271482395+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-24T17:43:25.460347815+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:25.464637785+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:25.465627891+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 70f79726-c525-4c61-9e1b-f5f96e591fff
2025-06-24T17:43:25.466707328+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/70f79726-c525-4c61-9e1b-f5f96e591fff |  |
2025-06-24T17:43:25.467067218+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:25.467144563+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-24T17:43:25.467151058+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-24T17:43:25.660047758+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-24T17:43:25.660880205+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:25.665418684+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:25.665961826+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 1da96480-5411-4a7a-a055-c2cc7dd0ab35
2025-06-24T17:43:25.666529567+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/1da96480-5411-4a7a-a055-c2cc7dd0ab35 |  |
2025-06-24T17:43:25.666947580+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:25.666958968+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-24T17:43:25.872379868+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-24T17:43:25.872508459+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-24T17:43:25.873602846+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-24T17:43:25.874372555+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:25.879138388+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:25.880098362+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: f9b115fb-5c7e-4c73-9ff8-4af06760167b
2025-06-24T17:43:25.880676976+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/f9b115fb-5c7e-4c73-9ff8-4af06760167b |  |
2025-06-24T17:43:25.881090195+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:25.881207145+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-24T17:43:26.075410673+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-24T17:43:26.076238437+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-24T17:43:26.077957789+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:43:26.082423860+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:43:26.083872290+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9bffc32c-5a0d-462f-b60b-a119e6cd29b8
2025-06-24T17:43:26.085389295+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9bffc32c-5a0d-462f-b60b-a119e6cd29b8 |  |
2025-06-24T17:43:26.085575005+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:43:26.085661144+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-24T17:43:31.938063948+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583
2025-06-24T17:43:31.938445363+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583
2025-06-24T17:43:31.939006054+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle NGSetupRequest
2025-06-24T17:43:31.939092843+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mMissing IE PagingDRX
2025-06-24T17:43:31.939250183+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3723046759/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-24T17:43:38.391693082+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.391970723+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.391977228+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:38.391980697+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:43:38.391982854+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:38.392114310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.392186985+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.392191955+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:38.392194650+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:43:38.392196541+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:38.400606747+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.400661104+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.400667208+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.400670846+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.400672967+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.400676001+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.400677878+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-24T17:43:38.405205091+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.405252771+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:43:38.405257796+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:38.405260599+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:38.405263335+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:38.405279771+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.405282510+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.405284166+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.405290416+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.405291955+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.405294461+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.407966445+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.408042491+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.408050039+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408053452+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.408055007+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.408056735+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.408123310+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.408126528+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408128409+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408130958+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408132990+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408291559+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-24T17:43:38.408339867+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.408342135+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.408343966+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:43:38.408350008+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.408413666+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.408424859+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.408433537+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.408435100+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.408436642+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.409469723+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle InitialUEMessage
2025-06-24T17:43:38.409511358+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-24T17:43:38.409657139+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-24T17:43:38.409765764+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-24T17:43:38.409783980+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-24T17:43:38.409793300+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-24T17:43:38.409797109+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-24T17:43:38.409801061+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-24T17:43:38.409807454+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-24T17:43:38.409810554+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-24T17:43:38.410435806+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.415079689+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-24T17:43:38.416259322+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-24T17:43:38.416313063+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-24T17:43:38.417135322+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.423965140+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-24T17:43:38.425216264+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-24T17:43:38.425322460+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-24T17:43:38.425344212+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-24T17:43:38.425346856+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-24T17:43:38.425920071+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.429061035+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-24T17:43:38.430493343+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:43:38.432768511+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:43:38.433052409+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-24T17:43:38.433500229+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-24T17:43:38.433510013+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-24T17:43:38.433513487+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 6335393736626636613434363433313230366235643761636533616366656338
2025-06-24T17:43:38.433573041+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-24T17:43:38.433888642+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-24T17:43:38.433969992+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend Downlink Nas Transport
2025-06-24T17:43:38.434845057+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.434863763+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.434867130+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.434869606+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.434871772+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.434873424+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.434893588+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.434898896+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.434901024+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.434988921+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.435057381+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.435063095+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:43:38.435069045+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.435070724+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.435072192+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.435081863+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.435085256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.435086948+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.436048859+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:38.436125795+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:38.436155855+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-24T17:43:38.436159377+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-24T17:43:38.436688554+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-24T17:43:38.436748391+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 6335393736626636613434363433313230366235643761636533616366656338
Xres*: 6335393736626636613434363433313230366235643761636533616366656338
2025-06-24T17:43:38.436754088+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-24T17:43:38.437381965+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-24T17:43:38.438914613+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-24T17:43:38.438984766+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-24T17:43:38.439145168+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-24T17:43:38.439316200+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-24T17:43:38.439374453+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-24T17:43:38.439390957+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend Downlink Nas Transport
2025-06-24T17:43:38.440272843+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.440342001+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.440349790+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.440352534+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.440356238+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.440357780+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.440367159+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.440369223+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.440371038+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.440412599+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.440414942+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.440416435+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:43:38.440421534+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.440423051+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.440424519+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.440509620+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.440515256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.440516867+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.441275238+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:38.441442610+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:38.441652442+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-24T17:43:38.441843424+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-24T17:43:38.441895311+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-24T17:43:38.442078151+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-24T17:43:38.442707729+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.456721717+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:43:38.458093975+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-24T17:43:38.458509660+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:43:38.459039568+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-24T17:43:38.459177042+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:38.459600889+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.466117374+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:43:38.467255354+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-24T17:43:38.469542569+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-24T17:43:38.469615695+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-24T17:43:38.469865236+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-24T17:43:38.469990624+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:43:38.470471315+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:38.470619450+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:38.470757954+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-24T17:43:38.471167110+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-24T17:43:38.471345838+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:38.471473227+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-24T17:43:38.472156336+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-24T17:43:38.472392468+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-24T17:43:38.472564256+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-24T17:43:38.472689811+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-24T17:43:38.472805596+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-24T17:43:38.473070531+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.478090121+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-24T17:43:38.480109601+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:43:38.487583527+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.521752535+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-24T17:43:38.523914410+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:43:38.526281594+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:38.548805775+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-24T17:43:38.550229151+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-24T17:43:38.550292538+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-24T17:43:38.550318827+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-24T17:43:38.550606311+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:43:38.550908575+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-24T17:43:38.550935326+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend Initial Context Setup Request
2025-06-24T17:43:38.551918512+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.551978838+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.551984982+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.551987532+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.551989337+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.551990986+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.552009028+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.552011376+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.552019098+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.552021237+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:43:38.552033784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.552110733+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:43:38.552118613+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:43:38.552125372+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.552142276+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.552145073+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.552150437+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.552152071+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.552153519+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.553411567+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.553427912+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.553430131+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553432696+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.553434340+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.553435856+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.553461017+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.553464409+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553468002+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553472091+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553476208+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553478565+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553481499+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.553483138+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-24T17:43:38.553535934+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle InitialContextSetupResponse
2025-06-24T17:43:38.553558868+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:43:38.553563460+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0xe9cd2a72
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc0006e3180)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d1a690)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000cb68c0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000ca19b0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc0006e31a0)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc0006e31c0)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000ca19eb)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000ca1a03)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-24T17:43:38.555372630+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:38.555426464+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:38.555458210+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-24T17:43:38.555463582+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-24T17:43:38.555476572+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-24T17:43:38.555519191+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend Downlink Nas Transport
2025-06-24T17:43:38.555595986+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-24T17:43:39.060773574+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:39.060843891+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.060884973+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:43:39.060889313+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:43:39.060892848+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:43:39.060899067+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:43:39.061718621+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.065717210+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-24T17:43:39.066702841+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:43:39.066777229+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:43:39.066866744+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:43:39.067006720+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:43:39.067487188+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.072530098+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:39.074006889+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:43:39.074201966+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:43:39.074317488+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:43:39.074323129+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:43:39.074796305+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.081316221+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:43:39.082702667+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:43:39.083894125+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:43:39.083985674+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:43:39.085536283+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.085905541+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.086475821+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:43:39+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000a84a80 0xc000a84aa0 0xc000a84ac0]
2025-06-24T17:43:39.086600667+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:43:39.087128895+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000a84a80 0xc000a84aa0 0xc000a84ac0]}
2025-06-24T17:43:39.087413863+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:43:39.088100298+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.089414236+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&target-nf-type=AMF |  |
2025-06-24T17:43:39.090171034+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:43:39.090271682+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-24T17:43:39.090316993+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:43:39.090322773+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-24T17:43:39.090327763+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:43:39.090331518+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:43:39.090334682+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:43:39.090337303+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:43:39.090877392+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:43:39.091130243+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.101507045+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-24T17:43:39.102954120+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:43:39.104543796+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:43:39.104722895+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:43:39.104789109+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-24T17:43:39.107140149+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.110235027+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-24T17:43:39.111943847+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.114561126+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:43:39.114639987+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:43:39.114899130+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:43:39.115629409+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.116246885+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:43:39.116666596+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:43:39.117055164+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:43:39.117159696+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.119798000+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:43:39.120176565+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:43:39.121286720+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:43:39.121356562+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:43:39.121365917+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:43:39.121368195+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:43:39.121370213+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:43:39.121493682+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:43:39.121625879+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:43:39.121751580+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:43:39.121810818+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.121840839+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:43:39.121845385+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.121886099+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:43:39.121975927+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:43:39.122137344+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:43:39.122353662+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-24T17:43:39.128309661+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:43:39.129390230+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:43:39.129465156+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend PDU Session Resource Setup Request
2025-06-24T17:43:39.129581221+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:43:39.130524641+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.130548353+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.130551493+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-24T17:43:39.130589718+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.130591883+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130593878+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.130635977+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.130685483+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.130696345+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.130699703+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.130702091+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.130706452+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.130708775+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-24T17:43:39.130761888+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130765682+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.130768398+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.130770924+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.130772663+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.130781148+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.130782860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130784388+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.130794455+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.130795943+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130797451+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x8e802bd5
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b36440)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fc5a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000754410)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  03 02 00 06 21 12 01 01  ff 02 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00074a544)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007821b0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b44080)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 03 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00074a570)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00074a580)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b36460)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b36480)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b364a0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:43:39.232582465+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:43:39.232655543+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.233752137+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:43:39.238013761+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:43:39.238129556+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:f766ac46-1955-4c92-8a46-d1656c3a22ac/modify |  |
2025-06-24T17:43:39.238775800+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:39.239047356+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.239112592+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:43:39.239221409+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:43:39.239229986+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:43:39.239236261+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:43:39.240287067+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:43:39.240362421+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:43:39.240378133+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:43:39.240621935+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:43:39.241503103+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.251450917+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:39.252603260+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:43:39.253151282+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:43:39.253221725+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:43:39.253227733+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:43:39.253776613+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.259824856+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:43:39.260460387+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:43:39.261124752+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:43:39.261183119+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:43:39.262503170+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.264327226+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.265285538+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:43:39+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001732060 0xc001732080 0xc0017320a0]
2025-06-24T17:43:39.265479452+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:43:39.265499760+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001732060 0xc001732080 0xc0017320a0]}
2025-06-24T17:43:39.265501867+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:43:39.265906315+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.267022025+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&target-nf-type=AMF |  |
2025-06-24T17:43:39.267260636+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:43:39.267346870+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-24T17:43:39.267353067+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:43:39.267355441+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-24T17:43:39.267360433+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:43:39.267365912+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:43:39.267367978+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:43:39.267370348+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:43:39.267699744+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:43:39.268668789+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.272043444+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:43:39.272294842+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:43:39.272493913+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:43:39.272924458+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.273533113+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:43:39.273653654+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:43:39.273899615+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:43:39.274157157+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.276700895+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:43:39.276992868+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:43:39.277678978+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:43:39.277729234+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:43:39.277736037+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:43:39.277738372+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:43:39.277740205+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:43:39.277751739+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:43:39.277986948+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:43:39.278088188+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:43:39.278097212+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.278118406+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:43:39.278121476+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.278141874+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:43:39.278207079+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:43:39.278354826+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:43:39.278575514+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-24T17:43:39.284969045+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:43:39.286404665+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:43:39.286451874+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend PDU Session Resource Setup Request
2025-06-24T17:43:39.286610553+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:43:39.287326368+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.287364413+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.287369044+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-24T17:43:39.287396436+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.287398796+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287402119+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.287445786+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.287488864+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287495507+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287497999+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287500496+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287502508+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287504320+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:43:39.287538554+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287540510+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.287543059+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.287545025+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.287546864+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.287551986+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.287553522+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287555063+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.287565959+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.287567442+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287568816+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000017e3a0c
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xc4b27e271078cc9b22f59fe4cb3f8db7b35e8669b57bc25252c2b93cb383daa1
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x2358b9a0527640b0af9b821127c6b63e2bc32d0b
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000002dd5a941
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xdcc3d30a78728394d2ef83816ba818122a9f19786adb995d92fc24a0503e55a4
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x973dc933ab83b6b5e6e504971fca69fd9cea7fe3
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
2025-06-24T17:43:39.295885421+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:43:39.296069079+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
Security header type: Integrity Protected And Ciphered
cmac value: 0x7c8c5665
err <nil>
2025-06-24T17:43:39.297798559+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b37120)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fc870)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000754dc0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0006b5a4c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000782360)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b44780)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0006b5a70)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0006b5a80)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b37140)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b37160)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b37180)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:43:39.305573691+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:43:39.305668750+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:90fbf3ff-c8d0-4e41-a983-717aa082ea1c/modify |  |
2025-06-24T17:43:39.496289584+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:39.496383751+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.496449331+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:43:39.496466356+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:43:39.496482087+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:43:39.496494887+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:43:39.497143657+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:43:39.497217991+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:43:39.497242681+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:43:39.497638881+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:43:39.498360124+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.505196112+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:39.506397221+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:43:39.506635854+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:43:39.506699620+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:43:39.506705426+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:43:39.507118513+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.514608851+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:43:39.515392811+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:43:39.516094531+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:43:39.516161975+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:43:39.517068174+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.517624307+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.517986015+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:43:39+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0008cf760 0xc0008cf780 0xc0008cf7a0]
2025-06-24T17:43:39.518059962+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:43:39.518064688+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0008cf760 0xc0008cf780 0xc0008cf7a0]}
2025-06-24T17:43:39.518067927+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:43:39.518794404+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.519845330+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&target-nf-type=AMF |  |
2025-06-24T17:43:39.520177652+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:43:39.520310084+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-24T17:43:39.520315981+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:43:39.520318465+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-24T17:43:39.520322628+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:43:39.520326075+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:43:39.520328676+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:43:39.520331039+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:43:39.520814878+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:43:39.522538515+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.525635784+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:43:39.525740046+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:43:39.525829482+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:43:39.526261424+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.526912554+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:43:39.527132986+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:43:39.527473091+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:43:39.527571300+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.530251019+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:43:39.530804103+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:43:39.531478721+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:43:39.531490599+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:43:39.531494686+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:43:39.531496912+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:43:39.531498737+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:43:39.531509918+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:43:39.532044393+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:43:39.532153700+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:43:39.532200830+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.532233073+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:43:39.532238035+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.532255368+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:43:39.532356177+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:43:39.532437029+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:43:39.532587614+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-24T17:43:39.543502755+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:43:39.544846040+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:43:39.544953831+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend PDU Session Resource Setup Request
2025-06-24T17:43:39.545108416+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:43:39.546254271+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.546311000+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.546316688+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-24T17:43:39.546345162+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.546348791+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.546350550+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.546376367+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.546426313+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.546437610+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.546440421+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.546442977+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.546445175+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.546447142+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:43:39.546505401+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.546508857+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.546511722+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.546513839+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.546516905+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.546524326+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.546525886+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.546527520+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.546538214+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.546539768+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.546541195+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000007ce99c65
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xc14634a145845197050809a33c8c898a8ec9b6f422802255493b447a50a8adb4
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x852e3a8b5adb69dacf1fbd1a50ab442f6a672443
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000005a74ddba
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x9fe98100df394b113e66d4a15ae82729262125cc7432dd189660376b3e542464
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x73416e11b6b765f9d00e3e6effb255a2d5db659d
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xc554f23a
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006b26a0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fcb40)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000755900)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000631d6c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000782510)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b44e80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000631d90)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000631db0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006b26c0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006b26e0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006b2700)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:43:39.647953127+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:43:39.647978343+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.648858724+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:43:39.652663047+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:43:39.652836385+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:1d6b5161-d674-4e2f-bc0b-e6b2c8c114c4/modify |  |
2025-06-24T17:43:39.653870137+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport
2025-06-24T17:43:39.653935024+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.653969663+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:43:39.653973969+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:43:39.653976863+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:43:39.653982933+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:43:39.654688703+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:43:39.654773160+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:43:39.654788947+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:43:39.654906181+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:43:39.655635182+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.669531968+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:43:39.670664761+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:43:39.670788738+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:43:39.670836992+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:43:39.670841106+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:43:39.671359204+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.678007181+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:43:39.678584696+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:43:39.680029819+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:43:39.680182257+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:43:39.681298140+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.681848490+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.682227698+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:43:39+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000886540 0xc000886560 0xc000886580]
2025-06-24T17:43:39.682280927+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:43:39.682285462+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000886540 0xc000886560 0xc000886580]}
2025-06-24T17:43:39.682287515+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:43:39.682841543+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.684233452+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=6f4efc30-2c40-4a3f-95d8-689da9676c99&target-nf-type=AMF |  |
2025-06-24T17:43:39.684402362+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:43:39.684448369+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-24T17:43:39.684522972+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:43:39.684531234+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-24T17:43:39.684539333+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:43:39.684555728+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:43:39.684559466+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:43:39.684562504+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:43:39.685165697+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:43:39.701441356+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:43:39.705760219+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:43:39.705886150+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:43:39.706336783+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:43:39.706797501+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.707275345+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:43:39.707494447+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:43:39.707662930+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:43:39.707945090+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:43:39.710711106+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:43:39.711219426+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:43:39.712142044+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:43:39.712198593+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:43:39.712206928+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:43:39.712209428+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:43:39.712211222+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:43:39.712223763+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:43:39.712557224+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:43:39.712672677+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:43:39.712680955+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.712700025+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:43:39.712738820+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:43:39.712771802+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:43:39.712858569+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:43:39.712955306+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:43:39.713607583+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-24T17:43:39.716810857+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:43:39.717772992+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:43:39.717829959+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mSend PDU Session Resource Setup Request
2025-06-24T17:43:39.717954396+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:43:39.718973506+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.718997313+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.719001058+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-24T17:43:39.719029579+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.719031829+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.719033540+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.719058316+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.719060591+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719064674+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719067002+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719069708+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719071703+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719074241+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:43:39.719225982+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.719229988+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.719232876+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.719235501+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.719292722+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.719307136+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.719309011+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.719310589+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.719325856+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.719328485+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.719331164+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000b539ba11
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x955956fd0c314092d3865f1cae26c7b82d6d0cf18a81ba238f782e7e83cca55a
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x4da6da75946388fadbcc360360f48d46a73ae176
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000fd1a4846
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x632804f37ecfb47d19a116f0b602fed8b79bb9be25a3ca1eb9a9ba8e6cdae7a4
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xb8fc12042620c1bd382fe3205f76ceaa67a80ab2
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xb0750396
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0006b3520)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fce10)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000690320)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000015c5c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0007826c0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b45880)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000015c90)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000015ca0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0006b3540)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0006b3560)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0006b3580)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-24T17:43:39.731874708+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:43:39.731901400+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:35583] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:43:39.732827005+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:43:39.737476673+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:43:39.737601674+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:2eb4c861-a95d-4947-8be1-5dc91db9a9f2/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=619.522µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=751.768µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=678.588µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=663.901µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=488.06µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 488.06µs/640.368µs/751.768µs/87.243µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.85s)
PASS
ok  	test	9.897s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (24.81s)
PASS
ok  	test	27.701s

--- STDERR ---
2025-06-24T17:43:19.800835979+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:43:19.800950443+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-24T17:43:19.801244686+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:43:19.801313987+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0000781e0)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000014e10)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc000014fc0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc000032360)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-24T17:43:19.801319388+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:43:19.801321836+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-24T17:43:19.801323882+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:19.801338148+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-24T17:43:19.801340887+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-24T17:43:19.806179859+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-24T17:43:19.806278628+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-24T17:43:19.806403245+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-24T17:43:19.806839234+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-24T17:43:19.806914398+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-24T17:43:19.806921561+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-24T17:43:25.873280408+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-24T17:43:25.873358317+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-24T17:43:31.926660062+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:43:31.927251503+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-24T17:43:31.927964424+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-24T17:43:31.927994791+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-24T17:43:31.928016954+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:31.928094737+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-24T17:43:31.928121426+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-24T17:43:31.936654916+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-24T17:43:31.936748927+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-24T17:43:31.937843444+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-24T17:43:31.938586998+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-24T17:43:31.938769594+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-24T17:43:31.938966859+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-24T17:43:31.939211082+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-24T17:43:31.939373386+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-24T17:43:31.939619958+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-24T17:43:38.392313120+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.392370211+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.392376298+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.392380363+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.392383265+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.392386337+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-24T17:43:38.400213743+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.400284660+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.400290437+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:38.400293619+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:43:38.400295705+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:38.400298744+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:38.400300522+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:38.400312421+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.400327183+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:43:38.400340713+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.400342260+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.400343635+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:38.400345687+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:43:38.400347387+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:38.400348968+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:38.400350458+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:38.405435531+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.405514260+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.405519777+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.405522537+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:43:38.405531903+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.405547351+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.405550602+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.405579548+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.405581840+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.405583836+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.405587214+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.405589502+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.405592121+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-24T17:43:38.405593603+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.405595121+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:43:38.405598219+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-24T17:43:38.405601727+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:43:38.405603413+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:43:38.407226699+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.407279749+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:43:38.407285678+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-24T17:43:38.407288158+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:43:38.407290648+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.407292567+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:43:38.407320879+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.407322907+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.407324420+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.407640690+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.407684542+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.407689571+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.408754040+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.408807883+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.408813846+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408816683+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:43:38.408820065+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.408823461+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.408825176+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.408840617+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.408842797+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408844709+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.408847436+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:43:38.408857601+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.409058697+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:38.409103887+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-24T17:43:38.409116273+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.409119379+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-24T17:43:38.434374589+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:43:38.434397512+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:38.434400749+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:43:38.434420881+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.434423309+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.434425310+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:43:38.434450832+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.434452798+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.434457402+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.434466887+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.434468438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.434469924+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.435504156+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.435519269+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.435535665+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.435538970+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:43:38.435542491+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.435544784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.435546314+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.435556563+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.435612082+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.435616889+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.435619778+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:43:38.435626776+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.435630350+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:38.439577553+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:43:38.439817015+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:38.439824330+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:43:38.439828489+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.439830816+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.439833127+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:43:38.439842322+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.439844449+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.439846063+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.439858606+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.439860205+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.439861662+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.440708706+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.440731996+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.440742026+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.440749825+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:43:38.440758207+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.440764475+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.440770575+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.440786128+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.440793183+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.440799499+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.440807939+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:43:38.440861052+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.440897115+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:38.551412140+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-24T17:43:38.551481225+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:38.551489719+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-24T17:43:38.551494956+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.551497334+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:43:38.551507459+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.551509331+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.551510949+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.551518909+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.551521470+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.551523155+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.552714392+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:38.552731644+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.552734573+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.552737228+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:43:38.552741134+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.552742860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.552744519+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.552755441+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:38.552917078+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.552922992+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:38.552954734+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 2046682197, Outbound SPI: 2753854938
2025-06-24T17:43:38.552972502+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.553011537+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:43:38.553016708+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:43:38.553019288+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:38.553023770+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:38.553025858+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:38.553027761+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:38.553029528+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:38.553035505+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.553037112+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.553038677+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.553194807+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:38.553241827+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:38.553247572+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:38.553340528+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.553394818+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.553402035+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:38.553404259+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:43:38.553416077+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.553418621+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-24T17:43:38.553869098+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:43:38.554505691+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:38.555230286+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:38.555799070+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:43:39.060296162+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:39.122661063+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:43:39.122716555+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-24T17:43:39.126059164+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-24T17:43:39.126115277+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-24T17:43:39.126204954+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-24T17:43:39.130008417+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:43:39.130173987+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.130217469+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:43:39.130240574+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130243363+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.130249424+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.130253521+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.130256554+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.130258453+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.130260205+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.130267628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.130269431+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130271013+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.130285013+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.130287035+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.130288505+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.131052438+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.131071061+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.131074193+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.131088997+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:43:39.131091442+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15745650261390999891
2025-06-24T17:43:39.131094816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.131096722+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.131104864+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.131135902+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.131177229+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.131183731+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.131185926+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.131188107+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.131230897+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.131238743+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.131241515+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:43:39.131387327+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.131496044+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.131636662+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:43:39.132596270+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:39.234667572+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:43:39.278868642+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:43:39.278971296+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-24T17:43:39.282349545+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-24T17:43:39.282561880+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-24T17:43:39.286896129+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:43:39.287016649+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.287023749+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:43:39.287039644+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287041858+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.287044774+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.287049799+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.287052053+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.287054014+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.287056883+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.287063871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.287065617+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287067124+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.287084504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.287185770+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287230607+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.287862515+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.287882790+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.287887948+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287890686+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:43:39.287893040+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15745650261390999891
2025-06-24T17:43:39.287896207+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.287897860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.287899415+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.287920165+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.287956430+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287962438+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287965026+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287967263+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.287972971+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.287976535+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.287978636+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:43:39.295053281+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-24T17:43:39.295274268+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.295346350+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.295407681+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:43:39.298391554+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:43:39.300264256+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:39.532868756+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:43:39.532889261+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-24T17:43:39.537115301+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-24T17:43:39.539909255+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-24T17:43:39.545672825+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:43:39.545783750+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.545791157+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:43:39.545814663+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.545820296+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.545823331+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.545825466+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.545828736+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.545830693+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.545834533+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.545927161+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.545933000+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.545934758+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.545953949+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.545956670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.545958195+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.547055320+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.547069680+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.547072404+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.547075052+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:43:39.547077191+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15745650261390999891
2025-06-24T17:43:39.547082415+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.547084256+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.547085851+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.547113407+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.547116697+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.547119752+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.547121889+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.547123933+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.547129120+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.547132444+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.547134477+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:43:39.548888550+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-24T17:43:39.549077302+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.549131038+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.549148965+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:43:39.554290972+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:43:39.649219833+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:43:39.713372183+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:43:39.713431142+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-24T17:43:39.714511042+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-24T17:43:39.715293847+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-24T17:43:39.718387444+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:43:39.718713665+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.718722957+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:43:39.718740943+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.718745304+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:43:39.718748424+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:43:39.718750800+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.718752928+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:43:39.718754745+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.718756380+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:43:39.718766671+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.718769438+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.718771005+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.718789711+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.718792402+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.718793919+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.719446012+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:43:39.719464072+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.719500488+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719506320+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:43:39.719508714+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 15745650261390999891
2025-06-24T17:43:39.719512121+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:43:39.719517553+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:43:39.719519201+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:43:39.719541878+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:43:39.719543706+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719548621+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719550956+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719553291+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:43:39.719609517+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.719686763+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:43:39.719692152+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:43:39.726889710+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-24T17:43:39.729968380+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.730136171+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:43:39.730209226+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:43:39.733368769+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:43:51.254223732+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-24T17:43:51.254254370+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-24T17:43:51.254292084+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-24T17:43:51.254297671+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-24T17:43:51.254305075+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-24T17:43:51.284625218+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-24T17:43:51.285948768+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-24T17:43:51.285969881+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-24T17:43:51.285990510+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-24T17:43:51.285994795+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-24T17:43:51.285996786+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-24T17:43:52.069458454+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-24T17:43:52.069589888+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-24T17:43:52.069982530+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-24T17:43:52.070052201+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-24T17:43:52.070062667+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-24T17:43:52.070068048+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-24T17:43:52.070134508+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-24T17:43:52.070315799+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-24T17:43:52.070363405+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-24T17:43:52.070386703+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.158:42673: use of closed network connection
2025-06-24T17:43:52.070512817+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.158:42673: use of closed network connection
2025-06-24T17:43:52.070531871+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-24T17:43:52.070546085+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-24T17:43:52.070548381+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-24T17:43:52.070551649+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-24T17:43:52.070559946+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-24T17:43:52.070562217+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:43:52.070569822+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-24T17:43:52.070626470+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:43:52.070637720+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-24T17:43:52.070877166+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-24T17:43:52.070907699+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-24T17:43:52.070916392+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-24T17:43:52.070928382+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-24T17:43:52.070931010+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (71082): No such process
