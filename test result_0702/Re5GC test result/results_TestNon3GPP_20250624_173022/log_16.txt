Run TestCN
os.Args: [/tmp/go-build4138405140/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-24T17:39:41.349534865+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.349578661+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.349583939+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.349590801+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-24T17:39:41.349695768+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-24T17:39:41.351172183+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.351180096+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.351182430+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.351840880+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-24T17:39:41.356432286+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.356481791+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.356488090+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.356497858+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-24T17:39:41.356514904+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-24T17:39:41.356684808+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:39:41.356735429+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.356740287+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.356742129+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.357153435+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.357213149+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.357224752+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.357229109+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-24T17:39:41.357245656+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-24T17:39:41.357310699+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.357347455+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.357352141+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-24T17:39:41.357613433+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.357619188+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.357621004+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.357631356+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 46b8ce3d-b684-41ce-b810-8040e5549190 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{46b8ce3d-b684-41ce-b810-8040e5549190-auth nausf-auth 0xc0000cb968 http REGISTERED   0xc0000cb950  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{46b8ce3d-b684-41ce-b810-8040e5549190-policyauthorization npcf-policyauthorization 0xc0000cb9c8 http REGISTERED   0xc0000cb9b0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{46b8ce3d-b684-41ce-b810-8040e5549190-smpolicycontrol npcf-smpolicycontrol 0xc0000cb998 http REGISTERED   0xc0000cb980  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000c31900 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc00022c9f0 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-24T17:39:41.357760712+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-24T17:39:41.358166058+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.358244201+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.358250394+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.358254563+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-24T17:39:41.358355580+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-24T17:39:41.358633394+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:41.358694635+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-24T17:39:41.358699904+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:41.358702592+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-24T17:39:41.358722574+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-24T17:39:41.358786623+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-24T17:39:41.358875956+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-24T17:39:41.563032870+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-24T17:39:41.563127835+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-24T17:39:41.563456759+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-24T17:39:41.565387430+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:41.571570419+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:41.572901525+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3f4d7810-438f-44b2-8a24-66cf8ab4f349
2025-06-24T17:39:41.575451348+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3f4d7810-438f-44b2-8a24-66cf8ab4f349 |  |
2025-06-24T17:39:41.576078705+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:41.576112966+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-24T17:39:41.764322020+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-24T17:39:41.765786418+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:41.770923221+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:41.772316955+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: fbad6047-e3df-4bae-b53e-35898cf6eee5
2025-06-24T17:39:41.773202323+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/fbad6047-e3df-4bae-b53e-35898cf6eee5 |  |
2025-06-24T17:39:41.773631079+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:41.773730012+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {fbad6047-e3df-4bae-b53e-35898cf6eee5 SMF REGISTERED 0 0xc0008f8570 0xc0008f8588 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc0004df080 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0008f84c8 false false []}
2025-06-24T17:39:41.773893935+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-24T17:39:41.773910542+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-24 17:39:41.773901794 +0800 CST m=+0.467892610]
2025-06-24T17:39:41.773896333+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-24T17:39:41.966223210+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:41.976055569+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:41.977098067+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 44bbf2bd-ae8e-4a3e-8407-e04c01e81763
2025-06-24T17:39:41.979002539+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/44bbf2bd-ae8e-4a3e-8407-e04c01e81763 |  |
2025-06-24T17:39:41.979168617+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:41.979232776+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-24T17:39:41.979238307+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-24T17:39:41.979240988+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:39:41.979250031+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-24T17:39:42.165530384+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-24T17:39:42.165643818+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-24T17:39:42.166749086+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:42.172383552+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:42.173535904+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 462d8754-2c40-47fa-b763-9d209a442259
2025-06-24T17:39:42.174264546+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/462d8754-2c40-47fa-b763-9d209a442259 |  |
2025-06-24T17:39:42.174772175+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:42.174829963+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-24T17:39:42.367985970+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:42.372686874+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:42.373457120+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 11bda6d7-9dfb-4a13-a716-9b4e482cb9a4
2025-06-24T17:39:42.374363167+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/11bda6d7-9dfb-4a13-a716-9b4e482cb9a4 |  |
2025-06-24T17:39:42.375400383+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:42.375577310+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-24T17:39:42.375583763+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-24T17:39:42.566867236+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-24T17:39:42.568198192+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:42.572398597+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:42.573907893+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 46b8ce3d-b684-41ce-b810-8040e5549190
2025-06-24T17:39:42.576233136+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/46b8ce3d-b684-41ce-b810-8040e5549190 |  |
2025-06-24T17:39:42.576473030+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:42.576556069+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-24T17:39:42.768373119+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-24T17:39:42.769087388+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:42.774173553+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-24T17:39:42.775049257+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:42.775155096+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-24T17:39:42.776031164+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: d8ffd37f-4475-4fb1-aea4-aa356b7a006f
2025-06-24T17:39:42.776972917+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d8ffd37f-4475-4fb1-aea4-aa356b7a006f |  |
2025-06-24T17:39:42.777525508+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:42.777602149+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-24T17:39:42.968898669+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-24T17:39:42.969477963+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-24T17:39:42.973279093+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:39:42.977780385+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:39:42.978387476+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 692d31dc-72bd-4197-861f-33aab69cef6a
2025-06-24T17:39:42.978798299+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/692d31dc-72bd-4197-861f-33aab69cef6a |  |
2025-06-24T17:39:42.979329838+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:39:42.979396869+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-24T17:39:49.954205583+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172
2025-06-24T17:39:49.957700968+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172
2025-06-24T17:39:49.957890142+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle NGSetupRequest
2025-06-24T17:39:49.957980133+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mMissing IE PagingDRX
2025-06-24T17:39:49.958015892+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3315164944/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-24T17:39:56.390451261+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.390560544+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.390567664+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:56.390571192+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:39:56.390573588+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:56.390679504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.390735310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.390755907+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:56.390774424+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:39:56.390777089+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:56.399294286+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.399572223+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.399582208+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.399587429+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.399762421+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.399801205+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.399806022+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-24T17:39:56.403786898+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.403847059+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:39:56.403868559+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:56.403871521+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:56.403873414+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:56.403892277+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.403895557+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.403897328+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.403906345+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.403907852+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.403909303+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.406015326+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.406101985+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.406109366+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.406112583+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.406115222+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.406117648+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.406294163+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.406333862+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.406338853+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.406341774+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.406344205+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.406346102+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-24T17:39:56.406390580+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.406393904+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.406397587+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:39:56.406402608+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.406404146+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.406405629+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.406411830+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.406413351+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.406414798+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.408530898+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle InitialUEMessage
2025-06-24T17:39:56.408691549+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-24T17:39:56.408722075+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-24T17:39:56.408756633+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-24T17:39:56.408771387+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-24T17:39:56.408777720+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-24T17:39:56.408781030+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-24T17:39:56.408786600+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-24T17:39:56.408792913+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-24T17:39:56.408795827+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-24T17:39:56.409393349+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.413122867+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-24T17:39:56.414999980+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-24T17:39:56.415239642+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-24T17:39:56.415949076+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.421325074+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-24T17:39:56.423835477+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-24T17:39:56.423919155+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-24T17:39:56.423941518+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-24T17:39:56.423943956+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-24T17:39:56.424733270+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.427310479+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-24T17:39:56.428574083+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:39:56.432271203+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:39:56.432425548+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-24T17:39:56.432831325+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-24T17:39:56.432879554+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-24T17:39:56.432886644+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 3231623030323936336161613735626264373336313532396434613131626363
2025-06-24T17:39:56.432948622+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-24T17:39:56.433433831+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-24T17:39:56.433595071+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend Downlink Nas Transport
2025-06-24T17:39:56.436994732+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.437046819+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.437083204+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.437086310+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.437098014+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.437100162+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.437117796+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.437120077+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.437121915+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.437218727+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.437272573+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.437277710+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:39:56.437283650+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.437286492+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.437308161+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.437313659+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.437315046+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.437316511+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.438254899+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:56.438409734+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:56.438579172+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-24T17:39:56.438721781+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-24T17:39:56.439971958+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-24T17:39:56.440166420+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 3231623030323936336161613735626264373336313532396434613131626363
Xres*: 3231623030323936336161613735626264373336313532396434613131626363
2025-06-24T17:39:56.440353077+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-24T17:39:56.441487641+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-24T17:39:56.443247278+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-24T17:39:56.443357000+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-24T17:39:56.443418097+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-24T17:39:56.443585759+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-24T17:39:56.443643057+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-24T17:39:56.443657364+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend Downlink Nas Transport
2025-06-24T17:39:56.444446958+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.444465393+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.444468169+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.444470766+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.444472535+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444479545+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.444493435+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.444495545+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.444499000+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.444803381+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444849154+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.444855321+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:39:56.444867429+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.444870684+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444872313+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.444885598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.444888451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444890090+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.446952452+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:56.447047391+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:56.447084742+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-24T17:39:56.447088683+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-24T17:39:56.447105344+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-24T17:39:56.447109312+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-24T17:39:56.447643257+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.455166062+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:39:56.456948890+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-24T17:39:56.457441057+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:39:56.458204889+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-24T17:39:56.458534707+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:56.459410957+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.464449013+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:39:56.465510993+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-24T17:39:56.467220375+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-24T17:39:56.467801865+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-24T17:39:56.468877298+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-24T17:39:56.469676140+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:39:56.470319559+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:56.470495305+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:56.471095743+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-24T17:39:56.471736761+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-24T17:39:56.472254756+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:56.472955915+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-24T17:39:56.474563765+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-24T17:39:56.475212048+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-24T17:39:56.475444860+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-24T17:39:56.475583918+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-24T17:39:56.475820536+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-24T17:39:56.478676449+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.483231432+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-24T17:39:56.484725229+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:39:56.485333518+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.487561848+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-24T17:39:56.489065359+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:39:56.528969379+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:56.536019764+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-24T17:39:56.538082941+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-24T17:39:56.538143430+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-24T17:39:56.538206856+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-24T17:39:56.538457966+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:39:56.538620209+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-24T17:39:56.538703136+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend Initial Context Setup Request
2025-06-24T17:39:56.540361446+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.540387985+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.540391543+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.540394406+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.540397043+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540399110+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.540421298+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.540424102+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.540433632+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540436656+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:39:56.540449537+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540451329+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:39:56.540463690+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:39:56.540472823+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.540474628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540476201+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.540481957+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.540483437+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540484895+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.545613284+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.545806978+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.545816659+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545826451+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.545831390+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.545835795+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.545875592+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.545896814+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545904346+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545908040+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545948138+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545953158+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545955903+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.545957778+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-24T17:39:56.546844575+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle InitialContextSetupResponse
2025-06-24T17:39:56.546897062+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:39:56.546902201+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0xcdc12e19
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000b2f9e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013cd20)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000ae4540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000b7f7c0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000b2fa00)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000b2fa20)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000b7f7fb)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000b7f813)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-24T17:39:56.548001329+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:56.548048681+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:56.548084040+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-24T17:39:56.548088929+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-24T17:39:56.548102526+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-24T17:39:56.548138825+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend Downlink Nas Transport
2025-06-24T17:39:56.548220275+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-24T17:39:57.048622380+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:57.048702991+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.048819234+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:39:57.048826256+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:39:57.048829453+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:39:57.048836367+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:39:57.049462695+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.052298051+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-24T17:39:57.053471173+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:39:57.053559784+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:39:57.053644242+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:39:57.053909181+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:39:57.054476401+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.058812796+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:57.059820155+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:39:57.060191938+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:39:57.060305966+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:39:57.060311303+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:39:57.060968434+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.065211881+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:39:57.065904884+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:39:57.066644231+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:39:57.066702105+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:39:57.068109559+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.068713256+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.069144898+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:39:57+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000922ae0 0xc000922b00 0xc000922b20]
2025-06-24T17:39:57.069216309+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:39:57.069222116+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000922ae0 0xc000922b00 0xc000922b20]}
2025-06-24T17:39:57.069224268+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:39:57.069818965+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.071195304+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&target-nf-type=AMF |  |
2025-06-24T17:39:57.071550117+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:39:57.071644104+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-24T17:39:57.071649782+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:39:57.071652090+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-24T17:39:57.071655840+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:39:57.071659835+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:39:57.071662368+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:39:57.071664846+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:39:57.072904282+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:39:57.073618434+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.078393849+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-24T17:39:57.079608864+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:39:57.080989138+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:39:57.081379258+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:39:57.081491712+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-24T17:39:57.082115196+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.085145479+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-24T17:39:57.087507084+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.091925496+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:39:57.092060188+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:39:57.092180911+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:39:57.092572157+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.093503067+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:39:57.094324036+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:39:57.095060356+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:39:57.095881836+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.098466202+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:39:57.098807302+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:39:57.105099632+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:39:57.105202998+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:39:57.105211812+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:39:57.105214202+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:39:57.105216114+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:39:57.105347056+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:39:57.105654014+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:39:57.105788334+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:39:57.105810740+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.105833755+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:39:57.105876478+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.105902925+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:39:57.105999889+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:39:57.106138805+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:39:57.106248701+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-24T17:39:57.114420878+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:39:57.115593261+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:39:57.115674145+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend PDU Session Resource Setup Request
2025-06-24T17:39:57.116002075+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:39:57.117902228+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.117929292+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.117932878+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-24T17:39:57.117970329+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.117972338+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.117974124+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.118009685+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.118013383+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118017346+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118019592+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118022137+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118024652+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118026409+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-24T17:39:57.118270825+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.118276864+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.118281737+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.118283924+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.118286000+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.118329291+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.118333796+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.118335384+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.118346364+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.118347984+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.118349482+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0x3058ec2a
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b2fe00)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013cff0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000710960)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0007266c4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000642090)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b2a500)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0007266f0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000726700)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b2fe20)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b2fe40)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b2fe60)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:39:57.220389089+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:39:57.220454929+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.221275397+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:39:57.224124136+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:39:57.224251864+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:418ece6d-f93d-4e26-a5bd-fe4e9ffe1847/modify |  |
2025-06-24T17:39:57.224719964+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:57.224785933+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.224835365+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:39:57.224839463+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:39:57.224842614+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:39:57.224847726+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:39:57.226432071+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:39:57.226511889+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:39:57.226533006+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:39:57.226834457+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:39:57.227598716+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.233351614+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:57.235077115+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:39:57.235322893+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:39:57.235411090+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:39:57.235417415+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:39:57.236112091+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.241043804+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:39:57.241754568+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:39:57.242467082+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:39:57.242617365+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:39:57.246312867+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.246731696+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.247003967+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:39:57+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000815bc0 0xc000815be0 0xc000815c00]
2025-06-24T17:39:57.247061408+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:39:57.247066706+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000815bc0 0xc000815be0 0xc000815c00]}
2025-06-24T17:39:57.247070493+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:39:57.247432561+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.248473068+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&target-nf-type=AMF |  |
2025-06-24T17:39:57.248855182+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:39:57.248928204+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-24T17:39:57.248939325+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:39:57.248947141+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-24T17:39:57.248955983+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:39:57.248964261+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:39:57.248970838+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:39:57.248977874+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:39:57.249606122+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:39:57.251018686+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.256429862+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:39:57.256546413+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:39:57.256889791+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:39:57.272426446+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.273205323+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:39:57.273641170+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:39:57.273946802+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:39:57.274070181+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.276767590+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:39:57.277088598+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:39:57.277601962+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:39:57.277613539+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:39:57.277617714+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:39:57.277619907+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:39:57.277621574+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:39:57.277632374+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:39:57.277832934+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:39:57.277919999+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:39:57.277937442+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.277962785+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:39:57.277973296+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.277997552+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:39:57.278027888+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:39:57.278004065+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:39:57.278584097+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-24T17:39:57.285268263+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:39:57.287014576+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:39:57.287112713+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend PDU Session Resource Setup Request
2025-06-24T17:39:57.287202960+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:39:57.288115163+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.288247228+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.288286806+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-24T17:39:57.288315748+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.288317730+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.288319445+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.288515517+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.288522155+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.288526863+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.288529343+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.288531867+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.288535476+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.288537464+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:39:57.288585680+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.288587715+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.288590223+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.288592018+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.288594683+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.288610949+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.288613613+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.288615098+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.288637870+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.288640628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.288642013+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000576169a6
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x90ce05f7368c1f095d95dae7c24f8d088a0d495cbeadd14341e37dc199b802d6
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x0d7a04db67487a90ecc5abf05ff6252b6c7fd98f
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000e0ba7176
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x3540fbf688335727640fa42b272a0c18eb298c63a88cbbd17f9d6f83a0b58960
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xf1f701b56450eadf40074dfb2f50ce38d63e281b
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-06-24T17:39:57.292299632+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:39:57.292464259+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.293047530+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x6ad7a743
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d1cb40)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013d2c0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000711310)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  03 02 00 06 21 12 01 01  ff 02 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000727fdc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0006422d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b2ac00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 03 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000662160)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0006621a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d1cb60)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d1cb80)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d1cba0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:39:57.307863715+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:39:57.307936358+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:7c0e5de8-e50f-41ba-829d-d644b9d9e5c3/modify |  |
2025-06-24T17:39:57.501433331+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:57.501522474+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.501583752+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:39:57.501595417+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:39:57.501603552+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:39:57.501618801+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:39:57.502281256+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:39:57.502366025+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:39:57.502388800+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:39:57.502593403+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:39:57.503363424+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.507676895+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:57.508807417+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:39:57.509002319+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:39:57.509079409+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:39:57.509137071+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:39:57.509277145+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.514320737+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:39:57.514790736+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:39:57.516291095+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:39:57.516374662+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:39:57.517909650+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.518331103+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.518781077+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:39:57+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0009f10e0 0xc0009f1100 0xc0009f1120]
2025-06-24T17:39:57.518830438+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:39:57.518840209+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0009f10e0 0xc0009f1100 0xc0009f1120]}
2025-06-24T17:39:57.518847280+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:39:57.519233514+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.521715033+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&target-nf-type=AMF |  |
2025-06-24T17:39:57.522074278+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:39:57.522473018+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-24T17:39:57.522502491+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:39:57.522515550+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-24T17:39:57.522525680+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:39:57.522536988+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:39:57.522656587+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:39:57.522691268+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:39:57.523495720+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:39:57.524718512+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.531179470+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:39:57.531258962+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:39:57.531735985+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:39:57.532389073+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.533063937+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:39:57.533284732+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:39:57.533407146+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:39:57.533789473+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.536352407+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:39:57.536823250+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:39:57.537636405+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:39:57.537649843+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:39:57.537653991+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:39:57.537656309+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:39:57.537658144+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:39:57.537703077+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:39:57.538022537+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:39:57.538134308+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:39:57.538211937+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.538280780+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:39:57.538286485+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.538308562+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:39:57.538375298+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:39:57.538506639+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:39:57.538720291+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-24T17:39:57.545124421+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:39:57.546141680+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:39:57.546199776+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend PDU Session Resource Setup Request
2025-06-24T17:39:57.546341367+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:39:57.547010902+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.547034700+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.547037891+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-24T17:39:57.547063184+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.547065289+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.547067049+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.547091835+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.547134253+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547141152+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547143603+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547146069+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547148514+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547164035+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:39:57.547194615+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.547196346+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.547198939+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.547201118+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.547206463+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.547211705+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.547213178+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.547214603+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.547226682+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.547228104+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.547229436+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000069c51367
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x9e0d85fa84c89d6a670501e858c14356c4ac4994f2886313ca10779f56d65ef8
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xa9178c56c9bc03ffbe661e7021f7ff315a93ade5
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000044423231
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x98d52f981ba952437b3d7a3f662384c10566c104d0c2ef63ed56b84127384baf
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x2c531552ee22c9ac566ef40e7fd9c2a01636f085
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x271fd34d
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d1d820)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013d590)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000711cc0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 0e 21 11 09 10 09  09 09 09 ff ff ff ff 80  |...!............|
        					00000020  03 02 00 06 21 12 01 01  ff 02 06 01 03 e8 01 03  |....!...........|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0007c63b4)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000642480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000b2b380)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 0e 21 11 09 10  |...11.......!...|
        					00000010  09 09 09 09 ff ff ff ff  80 03 02 00 06 21 12 01  |.............!..|
        					00000020  01 ff 02                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0007c63d0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0007c63e6)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d1d840)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d1d860)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d1d880)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:39:57.650100195+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:39:57.650176268+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.650949986+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:39:57.655004391+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:39:57.655217814+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:7f6ca136-b70b-4b60-8fb6-eb6198360aec/modify |  |
2025-06-24T17:39:57.655655291+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport
2025-06-24T17:39:57.655911456+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.655946414+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:39:57.655996956+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:39:57.656003628+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:39:57.656010574+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:39:57.656652853+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:39:57.656743322+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:39:57.656761607+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:39:57.656875364+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:39:57.657710523+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.662564197+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:39:57.663918283+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:39:57.664081357+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:39:57.664133415+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:39:57.664136222+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:39:57.664724480+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.669346775+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:39:57.669879379+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:39:57.670479435+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:39:57.670572134+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:39:57.671618649+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.671890659+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.672305077+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:39:57+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0009f1ac0 0xc0009f1ae0 0xc0009f1b00]
2025-06-24T17:39:57.672357676+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:39:57.672361862+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0009f1ac0 0xc0009f1ae0 0xc0009f1b00]}
2025-06-24T17:39:57.672363948+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:39:57.672927449+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.673979772+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=3f4d7810-438f-44b2-8a24-66cf8ab4f349&target-nf-type=AMF |  |
2025-06-24T17:39:57.674381488+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:39:57.674527396+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-24T17:39:57.674533563+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:39:57.674535795+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-24T17:39:57.674539240+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:39:57.674542597+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:39:57.674544595+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:39:57.674547880+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:39:57.674916516+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:39:57.676323129+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:39:57.677907481+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:39:57.678015919+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:39:57.678130369+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:39:57.678800791+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.679300364+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:39:57.679495647+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:39:57.679637871+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:39:57.680065494+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:39:57.682021836+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:39:57.682240133+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:39:57.683056670+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:39:57.683102614+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:39:57.683111275+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:39:57.683113527+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:39:57.683116295+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:39:57.683129095+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:39:57.683366836+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:39:57.683504497+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:39:57.683513128+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.683532696+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:39:57.683572161+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:39:57.683614483+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:39:57.683652093+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:39:57.683685888+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:39:57.684257185+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-24T17:39:57.688416900+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:39:57.689073395+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:39:57.689167609+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mSend PDU Session Resource Setup Request
2025-06-24T17:39:57.689300115+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:39:57.690072314+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.690142753+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.690149814+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-24T17:39:57.690174698+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.690176657+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.690178817+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.690209214+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.690254676+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690275023+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690277297+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690279627+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690281631+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690284763+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:39:57.690333859+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.690335690+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.690338266+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.690341203+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.690344915+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.690360089+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.690363050+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.690364826+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.690376921+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.690378501+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.690380677+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000bec48b0a
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x25b72d6f5120fde9cdc2187411031dd2854c19096252f9dc01e7c671f4a059f5
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xa6cd33a418aa2822c31814b323a1988544337aa0
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000d0287a8f
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x7e85a355fefa68feac98dcd688fa655f8502eb0fd7870fee79160fd20b571d05
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x55c665a88ab940d4fee080f8389a1b0b8bc7331a
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
2025-06-24T17:39:57.699574867+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:39:57.699983948+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:37172] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:39:57.700635266+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
Security header type: Integrity Protected And Ciphered
cmac value: 0xee2da550
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc0004d8700)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00013d950)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d048c0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00014f7cc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000642630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000736380)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc00014f7f0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc00014f810)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc0004d8720)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc0004d8740)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc0004d8760)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-24T17:39:57.708969752+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:39:57.709066661+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:3a88bf7d-6bad-4f14-a569-5dcf430f2e70/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.112746ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=816.68µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=1.497426ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=790.615µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=669.307µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 669.307µs/977.355µs/1.497426ms/298.123µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.74s)
PASS
ok  	test	9.781s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.43s)
PASS
ok  	test	28.304s

--- STDERR ---
2025-06-24T17:39:37.806072227+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:39:37.806151801+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-24T17:39:37.806874877+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:39:37.806883080+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc0000ac140)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000094510)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0000946c0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc0000aa380)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-24T17:39:37.806887180+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:39:37.806889481+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-24T17:39:37.806891455+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:37.806940097+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-24T17:39:37.806946570+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-24T17:39:37.812499340+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-24T17:39:37.812526617+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-24T17:39:37.812640886+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-24T17:39:37.812970726+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-24T17:39:37.813002650+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-24T17:39:37.813012503+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-24T17:39:42.774696137+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-24T17:39:42.774820820+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-24T17:39:49.939942387+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:39:49.940639739+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-24T17:39:49.941163828+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-24T17:39:49.941223284+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-24T17:39:49.941228341+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-24T17:39:49.941314112+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-24T17:39:49.941318274+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-24T17:39:49.950209679+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-24T17:39:49.950651190+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-24T17:39:49.954074310+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-24T17:39:49.956937117+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-24T17:39:49.957045668+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-24T17:39:49.957537206+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-24T17:39:49.957616074+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-24T17:39:49.957619469+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-24T17:39:49.958407005+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-24T17:39:56.390984247+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.391078667+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.391089908+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.391097350+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.391100217+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.391103697+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-24T17:39:56.398628934+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.398723257+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.398729337+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:56.398732641+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:39:56.398734947+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:56.398736863+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:56.398738519+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:56.398753345+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.398755007+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:39:56.398773989+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.398775596+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.398785182+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:56.398789152+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:39:56.398790899+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:56.398792440+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:56.398793951+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:56.404150261+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.404163960+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.404166780+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.404169633+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:39:56.404182641+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.404185718+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.404187295+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.404210639+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.404318436+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.404328659+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.404332617+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.404335652+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.404338278+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-24T17:39:56.404376221+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.404380480+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:39:56.404384173+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-24T17:39:56.404403039+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:39:56.404404717+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:39:56.405690646+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.405739910+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:39:56.405744812+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-24T17:39:56.405751648+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:39:56.405756351+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.405761146+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:39:56.405775891+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.405778574+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.405780050+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.405804415+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.405806102+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.405807607+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.406726309+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.407053837+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.407061334+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.407063946+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:39:56.407067374+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.407069012+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.407070544+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.407087099+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.407090323+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.407092069+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.407094537+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:39:56.407413849+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.407621522+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:56.407868062+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-24T17:39:56.408064268+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.408232967+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-24T17:39:56.434266496+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:39:56.434715906+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:56.435061228+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:39:56.435257876+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.435442071+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.435615115+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:39:56.435777475+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.436060984+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.436202668+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.436364575+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.436503470+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.436650948+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.437688014+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.437732455+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.437738094+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.437740645+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:39:56.437748465+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.437750488+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.437752192+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.437762516+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.437764897+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.437766697+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.437769164+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:39:56.437773735+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.437776986+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:56.444092409+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:39:56.444306088+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:56.444314014+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:39:56.444321393+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444323676+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.444325722+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:39:56.444333465+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.444335347+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444336865+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.444350179+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.444393495+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.444398072+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.446437948+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.446515019+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.446521794+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.446635499+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:39:56.446706790+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.446720278+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.446722224+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.446735336+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.446737580+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.446739422+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.446742296+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:39:56.446752293+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.446755674+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:56.539936159+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-24T17:39:56.540032757+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:56.540041957+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-24T17:39:56.540046723+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540049063+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:39:56.540060937+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.540062882+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540064940+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.540074760+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.540076514+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.540078101+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.543351905+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:56.543422373+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.543429452+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.543432590+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:39:56.543438516+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.543440447+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.543442369+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.543455410+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:56.543458308+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.543460985+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:56.544235372+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 1084920180, Outbound SPI: 3952752640
2025-06-24T17:39:56.544268650+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.544271700+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:39:56.544273861+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:39:56.544276026+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:56.544279041+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:56.544280973+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:56.544282847+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:56.544284508+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:56.544290976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.544292567+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.544294086+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.544852374+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:56.545199722+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:56.545205846+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:56.545437219+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.545487270+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.545502798+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:56.545507353+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:39:56.545521663+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.545525917+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-24T17:39:56.546857044+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:56.547168859+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:39:56.547813019+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:56.548490386+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:39:57.048288374+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:57.106827655+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:39:57.106845917+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-24T17:39:57.109903996+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-24T17:39:57.110075756+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-24T17:39:57.111090533+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-24T17:39:57.117431841+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:39:57.117570851+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.117578724+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:39:57.117599009+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.117601629+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.117604558+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.117607313+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.117614068+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.117654521+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.117659078+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.117668674+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.117670603+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.117672228+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.117694563+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.117696453+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.117698065+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.118533149+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.118586695+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.118593034+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118714097+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:39:57.118720970+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18316069273695520874
2025-06-24T17:39:57.118724803+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.118726821+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.118728814+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.118757645+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.118792618+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118800703+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118803367+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118805737+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.118848956+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.118856179+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.118859842+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:39:57.119788602+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.119921249+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.119951450+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:39:57.121119619+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:57.221943586+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:39:57.278502142+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:39:57.278551725+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-24T17:39:57.282806502+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-24T17:39:57.283139156+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-24T17:39:57.287638038+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:39:57.287859281+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.287867038+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:39:57.287884537+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.287934377+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.287940629+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.287943047+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.287947292+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.287949232+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.287950878+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.287958461+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.287960406+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.287961926+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.287975113+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.287976773+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.287978352+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.288955424+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.288975292+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.288978110+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.288980753+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:39:57.288982774+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18316069273695520874
2025-06-24T17:39:57.288985849+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.288987504+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.288989255+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.289012820+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.289015604+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.289018847+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.289021104+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.289023128+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.289028051+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.289031399+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.289033547+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:39:57.291652718+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-24T17:39:57.291896286+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.291945227+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.292032179+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:39:57.293489757+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:39:57.300997278+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:57.538899289+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:39:57.538918169+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-24T17:39:57.542203547+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-24T17:39:57.542626441+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-24T17:39:57.546594251+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:39:57.546640824+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.546644552+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:39:57.546660670+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.546663193+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.546666534+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.546668788+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.546672124+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.546674292+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.546676005+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.546691945+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.546697630+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.546700251+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.546714046+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.546715741+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.546717182+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.547489504+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.547581151+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.547583991+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547590650+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:39:57.547593971+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18316069273695520874
2025-06-24T17:39:57.547597411+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.547599087+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.547600772+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.547629532+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.547632205+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547637454+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547640335+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547642504+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.547648414+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.547651626+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.547653932+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:39:57.553470065+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-24T17:39:57.554016917+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.554132914+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.554160876+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:39:57.555453490+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:39:57.651651153+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:39:57.684270245+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:39:57.684331937+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-24T17:39:57.686203482+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-24T17:39:57.686503944+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-24T17:39:57.689651225+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:39:57.689702518+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.689708005+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:39:57.689737693+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.689739918+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:39:57.689742682+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:39:57.689745049+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.689747184+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:39:57.689748966+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.689750607+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:39:57.689760063+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.689771636+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.689774038+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.689791656+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.689793335+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.689794875+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.690871965+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:39:57.690885581+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.690888622+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690892163+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:39:57.690894329+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 18316069273695520874
2025-06-24T17:39:57.690897704+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:39:57.690899380+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:39:57.690901249+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:39:57.690931591+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:39:57.690933982+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690937459+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690940009+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690944463+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:39:57.690950996+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.690954278+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:39:57.690956611+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:39:57.697996429+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-24T17:39:57.699076123+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.699309760+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:39:57.699353487+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:39:57.701064804+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:40:09.142415820+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-24T17:40:09.142555310+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-24T17:40:09.142832882+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-24T17:40:09.142881986+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-24T17:40:09.142892511+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-24T17:40:09.204449879+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-24T17:40:09.204535312+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-24T17:40:09.204554343+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-24T17:40:09.204559065+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-24T17:40:09.204561117+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-24T17:40:09.204563333+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-24T17:40:09.582585209+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-24T17:40:09.582646061+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-24T17:40:09.582992190+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-24T17:40:09.583289466+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-24T17:40:09.583393642+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-24T17:40:09.583405454+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-24T17:40:09.583408595+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-24T17:40:09.583415796+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-24T17:40:09.583426010+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-24T17:40:09.583455002+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.72:40247: use of closed network connection
2025-06-24T17:40:09.583461814+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.72:40247: use of closed network connection
2025-06-24T17:40:09.583464992+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-24T17:40:09.583475671+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-24T17:40:09.583478361+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-24T17:40:09.583481684+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-24T17:40:09.583491678+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-24T17:40:09.583494333+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:40:09.583501201+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-24T17:40:09.583503128+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:40:09.583507629+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-24T17:40:09.583559458+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-24T17:40:09.583770432+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-24T17:40:09.583782687+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-24T17:40:09.583791075+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-24T17:40:09.583793312+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (68948): No such process
