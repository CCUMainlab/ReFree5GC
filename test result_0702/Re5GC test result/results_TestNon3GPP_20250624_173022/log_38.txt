Run TestCN
os.Args: [/tmp/go-build10653933/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-24T17:53:17.343819680+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.343893237+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.343898874+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.343904564+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-24T17:53:17.343915450+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-24T17:53:17.344422573+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.344428440+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.344433675+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.344492452+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-24T17:53:17.345028172+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.345089786+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.345094884+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.345098443+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-24T17:53:17.345113337+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-24T17:53:17.345265506+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:53:17.345315857+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.345321075+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.345322795+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.345676323+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.345720400+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.345725525+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.345728790+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-24T17:53:17.345744332+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-24T17:53:17.345775735+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.345777808+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.345779930+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-24T17:53:17.345936997+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.345978858+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.345981977+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.345993894+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 3bd86ac6-ea56-4b75-a046-f89d2cc960fe ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{3bd86ac6-ea56-4b75-a046-f89d2cc960fe-auth nausf-auth 0xc000c0fea8 http REGISTERED   0xc000c0fe90  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{3bd86ac6-ea56-4b75-a046-f89d2cc960fe-policyauthorization npcf-policyauthorization 0xc000c0ff08 http REGISTERED   0xc000c0fef0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{3bd86ac6-ea56-4b75-a046-f89d2cc960fe-smpolicycontrol npcf-smpolicycontrol 0xc000c0fed8 http REGISTERED   0xc000c0fec0  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc00068bb80 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc00032a630 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-24T17:53:17.346162516+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-24T17:53:17.346398894+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.346444400+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.346449484+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.346453418+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-24T17:53:17.346528591+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-24T17:53:17.346776151+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:17.346817873+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-24T17:53:17.346822583+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:17.346824830+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-24T17:53:17.346839677+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-24T17:53:17.347176233+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-24T17:53:17.347438740+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-24T17:53:17.547968402+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-24T17:53:17.548110823+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-24T17:53:17.548233760+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-24T17:53:17.549501773+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:17.557635391+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:17.558373764+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 124358a1-e7c3-47f5-a39a-f76522040d07
2025-06-24T17:53:17.559480337+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/124358a1-e7c3-47f5-a39a-f76522040d07 |  |
2025-06-24T17:53:17.560118694+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:17.560297307+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-24T17:53:17.749545835+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-24T17:53:17.751300786+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:17.769601322+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:17.771277750+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 6f376d8a-e667-4b0d-8bb9-038d63270cf4
2025-06-24T17:53:17.772409632+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/6f376d8a-e667-4b0d-8bb9-038d63270cf4 |  |
2025-06-24T17:53:17.772914302+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:17.773032413+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {6f376d8a-e667-4b0d-8bb9-038d63270cf4 SMF REGISTERED 0 0xc0000cdcc8 0xc0000cdce0 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc0004ec400 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc0000cdc20 false false []}
2025-06-24T17:53:17.773097749+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-24T17:53:17.773182421+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-24T17:53:17.773258317+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-24 17:53:17.773224163 +0800 CST m=+0.479059943]
2025-06-24T17:53:17.951439678+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:17.956413352+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:17.959527778+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 815b585b-0b28-4d6c-a310-fda06774e5ed
2025-06-24T17:53:17.961031163+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/815b585b-0b28-4d6c-a310-fda06774e5ed |  |
2025-06-24T17:53:17.961815460+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:17.961879428+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-24T17:53:17.961901912+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-24T17:53:17.961905771+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:53:17.961931908+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-24T17:53:18.150473512+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-24T17:53:18.150496897+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-24T17:53:18.151284928+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:18.156812825+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:18.158247802+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 199232eb-6823-48f8-95e7-4f39bb230fc3
2025-06-24T17:53:18.160482958+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/199232eb-6823-48f8-95e7-4f39bb230fc3 |  |
2025-06-24T17:53:18.160858826+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:18.160941635+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-24T17:53:18.361060329+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:18.366820991+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:18.368020969+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9fa13671-dc90-4080-b7f0-849088738239
2025-06-24T17:53:18.369270457+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9fa13671-dc90-4080-b7f0-849088738239 |  |
2025-06-24T17:53:18.369474664+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:18.369527448+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-24T17:53:18.369546434+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-24T17:53:18.561205201+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-24T17:53:18.562566965+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:18.569319873+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:18.570769480+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 3bd86ac6-ea56-4b75-a046-f89d2cc960fe
2025-06-24T17:53:18.572705773+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/3bd86ac6-ea56-4b75-a046-f89d2cc960fe |  |
2025-06-24T17:53:18.572875637+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:18.572928472+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-24T17:53:18.772322205+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-24T17:53:18.773427527+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-24T17:53:18.773678055+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:18.775209400+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-24T17:53:18.783960780+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:18.788224156+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 15ab0410-d407-442b-ba1d-f35c58b57e4e
2025-06-24T17:53:18.788731906+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/15ab0410-d407-442b-ba1d-f35c58b57e4e |  |
2025-06-24T17:53:18.789526249+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:18.789595183+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-24T17:53:18.974381240+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-24T17:53:18.975451817+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-24T17:53:18.977832677+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:53:18.981887675+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:53:18.982503574+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9d4c9dad-bbb2-4000-bbe2-62960f9251bd
2025-06-24T17:53:18.983632303+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9d4c9dad-bbb2-4000-bbe2-62960f9251bd |  |
2025-06-24T17:53:18.984097211+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:53:18.984159339+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-24T17:53:25.908489751+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889
2025-06-24T17:53:25.909112467+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889
2025-06-24T17:53:25.909439160+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle NGSetupRequest
2025-06-24T17:53:25.909447666+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mMissing IE PagingDRX
2025-06-24T17:53:25.909462082+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build3625507667/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-24T17:53:32.360068288+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.360532558+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.360544624+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:32.360679527+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:53:32.360697189+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:32.361062651+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.361088974+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.361217722+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:32.361233376+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:53:32.361241045+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:32.370537973+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.370589890+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.370596912+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.370602043+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.370608234+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.370610869+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.370612630+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-24T17:53:32.374816657+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.374864802+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:53:32.374870006+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:32.374873112+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:32.374874934+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:32.374891211+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.374894071+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.374895747+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.374902357+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.374904049+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.374905651+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.377377598+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.377569285+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.377817477+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.377824428+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.377826340+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.377827980+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.378052124+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.378202263+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.378207973+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.378210303+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.378212532+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.378214299+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-24T17:53:32.378272107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.378275564+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.378277252+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:53:32.378282208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.378283758+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.378298873+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.378305566+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.378307679+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.378309170+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.379847772+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle InitialUEMessage
2025-06-24T17:53:32.379885053+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-24T17:53:32.379932201+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-24T17:53:32.379971192+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-24T17:53:32.379986896+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-24T17:53:32.379992437+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-24T17:53:32.379995748+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-24T17:53:32.379999215+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-24T17:53:32.380004495+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-24T17:53:32.380007101+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-24T17:53:32.380854183+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.388396282+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-24T17:53:32.390056246+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-24T17:53:32.390066586+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-24T17:53:32.390649783+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.404567130+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-24T17:53:32.407214394+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-24T17:53:32.407290131+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-24T17:53:32.407296510+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-24T17:53:32.407298730+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-24T17:53:32.408004674+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.412708538+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-24T17:53:32.414419142+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:53:32.416693570+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:53:32.416872376+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-24T17:53:32.417013728+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-24T17:53:32.417118658+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-24T17:53:32.417125986+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 3265343832343662346538323330626531383663633362326633376535306339
2025-06-24T17:53:32.417196190+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-24T17:53:32.417649520+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-24T17:53:32.417697336+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend Downlink Nas Transport
2025-06-24T17:53:32.418959851+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.419017342+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.419023718+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.419026458+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.419028353+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.419029965+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.419048372+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.419050661+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.419052525+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.419150639+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.419217312+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.419223505+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:53:32.419230076+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.419232421+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.419234036+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.419239313+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.419240823+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.419242280+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.419647318+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:32.419668160+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:32.419710631+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-24T17:53:32.419722501+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-24T17:53:32.420582808+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-24T17:53:32.420633505+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 3265343832343662346538323330626531383663633362326633376535306339
Xres*: 3265343832343662346538323330626531383663633362326633376535306339
2025-06-24T17:53:32.420639364+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-24T17:53:32.421213256+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-24T17:53:32.422263954+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-24T17:53:32.422455120+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-24T17:53:32.422548468+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-24T17:53:32.422748993+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-24T17:53:32.422785571+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-24T17:53:32.422818192+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend Downlink Nas Transport
2025-06-24T17:53:32.423564314+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.423612558+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.423618164+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.423621209+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.423622831+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423624448+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.423633482+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.423776903+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.423781969+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.423805139+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423807216+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.423809021+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:53:32.423813720+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.423815348+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423816919+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.423822554+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.423826971+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423828373+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.424359517+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:32.424386320+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:32.424414775+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-24T17:53:32.424423948+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-24T17:53:32.424460658+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-24T17:53:32.424470217+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-24T17:53:32.424871050+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.440752969+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:53:32.442886874+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-24T17:53:32.443337774+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:53:32.443735073+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-24T17:53:32.443863713+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:32.446515557+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.456854982+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:53:32.458744826+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-24T17:53:32.460202023+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-24T17:53:32.460382816+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-24T17:53:32.460998871+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-24T17:53:32.461856478+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:53:32.462408096+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:32.462512182+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:32.462618122+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-24T17:53:32.463354449+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-24T17:53:32.463474949+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:32.463900814+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-24T17:53:32.464581539+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-24T17:53:32.464739175+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-24T17:53:32.465217931+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-24T17:53:32.465604618+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-24T17:53:32.465670052+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-24T17:53:32.466507250+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.475548703+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-24T17:53:32.477828859+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:53:32.478433313+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.487356013+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-24T17:53:32.489698402+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:53:32.494020635+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:32.507066647+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-24T17:53:32.509643747+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-24T17:53:32.509726366+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-24T17:53:32.509755801+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-24T17:53:32.510035284+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:53:32.510455201+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-24T17:53:32.510532039+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend Initial Context Setup Request
2025-06-24T17:53:32.511559361+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.511803915+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.511925405+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.511937112+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.511942246+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.511946184+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.511978915+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.511983461+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.511998816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512003000+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:53:32.512034407+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512048730+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:53:32.512053490+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:53:32.512064485+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.512068362+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512072187+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.512084157+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.512088111+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512091711+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.513019165+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.513132754+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.513139508+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513143156+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.513144812+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.513147411+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.513160343+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.513162396+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513165416+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513167960+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513172457+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513174569+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513176756+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.513178362+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-24T17:53:32.513356033+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle InitialContextSetupResponse
2025-06-24T17:53:32.513379198+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:53:32.513390630+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0x4e7c2878
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000c98f20)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc00015e960)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000acc540)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000c0ced0)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000c98f40)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000c98f60)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000c0cf0b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000c0cf23)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-24T17:53:32.515518658+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:32.515758583+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:32.516165858+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-24T17:53:32.516298565+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-24T17:53:32.516447640+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-24T17:53:32.516474163+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend Downlink Nas Transport
2025-06-24T17:53:32.516690511+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-24T17:53:33.016531662+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:33.016580948+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.016658631+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:53:33.016680116+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:53:33.016690450+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:53:33.016723659+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:53:33.017437392+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.024206504+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-24T17:53:33.025925596+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:53:33.026000906+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:53:33.026093754+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=124358a1-e7c3-47f5-a39a-f76522040d07&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:53:33.026347891+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:53:33.026905344+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.038201699+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:33.040943918+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:53:33.041254915+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:53:33.041323814+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:53:33.041338581+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:53:33.042123051+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.052767330+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:53:33.054088601+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:53:33.054867767+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:53:33.055002458+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:53:33.056534804+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.056744797+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.056869146+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:53:33+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0007769a0 0xc0007769c0 0xc0007769e0]
2025-06-24T17:53:33.056881913+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:53:33.056886260+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0007769a0 0xc0007769c0 0xc0007769e0]}
2025-06-24T17:53:33.056888769+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:53:33.057171894+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.058715727+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=124358a1-e7c3-47f5-a39a-f76522040d07&target-nf-type=AMF |  |
2025-06-24T17:53:33.059064652+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:53:33.059171197+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-24T17:53:33.059177092+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:53:33.059180088+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-24T17:53:33.059183701+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:53:33.059186898+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:53:33.059188969+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:53:33.059191408+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:53:33.059649396+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:53:33.060560640+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.072768339+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-24T17:53:33.076672460+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:53:33.077526477+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:53:33.077804668+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:53:33.078306092+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-24T17:53:33.078744758+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.083815338+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-24T17:53:33.086485976+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.091561974+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:53:33.091654010+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:53:33.091837645+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:53:33.092526878+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.093118408+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:53:33.093603432+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:53:33.094151544+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:53:33.096320220+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.100815878+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:53:33.101502194+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:53:33.102732033+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:53:33.102940773+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:53:33.102968953+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:53:33.102978079+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:53:33.102984989+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:53:33.103139600+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:53:33.103527190+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:53:33.103833202+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:53:33.103841775+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.103861725+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:53:33.103864834+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.103882564+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:53:33.104066036+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:53:33.104161195+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:53:33.104534934+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-24T17:53:33.108656473+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:53:33.109579350+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:53:33.109637629+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend PDU Session Resource Setup Request
2025-06-24T17:53:33.109811365+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:53:33.110904363+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.110970855+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.110978029+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-24T17:53:33.111026976+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.111029169+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.111030979+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.111060776+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.111101912+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111111589+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111114395+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111116943+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111119180+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111123473+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-24T17:53:33.111216834+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.111221460+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.111224415+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.111227330+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.111230050+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.111235585+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.111240248+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.111244293+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.111254848+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.111256361+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.111259010+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xb3533607
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d144e0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c401e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d08500)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000ca2564)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000cc120)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000bfc380)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000ca2590)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000ca25a0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d14500)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d14520)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d14540)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:53:33.215656013+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:53:33.216206892+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.217569776+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:53:33.219209431+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:53:33.219293509+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:06bf0aad-5896-49fb-b4ca-110ddd9b35ea/modify |  |
2025-06-24T17:53:33.219741905+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:33.219792198+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.219822529+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:53:33.219826804+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:53:33.219830393+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:53:33.219836546+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:53:33.220336187+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:53:33.220406855+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:53:33.220423246+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=124358a1-e7c3-47f5-a39a-f76522040d07&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:53:33.220617013+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:53:33.220851844+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.230754434+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:33.233013504+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:53:33.233165980+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:53:33.233191488+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:53:33.233233138+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:53:33.233671423+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.248358348+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:53:33.249372850+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:53:33.250115111+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:53:33.250191649+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:53:33.251831299+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.252096034+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.252201622+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:53:33+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc000686ae0 0xc000686b00 0xc000686b20]
2025-06-24T17:53:33.252254219+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:53:33.252258852+08:00[36m [INFO][SMF][GSM] [0m&{[0xc000686ae0 0xc000686b00 0xc000686b20]}
2025-06-24T17:53:33.252261041+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:53:33.252844549+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.254838162+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=124358a1-e7c3-47f5-a39a-f76522040d07&target-nf-type=AMF |  |
2025-06-24T17:53:33.255154819+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:53:33.255257941+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-24T17:53:33.255265071+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:53:33.255267609+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-24T17:53:33.255288799+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:53:33.255292428+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:53:33.255294583+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:53:33.255297977+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:53:33.256307917+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:53:33.257375652+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.262200968+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:53:33.262318383+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:53:33.262648324+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:53:33.263181511+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.263991552+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:53:33.264399681+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:53:33.264857572+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:53:33.265225017+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.269597752+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:53:33.270116228+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:53:33.270810640+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:53:33.270883327+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:53:33.270891191+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:53:33.270893515+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:53:33.270895515+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:53:33.270908587+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:53:33.271335285+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:53:33.271464839+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:53:33.271610270+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.271788606+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:53:33.271796791+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.271815088+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:53:33.271925360+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:53:33.272072718+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:53:33.272343090+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-24T17:53:33.276383123+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:53:33.277280502+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:53:33.277350103+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend PDU Session Resource Setup Request
2025-06-24T17:53:33.277457046+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:53:33.278452015+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.278534198+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.278541417+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-24T17:53:33.278589512+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.278594207+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278596435+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.278625423+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.278628195+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.278631652+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.278633840+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.278636500+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.278638505+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.278640413+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:53:33.278752726+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278759923+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.278766665+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.278772671+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.278775983+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.278799780+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.278844860+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278856941+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.278884023+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.278888628+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278891289+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000a355816b
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xbb5850aa04efcf038d12b07ce2ff12938acdadb114efcd9fab0fb807a01205e7
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xc60b2485af29b51909e25cfb2601d6b116d75760
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x000000009343df69
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xdd3be42d95323d4774ba60917a5870254832d5e8dcb4af1a563dad451c94caeb
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xad663995029ade0ab9bb16b763130b5b370cfa68
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0x2de4270f
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d151c0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c404b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d08eb0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000ca3e7c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000cc2d0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000bfca80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000ca3ea0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000ca3eb0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d151e0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d15200)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d15220)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:53:33.287176394+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:53:33.287204422+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.292801170+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:53:33.295102341+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:53:33.295222641+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:72d2eb4b-1dc9-475b-82ea-2a40847e7ec9/modify |  |
2025-06-24T17:53:33.488047021+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:33.488093196+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.488148157+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:53:33.488153392+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:53:33.488157207+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:53:33.488163899+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:53:33.488976562+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:53:33.489063998+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:53:33.489099172+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=124358a1-e7c3-47f5-a39a-f76522040d07&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:53:33.489549675+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:53:33.490166860+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.499452727+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:33.501967703+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:53:33.502094789+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:53:33.502120473+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:53:33.502123679+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:53:33.502721717+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.520053208+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:53:33.521124495+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:53:33.521751382+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:53:33.521829746+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:53:33.523212801+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.523417541+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.523524245+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:53:33+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0005d0360 0xc0005d0380 0xc0005d03a0]
2025-06-24T17:53:33.523558742+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:53:33.523567359+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0005d0360 0xc0005d0380 0xc0005d03a0]}
2025-06-24T17:53:33.523574223+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:53:33.523974992+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.525579586+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=124358a1-e7c3-47f5-a39a-f76522040d07&target-nf-type=AMF |  |
2025-06-24T17:53:33.525768381+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:53:33.525854347+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-24T17:53:33.525865949+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:53:33.525873992+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-24T17:53:33.525883097+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:53:33.525900944+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:53:33.525908078+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:53:33.525915550+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:53:33.526404333+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:53:33.529035581+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.534408238+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:53:33.534527992+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:53:33.534734231+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:53:33.535274184+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.536122812+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:53:33.536288185+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:53:33.536674144+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:53:33.536779706+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.541129779+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:53:33.541661228+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:53:33.542376988+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:53:33.542429945+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:53:33.542450826+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:53:33.542454586+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:53:33.542456649+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:53:33.542469321+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:53:33.542772399+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:53:33.543012500+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:53:33.543090413+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.543122992+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:53:33.543127570+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.543150754+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:53:33.543178050+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:53:33.543274881+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:53:33.543998337+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-24T17:53:33.547537657+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:53:33.548521323+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:53:33.548568109+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend PDU Session Resource Setup Request
2025-06-24T17:53:33.548731410+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:53:33.549441932+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.549468698+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.549472226+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-24T17:53:33.549536491+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.549543537+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549545643+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.549590957+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.549593796+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549598203+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549600594+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549602976+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549605252+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549607412+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:53:33.549650829+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549652785+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.549655453+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.549657321+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.549659180+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.549670268+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.549671863+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549673337+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.549682948+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.549735581+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549740336+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x0000000075e35eb8
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x83db62f7466010032538eb88239d43007ada5af01cf052528d26467d743a9f26
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x88481fdb5a9bc80d00232efe5d57fa2430b816ff
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000538457f2
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xd73823e8dcfeebea0faebe81b6ad6519ebdb8cb7dd8d17a14628adc8f526edff
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x87bef4d27b4ceae703f5498f9ae29e92fd2dcb8d
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xf86b1bb0
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000d15ec0)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c40780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000d09860)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00075202c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000cc480)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000bfd180)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000752060)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000752070)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000d15ee0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000d15f00)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000d15f20)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:53:33.652073226+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:53:33.652142506+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.652708238+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:53:33.655319136+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:53:33.655402782+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:419826ef-0919-4cfa-b95f-578eb011069d/modify |  |
2025-06-24T17:53:33.655729876+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport
2025-06-24T17:53:33.655898371+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:53:33.655930271+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:53:33.655974046+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:53:33.655982331+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:53:33.655988448+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:53:33.656689408+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:53:33.656784873+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:53:33.656800299+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=124358a1-e7c3-47f5-a39a-f76522040d07&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:53:33.657045932+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:53:33.657835319+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.667612007+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:53:33.669412562+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:53:33.669545737+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:53:33.669596006+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:53:33.669612218+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:53:33.670020410+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.685124988+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:53:33.686253022+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:53:33.687126396+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:53:33.687205202+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:53:33.688473383+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.688826161+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.689072423+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:53:33+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0008400c0 0xc0008400e0 0xc000840100]
2025-06-24T17:53:33.689136719+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:53:33.689141389+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0008400c0 0xc0008400e0 0xc000840100]}
2025-06-24T17:53:33.689143508+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:53:33.689546395+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.690610885+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=124358a1-e7c3-47f5-a39a-f76522040d07&target-nf-type=AMF |  |
2025-06-24T17:53:33.691057205+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:53:33.691162973+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-24T17:53:33.691200398+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:53:33.691208926+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-24T17:53:33.691218270+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:53:33.691226560+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:53:33.691236207+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:53:33.691243849+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:53:33.691975490+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:53:33.693327081+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:53:33.698688129+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:53:33.699004832+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:53:33.699139615+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:53:33.699501521+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.700539907+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:53:33.700834017+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:53:33.701038091+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:53:33.701302589+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:53:33.705979711+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:53:33.706402038+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:53:33.706949335+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:53:33.706988005+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:53:33.706998891+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:53:33.707012736+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:53:33.707019049+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:53:33.707036590+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:53:33.707305157+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:53:33.707390221+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:53:33.707410476+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.707444613+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:53:33.707456021+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:53:33.707481163+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:53:33.707555570+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:53:33.709963216+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:53:33.711733447+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-24T17:53:33.714718271+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:53:33.715689293+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:53:33.715849447+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mSend PDU Session Resource Setup Request
2025-06-24T17:53:33.715985426+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:53:33.716729468+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.716794653+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.716800677+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-24T17:53:33.716827499+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.716830211+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.716831946+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.716861632+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.716902070+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.716909237+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.716912315+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.716914904+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.716916998+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.716919131+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:53:33.716959547+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.717016145+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.717023842+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.717026098+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.717028226+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.717042279+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.717045235+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.717046891+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.717057082+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.717058686+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.717060174+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000aeb6a988
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xc0bb66229e026708fff95028c57b779695f908c1450e0fcc5b67da14fe4e6747
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x5a1ada317bbb6f337494f6b798c995c2d48d04c2
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000053190fa2
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xff1503f42c7d011b709a166d1ac63201e8872b422c10b76b20f0b3ae6851c451
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x788707385c982dc4b1be5c15f626af30f4535af5
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xd2c1536b
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000b4b060)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000c40a50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000afe230)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0001716ac)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc0000cc630)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000bfd880)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000171710)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000171720)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000b4b080)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000b4b0a0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000b4b0c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-06-24T17:53:33.722108724+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:53:33.722157022+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:54889] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-24T17:53:33.730539011+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:53:33.740988945+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:53:33.741041373+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:d5761fc6-6c3f-4344-8728-0b3685c4d506/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=1.163337ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=1.234103ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=954.914µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=1.091377ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=960.172µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 954.914µs/1.080782ms/1.234103ms/110.295µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.78s)
PASS
ok  	test	9.828s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.38s)
PASS
ok  	test	28.272s

--- STDERR ---
2025-06-24T17:53:13.754036838+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:53:13.754133299+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-24T17:53:13.754350011+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:53:13.754397017+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc000492370)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc000445800)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc0004459b0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc00048f9a0)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-24T17:53:13.754405072+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:53:13.754407679+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-24T17:53:13.754409654+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:13.754424809+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-24T17:53:13.754428690+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-24T17:53:13.758638503+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-24T17:53:13.758816397+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-24T17:53:13.758940655+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-24T17:53:13.759078579+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-24T17:53:13.759087829+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-24T17:53:13.759091227+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-24T17:53:18.774331266+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-24T17:53:18.774468127+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-24T17:53:25.899438498+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:53:25.900091781+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-24T17:53:25.900721371+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-24T17:53:25.900787232+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-24T17:53:25.900792820+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-24T17:53:25.900863457+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-24T17:53:25.900868293+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-24T17:53:25.902672026+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-24T17:53:25.902985218+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-24T17:53:25.906129600+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-24T17:53:25.908215769+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-24T17:53:25.908522756+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-24T17:53:25.912424182+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-24T17:53:25.915173240+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-24T17:53:25.916090232+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-24T17:53:25.916338975+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-24T17:53:32.361434235+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.361537287+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.361544788+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.361585429+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.361589692+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.361593326+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-24T17:53:32.370088072+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.370136641+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.370142532+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:32.370145678+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:53:32.370147697+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:32.370149662+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:32.370151386+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:32.370176606+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.370179571+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:53:32.370196154+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.370197966+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.370199587+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:32.370201834+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:53:32.370203559+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:32.370205239+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:32.370206881+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:32.375279708+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.375341367+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.375347348+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.375461189+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:53:32.375507827+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.375512627+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.375529889+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.375743486+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.375786782+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.375792462+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.375796021+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.375798452+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.375801174+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-24T17:53:32.375806103+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.375807608+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:53:32.375811168+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-24T17:53:32.375813913+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:53:32.375815421+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:53:32.377058817+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.377100315+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:53:32.377109467+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-24T17:53:32.377113496+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:53:32.377116819+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.377119224+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:53:32.377130456+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.377133297+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.377134941+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.377158945+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.377160573+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.377162065+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.378707918+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.378999911+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.379070528+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.379081168+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:53:32.379084698+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.379086376+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.379088034+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.379099244+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.379101344+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.379103120+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.379105729+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:53:32.379144839+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.379174859+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:32.379177544+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-24T17:53:32.379181945+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.379184542+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-24T17:53:32.418380763+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:53:32.418471762+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:32.418478597+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:53:32.418490738+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.418522860+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.418527702+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:53:32.418536718+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.418538653+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.418540293+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.418555890+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.418559979+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.418561617+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.419406375+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.419417758+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.419420965+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.419493155+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:53:32.419500556+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.419502356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.419503943+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.419516827+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.419519183+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.419521033+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.419523785+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:53:32.419529066+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.419532497+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:32.423015347+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:53:32.423245403+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:32.423283869+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:53:32.423290781+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423292951+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.423294878+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:53:32.423300899+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.423303780+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423305449+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.423311450+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.423312950+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.423318977+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.424078483+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.424096736+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.424099926+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.424103038+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:53:32.424106157+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.424107913+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.424109562+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.424121456+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.424123643+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.424125385+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.424127929+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:53:32.424155646+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.424158543+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:32.511057393+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-24T17:53:32.511155469+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:32.511162966+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-24T17:53:32.511167677+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.511171722+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:53:32.511179929+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.511217099+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.511221694+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.511229485+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.511231193+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.511232845+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.512405779+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:32.512422203+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.512424971+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.512427551+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:53:32.512431050+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.512435557+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512438356+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.512448120+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:32.512450439+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.512452396+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:32.512482575+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 547706139, Outbound SPI: 180566229
2025-06-24T17:53:32.512504869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512506798+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:53:32.512508747+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:53:32.512512872+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:32.512515670+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:32.512517467+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:32.512519337+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:32.512521063+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:32.512525317+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.512526857+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512528360+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.512679042+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:32.512682638+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:32.512684250+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:32.512812696+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.512864370+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.512887817+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:32.512890103+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:53:32.512919241+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.512921811+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-24T17:53:32.513582864+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:53:32.514212674+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:32.515028392+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:32.516950814+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:53:33.016215216+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:33.104615655+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:53:33.104678668+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-24T17:53:33.105977531+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-24T17:53:33.105990172+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-24T17:53:33.106605797+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-24T17:53:33.110265926+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:53:33.110522276+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.110564008+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:53:33.110584799+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.110587353+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.110590476+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.110594295+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.110600050+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.110602011+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.110603752+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.110610440+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.110612208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.110613718+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.110628605+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.110630239+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.110631807+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.111585401+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.111749981+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.111756368+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111759432+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:53:33.111761612+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9100927300737251817
2025-06-24T17:53:33.111764944+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.111767115+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.111769010+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.111795789+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.111797933+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111801291+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111803637+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111805849+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.111814841+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.111819673+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.111822794+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:53:33.111961665+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.112070434+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.112138063+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:53:33.113470607+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:33.218162616+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:53:33.272524765+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:53:33.272578074+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-24T17:53:33.273826184+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-24T17:53:33.273990694+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-24T17:53:33.277824297+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:53:33.278085878+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.278132411+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:53:33.278158408+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278161477+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.278164998+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.278167495+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.278170364+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.278172601+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.278174614+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.278190988+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.278193653+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278195673+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.278217466+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.278219449+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.278221187+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.279812344+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.279883951+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.279890968+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.279896215+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:53:33.279898734+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9100927300737251817
2025-06-24T17:53:33.279903174+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.279905203+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.279906991+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.279941359+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.279944701+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.279949002+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.279951553+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.279953805+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.279962841+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.279966702+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.280038601+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:53:33.283069465+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-24T17:53:33.283241594+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.283313532+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.285288664+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:53:33.286963785+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:33.293493758+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:53:33.544353869+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:53:33.544435450+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-24T17:53:33.544933193+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-24T17:53:33.545078886+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-24T17:53:33.548920221+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:53:33.549007771+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.549014574+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:53:33.549029786+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549032160+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.549035422+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.549050600+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.549052899+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.549054965+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.549056699+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.549063415+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.549065616+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549314662+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.549334378+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.549336663+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549338408+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.549884644+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.549900428+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.549903991+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549907548+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:53:33.549910114+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9100927300737251817
2025-06-24T17:53:33.549913688+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.549915379+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.549917006+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.549949744+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.549952257+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549955445+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549957693+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549960606+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.549965378+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.549968860+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.549970978+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:53:33.552830179+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-24T17:53:33.552930312+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.552982248+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.553000794+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:53:33.562988610+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:53:33.653499186+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:53:33.712082158+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:53:33.712138869+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-24T17:53:33.713792193+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-24T17:53:33.713924837+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-24T17:53:33.716180490+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:53:33.716315784+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.716324635+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:53:33.716342969+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.716345405+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:53:33.716348870+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:53:33.716355379+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.716396731+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:53:33.716401527+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.716403463+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:53:33.716413274+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.716415239+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.716416848+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.716432383+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.716434834+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.716436483+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.717890782+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:53:33.717969634+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.717975931+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.717978859+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:53:33.717981135+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 9100927300737251817
2025-06-24T17:53:33.717984731+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:53:33.717986425+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:53:33.717988142+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:53:33.718017018+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:53:33.718020413+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.718023627+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.718025931+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.718028066+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:53:33.718037473+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.718079112+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:53:33.718084104+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:53:33.720935810+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-24T17:53:33.721090588+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.721209268+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:53:33.721230692+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:53:33.731223429+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:53:45.159926647+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-24T17:53:45.160004815+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-24T17:53:45.160093068+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-24T17:53:45.160101934+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-24T17:53:45.160109039+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-24T17:53:45.204387975+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-24T17:53:45.204407020+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-24T17:53:45.204420709+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-24T17:53:45.204425055+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-24T17:53:45.204427047+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-24T17:53:45.204428715+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-24T17:53:45.534699767+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-24T17:53:45.534762484+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-24T17:53:45.534876186+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-24T17:53:45.534955787+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-24T17:53:45.535042410+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-24T17:53:45.535074399+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.219:48999: use of closed network connection
2025-06-24T17:53:45.535080919+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.219:48999: use of closed network connection
2025-06-24T17:53:45.535083920+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-24T17:53:45.535095639+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-24T17:53:45.535098100+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-24T17:53:45.535110810+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-24T17:53:45.535127957+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-24T17:53:45.535132644+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:53:45.535142332+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-24T17:53:45.535180125+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:53:45.535188631+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-24T17:53:45.535217993+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-24T17:53:45.535234484+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-24T17:53:45.535236810+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-24T17:53:45.535239604+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-24T17:53:45.535282057+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-24T17:53:45.535339564+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-24T17:53:45.535351015+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-24T17:53:45.535359316+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-24T17:53:45.535361436+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (76753): No such process
