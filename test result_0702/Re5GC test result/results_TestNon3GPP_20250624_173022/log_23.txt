Run TestCN
os.Args: [/tmp/go-build288491807/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestCN]
2025-06-24T17:44:00.924271627+08:00[36m [INFO][NRF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.924371227+08:00[36m [INFO][NRF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.924376688+08:00[36m [INFO][NRF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.924382503+08:00[36m [INFO][NRF][Init] [0mnrfconfig Info: Version[1.0.2] Description[NRF initial test configuration]
2025-06-24T17:44:00.924394741+08:00[36m [INFO][NRF][SBI] [0mBinding addr: [127.0.0.10:8000]
CPAF Config failed: invalid Non3gppDeregTimerValue: value is required
2025-06-24T17:44:00.930527454+08:00[36m [INFO][CPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.930538521+08:00[36m [INFO][CPAF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.930540631+08:00[36m [INFO][CPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.931770829+08:00[36m [INFO][CPAF][SBI] [0mBinding addr: [127.0.0.18:8000]
2025-06-24T17:44:00.934718957+08:00[36m [INFO][SMF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.934767505+08:00[36m [INFO][SMF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.934773336+08:00[36m [INFO][SMF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.934776991+08:00[36m [INFO][SMF][CTX] [0msmfconfig Info: Version[1.0.7] Description[SMF initial single test configuration]
2025-06-24T17:44:00.934794601+08:00[36m [INFO][SMF][CTX] [0mEndpoints: [10.200.200.102]
2025-06-24T17:44:00.934957776+08:00[36m [INFO][UDR][Util] [0mudrconfig Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:44:00.935007708+08:00[36m [INFO][UDR][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.935012958+08:00[36m [INFO][UDR][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.935015703+08:00[36m [INFO][UDR][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.935370511+08:00[36m [INFO][UDM][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.935420865+08:00[36m [INFO][UDM][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.935426356+08:00[36m [INFO][UDM][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.935428825+08:00[36m [INFO][UDM][Util] [0mudmconfig Info: Version[1.0.3] Description[UDM initial test configuration]
2025-06-24T17:44:00.935448242+08:00[36m [INFO][UDM][SBI] [0mBinding addr: [127.0.0.3:8000]
2025-06-24T17:44:00.935524815+08:00[36m [INFO][NSSF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.935530779+08:00[36m [INFO][NSSF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.935532736+08:00[36m [INFO][NSSF][Main] [0mReport Caller is set to [false]
SDPAF Config failed: invalid DefaultBdtRefId: non zero value required;invalid Mongodb: non zero value required;invalid PcfName: non zero value required;invalid ServiceList: non zero value required;invalid TimeFormat: non zero value required
2025-06-24T17:44:00.935974313+08:00[36m [INFO][SDPAF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.935980276+08:00[36m [INFO][SDPAF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.935982180+08:00[36m [INFO][SDPAF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.935993113+08:00[36m [INFO][SDPAF][Init] [0msdpafconfig Info: Version[1.0.3] Description[SDPAF initial test configuration]
ausf context =  &{{{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} 5e8b4ae8-6e7f-4dc7-842d-0ed17ebc3ae9 ausfGroup001 8000 127.0.0.9 127.0.0.9 http://127.0.0.9:8000 http http://127.0.0.10:8000 ../cert/nrf.pem map[nausf-auth:{5e8b4ae8-6e7f-4dc7-842d-0ed17ebc3ae9-auth nausf-auth 0xc0005077d0 http REGISTERED   0xc0005077b8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-policyauthorization:{5e8b4ae8-6e7f-4dc7-842d-0ed17ebc3ae9-policyauthorization npcf-policyauthorization 0xc000507830 http REGISTERED   0xc000507818  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  } npcf-smpolicycontrol:{5e8b4ae8-6e7f-4dc7-842d-0ed17ebc3ae9-smpolicycontrol npcf-smpolicycontrol 0xc000507800 http REGISTERED   0xc0005077e8  [] <nil> [] [] <nil> 0 0 0 <nil> <nil>  }] [{208 93} {123 45}]  0xc000d55680 false false map[]     {{0 0} {[] {} <nil>} map[] 0} {{0 0} {[] {} <nil>} map[] 0} map[] {{0 0} {[] {} <nil>} map[] 0} {{0 0} 0 0 {{} 0} {{} 0}} 0xc000294ba0 {{0 0} {[] {} <nil>} map[] 0} <nil>  {{0 0} {[] {} <nil>} map[] 0} <nil> map[] {{0 0} {[] {} <nil>} map[] 0}}
2025-06-24T17:44:00.936092825+08:00[36m [INFO][SDPAF][SBI] [0mBinding addr: [127.0.0.9:8000]
2025-06-24T17:44:00.936421911+08:00[36m [INFO][APCF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.936490109+08:00[36m [INFO][APCF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.936496100+08:00[36m [INFO][APCF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.936500868+08:00[36m [INFO][APCF][Util] [0mpcfconfig Info: Version[1.0.2] Description[APCF initial test configuration]
2025-06-24T17:44:00.936629107+08:00[36m [INFO][APCF][SBI] [0mBinding addr: [127.0.0.7:8000]
2025-06-24T17:44:00.938468994+08:00[36m [INFO][CHF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:00.938718319+08:00[36m [INFO][CHF][Main] [0mLog level is set to [info]
2025-06-24T17:44:00.938724456+08:00[36m [INFO][CHF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:00.938726967+08:00[36m [INFO][CHF][Init] [0mchfconfig Info: Version[1.0.3] Description[CHF initial test configuration]
2025-06-24T17:44:00.938744777+08:00[36m [INFO][CHF][SBI] [0mBinding addr: [127.0.0.113:8000]
NfStart 9
2025-06-24T17:44:00.938948592+08:00[36m [INFO][NRF][Init] [0mServer starting
2025-06-24T17:44:00.939045372+08:00[36m [INFO][NRF][SBI] [0mSBI server started
2025-06-24T17:44:01.139250641+08:00[36m [INFO][CPAF][Util] [0mamfconfig Info: Version[1.0.0]
2025-06-24T17:44:01.139396580+08:00[36m [INFO][CPAF][Init] [0mServer started
2025-06-24T17:44:01.140002110+08:00[36m [INFO][CPAF][Ngap] [0mListen on 10.200.200.1:38412
2025-06-24T17:44:01.141013667+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:01.146809458+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:01.147847762+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: c4a81613-c84d-4951-abbc-7bc76d46f86f
2025-06-24T17:44:01.150576561+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/c4a81613-c84d-4951-abbc-7bc76d46f86f |  |
2025-06-24T17:44:01.150830825+08:00[36m [INFO][CPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:01.150887959+08:00[36m [INFO][CPAF][SBI] [0mStart SBI server (listen on 127.0.0.18:8000)
2025-06-24T17:44:01.340192963+08:00[36m [INFO][SMF][Init] [0mServer started
2025-06-24T17:44:01.341045435+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:01.347334150+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:01.348806128+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 307c58a5-a609-4d8d-8614-271303b8fc48
2025-06-24T17:44:01.352414994+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/307c58a5-a609-4d8d-8614-271303b8fc48 |  |
2025-06-24T17:44:01.352709890+08:00[36m [INFO][SMF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:01.352773779+08:00[36m [INFO][SMF][Init] [0mSMF Registration to NRF {307c58a5-a609-4d8d-8614-271303b8fc48 SMF REGISTERED 0 0xc00082edc8 0xc00082ede0 [] []   [127.0.0.2] [] <nil> [] [] <nil> 0 0 0 area1 <nil> <nil> <nil> <nil> 0xc000273a00 <nil> <nil> <nil> <nil> <nil> map[oauth2:false] <nil> false 0xc00082ed20 false false []}
2025-06-24T17:44:01.352822921+08:00[36m [INFO][SMF][PFCP] [0mListen on 10.200.200.1:8805
2025-06-24T17:44:01.352833922+08:00[36m [INFO][SMF][PFCP] [0mPfcp running... [2025-06-24 17:44:01.352826518 +0800 CST m=+0.463261028]
2025-06-24T17:44:01.352854742+08:00[36m [INFO][SMF][SBI] [0mStart SBI server (listen on 127.0.0.2:8000)
2025-06-24T17:44:01.543669097+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:01.550864104+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:01.554456203+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: f643c178-70ff-40bf-9d68-321fb6ec206f
2025-06-24T17:44:01.556105661+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/f643c178-70ff-40bf-9d68-321fb6ec206f |  |
2025-06-24T17:44:01.556357320+08:00[36m [INFO][UDR][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:01.556402494+08:00[36m [INFO][UDR][Init] [0mregister to NRF successfully
2025-06-24T17:44:01.556408011+08:00[36m [INFO][UDR][Init] [0mServer started
2025-06-24T17:44:01.556414659+08:00[36m [INFO][UDR][Init] [0mUDR Config Info: Version[1.1.0] Description[UDR initial test configuration]
2025-06-24T17:44:01.556424380+08:00[36m [INFO][UDR][SBI] [0mStarting server...
2025-06-24T17:44:01.742983965+08:00[36m [INFO][UDM][Init] [0mServer started
2025-06-24T17:44:01.743124119+08:00[36m [INFO][UDM][SBI] [0mStarting server...
2025-06-24T17:44:01.745082734+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:01.751908955+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:01.753340503+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 45e82535-7c18-4acc-b81c-d1f6af64c46c
2025-06-24T17:44:01.755281564+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/45e82535-7c18-4acc-b81c-d1f6af64c46c |  |
2025-06-24T17:44:01.755454753+08:00[36m [INFO][UDM][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:01.755484442+08:00[36m [INFO][UDM][SBI] [0mStart SBI server (listen on 127.0.0.3:8000)
2025-06-24T17:44:01.946010053+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:01.950701831+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:01.952009135+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 9051a167-116c-47ac-ac2a-6ba96f8ea420
2025-06-24T17:44:01.953481277+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/9051a167-116c-47ac-ac2a-6ba96f8ea420 |  |
2025-06-24T17:44:01.953631887+08:00[36m [INFO][NSSF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:01.953653412+08:00[36m [INFO][NSSF][Main] [0mregister to NRF successfully
2025-06-24T17:44:01.953661811+08:00[36m [INFO][NSSF][SBI] [0mStarting server...
2025-06-24T17:44:02.151271943+08:00[36m [INFO][SDPAF][Init] [0mServer started
2025-06-24T17:44:02.152423152+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:02.157382659+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:02.158454037+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 5e8b4ae8-6e7f-4dc7-842d-0ed17ebc3ae9
2025-06-24T17:44:02.160310387+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/5e8b4ae8-6e7f-4dc7-842d-0ed17ebc3ae9 |  |
2025-06-24T17:44:02.160480028+08:00[36m [INFO][SDPAF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:02.160523175+08:00[36m [INFO][SDPAF][SBI] [0mStart SBI server (listen on 127.0.0.9:8000)
2025-06-24T17:44:02.360338642+08:00[36m [INFO][SMF][Main] [0mSending PFCP Association Request to UPF[10.200.200.101]
2025-06-24T17:44:02.360888952+08:00[36m [INFO][APCF][Init] [0mServer started
2025-06-24T17:44:02.361091284+08:00[36m [INFO][SMF][Main] [0mReceived PFCP Association Setup Accepted Response from UPF[10.200.200.101]
2025-06-24T17:44:02.361715092+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:02.366918545+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:02.368078126+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: 51503939-5153-4c70-a7af-2c1ec519b562
2025-06-24T17:44:02.369715532+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/51503939-5153-4c70-a7af-2c1ec519b562 |  |
2025-06-24T17:44:02.370131206+08:00[36m [INFO][APCF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:02.370195621+08:00[36m [INFO][APCF][SBI] [0mStart SBI server (listen on 127.0.0.7:8000)
2025-06-24T17:44:02.561665373+08:00[36m [INFO][CHF][Init] [0mServer started
2025-06-24T17:44:02.562280814+08:00[36m [INFO][CHF][Acct] [0mOpen Account Balance Management Server
2025-06-24T17:44:02.564141466+08:00[36m [INFO][NRF][NFM] [0mHandle NFRegisterRequest
2025-06-24T17:44:02.569198397+08:00[36m [INFO][NRF][NFM] [0murilist update
2025-06-24T17:44:02.569815895+08:00[36m [INFO][NRF][NFM] [0mCreate NF Profile: d27ad1b0-ec1e-4aa9-b2eb-22b32367f6e1
2025-06-24T17:44:02.570417150+08:00[36m [INFO][NRF][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nnrf-nfm/v1/nf-instances/d27ad1b0-ec1e-4aa9-b2eb-22b32367f6e1 |  |
2025-06-24T17:44:02.570587235+08:00[36m [INFO][CHF][Main] [0mOAuth2 setting receive from NRF: false
2025-06-24T17:44:02.570628546+08:00[36m [INFO][CHF][SBI] [0mStart SBI server (listen on 127.0.0.113:8000)
=== RUN   TestCN
2025-06-24T17:44:09.470578543+08:00[36m [INFO][CPAF][Ngap] [0m[AMF] SCTP Accept from: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271
2025-06-24T17:44:09.470875914+08:00[36m [INFO][CPAF][Ngap] [0mCreate a new NG connection for: 10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271
2025-06-24T17:44:09.471432916+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle NGSetupRequest
2025-06-24T17:44:09.471443514+08:00[33m [WARN][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mMissing IE PagingDRX
2025-06-24T17:44:09.471461474+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend NG-Setup response
Run TestNon3GPPUE
os.Args: [/tmp/go-build2620675167/b001/test.test -test.paniconexit0 -test.v=true -test.timeout=0s -test.run=TestNon3GPPUE noinit]
MongoDB Set
=== RUN   TestNon3GPPUE
2025-06-24T17:44:15.997020089+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:15.997250531+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:15.997261051+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:15.997273016+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:44:15.997280839+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:15.998146488+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:15.998283279+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:15.998289085+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:15.998292972+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:44:15.998296656+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.007521125+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.007549259+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.007553807+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.007558737+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.007561134+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.007563406+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.007565007+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1056: Get SA payload
2025-06-24T17:44:16.011514849+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.011584664+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:44:16.011590085+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.011592789+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.011595749+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.011610945+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.011613821+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.011615506+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.011622118+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.011623658+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.011625047+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.014107178+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.014251192+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.014274452+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.014284218+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.014293421+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.014304311+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.014384213+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.014395410+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.014402369+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.014409147+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.014424156+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.014431019+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1164: Get IDr
    non3gpp_test.go:1168: Get CERT
    non3gpp_test.go:1166: Get AUTH
    non3gpp_test.go:1171: Get EAP
2025-06-24T17:44:16.014495619+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.014502709+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.014508804+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:44:16.014518182+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.014524498+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.014534649+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.014545517+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.014569630+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.014575803+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.019429293+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle InitialUEMessage
2025-06-24T17:44:16.019467247+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mNew RanUe [RanUeNgapID:0][AmfUeNgapID:1]
2025-06-24T17:44:16.019500373+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0m5GSMobileIdentity ["SUCI":"suci-0-208-93-0-0-0-00007487", err: <nil>]
2025-06-24T17:44:16.019534251+08:00[36m [INFO][CPAF][CTX] [0mNew AmfUe [supi:][guti:20893cafe0000000001]
2025-06-24T17:44:16.019548888+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Deregistered] to [Deregistered]
2025-06-24T17:44:16.019555370+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Registration Request
2025-06-24T17:44:16.019559383+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mRegistrationType: Initial Registration
2025-06-24T17:44:16.019564164+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mMobileIdentity5GS: SUCI[suci-0-208-93-0-0-0-00007487]
2025-06-24T17:44:16.019569360+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Start Authentication], transition from [Deregistered] to [Authentication]
2025-06-24T17:44:16.019572146+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mAuthentication procedure
2025-06-24T17:44:16.020286536+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.025004729+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=AUSF |  |
2025-06-24T17:44:16.026563967+08:00[36m [INFO][SDPAF][UeAuth] [0mHandleUeAuthPostRequest
2025-06-24T17:44:16.026601690+08:00[36m [INFO][SDPAF][UeAuth] [0mServing network authorized
2025-06-24T17:44:16.026859755+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.033624316+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=nudm-ueau&target-nf-type=UDM |  |
2025-06-24T17:44:16.035311007+08:00[36m [INFO][UDM][UEAU] [0mHandle GenerateAuthDataRequest
2025-06-24T17:44:16.035409298+08:00[36m [INFO][UDM][Suci] [0msuciPart: [suci 0 208 93 0 0 0 00007487]
2025-06-24T17:44:16.035415544+08:00[36m [INFO][UDM][Suci] [0mscheme 0
2025-06-24T17:44:16.035418521+08:00[36m [INFO][UDM][Suci] [0mSUPI type is IMSI
http://127.0.0.10:8000
2025-06-24T17:44:16.036084544+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.038893736+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=UDM&target-nf-type=UDR |  |
2025-06-24T17:44:16.040016286+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:44:16.041839549+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PATCH   | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-subscription |  |
2025-06-24T17:44:16.042661818+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | POST    | /nudm-ueau/v1/suci-0-208-93-0-0-0-00007487/security-information/generate-auth-data |  |
2025-06-24T17:44:16.042833811+08:00[36m [INFO][SDPAF][UeAuth] [0mAdd SuciSupiPair (suci-0-208-93-0-0-0-00007487, imsi-2089300007487) to map.
2025-06-24T17:44:16.042963578+08:00[36m [INFO][SDPAF][UeAuth] [0mUse 5G AKA auth method
2025-06-24T17:44:16.042971239+08:00[36m [INFO][SDPAF][5gAka] [0mXresStar = 3034313134386664333966336163373865663561653136303461666661636562
2025-06-24T17:44:16.043018564+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nausf-auth/v1/ue-authentications |  |
2025-06-24T17:44:16.043094189+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mSend Authentication Request
2025-06-24T17:44:16.043160565+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend Downlink Nas Transport
2025-06-24T17:44:16.044127429+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.044168901+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.044319519+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.044341840+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.044350107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.044356551+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.044479035+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.044502386+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.044510168+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.044820980+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.044844235+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.044854669+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:44:16.044968030+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.044991182+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.045000102+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.045014147+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.045021844+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.045028917+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.045564876+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:16.045619496+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.045646553+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Authentication] to [Authentication]
2025-06-24T17:44:16.045651689+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:] [0mHandle Authentication Response
2025-06-24T17:44:16.046184992+08:00[36m [INFO][SDPAF][5gAka] [0mAuth5gAkaComfirmRequest
2025-06-24T17:44:16.046252377+08:00[36m [INFO][SDPAF][5gAka] [0mres*: 3034313134386664333966336163373865663561653136303461666661636562
Xres*: 3034313134386664333966336163373865663561653136303461666661636562
2025-06-24T17:44:16.046260136+08:00[36m [INFO][SDPAF][5gAka] [0m5G AKA confirmation succeeded
2025-06-24T17:44:16.046695669+08:00[36m [INFO][UDM][UEAU] [0mHandle ConfirmAuthDataRequest
2025-06-24T17:44:16.049086562+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/authentication-data/authentication-status |  |
2025-06-24T17:44:16.049209800+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-ueau/v1/imsi-2089300007487/auth-events |  |
2025-06-24T17:44:16.049434903+08:00[36m [INFO][SDPAF][GIN] [0m| 200 |       127.0.0.1 | PUT     | /nausf-auth/v1/ue-authentications/suci-0-208-93-0-0-0-00007487/5g-aka-confirmation |  |
2025-06-24T17:44:16.049605260+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Authentication Success], transition from [Authentication] to [SecurityMode]
2025-06-24T17:44:16.049663844+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Security Mode Command
2025-06-24T17:44:16.049679048+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend Downlink Nas Transport
2025-06-24T17:44:16.050379410+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.050524331+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.050547075+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.050555349+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.050561689+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.050585654+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.051080129+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.051102426+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.051114226+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.051255871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.051266694+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.051274690+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:44:16.051286924+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.051293356+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.051299520+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.051471601+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.051492439+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.051499609+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.052245931+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:16.052302163+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.052333367+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [SecurityMode] to [SecurityMode]
2025-06-24T17:44:16.052337242+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Security Mode Complete
2025-06-24T17:44:16.052348597+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[SecurityMode Success], transition from [SecurityMode] to [ContextSetup]
2025-06-24T17:44:16.052389791+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle InitialRegistration
2025-06-24T17:44:16.052869152+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.061752496+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:44:16.063228038+08:00[36m [INFO][UDM][SDM] [0mHandle GetNssai
2025-06-24T17:44:16.065556167+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:44:16.065985754+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data |  |
2025-06-24T17:44:16.066185916+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/nssai?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:16.066643377+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.072908381+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=UDM |  |
2025-06-24T17:44:16.074284104+08:00[36m [INFO][UDM][UECM] [0mHandle RegisterAmfNon3gppAccessRequest
2025-06-24T17:44:16.075924468+08:00[36m [INFO][UDR][GIN] [0m| 204 |       127.0.0.1 | PUT     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/amf-non-3gpp-access |  |
2025-06-24T17:44:16.076099862+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | PUT     | /nudm-uecm/v1/imsi-2089300007487/registrations/amf-non-3gpp-access |  |
2025-06-24T17:44:16.076295749+08:00[36m [INFO][UDM][SDM] [0mHandle GetAmData
2025-06-24T17:44:16.076422933+08:00[36m [INFO][UDR][DataRepo] [0mQueryAmDataProcedure: ueId: imsi-2089300007487, servingPlmnId: 20893
2025-06-24T17:44:16.076802828+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/am-data?supported-features=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:16.076921276+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/am-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:16.077000503+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmfSelectData
2025-06-24T17:44:16.077484387+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/smf-selection-subscription-data |  |
2025-06-24T17:44:16.077653685+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/smf-select-data?plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:16.077917549+08:00[36m [INFO][UDM][SDM] [0mHandle GetUeContextInSmfData
2025-06-24T17:44:16.078523623+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/smf-registrations |  |
2025-06-24T17:44:16.078597158+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/ue-context-in-smf-data |  |
2025-06-24T17:44:16.079026937+08:00[36m [INFO][UDM][SDM] [0mHandle Subscribe
2025-06-24T17:44:16.079124327+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/subscription-data/imsi-2089300007487/context-data/sdm-subscriptions |  |
2025-06-24T17:44:16.079200898+08:00[36m [INFO][UDM][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudm-sdm/v1/imsi-2089300007487/sdm-subscriptions |  |
2025-06-24T17:44:16.079596655+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.084923993+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?preferred-locality=area1&requester-nf-type=AMF&supi=imsi-2089300007487&target-nf-type=PCF |  |
2025-06-24T17:44:16.086572241+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:44:16.087213371+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.090336953+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=UDR |  |
2025-06-24T17:44:16.091640187+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:44:16.092264370+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.104738875+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?guami=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22amfId%22%3A%22cafe00%22%7D&requester-nf-type=PCF&target-nf-type=AMF |  |
2025-06-24T17:44:16.106804550+08:00[36m [INFO][CPAF][Comm] [0mHandle AMF Status Change Subscribe Request
2025-06-24T17:44:16.106874644+08:00[36m [INFO][CPAF][Comm] [0mnew AMF Status Subscription[1]
2025-06-24T17:44:16.106890774+08:00[36m [INFO][CPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /namf-comm/v1/subscriptions |  |
2025-06-24T17:44:16.107222799+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:44:16.107363605+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Registration Accept
2025-06-24T17:44:16.107425021+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend Initial Context Setup Request
2025-06-24T17:44:16.108360745+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.108392466+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.108399305+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.108401888+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.108403925+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108407787+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.108420271+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.108422473+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.108429412+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108431146+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:44:16.108445302+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108448161+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:44:16.108449860+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:44:16.108454937+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.108456383+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108457911+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.108466203+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.108468784+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108470296+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.109616099+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.109633078+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.109639866+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109659687+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.109670737+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.109675126+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.109690142+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.109693002+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109695260+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109698720+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109702792+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109704994+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109707575+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.109709222+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1517: Get Authentication from N3IWF
2025-06-24T17:44:16.110050158+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle InitialContextSetupResponse
2025-06-24T17:44:16.110062573+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle InitialContextSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.110066428+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend Downlink Nas Transport
Security header type: Integrity Protected And Ciphered
cmac value: 0xe3106b4d
err <nil>
    non3gpp_test.go:1621: Get NAS Security Mode Command Message:
         (*nas.Message)(0xc000b79500)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc0000fd4a0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 42                                          |~.B|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(0xc000172e00)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			RegistrationAcceptMessageIdentity: (nasType.RegistrationAcceptMessageIdentity) {
        				Octet: (uint8) 66
        			},
        			RegistrationResult5GS: (nasType.RegistrationResult5GS) {
        				Iei: (uint8) 0,
        				Len: (uint8) 1,
        				Octet: (uint8) 2
        			},
        			GUTI5G: (*nasType.GUTI5G)(0xc000b7cf20)({
        				Iei: (uint8) 119,
        				Len: (uint16) 11,
        				Octet: ([11]uint8) (len=11 cap=11) {
        					00000000  f2 02 f8 39 ca fe 00 00  00 00 01                 |...9.......|
        				}
        			}),
        			EquivalentPlmns: (*nasType.EquivalentPlmns)(<nil>),
        			TAIList: (*nasType.TAIList)(0xc000b79520)({
        				Iei: (uint8) 84,
        				Len: (uint8) 7,
        				Buffer: ([]uint8) (len=7 cap=7) {
        					00000000  00 02 f8 39 00 00 01                              |...9...|
        				}
        			}),
        			AllowedNSSAI: (*nasType.AllowedNSSAI)(0xc000b79540)({
        				Iei: (uint8) 21,
        				Len: (uint8) 10,
        				Buffer: ([]uint8) (len=10 cap=10) {
        					00000000  04 01 11 22 33 04 01 01  02 03                    |..."3.....|
        				}
        			}),
        			RejectedNSSAI: (*nasType.RejectedNSSAI)(<nil>),
        			ConfiguredNSSAI: (*nasType.ConfiguredNSSAI)(<nil>),
        			NetworkFeatureSupport5GS: (*nasType.NetworkFeatureSupport5GS)(0xc000b7cf5b)({
        				Iei: (uint8) 33,
        				Len: (uint8) 1,
        				Octet: ([3]uint8) (len=3 cap=3) {
        					00000000  00 00 00                                          |...|
        				}
        			}),
        			PDUSessionStatus: (*nasType.PDUSessionStatus)(<nil>),
        			PDUSessionReactivationResult: (*nasType.PDUSessionReactivationResult)(<nil>),
        			PDUSessionReactivationResultErrorCause: (*nasType.PDUSessionReactivationResultErrorCause)(<nil>),
        			LADNInformation: (*nasType.LADNInformation)(<nil>),
        			MICOIndication: (*nasType.MICOIndication)(<nil>),
        			NetworkSlicingIndication: (*nasType.NetworkSlicingIndication)(<nil>),
        			ServiceAreaList: (*nasType.ServiceAreaList)(<nil>),
        			T3512Value: (*nasType.T3512Value)(<nil>),
        			Non3GppDeregistrationTimerValue: (*nasType.Non3GppDeregistrationTimerValue)(0xc000b7cf73)({
        				Iei: (uint8) 93,
        				Len: (uint8) 1,
        				Octet: (uint8) 0
        			}),
        			T3502Value: (*nasType.T3502Value)(<nil>),
        			EmergencyNumberList: (*nasType.EmergencyNumberList)(<nil>),
        			ExtendedEmergencyNumberList: (*nasType.ExtendedEmergencyNumberList)(<nil>),
        			SORTransparentContainer: (*nasType.SORTransparentContainer)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			NSSAIInclusionMode: (*nasType.NSSAIInclusionMode)(<nil>),
        			OperatordefinedAccessCategoryDefinitions: (*nasType.OperatordefinedAccessCategoryDefinitions)(<nil>),
        			NegotiatedDRXParameters: (*nasType.NegotiatedDRXParameters)(<nil>),
        			Non3GppNwPolicies: (*nasType.Non3GppNwPolicies)(<nil>),
        			EPSBearerContextStatus: (*nasType.EPSBearerContextStatus)(<nil>)
        		}),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(<nil>),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(<nil>)
        })
2025-06-24T17:44:16.111772198+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:16.111819863+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.111862566+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [ContextSetup] to [ContextSetup]
2025-06-24T17:44:16.111866614+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle Registration Complete
2025-06-24T17:44:16.111878215+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSend Configuration Update Command
2025-06-24T17:44:16.111882095+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend Downlink Nas Transport
2025-06-24T17:44:16.112086524+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[ContextSetup Success], transition from [ContextSetup] to [Registered]
2025-06-24T17:44:16.612888803+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:16.613059622+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.613259692+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:44:16.613395816+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:44:16.613556329+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:44:16.613622180+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:44:16.614885251+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.619461958+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AMF&target-nf-type=NSSF |  |
2025-06-24T17:44:16.620546692+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:44:16.620901225+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:44:16.620986746+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:44:16.621280376+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:44:16.622715054+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.628179645+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:16.632860543+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:44:16.632970722+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:44:16.633001413+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:44:16.633004146+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:44:16.634714673+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.642783667+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:44:16.643779842+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:44:16.644429278+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:44:16.644498488+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:44:16.645768479+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:16.646034123+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:16.646484626+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:44:16+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0008f3120 0xc0008f3140 0xc0008f3160]
2025-06-24T17:44:16.646524932+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:44:16.646534682+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0008f3120 0xc0008f3140 0xc0008f3160]}
2025-06-24T17:44:16.646546490+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:44:16.647164225+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.648899438+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&target-nf-type=AMF |  |
2025-06-24T17:44:16.649472053+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:44:16.649580912+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.1
2025-06-24T17:44:16.649596256+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:44:16.649604118+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.1]
2025-06-24T17:44:16.649626778+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:44:16.649635386+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:44:16.649642245+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:44:16.649649282+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:44:16.650485137+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:44:16.651182427+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.660995577+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=AUSF&service-names=npcf-am-policy-control&target-nf-type=PCF |  |
2025-06-24T17:44:16.662332440+08:00[36m [INFO][APCF][AmPol] [0mHandle AM Policy Create Request
2025-06-24T17:44:16.663236796+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/am-data |  |
2025-06-24T17:44:16.663376678+08:00[36m [INFO][APCF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-am-policy-control/v1/policies |  |
2025-06-24T17:44:16.663626041+08:00[36m [INFO][SDPAF][SmPolicy] [0mCreated new UE context for SUPI[imsi-2089300007487]
2025-06-24T17:44:16.664116637+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.667182834+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&service-names=nudr-dr&target-nf-type=UDR |  |
2025-06-24T17:44:16.668782984+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:16.673167338+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:44:16.673302643+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:44:16.673514651+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:44:16.673876185+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.674445348+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:44:16.675220227+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:44:16.675837605+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[1]
2025-06-24T17:44:16.676795962+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.679621482+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:44:16.679874317+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:44:16.680958997+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:44:16.681040885+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:44:16.681049136+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:44:16.681051415+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:44:16.681053172+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:44:16.681199404+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:44:16.681411206+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:44:16.681487005+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:44:16.681503726+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:16.681532976+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:44:16.681543749+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:16.681568037+08:00[36m [INFO][SMF][PduSess][pdu_session_id:1][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:44:16.681671396+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:44:16.681772030+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:44:16.682175148+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 1] Success
2025-06-24T17:44:16.689558043+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:44:16.690942481+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:44:16.691022327+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend PDU Session Resource Setup Request
2025-06-24T17:44:16.691174124+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:44:16.696303005+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.696387384+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.696393512+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1668: IKE message exchange type: 36
    non3gpp_test.go:1669: IKE message ID: 0
2025-06-24T17:44:16.696437634+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.696439469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.696441409+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.696481231+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.696484670+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696490319+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696493811+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696496579+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696498599+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696500583+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:1696: Received Qos Flow settings
    non3gpp_test.go:1699: NotificationData:[6 1 2 1 3 2]
    non3gpp_test.go:1709: UP IP Address: 10.0.0.1
2025-06-24T17:44:16.696633283+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.696639659+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.696642608+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.696645591+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.696660560+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.696668236+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.696669960+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.696672347+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.696695643+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.696736338+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.696740390+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
Security header type: Integrity Protected And Ciphered
cmac value: 0xa2a5e45a
err <nil>
    non3gpp_test.go:1801: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cbc480)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d0c1e0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000ca4730)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 01 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 01  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000716594)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 1
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cba3f0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 01 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cbe180)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 1
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0007165c0)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 01 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0007165d0)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000cbc4a0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000cbc4c0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000cbc4e0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:1807: PDU Address: 10.60.0.1
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1840: 2 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:44:16.796723008+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:44:16.796802310+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.797599812+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:44:16.799239877+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:44:16.799334242+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:0c4a11f7-0ca7-4d64-b74f-33a833a8e355/modify |  |
2025-06-24T17:44:16.800336887+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:16.800390833+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.800423410+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:44:16.800427949+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:44:16.800431010+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:44:16.800436463+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:44:16.803855907+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:44:16.804305375+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:44:16.804479320+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:44:16.804951798+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:44:16.806097040+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.812421065+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:16.813612868+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:44:16.813786258+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:44:16.813812008+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:44:16.813849546+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:44:16.814776736+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.821776384+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:44:16.822452687+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:44:16.823157033+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:44:16.823255997+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:44:16.824623671+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:16.824819163+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:16.824888737+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:44:16+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc0019a7740 0xc0019a7760 0xc0019a7780]
2025-06-24T17:44:16.824944395+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:44:16.824952538+08:00[36m [INFO][SMF][GSM] [0m&{[0xc0019a7740 0xc0019a7760 0xc0019a7780]}
2025-06-24T17:44:16.824954594+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:44:16.825584099+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.827433417+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&target-nf-type=AMF |  |
2025-06-24T17:44:16.828217660+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:44:16.828415924+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.2
2025-06-24T17:44:16.828557078+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:44:16.828611965+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.2]
2025-06-24T17:44:16.828624038+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:44:16.828629113+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:44:16.828631526+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:44:16.828636150+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:44:16.829066985+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:44:16.830795570+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:16.840073840+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:44:16.840467770+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:44:16.840849370+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:44:16.841348638+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.842014738+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:44:16.842640610+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:44:16.842746337+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[2]
2025-06-24T17:44:16.842798864+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:16.845321168+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:44:16.845528723+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:44:16.846220016+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:44:16.846299317+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:44:16.846307106+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:44:16.846309302+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:44:16.846311101+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:44:16.846324343+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:44:16.846825792+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:44:16.846954842+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:44:16.847003311+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:16.847033660+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:44:16.847038083+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:16.847058202+08:00[36m [INFO][SMF][PduSess][pdu_session_id:2][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:44:16.847156450+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:44:16.847199713+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:44:16.847459641+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 2] Success
2025-06-24T17:44:16.853416346+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:44:16.860332118+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:44:16.860357884+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend PDU Session Resource Setup Request
2025-06-24T17:44:16.860516155+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:44:16.861274857+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.861418069+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.861461864+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 1
2025-06-24T17:44:16.861567436+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.861573796+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.861575925+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.861608709+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.861611977+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.861615594+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.861617757+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.861619998+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.861622021+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.861623736+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 2 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:44:16.861654935+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.861656750+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.861659141+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.861661009+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.861664158+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.861668606+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.861670107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.861671682+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.861681063+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.861683104+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.861684498+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000ac2b210f
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0xf7f94da7f190644acacf2edb54047978395c1aa4b1d81cc2197a2360ed9318cf
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x406b88724a7a504c0ec83850edfcef91ace686d8
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000cea39d2d
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x5d69d05d6c50b290c64dd258e2f042db8037cda07f1820159176db8bae48d4b1
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0xb1c5c8f68cdc4d5e7e66cc4eaefe3903e4f2ef05
    non3gpp_test.go:903: State function: encr: 12, auth: 2
2025-06-24T17:44:16.867221951+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:44:16.867250189+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:44:16.871229201+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:924: Setup XFRM interface ipsec-2 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xdc68adf8
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cbd160)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d0c4b0)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000ca50e0)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 02 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 02  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc00063190c)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 2
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cba5a0)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 02 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cbe880)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 2
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000631940)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 02 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000631950)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000cbd180)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000cbd1a0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000cbd1c0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.2
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 3 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:44:16.879601531+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:44:16.880420521+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:080067d3-1d45-40d4-8671-68d3424de4ae/modify |  |
2025-06-24T17:44:17.073332504+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:17.073398010+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:17.073458635+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:44:17.073463792+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:44:17.073467023+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:44:17.073473669+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:44:17.074439770+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:44:17.074554834+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:44:17.074595362+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:44:17.075007698+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:44:17.076180417+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.085305936+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:17.087274451+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:44:17.087526367+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:44:17.087593972+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:44:17.087599447+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:44:17.088407880+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.094811824+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:44:17.095510432+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:44:17.096294145+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:44:17.096317607+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:44:17.097575464+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:17.097836116+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:17.098054990+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:44:17+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc001892660 0xc001892680 0xc0018926a0]
2025-06-24T17:44:17.098095088+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:44:17.098103750+08:00[36m [INFO][SMF][GSM] [0m&{[0xc001892660 0xc001892680 0xc0018926a0]}
2025-06-24T17:44:17.098110472+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:44:17.098362806+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.099177936+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&target-nf-type=AMF |  |
2025-06-24T17:44:17.099461768+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:44:17.099552986+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.3
2025-06-24T17:44:17.099620078+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:44:17.099625855+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.3]
2025-06-24T17:44:17.099630152+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:44:17.099633780+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:44:17.099635722+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:44:17.099639064+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:44:17.100126947+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:44:17.101201117+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:17.103767913+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:44:17.103894918+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:44:17.104234367+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:44:17.105024470+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.105631435+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:44:17.105739717+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:44:17.105928521+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[3]
2025-06-24T17:44:17.106021896+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.109088619+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:44:17.109807428+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:44:17.110701290+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:44:17.110751252+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:44:17.110758545+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:44:17.110762363+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:44:17.110764277+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:44:17.110776639+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:44:17.110943150+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:44:17.111049415+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:44:17.111072885+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:17.111105243+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:44:17.111116828+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:17.111153139+08:00[36m [INFO][SMF][PduSess][pdu_session_id:3][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:44:17.111182649+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:44:17.111221631+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:44:17.111816960+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 3] Success
2025-06-24T17:44:17.117621770+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:44:17.118976548+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:44:17.119038847+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend PDU Session Resource Setup Request
2025-06-24T17:44:17.119242788+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:44:17.122409702+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:17.122471999+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.122478398+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 2
2025-06-24T17:44:17.122507100+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.122509314+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122511253+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.122537191+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.122575967+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.122583715+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.122588662+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.122591200+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.122593301+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.122595119+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 3 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:44:17.122629816+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122666125+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:17.122671493+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.122673832+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.122676546+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:17.122692953+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.122695991+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122697856+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.122710901+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.122883615+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122918716+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x00000000464e91b0
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x0de05b9e6583fa5315f7b4381b4e42a4741715afe5939787ea6b7d817f0a610f
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0xc932f949b35db6009bcb6279e603661c17469173
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x00000000809f40da
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0x33c187128e098d9ded488a9766e0580ccbbd0d19e8488637f3948a9777fdbc60
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x5a888627ccdaeac674a56a595874fce4704bca9b
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-3 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xde12cd5b
err <nil>
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc000cbde60)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d0c780)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc000ca5a90)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 03 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 03  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc000015edc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 3
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cba750)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 03 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cbef80)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 3
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc000015f00)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 03 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc000015f10)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc000cbde80)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc000cbdea0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc000cbdec0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.3
    non3gpp_test.go:152: GRE Key Field: 0x1000000
    non3gpp_test.go:1844: Create 2 interfaces
    non3gpp_test.go:1840: 4 times PDU Session Est Request Start
    non3gpp_test.go:748: Waiting for N3IWF reply from IKE
2025-06-24T17:44:17.240159949+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:44:17.240354196+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
2025-06-24T17:44:17.241344249+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
2025-06-24T17:44:17.244286727+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:44:17.244354011+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:14e7772f-1add-42e9-ae62-3b2aaba63cec/modify |  |
2025-06-24T17:44:17.244793226+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport
2025-06-24T17:44:17.244853645+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle UplinkNASTransport (RAN UE NGAP ID: 0)
2025-06-24T17:44:17.244899968+08:00[36m [INFO][CPAF][Gmm] [0mHandle event[Gmm Message], transition from [Registered] to [Registered]
2025-06-24T17:44:17.244903964+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mHandle UL NAS Transport
2025-06-24T17:44:17.244907246+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mTransport 5GSM Message to SMF
2025-06-24T17:44:17.244913347+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mSelect SMF [snssai: {Sst:1 Sd:fedcba}, dnn: internet]
2025-06-24T17:44:17.245667577+08:00[36m [INFO][NSSF][NsSel] [0mHandle NSSelectionGet
2025-06-24T17:44:17.245760450+08:00[33m [WARN][NSSF][Util] [0mNo TA {"plmnId":{"mcc":"208","mnc":"93"},"tac":"000001"} in NSSF configuration
2025-06-24T17:44:17.245775403+08:00[36m [INFO][NSSF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnssf-nsselection/v1/network-slice-information?nf-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&nf-type=AMF&slice-info-request-for-pdu-session=%7B%22sNssai%22%3A%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D%2C%22roamingIndication%22%3A%22NON_ROAMING%22%7D&tai=%7B%22plmnId%22%3A%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D%2C%22tac%22%3A%22000001%22%7D |  |
2025-06-24T17:44:17.246067525+08:00[33m [WARN][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mnsiInformation is still nil, use default NRF[http://127.0.0.10:8000]
2025-06-24T17:44:17.246543125+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.255807895+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?dnn=internet&preferred-locality=area1&requester-nf-type=AMF&service-names=nsmf-pdusession&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&target-nf-type=SMF&target-plmn-list=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D |  |
2025-06-24T17:44:17.258339586+08:00[36m [INFO][SMF][PduSess] [0mReceive Create SM Context Request
2025-06-24T17:44:17.258467421+08:00[36m [INFO][SMF][PduSess] [0mIn HandlePDUSessionSMContextCreate
2025-06-24T17:44:17.258551153+08:00[36m [INFO][SMF][CTX] [0mUrrPeriod: 30s
2025-06-24T17:44:17.258556512+08:00[36m [INFO][SMF][CTX] [0mUrrThreshold: 10000
2025-06-24T17:44:17.259084102+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.265560659+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=UDM |  |
2025-06-24T17:44:17.266357522+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mSend NF Discovery Serving UDM Successfully
2025-06-24T17:44:17.266954217+08:00[36m [INFO][UDM][SDM] [0mHandle GetSmData
2025-06-24T17:44:17.267021117+08:00[36m [INFO][UDM][SDM] [0mgetSmDataProcedure: SUPI[imsi-2089300007487] PLMNID[20893] DNN[internet] SNssai[{"sst":1,"sd":"fedcba"}]
2025-06-24T17:44:17.268698987+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/subscription-data/imsi-2089300007487/20893/provisioned-data/sm-data?single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:17.268906065+08:00[36m [INFO][UDM][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudm-sdm/v1/imsi-2089300007487/sm-data?dnn=internet&plmn-id=%7B%22mcc%22%3A%22208%22%2C%22mnc%22%3A%2293%22%7D&single-nssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:17.269260881+08:00[36m [INFO][SMF][GSM] [0mIn HandlePDUSessionEstablishmentRequest
2025-06-24T17:44:17+08:00[36m [INFO][NAS][Convert] [0mProtocolOrContainerList:  [0xc00143e180 0xc00143e1a0 0xc00143e1c0]
2025-06-24T17:44:17.269302819+08:00[36m [INFO][SMF][GSM] [0mProtocol Configuration Options
2025-06-24T17:44:17.269311516+08:00[36m [INFO][SMF][GSM] [0m&{[0xc00143e180 0xc00143e1a0 0xc00143e1c0]}
2025-06-24T17:44:17.269318126+08:00[36m [INFO][SMF][GSM] [0mDidn't Implement container type IPAddressAllocationViaNASSignallingUL
2025-06-24T17:44:17.269757538+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.270934055+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-instance-id=c4a81613-c84d-4951-abbc-7bc76d46f86f&target-nf-type=AMF |  |
2025-06-24T17:44:17.271347105+08:00[36m [INFO][SMF][Consumer] [0mSendNFDiscoveryServingAMF ok
2025-06-24T17:44:17.271398723+08:00[36m [INFO][SMF][CTX] [0mAllocated UE IP address: 10.60.0.4
2025-06-24T17:44:17.271457193+08:00[36m [INFO][SMF][CTX] [0mSelected UPF: UPF
2025-06-24T17:44:17.271463355+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mAllocated PDUAdress[10.60.0.4]
2025-06-24T17:44:17.271480766+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting PCF Selection for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:44:17.271484251+08:00[36m [INFO][SMF][CTX] [0mSelected SDPAF as PCF: sdpaf-instance-1
2025-06-24T17:44:17.271486181+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mPCF Selection successful for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:44:17.271488534+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mStarting SM Policy Association Create for SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:44:17.272110984+08:00[36m [INFO][SDPAF][SmPolicy] [0mHandle CreateSmPolicy
2025-06-24T17:44:17.273299324+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/policy-data/ues/imsi-2089300007487/sm-data?dnn=internet&snssai=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D |  |
2025-06-24T17:44:17.275902717+08:00[36m [INFO][UDR][GIN] [0m| 200 |       127.0.0.1 | GET     | /nudr-dr/v1/application-data/influenceData?dnns=internet&internal-Group-Ids=&snssais=%7B%22sst%22%3A1%2C%22sd%22%3A%22fedcba%22%7D&supis=imsi-2089300007487 |  |
2025-06-24T17:44:17.276196030+08:00[36m [INFO][SDPAF][SmPolicy] [0mMatched [0] trafficInfluDatas from UDR
2025-06-24T17:44:17.276291878+08:00[36m [INFO][UDR][GIN] [0m| 201 |       127.0.0.1 | POST    | /nudr-dr/v1/application-data/influenceData/subs-to-notify |  |
2025-06-24T17:44:17.276810937+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.277183149+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=PCF&target-nf-type=BSF |  |
2025-06-24T17:44:17.277309213+08:00[36m [INFO][SDPAF][GIN] [0m| 201 |       127.0.0.1 | POST    | /npcf-smpolicycontrol/v1/sm-policies |  |
2025-06-24T17:44:17.277556139+08:00[36m [INFO][SMF][PduSess] [0mCHF Selection for SMContext SUPI[imsi-2089300007487] PDUSessionID[4]
2025-06-24T17:44:17.277834420+08:00[36m [INFO][NRF][DISC] [0mHandle NFDiscoveryRequest
2025-06-24T17:44:17.280422410+08:00[36m [INFO][NRF][GIN] [0m| 200 |       127.0.0.1 | GET     | /nnrf-disc/v1/nf-instances?requester-nf-type=SMF&target-nf-type=CHF |  |
2025-06-24T17:44:17.281484863+08:00[36m [INFO][SMF][Charging] [0mHandle SendConvergedChargingRequest
2025-06-24T17:44:17.283331533+08:00[36m [INFO][CHF][ChargingPost] [0mHandleChargingdataInitial
2025-06-24T17:44:17.283365584+08:00[36m [INFO][CHF][ChargingPost] [0mSMF charging event
2025-06-24T17:44:17.283377729+08:00[33m [WARN][CHF][CFG] [0mCGF Not enable: SendCDR() didn't do anything.
2025-06-24T17:44:17.283385272+08:00[36m [INFO][CHF][ChargingPost] [0mOpen CDR for UE imsi-2089300007487
2025-06-24T17:44:17.283391652+08:00[36m [INFO][CHF][ChargingPost] [0mNewChfUe imsi-2089300007487
2025-06-24T17:44:17.283407844+08:00[36m [INFO][CHF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nchf-convergedcharging/v3/chargingdata |  |
2025-06-24T17:44:17.283905345+08:00[36m [INFO][SMF][Charging] [0mSend Charging Data Request[Init] successfully
2025-06-24T17:44:17.284026173+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-1]
2025-06-24T17:44:17.284034595+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:17.284057430+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mInstall PCCRule[PccRuleId-2]
2025-06-24T17:44:17.284100210+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mNo srcTcData and tgtTcData. Nothing to do
2025-06-24T17:44:17.284156841+08:00[36m [INFO][SMF][PduSess][pdu_session_id:4][supi:imsi-2089300007487] [0mHas no pre-config route. Has default path
2025-06-24T17:44:17.284221022+08:00[36m [INFO][SMF][GIN] [0m| 201 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts |  |
2025-06-24T17:44:17.284307908+08:00[36m [INFO][SMF][PduSess] [0mSending PFCP Session Establishment Request
2025-06-24T17:44:17.284447397+08:00[36m [INFO][CPAF][Gmm][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][supi:SUPI:imsi-2089300007487] [0mcreate smContext[pduSessionID: 4] Success
2025-06-24T17:44:17.292840478+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Establishment Accepted Response
2025-06-24T17:44:17.293738994+08:00[36m [INFO][CPAF][Producer] [0mHandle N1N2 Message Transfer Request
2025-06-24T17:44:17.293822347+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mSend PDU Session Resource Setup Request
2025-06-24T17:44:17.295470171+08:00[36m [INFO][CPAF][GIN] [0m| 200 |       127.0.0.1 | POST    | /namf-comm/v1/ue-contexts/imsi-2089300007487/n1-n2-messages |  |
2025-06-24T17:44:17.296977638+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:17.297036969+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.297046418+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:762: IKE message exchange type: 36
    non3gpp_test.go:763: IKE message ID: 3
2025-06-24T17:44:17.297071845+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.297073800+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.297075505+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.297105410+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.297107972+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297119609+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297124259+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297128345+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297131510+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297134619+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] unmarshal(): Start unmarshalling received bytes
    non3gpp_test.go:793: Received Qos Flow settings
    non3gpp_test.go:796: NotificationData:[6 4 2 1 3 2]
    non3gpp_test.go:806: UP IP Address: 10.0.0.1
2025-06-24T17:44:17.297224140+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.297264240+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:17.297269683+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.297271727+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.297273755+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:17.297283142+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.297285869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.297287405+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.297297291+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.297298869+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.297300414+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
    non3gpp_test.go:886: ====== IPSec/Child SA for 3GPP UP Inbound =====
    non3gpp_test.go:887: [UE:192.168.127.2] <- [N3IWF:192.168.127.1]
    non3gpp_test.go:889: IPSec SPI: 0x000000004fe14448
    non3gpp_test.go:890: IPSec Encryption Algorithm: 12
    non3gpp_test.go:891: IPSec Encryption Key: 0x1a7d6bf868d557c3d4abb09924bffc8564eb9c07335f71ffa761b1297d69b73c
    non3gpp_test.go:892: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:893: IPSec Integrity  Key: 0x5d9bd32d5c25c506a5803e5f3c7e15c33fcbe77a
    non3gpp_test.go:895: ====== IPSec/Child SA for 3GPP UP Outbound =====
    non3gpp_test.go:896: [UE:192.168.127.2] -> [N3IWF:192.168.127.1]
    non3gpp_test.go:898: IPSec SPI: 0x0000000053c40027
    non3gpp_test.go:899: IPSec Encryption Algorithm: 12
    non3gpp_test.go:900: IPSec Encryption Key: 0xe3b3cc6125a9d0844978ad948e6b51f2377eb9ce5ebb7804291a0782f6cbe68b
    non3gpp_test.go:901: IPSec Integrity  Algorithm: 2
    non3gpp_test.go:902: IPSec Integrity  Key: 0x1708e46ed25bfa1008d4069b4f41521243ed973e
    non3gpp_test.go:903: State function: encr: 12, auth: 2
    non3gpp_test.go:924: Setup XFRM interface ipsec-4 successfully
Security header type: Integrity Protected And Ciphered
cmac value: 0xac81265e
err <nil>
2025-06-24T17:44:17.304497535+08:00[36m [INFO][CPAF][Ngap][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse
2025-06-24T17:44:17.304529786+08:00[36m [INFO][CPAF][Ngap][amf_ue_ngap_id:RU:0,AU:1(Non3GPP)][ran_addr:10.200.200.1/10.0.2.15/192.168.56.101/10.60.0.1/10.200.200.2/192.168.127.1/10.0.0.1:38271] [0mHandle PDUSessionResourceSetupResponse (RAN UE NGAP ID: 0)
    non3gpp_test.go:938: Dump DecodePDUSessionEstablishmentAccept:
         (*nas.Message)(0xc00072ab80)({
        	SecurityHeader: (nas.SecurityHeader) {
        		ProtocolDiscriminator: (uint8) 0,
        		SecurityHeaderType: (uint8) 2,
        		MessageAuthenticationCode: (uint32) 0,
        		SequenceNumber: (uint8) 0
        	},
        	GmmMessage: (*nas.GmmMessage)(0xc000d0ca50)({
        		GmmHeader: (nas.GmmHeader) {
        			Octet: ([3]uint8) (len=3 cap=3) {
        				00000000  7e 00 68                                          |~.h|
        			}
        		},
        		AuthenticationRequest: (*nasMessage.AuthenticationRequest)(<nil>),
        		AuthenticationResponse: (*nasMessage.AuthenticationResponse)(<nil>),
        		AuthenticationResult: (*nasMessage.AuthenticationResult)(<nil>),
        		AuthenticationFailure: (*nasMessage.AuthenticationFailure)(<nil>),
        		AuthenticationReject: (*nasMessage.AuthenticationReject)(<nil>),
        		RegistrationRequest: (*nasMessage.RegistrationRequest)(<nil>),
        		RegistrationAccept: (*nasMessage.RegistrationAccept)(<nil>),
        		RegistrationComplete: (*nasMessage.RegistrationComplete)(<nil>),
        		RegistrationReject: (*nasMessage.RegistrationReject)(<nil>),
        		ULNASTransport: (*nasMessage.ULNASTransport)(<nil>),
        		DLNASTransport: (*nasMessage.DLNASTransport)(0xc00072c460)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 126
        			},
        			SpareHalfOctetAndSecurityHeaderType: (nasType.SpareHalfOctetAndSecurityHeaderType) {
        				Octet: (uint8) 0
        			},
        			DLNASTRANSPORTMessageIdentity: (nasType.DLNASTRANSPORTMessageIdentity) {
        				Octet: (uint8) 104
        			},
        			SpareHalfOctetAndPayloadContainerType: (nasType.SpareHalfOctetAndPayloadContainerType) {
        				Octet: (uint8) 1
        			},
        			PayloadContainer: (nasType.PayloadContainer) {
        				Iei: (uint8) 0,
        				Len: (uint16) 118,
        				Buffer: ([]uint8) (len=118 cap=118) {
        					00000000  2e 04 00 c2 11 00 23 01  00 06 31 31 01 01 ff 01  |......#...11....|
        					00000010  01 00 06 21 11 01 01 ff  02 02 00 0e 21 12 09 10  |...!........!...|
        					00000020  09 09 09 09 ff ff ff ff  80 03 06 01 03 e8 01 03  |................|
        					00000030  e8 29 05 01 0a 3c 00 04  22 04 01 fe dc ba 79 00  |.)...<..".....y.|
        					00000040  0c 01 20 41 01 01 09 03  20 41 01 01 08 7b 00 1b  |.. A.... A...{..|
        					00000050  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000060  60 00 00 00 00 00 00 00  00 88 88 25 09 08 69 6e  |`..........%..in|
        					00000070  74 65 72 6e 65 74                                 |ternet|
        				}
        			},
        			PduSessionID2Value: (*nasType.PduSessionID2Value)(0xc0004a1cfc)({
        				Iei: (uint8) 18,
        				Octet: (uint8) 4
        			}),
        			AdditionalInformation: (*nasType.AdditionalInformation)(<nil>),
        			Cause5GMM: (*nasType.Cause5GMM)(<nil>),
        			BackoffTimerValue: (*nasType.BackoffTimerValue)(<nil>)
        		}),
        		DeregistrationRequestUEOriginatingDeregistration: (*nasMessage.DeregistrationRequestUEOriginatingDeregistration)(<nil>),
        		DeregistrationAcceptUEOriginatingDeregistration: (*nasMessage.DeregistrationAcceptUEOriginatingDeregistration)(<nil>),
        		DeregistrationRequestUETerminatedDeregistration: (*nasMessage.DeregistrationRequestUETerminatedDeregistration)(<nil>),
        		DeregistrationAcceptUETerminatedDeregistration: (*nasMessage.DeregistrationAcceptUETerminatedDeregistration)(<nil>),
        		ServiceRequest: (*nasMessage.ServiceRequest)(<nil>),
        		ServiceAccept: (*nasMessage.ServiceAccept)(<nil>),
        		ServiceReject: (*nasMessage.ServiceReject)(<nil>),
        		ConfigurationUpdateCommand: (*nasMessage.ConfigurationUpdateCommand)(<nil>),
        		ConfigurationUpdateComplete: (*nasMessage.ConfigurationUpdateComplete)(<nil>),
        		IdentityRequest: (*nasMessage.IdentityRequest)(<nil>),
        		IdentityResponse: (*nasMessage.IdentityResponse)(<nil>),
        		Notification: (*nasMessage.Notification)(<nil>),
        		NotificationResponse: (*nasMessage.NotificationResponse)(<nil>),
        		SecurityModeCommand: (*nasMessage.SecurityModeCommand)(<nil>),
        		SecurityModeComplete: (*nasMessage.SecurityModeComplete)(<nil>),
        		SecurityModeReject: (*nasMessage.SecurityModeReject)(<nil>),
        		SecurityProtected5GSNASMessage: (*nasMessage.SecurityProtected5GSNASMessage)(<nil>),
        		Status5GMM: (*nasMessage.Status5GMM)(<nil>)
        	}),
        	GsmMessage: (*nas.GsmMessage)(0xc000cba900)({
        		GsmHeader: (nas.GsmHeader) {
        			Octet: ([4]uint8) (len=4 cap=4) {
        				00000000  2e 04 00 c2                                       |....|
        			}
        		},
        		PDUSessionEstablishmentRequest: (*nasMessage.PDUSessionEstablishmentRequest)(<nil>),
        		PDUSessionEstablishmentAccept: (*nasMessage.PDUSessionEstablishmentAccept)(0xc000cbf680)({
        			ExtendedProtocolDiscriminator: (nasType.ExtendedProtocolDiscriminator) {
        				Octet: (uint8) 46
        			},
        			PDUSessionID: (nasType.PDUSessionID) {
        				Octet: (uint8) 4
        			},
        			PTI: (nasType.PTI) {
        				Octet: (uint8) 0
        			},
        			PDUSESSIONESTABLISHMENTACCEPTMessageIdentity: (nasType.PDUSESSIONESTABLISHMENTACCEPTMessageIdentity) {
        				Octet: (uint8) 194
        			},
        			SelectedSSCModeAndSelectedPDUSessionType: (nasType.SelectedSSCModeAndSelectedPDUSessionType) {
        				Octet: (uint8) 17
        			},
        			AuthorizedQosRules: (nasType.AuthorizedQosRules) {
        				Iei: (uint8) 0,
        				Len: (uint16) 35,
        				Buffer: ([]uint8) (len=35 cap=35) {
        					00000000  01 00 06 31 31 01 01 ff  01 01 00 06 21 11 01 01  |...11.......!...|
        					00000010  ff 02 02 00 0e 21 12 09  10 09 09 09 09 ff ff ff  |.....!..........|
        					00000020  ff 80 03                                          |...|
        				}
        			},
        			SessionAMBR: (nasType.SessionAMBR) {
        				Iei: (uint8) 0,
        				Len: (uint8) 6,
        				Octet: ([6]uint8) (len=6 cap=6) {
        					00000000  01 03 e8 01 03 e8                                 |......|
        				}
        			},
        			Cause5GSM: (*nasType.Cause5GSM)(<nil>),
        			PDUAddress: (*nasType.PDUAddress)(0xc0004a1d40)({
        				Iei: (uint8) 41,
        				Len: (uint8) 5,
        				Octet: ([13]uint8) (len=13 cap=13) {
        					00000000  01 0a 3c 00 04 00 00 00  00 00 00 00 00           |..<..........|
        				}
        			}),
        			RQTimerValue: (*nasType.RQTimerValue)(<nil>),
        			SNSSAI: (*nasType.SNSSAI)(0xc0004a1d90)({
        				Iei: (uint8) 34,
        				Len: (uint8) 4,
        				Octet: ([8]uint8) (len=8 cap=8) {
        					00000000  01 fe dc ba 00 00 00 00                           |........|
        				}
        			}),
        			AlwaysonPDUSessionIndication: (*nasType.AlwaysonPDUSessionIndication)(<nil>),
        			MappedEPSBearerContexts: (*nasType.MappedEPSBearerContexts)(<nil>),
        			EAPMessage: (*nasType.EAPMessage)(<nil>),
        			AuthorizedQosFlowDescriptions: (*nasType.AuthorizedQosFlowDescriptions)(0xc00072aba0)({
        				Iei: (uint8) 121,
        				Len: (uint16) 12,
        				Buffer: ([]uint8) (len=12 cap=12) {
        					00000000  01 20 41 01 01 09 03 20  41 01 01 08              |. A.... A...|
        				}
        			}),
        			ExtendedProtocolConfigurationOptions: (*nasType.ExtendedProtocolConfigurationOptions)(0xc00072abc0)({
        				Iei: (uint8) 123,
        				Len: (uint16) 27,
        				Buffer: ([]uint8) (len=27 cap=27) {
        					00000000  80 00 0d 04 08 08 08 08  00 03 10 20 01 48 60 48  |........... .H`H|
        					00000010  60 00 00 00 00 00 00 00  00 88 88                 |`..........|
        				}
        			}),
        			DNN: (*nasType.DNN)(0xc00072abe0)({
        				Iei: (uint8) 37,
        				Len: (uint8) 9,
        				Buffer: ([]uint8) (len=9 cap=9) {
        					00000000  08 69 6e 74 65 72 6e 65  74                       |.internet|
        				}
        			})
        		}),
        		PDUSessionEstablishmentReject: (*nasMessage.PDUSessionEstablishmentReject)(<nil>),
        		PDUSessionAuthenticationCommand: (*nasMessage.PDUSessionAuthenticationCommand)(<nil>),
        		PDUSessionAuthenticationComplete: (*nasMessage.PDUSessionAuthenticationComplete)(<nil>),
        		PDUSessionAuthenticationResult: (*nasMessage.PDUSessionAuthenticationResult)(<nil>),
        		PDUSessionModificationRequest: (*nasMessage.PDUSessionModificationRequest)(<nil>),
        		PDUSessionModificationReject: (*nasMessage.PDUSessionModificationReject)(<nil>),
        		PDUSessionModificationCommand: (*nasMessage.PDUSessionModificationCommand)(<nil>),
        		PDUSessionModificationComplete: (*nasMessage.PDUSessionModificationComplete)(<nil>),
        		PDUSessionModificationCommandReject: (*nasMessage.PDUSessionModificationCommandReject)(<nil>),
        		PDUSessionReleaseRequest: (*nasMessage.PDUSessionReleaseRequest)(<nil>),
        		PDUSessionReleaseReject: (*nasMessage.PDUSessionReleaseReject)(<nil>),
        		PDUSessionReleaseCommand: (*nasMessage.PDUSessionReleaseCommand)(<nil>),
        		PDUSessionReleaseComplete: (*nasMessage.PDUSessionReleaseComplete)(<nil>),
        		Status5GSM: (*nasMessage.Status5GSM)(<nil>)
        	})
        })
        
    non3gpp_test.go:945: PDU Address: 10.60.0.4
    non3gpp_test.go:152: GRE Key Field: 0x1000000
2025-06-24T17:44:17.305731000+08:00[36m [INFO][SMF][PduSess] [0mReceive Update SM Context Request
    non3gpp_test.go:1844: Create 2 interfaces
2025-06-24T17:44:17.308281672+08:00[36m [INFO][SMF][PduSess] [0mReceived PFCP Session Modification Accepted Response from AN UPF
2025-06-24T17:44:17.308325121+08:00[36m [INFO][SMF][GIN] [0m| 200 |       127.0.0.1 | POST    | /nsmf-pdusession/v1/sm-contexts/urn:uuid:f3cb0020-f462-43c7-8e0d-f432b8ffc432/modify |  |
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=0 time=658.168µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=1 time=725.174µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=2 time=495.061µs
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=3 time=1.059216ms
    non3gpp_test.go:1869: 32 bytes from 10.60.0.101: icmp_seq=4 time=704.892µs
    non3gpp_test.go:1873: 
        --- 10.60.0.101 ping statistics ---
    non3gpp_test.go:1874: 5 packets transmitted, 5 packets received, 0% packet loss
    non3gpp_test.go:1876: round-trip min/avg/max/stddev = 495.061µs/728.503µs/1.059216ms/184.055µs
    non3gpp_test.go:1852: Delete interface: ipsec-4
    non3gpp_test.go:1852: Delete interface: gretun-id-4
    non3gpp_test.go:1852: Delete interface: ipsec-3
    non3gpp_test.go:1852: Delete interface: gretun-id-3
    non3gpp_test.go:1852: Delete interface: ipsec-2
    non3gpp_test.go:1852: Delete interface: gretun-id-2
    non3gpp_test.go:1820: Delete interface: gretun-id-1
    non3gpp_test.go:1580: Delete XFRM interface: ipsec-default
--- PASS: TestNon3GPPUE (9.85s)
PASS
ok  	test	9.887s
SCTPConn: SCTPWrite failed bad file descriptor
--- PASS: TestCN (25.47s)
PASS
ok  	test	28.355s

--- STDERR ---
2025-06-24T17:43:57.327845739+08:00[36m [INFO][UPF][Main] [0mUPF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:43:57.330557427+08:00[36m [INFO][UPF][CFG] [0mRead config from [./config/upfcfg.test.yaml]
2025-06-24T17:43:57.331708967+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:43:57.331870702+08:00[36m [INFO][UPF][CFG] [0m(*factory.Config)(0xc00009d720)({
	Version: (string) (len=5) "1.0.3",
	Description: (string) (len=31) "UPF initial local configuration",
	Pfcp: (*factory.Pfcp)(0xc00058e6f0)({
		Addr: (string) (len=14) "10.200.200.101",
		NodeID: (string) (len=14) "10.200.200.101",
		RetransTimeout: (time.Duration) 1s,
		MaxRetrans: (uint8) 3
	}),
	Gtpu: (*factory.Gtpu)(0xc00058e8a0)({
		Forwarder: (string) (len=5) "gtp5g",
		IfList: ([]factory.IfInfo) (len=1 cap=1) {
			(factory.IfInfo) {
				Addr: (string) (len=14) "10.200.200.102",
				Type: (string) (len=2) "N3",
				Name: (string) "",
				IfName: (string) "",
				MTU: (uint32) 0
			}
		}
	}),
	DnnList: ([]factory.DnnList) (len=1 cap=1) {
		(factory.DnnList) {
			Dnn: (string) (len=8) "internet",
			Cidr: (string) (len=12) "10.60.0.0/16",
			NatIfName: (string) ""
		}
	},
	Logger: (*factory.Logger)(0xc00058c580)({
		Enable: (bool) true,
		Level: (string) (len=4) "info",
		ReportCaller: (bool) false
	})
})
2025-06-24T17:43:57.331875800+08:00[36m [INFO][UPF][CFG] [0m==================================================
2025-06-24T17:43:57.331878285+08:00[36m [INFO][UPF][Main] [0mLog level is set to [info]
2025-06-24T17:43:57.331880259+08:00[36m [INFO][UPF][Main] [0mReport Caller is set to [false]
2025-06-24T17:43:57.331931601+08:00[36m [INFO][UPF][Main] [0mstarting Gtpu Forwarder [gtp5g]
2025-06-24T17:43:57.331971938+08:00[36m [INFO][UPF][Main] [0mGTP Address: "10.200.200.102:2152"
2025-06-24T17:43:57.338192345+08:00[36m [INFO][UPF][BUFF] [0mbuff netlink server started
2025-06-24T17:43:57.338327537+08:00[36m [INFO][UPF][Gtp5g] [0mForwarder started
2025-06-24T17:43:57.338427191+08:00[36m [INFO][UPF][Perio] [0mperio server started
2025-06-24T17:43:57.338555726+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mstarting pfcp server
2025-06-24T17:43:57.338569635+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server started
2025-06-24T17:43:57.338572667+08:00[36m [INFO][UPF][Main] [0mUPF started
2025-06-24T17:44:02.360911916+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleAssociationSetupRequest
2025-06-24T17:44:02.360962735+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1] [0mNew node
2025-06-24T17:44:09.460158097+08:00[36m [INFO][N3IWF][Main] [0mN3IWF version:  
	Not specify ldflags (which link version) during go build
	go version: go1.21.8 linux/amd64
2025-06-24T17:44:09.461643577+08:00[36m [INFO][N3IWF][CFG] [0mRead config from [./config/n3iwfcfg.test.yaml]
2025-06-24T17:44:09.462113648+08:00[36m [INFO][N3IWF][Main] [0mLog enable is set to [true]
2025-06-24T17:44:09.462172239+08:00[36m [INFO][N3IWF][Main] [0mLog level is set to [info]
2025-06-24T17:44:09.462177352+08:00[36m [INFO][N3IWF][Main] [0mReport Caller is set to [false]
2025-06-24T17:44:09.462232983+08:00[33m [WARN][N3IWF][CTX] [0mParse PKCS8 private key failed: x509: failed to parse private key (use ParsePKCS1PrivateKey instead for this key format)
2025-06-24T17:44:09.462237312+08:00[36m [INFO][N3IWF][CTX] [0mParse using PKCS1...
2025-06-24T17:44:09.467743954+08:00[33m [WARN][N3IWF][Main] [0mnetlink.RouteAdd: file exists
2025-06-24T17:44:09.467761804+08:00[36m [INFO][N3IWF][Main] [0mSetup XFRM interface xfrmi-default
2025-06-24T17:44:09.469964142+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send NG Setup Request
2025-06-24T17:44:09.470373913+08:00[36m [INFO][N3IWF][Main] [0mNGAP service running.
2025-06-24T17:44:09.470667780+08:00[36m [INFO][N3IWF][Main] [0mNAS TCP server successfully started.
2025-06-24T17:44:09.473624781+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle NG Setup Response
2025-06-24T17:44:09.474181699+08:00[36m [INFO][N3IWF][Main] [0mListening NWu user plane traffic
2025-06-24T17:44:09.474252843+08:00[36m [INFO][N3IWF][Main] [0mIKE service running
2025-06-24T17:44:09.474256645+08:00[36m [INFO][N3IWF][Main] [0mN3IWF started
2025-06-24T17:44:15.997842422+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:15.997878946+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:15.997884498+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:15.997889968+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:15.997892744+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:15.997896286+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_SA_INIT
2025-06-24T17:44:16.006992537+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.007049780+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.007055509+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.007058970+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:44:16.007060944+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.007062791+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.007064426+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.007077090+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.007078729+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:44:16.007092308+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.007093812+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.007095284+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.007097288+08:00[36m [INFO][N3IWF][IKE] [0m[KeyExchange] marshal(): Start marshalling
2025-06-24T17:44:16.007098853+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.007105201+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.007106950+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.011960216+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.011971114+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.011973908+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.011982770+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:44:16.011986925+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.011989016+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.011990815+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.012241103+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.012289585+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.012298373+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.012301954+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.012305654+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.012308241+08:00[36m [INFO][N3IWF][IKE] [0mEcoding initiator for later IKE authentication
2025-06-24T17:44:16.012309863+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.012311342+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:44:16.012314766+08:00[36m [INFO][N3IWF][IKE] [0mParsing security association
2025-06-24T17:44:16.012317319+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:44:16.012320121+08:00[36m [INFO][N3IWF][IKE] [0mReceived traffic selector initiator from UE
2025-06-24T17:44:16.013729208+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.013767333+08:00[36m [INFO][N3IWF][IKE] [0m[Identification] marshal(): Start marshalling
2025-06-24T17:44:16.013772259+08:00[36m [INFO][N3IWF][IKE] [0m[Certificate] marshal(): Start marshalling
2025-06-24T17:44:16.013779032+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:44:16.013783619+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.013786001+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:44:16.013794946+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.013796664+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.013798132+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.013820070+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.013821704+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.013823159+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.014898995+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.015156401+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.015209153+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.015215474+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:44:16.015219598+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.015224306+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.015226061+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.015241577+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.015243680+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.015245526+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.015248134+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:44:16.015300013+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.015332666+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.018860234+08:00[36m [INFO][N3IWF][IKE] [0mHandle UnmarshalEAP5GDataResponse event
2025-06-24T17:44:16.019063724+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.019106104+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial UE Message
2025-06-24T17:44:16.043645087+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:44:16.043915876+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.043924719+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:44:16.043935178+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.043937471+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.043939496+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:44:16.043947969+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.043949986+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.043951670+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.043959553+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.043961178+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.043962646+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.045343359+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.045417279+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.045423871+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.045427139+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:44:16.045431220+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.045433406+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.045434937+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.045445370+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.045447390+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.045450200+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.045452925+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:44:16.045458717+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.045462453+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:16.050044481+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:44:16.050140204+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.050148097+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPNASMsg event
2025-06-24T17:44:16.050152420+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.050183557+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.050187847+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] marshal(): Start marshalling
2025-06-24T17:44:16.050196331+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.050198258+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.050199949+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.050211600+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.050213307+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.050214980+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.051835408+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.051908983+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.051914846+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.051917440+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:44:16.051920469+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.051922194+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.051926473+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.051951856+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.051954886+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.051956559+08:00[36m [INFO][N3IWF][IKE] [0m[EAP][Expanded] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.051958926+08:00[36m [INFO][N3IWF][IKE] [0mEAP5G MessageID : 2
2025-06-24T17:44:16.051963281+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.051966420+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:16.107994362+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Initial Context Setup Request
2025-06-24T17:44:16.108215068+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.108253194+08:00[36m [INFO][N3IWF][IKE] [0mHandle SendEAPSuccessMsg event
2025-06-24T17:44:16.108260303+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108262431+08:00[36m [INFO][N3IWF][IKE] [0m[EAP] marshal(): Start marshalling
2025-06-24T17:44:16.108287653+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.108289655+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108291389+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.108303141+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.108304773+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108306293+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.108698818+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.108769381+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.108777343+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.108780325+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE_AUTH
2025-06-24T17:44:16.108784440+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.108786156+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.108788145+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.108803273+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.108805663+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.108812452+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.108847199+08:00[36m [INFO][N3IWF][IKE] [0mInbound SPI: 3662390946, Outbound SPI: 1077898987
2025-06-24T17:44:16.108864186+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.109232016+08:00[36m [INFO][N3IWF][IKE] [0m[Authentication] marshal(): Start marshalling
2025-06-24T17:44:16.109239930+08:00[36m [INFO][N3IWF][IKE] [0m[Configuration] marshal(): Start marshalling
2025-06-24T17:44:16.109242661+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.109246165+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.109261269+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.109263414+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.109268532+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.109276092+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.109277810+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.109279325+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.109456560+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.109460327+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.109461893+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.109483721+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.109620884+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.109679768+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.109693498+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:44:16.109708812+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.109713030+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Initial Context Setup Response
2025-06-24T17:44:16.110310717+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:44:16.110658304+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.111235864+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:16.112350226+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle Downlink NAS Transport
2025-06-24T17:44:16.612339363+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:16.682356075+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:44:16.682377552+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x1][UPSEID:0x1] [0mNew session
2025-06-24T17:44:16.685025290+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:1 period:30000000000}]
2025-06-24T17:44:16.685110802+08:00[36m [INFO][UPF][Perio] [0mnew ticker [30s]
2025-06-24T17:44:16.685575350+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:1 urrid:2 period:30000000000}]
2025-06-24T17:44:16.691590041+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:44:16.691971716+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.695591926+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:44:16.695640743+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.695867613+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.695874911+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.695878394+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.695890168+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.695893048+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.695894749+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.695905611+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.695907507+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.695909164+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.695925301+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.695928233+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.695929880+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.696927640+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.696945589+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.696950765+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696954673+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:44:16.696956934+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17148866021590394380
2025-06-24T17:44:16.696960160+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.696961871+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.696963511+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.696987808+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.696989818+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696993065+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696995156+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.696997287+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.697043951+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.697052258+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.697061915+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:44:16.697208980+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.697315913+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.697347460+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:44:16.698498465+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:16.798291614+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:44:16.847997959+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:44:16.848051232+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x2][UPSEID:0x2] [0mNew session
2025-06-24T17:44:16.850874527+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:1 period:30000000000}]
2025-06-24T17:44:16.851012268+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:2 urrid:2 period:30000000000}]
2025-06-24T17:44:16.860824966+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:44:16.860918823+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.860926135+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:44:16.860950880+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.860953361+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:16.860956257+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:16.860958568+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.860960670+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:16.860962570+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.860964208+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:16.860970949+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.860972646+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.860974952+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.860988942+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.861025601+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.861029965+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.861924257+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:16.861970900+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.861974515+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.861977491+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:44:16.861985936+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17148866021590394380
2025-06-24T17:44:16.861989362+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:16.861991100+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:16.861992719+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:16.862014068+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:16.862016286+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.862019737+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.862022026+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.862024326+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:16.862030382+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.862033540+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:16.862036473+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:44:16.864752364+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-3
2025-06-24T17:44:16.866009960+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.866073694+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:16.866097760+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:44:16.873375437+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:44:16.877073991+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:17.111548558+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:44:17.111567164+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x3][UPSEID:0x3] [0mNew session
2025-06-24T17:44:17.114790210+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:1 period:30000000000}]
2025-06-24T17:44:17.114911367+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:3 urrid:2 period:30000000000}]
2025-06-24T17:44:17.119693694+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:44:17.121929973+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:17.122017830+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:44:17.122042827+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122045429+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:17.122048624+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:17.122051606+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.122053898+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.122055740+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:17.122057453+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:17.122065518+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.122134107+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122138755+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.122155368+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.122157127+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.122158764+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.123046396+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:17.123062684+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.123066272+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.123068967+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:44:17.123071082+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17148866021590394380
2025-06-24T17:44:17.123074228+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.123076001+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.123077535+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.123109564+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.123111765+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.123202798+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.123205679+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.123207882+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.123251328+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:17.123258344+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:17.123260632+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:44:17.126513878+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-4
2025-06-24T17:44:17.126806933+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:17.126907716+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:17.126932990+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:44:17.130488030+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send Uplink NAS Transport
2025-06-24T17:44:17.241728515+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:44:17.284822335+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionEstablishmentRequest
2025-06-24T17:44:17.284848559+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805][CPNodeID:10.200.200.1][CPSEID:0x4][UPSEID:0x4] [0mNew session
2025-06-24T17:44:17.288499505+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:1 period:30000000000}]
2025-06-24T17:44:17.288674693+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_PERIO_ADD][{eType:1 lSeid:4 urrid:2 period:30000000000}]
2025-06-24T17:44:17.296715097+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Handle PDU Session Resource Setup Request
2025-06-24T17:44:17.296797395+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:17.296803535+08:00[36m [INFO][N3IWF][IKE] [0mHandle CreatePDUSession event
2025-06-24T17:44:17.296824561+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.296826929+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] marshal(): Start marshalling
2025-06-24T17:44:17.296830161+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] marshal(): Start marshalling
2025-06-24T17:44:17.296832437+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.296838130+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] marshal(): Start marshalling
2025-06-24T17:44:17.296881601+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:17.296887420+08:00[36m [INFO][N3IWF][IKE] [0m[Notification] marshal(): Start marshalling
2025-06-24T17:44:17.296898560+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.296900536+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.296902451+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.296915296+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.296916879+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.296918375+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.297568693+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE message
2025-06-24T17:44:17.297661613+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.297668669+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297671544+08:00[36m [INFO][N3IWF][IKE] [0mHandle CREATE_CHILD_SA
2025-06-24T17:44:17.297673692+08:00[33m [WARN][N3IWF][IKE] [0mCREATE_CHILD_SA responderSPI: 17148866021590394380
2025-06-24T17:44:17.297677346+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE message
2025-06-24T17:44:17.297679217+08:00[36m [INFO][N3IWF][IKE] [0mEncoding IKE payloads
2025-06-24T17:44:17.297680972+08:00[36m [INFO][N3IWF][IKE] [0m[Encrypted] marshal(): Start marshalling
2025-06-24T17:44:17.297717773+08:00[36m [INFO][N3IWF][IKE] [0mDecoding IKE payloads
2025-06-24T17:44:17.297721324+08:00[36m [INFO][N3IWF][IKE] [0m[SecurityAssociation] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297725684+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297728174+08:00[36m [INFO][N3IWF][IKE] [0m[TrafficSelector] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297730205+08:00[36m [INFO][N3IWF][IKE] [0m[Nonce] unmarshal(): Start unmarshalling received bytes
2025-06-24T17:44:17.297735721+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:17.297738726+08:00[36m [INFO][N3IWF][IKE] [0mHandle IKE event
2025-06-24T17:44:17.297743412+08:00[36m [INFO][N3IWF][IKE] [0mHandle GetNGAPContextResponse event
2025-06-24T17:44:17.301253071+08:00[36m [INFO][N3IWF][IKE] [0mSetup XFRM interface: xfrmi-5
2025-06-24T17:44:17.303531316+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:17.303650067+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP event handle
2025-06-24T17:44:17.303679294+08:00[36m [INFO][N3IWF][NGAP] [0m[N3IWF] Send PDU Session Resource Setup Response
2025-06-24T17:44:17.306796387+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mhandleSessionModificationRequest
2025-06-24T17:44:28.863380433+08:00[36m [INFO][UPF][Main] [0mShutdown UPF ...
2025-06-24T17:44:28.863486178+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mStopping pfcp server
2025-06-24T17:44:28.863567697+08:00[31m [ERRO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mread udp4 10.200.200.101:8805: use of closed network connection
2025-06-24T17:44:28.863577524+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp reciver stopped
2025-06-24T17:44:28.863584796+08:00[36m [INFO][UPF][PFCP][LAddr:10.200.200.101:8805] [0mpfcp server stopped
2025-06-24T17:44:28.898446726+08:00[36m [INFO][UPF][Perio] [0mrecv event[TYPE_SERVER_CLOSE][{eType:4 lSeid:0 urrid:0 period:0}]
2025-06-24T17:44:28.898565616+08:00[36m [INFO][UPF][Perio] [0mperio server stopped
2025-06-24T17:44:28.898589241+08:00[36m [INFO][UPF][Perio] [0mticker[30s] Stopped
2025-06-24T17:44:28.898595096+08:00[36m [INFO][UPF][Main] [0mTerminating UPF...
2025-06-24T17:44:28.898597929+08:00[36m [INFO][UPF][Main] [0mUPF terminated
2025-06-24T17:44:28.898600088+08:00[36m [INFO][UPF][Main] [0mUPF exited
2025-06-24T17:44:29.212666080+08:00[36m [INFO][N3IWF][Main] [0mStopping service created by N3IWF
2025-06-24T17:44:29.212747542+08:00[36m [INFO][N3IWF][NGAP] [0mClose NGAP server....
2025-06-24T17:44:29.213023356+08:00[36m [INFO][N3IWF][NWuCP] [0mClose Nwucp server...
2025-06-24T17:44:29.213059332+08:00[31m [ERRO][N3IWF][NWuCP] [0mTCP server accept failed : accept tcp 10.0.0.1:20000: use of closed network connection. Close the listener...
2025-06-24T17:44:29.213066706+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing tcpListener: close tcp 10.0.0.1:20000: use of closed network connection
2025-06-24T17:44:29.213103698+08:00[31m [ERRO][N3IWF][NWuCP] [0mRead TCP connection failed: read tcp 10.0.0.1:20000->10.0.0.30:33271: use of closed network connection
2025-06-24T17:44:29.213155989+08:00[31m [ERRO][N3IWF][NWuCP] [0mError closing connection: close tcp 10.0.0.1:20000->10.0.0.30:33271: use of closed network connection
2025-06-24T17:44:29.213107235+08:00[33m [WARN][N3IWF][NGAP] [0m[SCTP] Close connection.
2025-06-24T17:44:29.213165214+08:00[31m [ERRO][N3IWF][NGAP] [0mconn close error: bad file descriptor
2025-06-24T17:44:29.213167878+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP receiver stopped
2025-06-24T17:44:29.213171475+08:00[36m [INFO][N3IWF][NGAP] [0mNGAP server stopped
2025-06-24T17:44:29.213117610+08:00[36m [INFO][N3IWF][NWuUP] [0mClose Nwuup server...
2025-06-24T17:44:29.213190490+08:00[31m [ERRO][N3IWF][NWuUP] [0mError read from IPv4 packet connection: read ip 10.0.0.1: raw-read ip4 10.0.0.1: use of closed network connection
2025-06-24T17:44:29.213193124+08:00[31m [ERRO][N3IWF][NWuUP] [0mError closing raw socket: close ip4 10.0.0.1: use of closed network connection
2025-06-24T17:44:29.213197161+08:00[36m [INFO][N3IWF][IKE] [0mClose Ike server...
2025-06-24T17:44:29.213206103+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:500: use of closed network connection
2025-06-24T17:44:29.213209527+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:44:29.213228855+08:00[31m [ERRO][N3IWF][IKE] [0mReadFromUDP failed: read udp 192.168.127.1:4500: use of closed network connection
2025-06-24T17:44:29.213231554+08:00[36m [INFO][N3IWF][IKE] [0mIke receiver stopped
2025-06-24T17:44:29.213235934+08:00[36m [INFO][N3IWF][IKE] [0mIke server stopped
2025-06-24T17:44:29.213297659+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-default fail: no such device
2025-06-24T17:44:29.213308843+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-3 fail: no such device
2025-06-24T17:44:29.213318333+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-4 fail: no such device
2025-06-24T17:44:29.213409864+08:00[31m [ERRO][N3IWF][Main] [0mDelete interface xfrmi-5 fail: no such device
2025-06-24T17:44:29.213414983+08:00[36m [INFO][N3IWF][Main] [0mN3IWF App is terminated
kill: (71430): No such process
